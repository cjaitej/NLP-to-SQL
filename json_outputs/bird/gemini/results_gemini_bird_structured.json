[
    {
        "id": "california_schools",
        "question": "What is the highest eligible free rate for K-12 students in the schools in Alameda County?",
        "original_query": "SELECT `Free Meal Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the maximum value of the 'Percent (%) Eligible Free (K-12)' column.\nThis information is available in the `frpm` table.\nI must filter the results to include only schools located in 'Alameda County', using the 'County Name' column in the `frpm` table.\n\n-- SQL Query\nSELECT\n  MAX(\"Percent (%) Eligible Free (K-12)\")\nFROM frpm\nWHERE\n  \"County Name\" = 'Alameda';",
        "pred_query": "SELECT\n  MAX(\"Percent (%) Eligible Free (K-12)\")\nFROM frpm\nWHERE\n  \"County Name\" = 'Alameda';",
        "pred_time": 0.004456281661987305,
        "orig_time": 0.0039598941802978516,
        "time_ratio": 0.8886094911989728,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Please list the lowest three eligible free rates for students aged 5-17 in continuation schools.",
        "original_query": "SELECT `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` FROM frpm WHERE `Educational Option Type` = 'Continuation School' AND `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` IS NOT NULL ORDER BY `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` ASC LIMIT 3",
        "llm_output": "-- Reasoning\nThe query needs to retrieve the lowest eligible free rates for students aged 5-17.\nThis specific rate is found in the `\"Percent (%) Eligible Free (Ages 5-17)\"` column of the `frpm` table.\nThe condition \"continuation schools\" can be identified by filtering the `frpm` table on the `\"Educational Option Type\"` column, setting its value to 'Continuation'.\nThe results should be ordered in ascending order by the percentage and limited to the top 3. Null values for the percentage should be excluded to ensure only valid rates are considered.\n\n-- SQL Query\nSELECT\n  \"Percent (%) Eligible Free (Ages 5-17)\"\nFROM\n  frpm\nWHERE\n  \"Educational Option Type\" = 'Continuation' AND \"Percent (%) Eligible Free (Ages 5-17)\" IS NOT NULL\nORDER BY\n  \"Percent (%) Eligible Free (Ages 5-17)\" ASC\nLIMIT 3;",
        "pred_query": "SELECT\n  \"Percent (%) Eligible Free (Ages 5-17)\"\nFROM\n  frpm\nWHERE\n  \"Educational Option Type\" = 'Continuation' AND \"Percent (%) Eligible Free (Ages 5-17)\" IS NOT NULL\nORDER BY\n  \"Percent (%) Eligible Free (Ages 5-17)\" ASC\nLIMIT 3;",
        "pred_time": 0.005021333694458008,
        "orig_time": 0.004281282424926758,
        "time_ratio": 0.8526185841128151,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please list the zip code of all the charter schools in Fresno County Office of Education.",
        "original_query": "SELECT T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`District Name` = 'Fresno County Office of Education' AND T1.`Charter School (Y/N)` = 1",
        "llm_output": "-- Reasoning\nI need to find schools that are charter schools and belong to the 'Fresno County Office of Education'.\nThe `schools` table contains information about schools, including their `Charter` status, `District`, and `Zip` code.\nI will filter for `Charter` = 1 and `District` = 'Fresno County Office of Education' and select the `Zip` column.\n\n-- SQL Query\nSELECT Zip FROM schools WHERE Charter = 1 AND District = 'Fresno County Office of Education';",
        "pred_query": "SELECT Zip FROM schools WHERE Charter = 1 AND District = 'Fresno County Office of Education';",
        "pred_time": 0.011570930480957031,
        "orig_time": 0.003789186477661133,
        "time_ratio": 0.32747465589714003,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the unabbreviated mailing address of the school with the highest FRPM count for K-12 students?",
        "original_query": "SELECT T2.MailStreet FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 1",
        "llm_output": "-- Reasoning\nFirst, I need to find the `CDSCode` for the school that has the maximum `FRPM Count (K-12)` from the `frpm` table.\nThen, I will join the `frpm` table with the `schools` table on `CDSCode` to get the mailing address details.\nFinally, I will select the `MailStreet`, `MailCity`, `MailZip`, and `MailState` for the school identified in the first step.\n\n-- SQL Query\nSELECT\n  T2.MailStreet,\n  T2.MailCity,\n  T2.MailZip,\n  T2.MailState\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nORDER BY\n  T1.`FRPM Count (K-12)` DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  T2.MailStreet,\n  T2.MailCity,\n  T2.MailZip,\n  T2.MailState\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nORDER BY\n  T1.`FRPM Count (K-12)` DESC\nLIMIT 1;",
        "pred_time": 0.008044004440307617,
        "orig_time": 0.006647586822509766,
        "time_ratio": 0.8264026793918018,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.",
        "original_query": "SELECT T2.Phone FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`Charter School (Y/N)` = 1 AND T2.OpenDate > '2000-01-01'",
        "llm_output": "-- Reasoning\nI need to query the `schools` table.\nI will filter the results to include only schools where `FundingType` is 'Direct Charter'.\nAdditionally, I will apply a filter for `OpenDate` to be after '2000-01-01'.\nFinally, I will select the `Phone` column from the filtered results.\n\n-- SQL Query\nSELECT\n  Phone\nFROM schools\nWHERE\n  FundingType = 'Direct Charter' AND OpenDate > '2000-01-01';",
        "pred_query": "SELECT\n  Phone\nFROM schools\nWHERE\n  FundingType = 'Direct Charter' AND OpenDate > '2000-01-01';",
        "pred_time": 0.00984644889831543,
        "orig_time": null,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?",
        "original_query": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400",
        "llm_output": "-- Reasoning\nI need to join the `satscores` table with the `schools` table using their common CDS code columns (`cds` and `CDSCode`).\nThen, I will filter for schools where the `AvgScrMath` is less than 400 and the `Virtual` column indicates 'Yes'.\nFinally, I will count the number of distinct `CDSCode`s that satisfy these conditions.\n\n-- SQL Query\nSELECT\n  COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.AvgScrMath < 400 AND T1.Virtual = 'Yes';",
        "pred_query": "SELECT\n  COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.AvgScrMath < 400 AND T1.Virtual = 'Yes';",
        "pred_time": 0.010132789611816406,
        "orig_time": 0.009380340576171875,
        "time_ratio": 0.9257411764705883,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.",
        "original_query": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Magnet = 1 AND T1.NumTstTakr > 500",
        "llm_output": "-- Reasoning\nI need to identify schools based on two conditions: the number of SAT test takers and whether they are magnet schools.\nI will join the `satscores` table (for test taker count) with the `schools` table (for school name and magnet status) using their respective CDS codes.\nThen, I will filter for schools with `NumTstTakr` greater than 500 and `Magnet` status equal to 1.\n\n-- SQL Query\nSELECT\n  T1.School\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.NumTstTakr > 500 AND T1.Magnet = 1;",
        "pred_query": "SELECT\n  T1.School\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.NumTstTakr > 500 AND T1.Magnet = 1;",
        "pred_time": 0.010950565338134766,
        "orig_time": 0.009837627410888672,
        "time_ratio": 0.8983670803396473,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the phone number of the school that has the highest number of test takers with an SAT score of over 1500?",
        "original_query": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the school with the maximum `NumGE1500` from the `satscores` table.\nThen, I will join this result with the `schools` table using the `CDSCode` to retrieve the `Phone` number for that specific school.\nI will order by `NumGE1500` in descending order and limit to 1 to get the top school's phone number.\n\n-- SQL Query\nSELECT\n  T2.Phone\nFROM satscores AS T1\nINNER JOIN schools AS T2\n  ON T1.cds = T2.CDSCode\nORDER BY\n  T1.NumGE1500 DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  T2.Phone\nFROM satscores AS T1\nINNER JOIN schools AS T2\n  ON T1.cds = T2.CDSCode\nORDER BY\n  T1.NumGE1500 DESC\nLIMIT 1;",
        "pred_time": 0.002252817153930664,
        "orig_time": 0.0018203258514404297,
        "time_ratio": 0.8080220129114192,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the number of SAT test takers of the schools with the highest FRPM count for K-12 students?",
        "original_query": "SELECT NumTstTakr FROM satscores WHERE cds = ( SELECT CDSCode FROM frpm ORDER BY `FRPM Count (K-12)` DESC LIMIT 1 )",
        "llm_output": "-- Reasoning\nFirst, I identified the `frpm` table contains the 'FRPM Count (K-12)' needed to determine the schools with the highest count.\nNext, I found the maximum 'FRPM Count (K-12)' using a subquery.\nThen, I joined the `frpm` table with the `satscores` table on their common CDS code (`CDSCode` in `frpm` and `cds` in `satscores`) to link FRPM data with SAT test taker information.\nFinally, I filtered the joined results to include only the schools whose 'FRPM Count (K-12)' matched the maximum value and selected their `NumTstTakr`.\n\n-- SQL Query\nSELECT\n  T2.NumTstTakr\nFROM frpm AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.\"FRPM Count (K-12)\" = (\n    SELECT\n      MAX(\"FRPM Count (K-12)\")\n    FROM frpm\n  );",
        "pred_query": "SELECT\n  T2.NumTstTakr\nFROM frpm AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.\"FRPM Count (K-12)\" = (\n    SELECT\n      MAX(\"FRPM Count (K-12)\")\n    FROM frpm\n  );",
        "pred_time": 0.011189937591552734,
        "orig_time": 0.005475759506225586,
        "time_ratio": 0.4893467422337751,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Among the schools with the average score in Math over 560 in the SAT test, how many schools are directly charter-funded?",
        "original_query": "SELECT COUNT(T2.`School Code`) FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath > 560 AND T2.`Charter Funding Type` = 'Directly funded'",
        "llm_output": "-- Reasoning\nI need to identify schools with an average SAT Math score greater than 560 from the `satscores` table.\nThen, I will join this result with the `schools` table using the `CDSCode` to filter for schools that are 'Directly Funded Charter'.\nFinally, I will count the number of unique schools that satisfy both conditions.\n\n-- SQL Query\nSELECT\n  COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.AvgScrMath > 560 AND T1.FundingType = 'Directly Funded Charter';",
        "pred_query": "SELECT\n  COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.AvgScrMath > 560 AND T1.FundingType = 'Directly Funded Charter';",
        "pred_time": 0.008442878723144531,
        "orig_time": 0.003818988800048828,
        "time_ratio": 0.45233254264091266,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "For the school with the highest average score in Reading in the SAT test, what is its FRPM count for students aged 5-17?",
        "original_query": "SELECT T2.`FRPM Count (Ages 5-17)` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrRead DESC LIMIT 1",
        "llm_output": "-- Reasoning\nFirst, I need to identify the school with the highest average reading score from the `satscores` table.\nThen, I will join this result with the `frpm` table using the common CDSCode/cds to retrieve the corresponding 'FRPM Count (Ages 5-17)'.\n\n-- SQL Query\nSELECT\n  T1.`FRPM Count (Ages 5-17)`\nFROM frpm AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nORDER BY\n  T2.AvgScrRead DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  T1.`FRPM Count (Ages 5-17)`\nFROM frpm AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nORDER BY\n  T2.AvgScrRead DESC\nLIMIT 1;",
        "pred_time": 0.006369113922119141,
        "orig_time": 0.0016362667083740234,
        "time_ratio": 0.25690649097851315,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Please list the codes of the schools with a total enrollment of over 500.",
        "original_query": "SELECT T2.CDSCode FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` + T2.`Enrollment (Ages 5-17)` > 500",
        "llm_output": "-- Reasoning\nTo find the codes of schools with a total enrollment over 500, I will query the `frpm` table. This table contains the `CDSCode` for schools and the `Enrollment (K-12)` column, which represents the total K-12 enrollment. I will filter the results where this enrollment figure exceeds 500.\n\n-- SQL Query\nSELECT\n  CDSCode\nFROM frpm\nWHERE\n  `Enrollment (K-12)` > 500;",
        "pred_query": "SELECT\n  CDSCode\nFROM frpm\nWHERE\n  `Enrollment (K-12)` > 500;",
        "pred_time": 0.006821155548095703,
        "orig_time": 0.009325742721557617,
        "time_ratio": 1.3671793079342887,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Among the schools with an SAT excellence rate of over 0.3, what is the highest eligible free rate for students aged 5-17?",
        "original_query": "SELECT MAX(CAST(T1.`Free Meal Count (Ages 5-17)` AS REAL) / T1.`Enrollment (Ages 5-17)`) FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE CAST(T2.NumGE1500 AS REAL) / T2.NumTstTakr > 0.3",
        "llm_output": "-- Reasoning\nI need to calculate the SAT excellence rate for each school using `NumGE1500` and `NumTstTakr` from the `satscores` table, ensuring `NumTstTakr` is not zero to avoid division by zero errors. I will filter for schools where this rate exceeds 0.3. Then, I will join these filtered schools with the `frpm` table on their common CDS code to retrieve the `Percent (%) Eligible Free (Ages 5-17)` and find the maximum among them.\n\n-- SQL Query\nSELECT\n  MAX(T2.`Percent (%) Eligible Free (Ages 5-17)`)\nFROM satscores AS T1\nINNER JOIN frpm AS T2\n  ON T1.cds = T2.CDSCode\nWHERE\n  T1.NumTstTakr > 0 AND (CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr) > 0.3;",
        "pred_query": "SELECT\n  MAX(T2.`Percent (%) Eligible Free (Ages 5-17)`)\nFROM satscores AS T1\nINNER JOIN frpm AS T2\n  ON T1.cds = T2.CDSCode\nWHERE\n  T1.NumTstTakr > 0 AND (CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr) > 0.3;",
        "pred_time": 0.0036115646362304688,
        "orig_time": 0.002767801284790039,
        "time_ratio": 0.7663717982571957,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please list the phone numbers of the schools with the top 3 SAT excellence rate.",
        "original_query": "SELECT T1.Phone FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY CAST(T2.NumGE1500 AS REAL) / T2.NumTstTakr DESC LIMIT 3",
        "llm_output": "-- Reasoning\nI need to calculate the SAT excellence rate for each school by dividing the number of students scoring 1500 or higher (`NumGE1500`) by the total number of test-takers (`NumTstTakr`) from the `satscores` table, ensuring to filter for actual schools (`rtype = 'S'`) and valid test taker counts. Then, I will join this with the `schools` table on `CDSCode` to retrieve the corresponding phone numbers. Finally, I will order the results by the calculated excellence rate in descending order and limit to the top 3.\n\n-- SQL Query\nSELECT T2.Phone\nFROM satscores AS T1\nINNER JOIN schools AS T2\n  ON T1.cds = T2.CDSCode\nWHERE\n  T1.rtype = 'S' AND T1.NumTstTakr > 0\nORDER BY\n  CAST(T1.NumGE1500 AS REAL) * 100 / T1.NumTstTakr DESC\nLIMIT 3;",
        "pred_query": "SELECT T2.Phone\nFROM satscores AS T1\nINNER JOIN schools AS T2\n  ON T1.cds = T2.CDSCode\nWHERE\n  T1.rtype = 'S' AND T1.NumTstTakr > 0\nORDER BY\n  CAST(T1.NumGE1500 AS REAL) * 100 / T1.NumTstTakr DESC\nLIMIT 3;",
        "pred_time": 0.003492593765258789,
        "orig_time": 0.015584707260131836,
        "time_ratio": 4.462215850911325,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "List the top five schools, by descending order, from the highest to the lowest, the most number of Enrollment (Ages 5-17). Please give their NCES school identification number.",
        "original_query": "SELECT T1.NCESSchool FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T2.`Enrollment (Ages 5-17)` DESC LIMIT 5",
        "llm_output": "-- Reasoning\nI need to retrieve the `NCESSchool` from the `schools` table and `Enrollment (Ages 5-17)` from the `frpm` table. I will join these two tables on their common `CDSCode`. Then, I will order the results by `Enrollment (Ages 5-17)` in descending order and limit the output to the top five.\n\n-- SQL Query\nSELECT\n  T1.NCESSchool\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nORDER BY\n  T2.`Enrollment (Ages 5-17)` DESC\nLIMIT 5;",
        "pred_query": "SELECT\n  T1.NCESSchool\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nORDER BY\n  T2.`Enrollment (Ages 5-17)` DESC\nLIMIT 5;",
        "pred_time": 0.016446828842163086,
        "orig_time": 0.013815641403198242,
        "time_ratio": 0.8400185552962324,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Which active district has the highest average score in Reading?",
        "original_query": "SELECT T1.District FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.StatusType = 'Active' ORDER BY T2.AvgScrRead DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the district with the highest average reading score. I will join `satscores` with `schools` on their respective CDS codes to filter for active schools. Then, I will group the results by district name (`dname` from `satscores`), calculate the average `AvgScrRead` for each district, and order by this average in descending order to get the top district.\n\n-- SQL Query\nSELECT\n  T1.dname\nFROM satscores AS T1\nINNER JOIN schools AS T2\n  ON T1.cds = T2.CDSCode\nWHERE\n  T2.StatusType = 'Active'\nGROUP BY\n  T1.dname\nORDER BY\n  AVG(T1.AvgScrRead) DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  T1.dname\nFROM satscores AS T1\nINNER JOIN schools AS T2\n  ON T1.cds = T2.CDSCode\nWHERE\n  T2.StatusType = 'Active'\nGROUP BY\n  T1.dname\nORDER BY\n  AVG(T1.AvgScrRead) DESC\nLIMIT 1;",
        "pred_time": 0.01201486587524414,
        "orig_time": 0.010001182556152344,
        "time_ratio": 0.8324006826209469,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "How many schools in merged Alameda have number of test takers less than 100?",
        "original_query": "SELECT COUNT(T1.CDSCode) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.StatusType = 'Merged' AND T2.NumTstTakr < 100 AND T1.County = 'Alameda'",
        "llm_output": "-- Reasoning\nI need to identify schools in 'Alameda' county and then filter those by the number of test takers.\nI will join the `schools` table with the `satscores` table using their common `CDSCode`/`cds` column.\nThen, I'll apply a filter for `County` = 'Alameda' and `NumTstTakr` < 100.\nFinally, I will count the distinct schools that satisfy these conditions.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T1.School)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Alameda' AND T2.NumTstTakr < 100;",
        "pred_query": "SELECT\n  COUNT(DISTINCT T1.School)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Alameda' AND T2.NumTstTakr < 100;",
        "pred_time": 0.013509750366210938,
        "orig_time": 0.013528823852539062,
        "time_ratio": 1.001411831144995,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the charter number of the school that the average score in Writing is 499?",
        "original_query": "SELECT T1.CharterNum FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.AvgScrWrite = 499",
        "llm_output": "-- Reasoning\nI need to find the `Charter School Number` from the `frpm` table. The condition for filtering is based on the `AvgScrWrite` in the `satscores` table. Both tables can be joined using their CDS code columns (`CDSCode` in `frpm` and `cds` in `satscores`).\n\n-- SQL Query\nSELECT\n  T1.`Charter School Number`\nFROM frpm AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.AvgScrWrite = 499;",
        "pred_query": "SELECT\n  T1.`Charter School Number`\nFROM frpm AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.AvgScrWrite = 499;",
        "pred_time": 0.0013561248779296875,
        "orig_time": 0.0009360313415527344,
        "time_ratio": 0.690225035161744,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "How many schools in Contra Costa (directly funded) have number of test takers not more than 250?",
        "original_query": "SELECT COUNT(T1.CDSCode) FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`County Name` = 'Contra Costa' AND T2.NumTstTakr <= 250",
        "llm_output": "-- Reasoning\nI need to count schools based on three criteria: county, funding type, and SAT test taker count. The `schools` table contains county and funding type information. The `satscores` table contains the number of test takers and links to schools via `cds` (which corresponds to `CDSCode` in `schools`). I will join these two tables on their respective school identifier columns, apply the three filters, and then count the distinct school codes.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Contra Costa' AND T1.FundingType = 'Direct Funded' AND T2.NumTstTakr <= 250;",
        "pred_query": "SELECT\n  COUNT(DISTINCT T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Contra Costa' AND T1.FundingType = 'Direct Funded' AND T2.NumTstTakr <= 250;",
        "pred_time": 0.01034688949584961,
        "orig_time": 0.0040514469146728516,
        "time_ratio": 0.39156182312548965,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the phone number of the school that has the highest average score in Math?",
        "original_query": "SELECT T1.Phone FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the school with the highest 'AvgScrMath' from the `satscores` table.\nThen, I will join this result with the `schools` table using the common `CDSCode` (or `cds`) to retrieve the corresponding 'Phone' number.\nI will order the `satscores` by `AvgScrMath` in descending order and limit to 1 to get the school with the highest score, then join and select the phone number.\n\n-- SQL Query\nSELECT\n  T2.Phone\nFROM satscores AS T1\nINNER JOIN schools AS T2\n  ON T1.cds = T2.CDSCode\nORDER BY\n  T1.AvgScrMath DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  T2.Phone\nFROM satscores AS T1\nINNER JOIN schools AS T2\n  ON T1.cds = T2.CDSCode\nORDER BY\n  T1.AvgScrMath DESC\nLIMIT 1;",
        "pred_time": 0.002341032028198242,
        "orig_time": 0.011425256729125977,
        "time_ratio": 4.8804358896017925,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "How many schools in Amador which the Low Grade is 9 and the High Grade is 12?",
        "original_query": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12",
        "llm_output": "-- Reasoning\nI need to count schools based on county and grade range. The `frpm` table contains `County Name`, `Low Grade`, and `High Grade`. I will filter this table for 'Amador' county, '09' for Low Grade, and '12' for High Grade, and then count the resulting rows (which correspond to schools).\n\n-- SQL Query\nSELECT\n  COUNT(CDSCode)\nFROM frpm\nWHERE\n  `County Name` = 'AMADOR' AND `Low Grade` = '09' AND `High Grade` = '12';",
        "pred_query": "SELECT\n  COUNT(CDSCode)\nFROM frpm\nWHERE\n  `County Name` = 'AMADOR' AND `Low Grade` = '09' AND `High Grade` = '12';",
        "pred_time": 0.004117250442504883,
        "orig_time": 0.008850812911987305,
        "time_ratio": 2.1496901963055186,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12?",
        "original_query": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `Free Meal Count (K-12)` < 700",
        "llm_output": "-- Reasoning\nI need to count schools based on meal data and county. The `frpm` table contains the meal counts and county name, while the `schools` table can also provide county information and is linked by `CDSCode`. I will filter the `frpm` table by 'Los Angeles' county and then apply the conditions for 'Free Meal Count (K-12)' and 'FRPM Count (K-12)'. Finally, I will count the distinct schools that meet all criteria.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T1.`School Name`)\nFROM frpm AS T1\nWHERE\n  T1.`County Name` = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700;",
        "pred_query": "SELECT\n  COUNT(DISTINCT T1.`School Name`)\nFROM frpm AS T1\nWHERE\n  T1.`County Name` = 'Los Angeles' AND T1.`Free Meal Count (K-12)` > 500 AND T1.`FRPM Count (K-12)` < 700;",
        "pred_time": 0.004293203353881836,
        "orig_time": 0.004271030426025391,
        "time_ratio": 0.9948353418115178,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which school in Contra Costa has the highest number of test takers?",
        "original_query": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND sname IS NOT NULL ORDER BY NumTstTakr DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the school with the maximum `NumTstTakr` from the `satscores` table.\nThe county name is available as `cname` in the `satscores` table.\nI will filter the `satscores` table for `cname` 'Contra Costa', order by `NumTstTakr` in descending order, and take the top result to find the school name.\n\n-- SQL Query\nSELECT sname\nFROM satscores\nWHERE cname = 'Contra Costa'\nORDER BY NumTstTakr DESC\nLIMIT 1;",
        "pred_query": "SELECT sname\nFROM satscores\nWHERE cname = 'Contra Costa'\nORDER BY NumTstTakr DESC\nLIMIT 1;",
        "pred_time": 0.001697540283203125,
        "orig_time": 0.0010101795196533203,
        "time_ratio": 0.5950842696629214,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools.",
        "original_query": "SELECT T1.School, T1.StreetAbr FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30",
        "llm_output": "-- Reasoning\nI need to retrieve school names and full addresses from the `schools` table. The enrollment data is in the `frpm` table.\nI will join `schools` and `frpm` tables on `CDSCode`.\nThen, I'll filter for schools where the absolute difference between `Enrollment (K-12)` and `Enrollment (Ages 5-17)` from the `frpm` table is greater than 30.\nFinally, I will select the school name and concatenate the street, city, state, and zip from the `schools` table to form the full address.\n\n-- SQL Query\nSELECT\n  T1.School,\n  T1.Street || ', ' || T1.City || ', ' || T1.State || ' ' || T1.Zip\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  ABS(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > 30;",
        "pred_query": "SELECT\n  T1.School,\n  T1.Street || ', ' || T1.City || ', ' || T1.State || ' ' || T1.Zip\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  ABS(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > 30;",
        "pred_time": null,
        "orig_time": null,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500?",
        "original_query": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS REAL) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0",
        "llm_output": "-- Reasoning\nI need to retrieve school names from the `schools` table. To apply the filtering conditions, I will join `schools` with `frpm` on `CDSCode` and with `satscores` on `CDSCode` (aliased as `cds`). The conditions are `frpm.\"Percent (%) Eligible Free (K-12)\"` > 0.1 and `satscores.NumGE1500` > 0.\n\n-- SQL Query\nSELECT DISTINCT\n  T1.School\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nINNER JOIN satscores AS T3\n  ON T1.CDSCode = T3.cds\nWHERE\n  T2.\"Percent (%) Eligible Free (K-12)\" > 0.1 AND T3.NumGE1500 > 0;",
        "pred_query": "SELECT DISTINCT\n  T1.School\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nINNER JOIN satscores AS T3\n  ON T1.CDSCode = T3.cds\nWHERE\n  T2.\"Percent (%) Eligible Free (K-12)\" > 0.1 AND T3.NumGE1500 > 0;",
        "pred_time": null,
        "orig_time": 0.004319429397583008,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools?",
        "original_query": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / COUNT(T1.cds) > 400",
        "llm_output": "-- Reasoning\nI need to retrieve the names and funding types of schools located in Riverside county.\nThese schools must also have an average SAT math score greater than 400.\nI will join the `schools` table with the `satscores` table on their common CDSCode/cds identifier, filter by county and math score, and then select the required columns.\n\n-- SQL Query\nSELECT\n  s.School,\n  s.FundingType\nFROM schools AS s\nJOIN satscores AS ss\n  ON s.CDSCode = ss.cds\nWHERE\n  s.County = 'Riverside' AND ss.AvgScrMath > 400;",
        "pred_query": "SELECT\n  s.School,\n  s.FundingType\nFROM schools AS s\nJOIN satscores AS ss\n  ON s.CDSCode = ss.cds\nWHERE\n  s.County = 'Riverside' AND ss.AvgScrMath > 400;",
        "pred_time": null,
        "orig_time": 0.0047266483306884766,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17?",
        "original_query": "SELECT T1.`School Name`, T2.Zip, T2.Street, T2.City, T2.State FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'",
        "llm_output": "-- Reasoning\nThe query joins the `schools` and `frpm` tables on `CDSCode` to combine school demographic and meal program data. It filters for schools in 'Monterey' county and specifically identifies 'High School' type from the `frpm` table. Finally, it applies the condition that the \"FRPM Count (Ages 5-17)\" must be greater than 800 and selects the school's name and mailing address details.\n\n-- SQL Query\nSELECT\n  T1.School,\n  T1.MailStreet,\n  T1.MailCity,\n  T1.MailZip,\n  T1.MailState\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.County = 'Monterey' AND T2.`School Type` = 'High School' AND T2.`FRPM Count (Ages 5-17)` > 800;",
        "pred_query": "SELECT\n  T1.School,\n  T1.MailStreet,\n  T1.MailCity,\n  T1.MailZip,\n  T1.MailState\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.County = 'Monterey' AND T2.`School Type` = 'High School' AND T2.`FRPM Count (Ages 5-17)` > 800;",
        "pred_time": 0.009515523910522461,
        "orig_time": 0.008899450302124023,
        "time_ratio": 0.9352559444764601,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any.",
        "original_query": "SELECT T2.School, T1.AvgScrWrite, T2.Phone, strftime('%Y', T2.OpenDate), strftime('%Y', T2.ClosedDate) FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE strftime('%Y', T2.OpenDate) > '1991' AND strftime('%Y', T2.ClosedDate) < '2000'",
        "llm_output": "-- Reasoning\nI need to retrieve the average writing scores, school names, and phone numbers. The `satscores` table contains writing scores, and the `schools` table contains school names, open dates, closed dates, and phone numbers. I will join these two tables on their common `CDSCode`/`cds` column. Then, I'll filter the results to include only schools that were opened after 1991 or closed before 2000.\n\n-- SQL Query\nSELECT\n  T1.School,\n  T2.AvgScrWrite,\n  T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  CAST(strftime('%Y', T1.OpenDate) AS INTEGER) > 1991 OR CAST(strftime('%Y', T1.ClosedDate) AS INTEGER) < 2000;",
        "pred_query": "SELECT\n  T1.School,\n  T2.AvgScrWrite,\n  T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  CAST(strftime('%Y', T1.OpenDate) AS INTEGER) > 1991 OR CAST(strftime('%Y', T1.ClosedDate) AS INTEGER) < 2000;",
        "pred_time": null,
        "orig_time": 0.011512517929077148,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average.",
        "original_query": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')",
        "llm_output": "-- Reasoning\nI first calculate the average difference between K-12 enrollment and 15-17 enrollment exclusively for schools designated as 'Locally Funded' in the `frpm` table, ensuring both enrollment figures are non-null for accurate calculation.\nThen, I join the `frpm` and `schools` tables on `CDSCode` to access both enrollment data and DOC type.\nFinally, I filter this joined data to include only schools that are 'Locally Funded', have non-null enrollment figures, and whose individual enrollment difference is greater than the previously calculated average difference, selecting their school name and DOC type.\n\n-- SQL Query\nSELECT\n  T1.`School Name`,\n  T2.DOCType\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`Charter Funding Type` = 'Locally Funded' AND T1.`Enrollment (K-12)` IS NOT NULL AND T1.`Enrollment (Ages 5-17)` IS NOT NULL AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (\n    SELECT\n      AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`)\n    FROM frpm AS T3\n    WHERE\n      T3.`Charter Funding Type` = 'Locally Funded' AND T3.`Enrollment (K-12)` IS NOT NULL AND T3.`Enrollment (Ages 5-17)` IS NOT NULL\n  );",
        "pred_query": "SELECT\n  T1.`School Name`,\n  T2.DOCType\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`Charter Funding Type` = 'Locally Funded' AND T1.`Enrollment (K-12)` IS NOT NULL AND T1.`Enrollment (Ages 5-17)` IS NOT NULL AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (\n    SELECT\n      AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`)\n    FROM frpm AS T3\n    WHERE\n      T3.`Charter Funding Type` = 'Locally Funded' AND T3.`Enrollment (K-12)` IS NOT NULL AND T3.`Enrollment (Ages 5-17)` IS NOT NULL\n  );",
        "pred_time": 0.00412297248840332,
        "orig_time": 0.018237590789794922,
        "time_ratio": 4.423408315503383,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "When did the first-through-twelfth-grade school with the largest enrollment open?",
        "original_query": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1",
        "llm_output": "-- Reasoning\nThe question asks for the `OpenDate` of the school that serves grades 1-12 and has the largest enrollment.\n1. Identify schools that serve grades 1 through 12 by filtering the `frpm` table where `Low Grade` is '1' and `High Grade` is '12'.\n2. From these schools, find the one with the maximum `Enrollment (K-12)`. This is done by ordering the results by `Enrollment (K-12)` in descending order and limiting to 1.\n3. Join the filtered `frpm` data with the `schools` table using `CDSCode` to retrieve the `OpenDate`.\n\n-- SQL Query\nSELECT\n  T2.OpenDate\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`Low Grade` = '1' AND T1.`High Grade` = '12'\nORDER BY\n  T1.`Enrollment (K-12)` DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  T2.OpenDate\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`Low Grade` = '1' AND T1.`High Grade` = '12'\nORDER BY\n  T1.`Enrollment (K-12)` DESC\nLIMIT 1;",
        "pred_time": 0.004889011383056641,
        "orig_time": 0.0073089599609375,
        "time_ratio": 1.4949770798790598,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which cities have the top 5 lowest enrollment number for students in grades 1 through 12?",
        "original_query": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5",
        "llm_output": "-- Reasoning\nI need to find the cities with the lowest enrollment. The `frpm` table contains enrollment numbers (`Enrollment (K-12)`), and the `schools` table contains city names (`City`). I will join these two tables on `CDSCode`, group the results by city, sum the enrollment for each city, and then order by the total enrollment in ascending order to find the lowest. Finally, I will limit the output to the top 5 cities.\n\n-- SQL Query\nSELECT\n  T2.City\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nGROUP BY\n  T2.City\nORDER BY\n  SUM(T1.`Enrollment (K-12)`) ASC\nLIMIT 5;",
        "pred_query": "SELECT\n  T2.City\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nGROUP BY\n  T2.City\nORDER BY\n  SUM(T1.`Enrollment (K-12)`) ASC\nLIMIT 5;",
        "pred_time": 0.018004179000854492,
        "orig_time": 0.016327857971191406,
        "time_ratio": 0.9068926703303979,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12?",
        "original_query": "SELECT CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 9, 2",
        "llm_output": "-- Reasoning\nI need to retrieve the school name and the 'Percent (%) Eligible Free (K-12)' from the `frpm` table.\nTo identify the 10th and 11th schools with the highest enrollment, I will sort the data by 'Enrollment (K-12)' in descending order.\nThen, I will use `LIMIT 2 OFFSET 9` to select exactly the 10th and 11th rows from the sorted result set.\n\n-- SQL Query\nSELECT\n  \"School Name\",\n  \"Percent (%) Eligible Free (K-12)\"\nFROM frpm\nORDER BY\n  \"Enrollment (K-12)\" DESC\nLIMIT 2 OFFSET 9;",
        "pred_query": "SELECT\n  \"School Name\",\n  \"Percent (%) Eligible Free (K-12)\"\nFROM frpm\nORDER BY\n  \"Enrollment (K-12)\" DESC\nLIMIT 2 OFFSET 9;",
        "pred_time": 0.004601240158081055,
        "orig_time": 0.0041446685791015625,
        "time_ratio": 0.9007720607285351,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66?",
        "original_query": "SELECT CAST(T1.`FRPM Count (K-12)` AS REAL) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5",
        "llm_output": "-- Reasoning\nI need to join the `frpm` and `schools` tables using their common `CDSCode`.\nI will filter the results to include only schools where the `DOC` (ownership code) is '66'.\nThen, I will order these schools by `FRPM Count (K-12)` in descending order to find the top schools.\nFinally, I will limit the results to the top 5 and select the `Percent (%) Eligible FRPM (K-12)` for these schools.\n\n-- SQL Query\nSELECT\n  T1.`Percent (%) Eligible FRPM (K-12)`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.DOC = '66'\nORDER BY\n  T1.`FRPM Count (K-12)` DESC\nLIMIT 5;",
        "pred_query": "SELECT\n  T1.`Percent (%) Eligible FRPM (K-12)`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.DOC = '66'\nORDER BY\n  T1.`FRPM Count (K-12)` DESC\nLIMIT 5;",
        "pred_time": 0.011456489562988281,
        "orig_time": 0.013144493103027344,
        "time_ratio": 1.1473403812536418,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school.",
        "original_query": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND T2.Website IS NOT NULL",
        "llm_output": "-- Reasoning\nI need to retrieve the website address and school name. The 'Free Meal Count (Ages 5-17)' is in the `frpm` table, and the 'Website' and 'School Name' are in the `schools` table. I will join `frpm` and `schools` tables on `CDSCode` and filter for 'Free Meal Count (Ages 5-17)' between 1900 and 2000.\n\n-- SQL Query\nSELECT T2.Website, T1.`School Name`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000;",
        "pred_query": "SELECT T2.Website, T1.`School Name`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000;",
        "pred_time": null,
        "orig_time": 0.00400090217590332,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson?",
        "original_query": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS REAL) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'",
        "llm_output": "-- Reasoning\nTo find the free rate for students aged 5-17, I need to query the `frpm` table. The question specifies a school by its administrator, Kacey Gibson. The `schools` table contains administrator names and the `CDSCode`, which is a common identifier with the `frpm` table. Therefore, I will join `frpm` with `schools` on `CDSCode`, filter by the administrator's first and last name, and then select the `Percent (%) Eligible Free (Ages 5-17)`.\n\n-- SQL Query\nSELECT T1.`Percent (%) Eligible Free (Ages 5-17)`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson';",
        "pred_query": "SELECT T1.`Percent (%) Eligible Free (Ages 5-17)`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.AdmFName1 = 'Kacey' AND T2.AdmLName1 = 'Gibson';",
        "pred_time": 0.010881900787353516,
        "orig_time": 0.009860754013061523,
        "time_ratio": 0.9061609920687086,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12?",
        "original_query": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the administrator's email of a chartered school.\nI will join the `schools` and `frpm` tables using `CDSCode`.\nI'll filter for chartered schools using the `Charter` column in the `schools` table.\nThen, I will order the results by the `Enrollment (K-12)` column from the `frpm` table in ascending order to find the school with the fewest students and limit the result to one.\n\n-- SQL Query\nSELECT T1.AdmEmail1\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.Charter = 1\nORDER BY\n  T2.`Enrollment (K-12)` ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.AdmEmail1\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.Charter = 1\nORDER BY\n  T2.`Enrollment (K-12)` ASC\nLIMIT 1;",
        "pred_time": 0.017760753631591797,
        "orig_time": 0.00719761848449707,
        "time_ratio": 0.40525411442532283,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Under whose administration does the school with the highest number of test takers whose total SAT Scores are greater or equal to 1500 belong to? Indicate his or her full name.",
        "original_query": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nFirst, I will find the `cds` (school identifier) from the `satscores` table that has the maximum value for `NumGE1500`.\nThen, I will join this `cds` with the `schools` table using the `CDSCode` to link to the school's administrative information.\nFinally, I will concatenate `AdmFName1` and `AdmLName1` from the `schools` table to get the full name of the administrator.\n\n-- SQL Query\nSELECT T1.AdmFName1 || ' ' || T1.AdmLName1 AS AdministratorFullName\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nORDER BY\n  T2.NumGE1500 DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.AdmFName1 || ' ' || T1.AdmLName1 AS AdministratorFullName\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nORDER BY\n  T2.NumGE1500 DESC\nLIMIT 1;",
        "pred_time": 0.012215852737426758,
        "orig_time": 0.0021224021911621094,
        "time_ratio": 0.17374163202373286,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State.",
        "original_query": "SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr ASC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the school with the lowest \"excellence rate\". From the `satscores` table, `NumGE1500` (number of test takers scoring >= 1500) and `NumTstTakr` (total number of test takers) can be used to calculate an excellence rate: `NumGE1500 / NumTstTakr`. I will join `schools` and `satscores` tables on their respective CDSCode/cds columns. I'll filter out schools with zero test takers to avoid division by zero. Finally, I will order by this calculated rate in ascending order and take the top result to get the address details.\n\n-- SQL Query\nSELECT\n  T1.Street,\n  T1.City,\n  T1.Zip,\n  T1.State\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.NumTstTakr > 0\nORDER BY\n  CAST(T2.NumGE1500 AS REAL) / T2.NumTstTakr\nLIMIT 1;",
        "pred_query": "SELECT\n  T1.Street,\n  T1.City,\n  T1.Zip,\n  T1.State\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.NumTstTakr > 0\nORDER BY\n  CAST(T2.NumGE1500 AS REAL) / T2.NumTstTakr\nLIMIT 1;",
        "pred_time": 0.002384185791015625,
        "orig_time": 0.0019304752349853516,
        "time_ratio": 0.8097,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers?",
        "original_query": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'",
        "llm_output": "-- Reasoning\nI need to find schools in 'Los Angeles' County from the `schools` table. I also need to filter by the number of test takers from the `satscores` table. I will join these two tables on their respective CDSCode/cds columns and select the `Website` for the matching schools.\n\n-- SQL Query\nSELECT\n  T1.Website\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;",
        "pred_query": "SELECT\n  T1.Website\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;",
        "pred_time": 0.01043391227722168,
        "orig_time": 0.008486270904541016,
        "time_ratio": 0.8133354660329503,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980?",
        "original_query": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) = '1980' AND T2.County = 'Fresno'",
        "llm_output": "-- Reasoning\nI need to join the `schools` table with the `satscores` table to link school opening dates and county information with SAT test taker data.\nI will filter the `schools` table for `County = 'Fresno'` and `OpenDate` within the specified range ('1980-01-01' and '1980-12-31').\nFinally, I will calculate the average of `NumTstTakr` from the `satscores` table for the filtered schools.\n\n-- SQL Query\nSELECT\n  AVG(T2.NumTstTakr)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Fresno' AND T1.OpenDate BETWEEN '1980-01-01' AND '1980-12-31';",
        "pred_query": "SELECT\n  AVG(T2.NumTstTakr)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Fresno' AND T1.OpenDate BETWEEN '1980-01-01' AND '1980-12-31';",
        "pred_time": 0.010113716125488281,
        "orig_time": 0.012684822082519531,
        "time_ratio": 1.2542197076850543,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the telephone number for the school with the lowest average score in reading in Fresno Unified?",
        "original_query": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the school in 'Fresno Unified' district with the lowest average reading score. I will query the `satscores` table, filter by district name, order by `AvgScrRead` ascending, and limit to 1 to find the specific school's `cds`. Then, I will join this result with the `schools` table on `CDSCode` to retrieve its `Phone` number.\n\n-- SQL Query\nSELECT\n  T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.dname = 'Fresno Unified'\nORDER BY\n  T2.AvgScrRead\nLIMIT 1;",
        "pred_query": "SELECT\n  T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.dname = 'Fresno Unified'\nORDER BY\n  T2.AvgScrRead\nLIMIT 1;",
        "pred_time": 0.0012202262878417969,
        "orig_time": 0.009366273880004883,
        "time_ratio": 7.675849941383353,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which exclusively virtual schools have the top 5 highest average reading scores?",
        "original_query": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' ORDER BY T1.AvgScrRead DESC LIMIT 5",
        "llm_output": "-- Reasoning\nI need to identify virtual schools from the `schools` table and then find their average reading scores from the `satscores` table. I will join these tables on their common CDSCode/cds identifier. Finally, I will order the results by average reading score in descending order and limit to the top 5.\n\n-- SQL Query\nSELECT\n  T1.School,\n  T2.AvgScrRead\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.Virtual = 'Yes'\nORDER BY\n  T2.AvgScrRead DESC\nLIMIT 5;",
        "pred_query": "SELECT\n  T1.School,\n  T2.AvgScrRead\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.Virtual = 'Yes'\nORDER BY\n  T2.AvgScrRead DESC\nLIMIT 5;",
        "pred_time": 0.0113983154296875,
        "orig_time": 0.010486364364624023,
        "time_ratio": 0.9199924698795181,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the type of education offered in the school who scored the highest average in Math?",
        "original_query": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the school with the highest average Math score and then retrieve its educational option type.\nI will first find the maximum `AvgScrMath` from the `satscores` table.\nThen, I will join `satscores` with `frpm` on their common school identifier (`cds` and `CDSCode` respectively).\nFinally, I will filter for the row(s) corresponding to the maximum Math score and select the `Educational Option Type`.\n\n-- SQL Query\nSELECT T1.`Educational Option Type`\nFROM frpm AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nORDER BY\n  T2.AvgScrMath DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.`Educational Option Type`\nFROM frpm AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nORDER BY\n  T2.AvgScrMath DESC\nLIMIT 1;",
        "pred_time": 0.0063745975494384766,
        "orig_time": 0.0023229122161865234,
        "time_ratio": 0.36440139133036614,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the average math score of the school with the lowest average score for all subjects, and in which county is it located?",
        "original_query": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath IS NOT NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the school with the lowest combined average score from the `satscores` table.\nFirst, I will sum `AvgScrRead`, `AvgScrMath`, and `AvgScrWrite` for each school, ensuring all three scores are not NULL.\nThen, I will order these schools by their sum of scores in ascending order and select the `cds` of the top school.\nFinally, I will use this `cds` to retrieve the `AvgScrMath` and `cname` (county name) for that specific school from the `satscores` table.\n\n-- SQL Query\nSELECT\n  T1.AvgScrMath,\n  T1.cname\nFROM satscores AS T1\nWHERE\n  T1.cds = (\n    SELECT\n      T2.cds\n    FROM satscores AS T2\n    WHERE\n      T2.AvgScrRead IS NOT NULL AND T2.AvgScrMath IS NOT NULL AND T2.AvgScrWrite IS NOT NULL\n    ORDER BY\n      (T2.AvgScrRead + T2.AvgScrMath + T2.AvgScrWrite) ASC\n    LIMIT 1\n  );",
        "pred_query": "SELECT\n  T1.AvgScrMath,\n  T1.cname\nFROM satscores AS T1\nWHERE\n  T1.cds = (\n    SELECT\n      T2.cds\n    FROM satscores AS T2\n    WHERE\n      T2.AvgScrRead IS NOT NULL AND T2.AvgScrMath IS NOT NULL AND T2.AvgScrWrite IS NOT NULL\n    ORDER BY\n      (T2.AvgScrRead + T2.AvgScrMath + T2.AvgScrWrite) ASC\n    LIMIT 1\n  );",
        "pred_time": 0.0015535354614257812,
        "orig_time": 0.0018775463104248047,
        "time_ratio": 1.2085635359116023,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated.",
        "original_query": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nThe query identifies the school with the highest number of test takers scoring 1500 or more by ordering the `satscores` table by `NumGE1500` in descending order. It then limits the result to the top entry. Finally, it joins this result with the `schools` table on `CDSCode` to retrieve the corresponding average writing score and city.\n\n-- SQL Query\nSELECT\n  T1.AvgScrWrite,\n  T2.City\nFROM satscores AS T1\nINNER JOIN schools AS T2\n  ON T1.cds = T2.CDSCode\nORDER BY\n  T1.NumGE1500 DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  T1.AvgScrWrite,\n  T2.City\nFROM satscores AS T1\nINNER JOIN schools AS T2\n  ON T1.cds = T2.CDSCode\nORDER BY\n  T1.NumGE1500 DESC\nLIMIT 1;",
        "pred_time": 0.002283811569213867,
        "orig_time": 0.0018684864044189453,
        "time_ratio": 0.8181438563524376,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores.",
        "original_query": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'",
        "llm_output": "-- Reasoning\nTo find the average writing scores for schools managed by Ricci Ulrich, I will join the `schools` table with the `satscores` table using their common CDSCode/cds. I will then filter the results to include only schools where any of the three administrator name fields match 'Ricci' as first name and 'Ulrich' as last name. Finally, I will select the school name and its average writing score.\n\n-- SQL Query\nSELECT\n  T2.sname,\n  T2.AvgScrWrite\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  (\n    T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich'\n  ) OR (\n    T1.AdmFName2 = 'Ricci' AND T1.AdmLName2 = 'Ulrich'\n  ) OR (\n    T1.AdmFName3 = 'Ricci' AND T1.AdmLName3 = 'Ulrich'\n  );",
        "pred_query": "SELECT\n  T2.sname,\n  T2.AvgScrWrite\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  (\n    T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich'\n  ) OR (\n    T1.AdmFName2 = 'Ricci' AND T1.AdmLName2 = 'Ulrich'\n  ) OR (\n    T1.AdmFName3 = 'Ricci' AND T1.AdmLName3 = 'Ulrich'\n  );",
        "pred_time": 0.011202812194824219,
        "orig_time": 0.010351181030273438,
        "time_ratio": 0.9239805907891376,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Which state special schools have the highest number of enrollees from grades 1 through 12?",
        "original_query": "SELECT T2.School FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.DOC = 31 ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1",
        "llm_output": "-- Reasoning\nTo find state special schools, I'll filter the `schools` table where `DOCType` is 'State Special'. I'll then join this with the `frpm` table on `CDSCode` to access the `Enrollment (K-12)` data. Finally, I will order the results by `Enrollment (K-12)` in descending order and select the top school name.\n\n-- SQL Query\nSELECT\n  T1.`School Name`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.DOCType = 'State Special'\nORDER BY\n  T1.`Enrollment (K-12)` DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  T1.`School Name`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.DOCType = 'State Special'\nORDER BY\n  T1.`Enrollment (K-12)` DESC\nLIMIT 1;",
        "pred_time": 0.010430335998535156,
        "orig_time": 0.009681224822998047,
        "time_ratio": 0.9281795739233794,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the monthly average number of schools that opened in Alameda County under the jurisdiction of the Elementary School District in 1980?",
        "original_query": "SELECT CAST(COUNT(School) AS REAL) / 12 FROM schools WHERE DOC = 52 AND County = 'Alameda' AND strftime('%Y', OpenDate) = '1980'",
        "llm_output": "-- Reasoning\nI need to query the `schools` table. First, filter for schools located in 'Alameda' County, with `DOCType` as 'Elementary School District', and `OpenDate` in the year 1980. Then, group these schools by the month of their `OpenDate` to count how many opened each month. Finally, calculate the average of these monthly counts to get the monthly average number of schools opened.\n\n-- SQL Query\nSELECT AVG(MonthlySchoolCount)\nFROM (\n    SELECT COUNT(CDSCode) AS MonthlySchoolCount\n    FROM schools\n    WHERE County = 'Alameda'\n      AND DOCType = 'Elementary School District'\n      AND strftime('%Y', OpenDate) = '1980'\n    GROUP BY strftime('%m', OpenDate)\n);",
        "pred_query": "SELECT AVG(MonthlySchoolCount)\nFROM (\n    SELECT COUNT(CDSCode) AS MonthlySchoolCount\n    FROM schools\n    WHERE County = 'Alameda'\n      AND DOCType = 'Elementary School District'\n      AND strftime('%Y', OpenDate) = '1980'\n    GROUP BY strftime('%m', OpenDate)\n);",
        "pred_time": 0.008910894393920898,
        "orig_time": 0.009021520614624023,
        "time_ratio": 1.0124147157190635,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the ratio of merged Unified School District schools in Orange County to merged Elementary School District schools?",
        "original_query": "SELECT CAST(SUM(CASE WHEN DOC = 54 THEN 1 ELSE 0 END) AS REAL) / SUM(CASE WHEN DOC = 52 THEN 1 ELSE 0 END) FROM schools WHERE StatusType = 'Merged' AND County = 'Orange'",
        "llm_output": "-- Reasoning\n1. Identify the relevant table: The `frpm` table contains `District Type` and `County Name` which are crucial for answering the question.\n2. Determine the two counts needed:\n    a. The number of schools that are 'Unified School District' and located in 'Orange County'.\n    b. The number of schools that are 'Elementary School District' (regardless of county).\n3. Since `CDSCode` is the primary key in the `frpm` table, each row represents a unique school entity. Therefore, `SUM(CASE WHEN condition THEN 1 ELSE 0 END)` effectively counts the unique schools meeting each criterion.\n4. Calculate the ratio by dividing the first count by the second, ensuring floating-point division using `CAST(... AS REAL)`.\n\n-- SQL Query\nSELECT\n  CAST(SUM(CASE WHEN \"District Type\" = 'Unified School District' AND \"County Name\" = 'Orange' THEN 1 ELSE 0 END) AS REAL) /\n  SUM(CASE WHEN \"District Type\" = 'Elementary School District' THEN 1 ELSE 0 END)\nFROM frpm;",
        "pred_query": "SELECT\n  CAST(SUM(CASE WHEN \"District Type\" = 'Unified School District' AND \"County Name\" = 'Orange' THEN 1 ELSE 0 END) AS REAL) /\n  SUM(CASE WHEN \"District Type\" = 'Elementary School District' THEN 1 ELSE 0 END)\nFROM frpm;",
        "pred_time": 0.005416154861450195,
        "orig_time": 0.009005308151245117,
        "time_ratio": 1.6626755293392614,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which different county has the most number of closed schools? Please provide the name of each school as well as the closure date.",
        "original_query": "SELECT DISTINCT County, School, ClosedDate FROM schools WHERE County = ( SELECT County FROM schools WHERE StatusType = 'Closed' GROUP BY County ORDER BY COUNT(School) DESC LIMIT 1 ) AND StatusType = 'Closed' AND school IS NOT NULL",
        "llm_output": "-- Reasoning\nI need to find schools that are closed, which is indicated by `StatusType = 'Closed'` in the `schools` table. To find the county with the most closed schools, I'll group the closed schools by `County` and count them, then order by the count in descending order and take the top county. Finally, I will select the `School` name and `ClosedDate` for all closed schools located in that specific county.\n\n-- SQL Query\nSELECT\n  School,\n  ClosedDate\nFROM schools\nWHERE\n  StatusType = 'Closed' AND County = (\n    SELECT\n      County\n    FROM schools\n    WHERE\n      StatusType = 'Closed'\n    GROUP BY\n      County\n    ORDER BY\n      COUNT(CDSCode) DESC\n    LIMIT 1\n  );",
        "pred_query": "SELECT\n  School,\n  ClosedDate\nFROM schools\nWHERE\n  StatusType = 'Closed' AND County = (\n    SELECT\n      County\n    FROM schools\n    WHERE\n      StatusType = 'Closed'\n    GROUP BY\n      County\n    ORDER BY\n      COUNT(CDSCode) DESC\n    LIMIT 1\n  );",
        "pred_time": null,
        "orig_time": 0.019199132919311523,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the postal street address for the school with the 6th highest Math average? Indicate the school's name.",
        "original_query": "SELECT T2.MailStreet, T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 5, 1",
        "llm_output": "-- Reasoning\nI need to find the school with the 6th highest `AvgScrMath` from the `satscores` table.\nI will join `satscores` with `schools` on their common CDS code to retrieve the school's name and street address.\nThen, I'll order the results by `AvgScrMath` in descending order and use `LIMIT 1 OFFSET 5` to get the 6th entry.\n\n-- SQL Query\nSELECT\n  T1.School,\n  T1.Street\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nORDER BY\n  T2.AvgScrMath DESC\nLIMIT 1 OFFSET 5;",
        "pred_query": "SELECT\n  T1.School,\n  T1.Street\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nORDER BY\n  T2.AvgScrMath DESC\nLIMIT 1 OFFSET 5;",
        "pred_time": 0.012342214584350586,
        "orig_time": 0.002491474151611328,
        "time_ratio": 0.20186605366353083,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "In which mailing street address can you find the school that has the lowest average score in reading? Also give the school's name.",
        "original_query": "SELECT T2.MailStreet, T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the school with the lowest 'AvgScrRead' from the 'satscores' table.\nThen, I will join this result with the 'schools' table using the common CDSCode/cds identifier.\nFinally, I will select the 'MailStreet' and 'School' name for that school.\n\n-- SQL Query\nSELECT\n  T2.MailStreet,\n  T2.School\nFROM satscores AS T1\nINNER JOIN schools AS T2\n  ON T1.cds = T2.CDSCode\nORDER BY\n  T1.AvgScrRead\nLIMIT 1;",
        "pred_query": "SELECT\n  T2.MailStreet,\n  T2.School\nFROM satscores AS T1\nINNER JOIN schools AS T2\n  ON T1.cds = T2.CDSCode\nORDER BY\n  T1.AvgScrRead\nLIMIT 1;",
        "pred_time": 0.0024232864379882812,
        "orig_time": 0.0018494129180908203,
        "time_ratio": 0.7631837859110586,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the total number of schools whose total SAT scores are greater or equal to 1500 whose mailing city is Lakeport?",
        "original_query": "SELECT COUNT(T1.cds) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.MailCity = 'Lakeport' AND (T1.AvgScrRead + T1.AvgScrMath + T1.AvgScrWrite) >= 1500",
        "llm_output": "-- Reasoning\nI need to join the `satscores` and `schools` tables using their common CDS code (`cds` in `satscores` and `CDSCode` in `schools`).\nThen, I will filter the results for schools where `NumGE1500` is greater than or equal to 1500 and `MailCity` is 'Lakeport'.\nFinally, I will count the distinct `CDSCode` to get the total number of such schools.\n\n-- SQL Query\nSELECT\n  COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.NumGE1500 >= 1500 AND T1.MailCity = 'Lakeport';",
        "pred_query": "SELECT\n  COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.NumGE1500 >= 1500 AND T1.MailCity = 'Lakeport';",
        "pred_time": 0.009394407272338867,
        "orig_time": 0.009346723556518555,
        "time_ratio": 0.9949242443468771,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "How many test takers are there at the school/s whose mailing city address is in Fresno?",
        "original_query": "SELECT T1.NumTstTakr FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.MailCity = 'Fresno'",
        "llm_output": "-- Reasoning\nI need to find the number of test takers for schools located in the mailing city of 'Fresno'.\nThe `schools` table contains the `MailCity` information and `CDSCode`.\nThe `satscores` table contains the `NumTstTakr` and `cds` (which corresponds to `CDSCode`).\nI will join `schools` and `satscores` tables on `CDSCode`/`cds` and filter by `MailCity = 'Fresno'`, then sum `NumTstTakr`.\n\n-- SQL Query\nSELECT\n  SUM(T2.NumTstTakr)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.MailCity = 'Fresno';",
        "pred_query": "SELECT\n  SUM(T2.NumTstTakr)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.MailCity = 'Fresno';",
        "pred_time": 0.010758161544799805,
        "orig_time": 0.00939178466796875,
        "time_ratio": 0.8729916007357666,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please specify all of the schools and their related mailing zip codes that are under Avetik Atoian's administration.",
        "original_query": "SELECT School, MailZip FROM schools WHERE AdmFName1 = 'Avetik' AND AdmLName1 = 'Atoian'",
        "llm_output": "-- Reasoning\nI need to retrieve the school name and mailing zip code from the `schools` table.\nThe administration name 'Avetik Atoian' can be found by combining the first and last name columns for the three possible administrator fields (`AdmFName1`, `AdmLName1`, `AdmFName2`, `AdmLName2`, `AdmFName3`, `AdmLName3`).\nI will filter the results where any of the administrator name combinations match 'Avetik Atoian'.\n\n-- SQL Query\nSELECT\n  School,\n  MailZip\nFROM schools\nWHERE\n  (\n    AdmFName1 = 'Avetik' AND AdmLName1 = 'Atoian'\n  )\n  OR (\n    AdmFName2 = 'Avetik' AND AdmLName2 = 'Atoian'\n  )\n  OR (\n    AdmFName3 = 'Avetik' AND AdmLName3 = 'Atoian'\n  );",
        "pred_query": "SELECT\n  School,\n  MailZip\nFROM schools\nWHERE\n  (\n    AdmFName1 = 'Avetik' AND AdmLName1 = 'Atoian'\n  )\n  OR (\n    AdmFName2 = 'Avetik' AND AdmLName2 = 'Atoian'\n  )\n  OR (\n    AdmFName3 = 'Avetik' AND AdmLName3 = 'Atoian'\n  );",
        "pred_time": 0.012077569961547852,
        "orig_time": 0.009479761123657227,
        "time_ratio": 0.7849063308131157,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Of the schools with a mailing state address in California, what is the ratio of the schools located in the county of Colusa against the school located in the county of Humboldt?",
        "original_query": "SELECT CAST(SUM(CASE WHEN County = 'Colusa' THEN 1 ELSE 0 END) AS REAL) / SUM(CASE WHEN County = 'Humboldt' THEN 1 ELSE 0 END) FROM schools WHERE MailState = 'CA'",
        "llm_output": "-- Reasoning\nI need to count schools in 'Colusa' and 'Humboldt' counties, but only for schools with a mailing state of 'CA'. I will use the `schools` table and filter by `MailState` and `County`. Then, I will divide the count of Colusa schools by the count of Humboldt schools.\n\n-- SQL Query\nSELECT\n  SUM(CASE WHEN County = 'Colusa' THEN 1 ELSE 0 END) * 1.0 / SUM(CASE WHEN County = 'Humboldt' THEN 1 ELSE 0 END)\nFROM schools\nWHERE\n  MailState = 'CA';",
        "pred_query": "SELECT\n  SUM(CASE WHEN County = 'Colusa' THEN 1 ELSE 0 END) * 1.0 / SUM(CASE WHEN County = 'Humboldt' THEN 1 ELSE 0 END)\nFROM schools\nWHERE\n  MailState = 'CA';",
        "pred_time": 0.01315760612487793,
        "orig_time": 0.012694597244262695,
        "time_ratio": 0.9648105532099951,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Of all the schools with a mailing state address in California, how many are active in San Joaquin?",
        "original_query": "SELECT COUNT(CDSCode) FROM schools WHERE City = 'San Joaquin' AND MailState = 'CA' AND StatusType = 'Active'",
        "llm_output": "-- Reasoning\nI need to count schools from the `schools` table.\nI will filter for schools where the `MailState` is 'CA', the `County` is 'San Joaquin', and the `StatusType` is 'Active'.\nFinally, I will count the `CDSCode` for the filtered results.\n\n-- SQL Query\nSELECT\n  COUNT(CDSCode)\nFROM schools\nWHERE\n  MailState = 'CA' AND County = 'San Joaquin' AND StatusType = 'Active';",
        "pred_query": "SELECT\n  COUNT(CDSCode)\nFROM schools\nWHERE\n  MailState = 'CA' AND County = 'San Joaquin' AND StatusType = 'Active';",
        "pred_time": 0.010367631912231445,
        "orig_time": 0.01022958755493164,
        "time_ratio": 0.9866850638151087,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the phone number and extension number for the school that had the 333rd highest average writing score?",
        "original_query": "SELECT T2.Phone, T2.Ext FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrWrite DESC LIMIT 332, 1",
        "llm_output": "-- Reasoning\nI need to find the school with the 333rd highest average writing score.\nFirst, I will order the `satscores` table by `AvgScrWrite` in descending order and select the `cds` for the 333rd entry (OFFSET 332).\nThen, I will join this result with the `schools` table on `CDSCode` to retrieve the `Phone` and `Ext` for that specific school.\n\n-- SQL Query\nSELECT\n  T1.Phone,\n  T1.Ext\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.AvgScrWrite IS NOT NULL\nORDER BY\n  T2.AvgScrWrite DESC\nLIMIT 1 OFFSET 332;",
        "pred_query": "SELECT\n  T1.Phone,\n  T1.Ext\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.AvgScrWrite IS NOT NULL\nORDER BY\n  T2.AvgScrWrite DESC\nLIMIT 1 OFFSET 332;",
        "pred_time": 0.006140232086181641,
        "orig_time": 0.005930423736572266,
        "time_ratio": 0.9658305505940825,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the phone number and extension number for the school with the zip code 95203-3704? Indicate the school's name.",
        "original_query": "SELECT Phone, Ext, School FROM schools WHERE Zip = '95203-3704'",
        "llm_output": "-- Reasoning\nThe question asks for the phone number, extension, and school name for a specific zip code.\nAll this information is available in the `schools` table.\nI will select the `Phone`, `Ext`, and `School` columns from the `schools` table.\nThe filtering condition will be on the `Zip` column, matching '95203-3704'.\n\n-- SQL Query\nSELECT Phone, Ext, School FROM schools WHERE Zip = '95203-3704';",
        "pred_query": "SELECT Phone, Ext, School FROM schools WHERE Zip = '95203-3704';",
        "pred_time": 0.010527372360229492,
        "orig_time": 0.009737491607666016,
        "time_ratio": 0.9249688596987884,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the website for the schools under the administrations of Mike Larson and Dante Alvarez?",
        "original_query": "SELECT Website FROM schools WHERE (AdmFName1 = 'Mike' AND AdmLName1 = 'Larson') OR (AdmFName1 = 'Dante' AND AdmLName1 = 'Alvarez')",
        "llm_output": "-- Reasoning\nTo find the websites of schools administered by both Mike Larson and Dante Alvarez, I need to query the `schools` table. I will select the `Website` column. The filtering condition requires checking the administrator names. A school must have 'Mike Larson' listed as an administrator in any of its `AdmFName`/`AdmLName` pairs (1, 2, or 3) AND 'Dante Alvarez' listed as an administrator in any of its `AdmFName`/`AdmLName` pairs (1, 2, or 3). I combine these two sets of OR conditions with a final AND.\n\n-- SQL Query\nSELECT Website\nFROM schools\nWHERE\n    ((AdmFName1 = 'Mike' AND AdmLName1 = 'Larson') OR\n     (AdmFName2 = 'Mike' AND AdmLName2 = 'Larson') OR\n     (AdmFName3 = 'Mike' AND AdmLName3 = 'Larson'))\nAND\n    ((AdmFName1 = 'Dante' AND AdmLName1 = 'Alvarez') OR\n     (AdmFName2 = 'Dante' AND AdmLName2 = 'Alvarez') OR\n     (AdmFName3 = 'Dante' AND AdmLName3 = 'Alvarez'));",
        "pred_query": "SELECT Website\nFROM schools\nWHERE\n    ((AdmFName1 = 'Mike' AND AdmLName1 = 'Larson') OR\n     (AdmFName2 = 'Mike' AND AdmLName2 = 'Larson') OR\n     (AdmFName3 = 'Mike' AND AdmLName3 = 'Larson'))\nAND\n    ((AdmFName1 = 'Dante' AND AdmLName1 = 'Alvarez') OR\n     (AdmFName2 = 'Dante' AND AdmLName2 = 'Alvarez') OR\n     (AdmFName3 = 'Dante' AND AdmLName3 = 'Alvarez'));",
        "pred_time": 0.010863065719604492,
        "orig_time": 0.009520292282104492,
        "time_ratio": 0.876390931238066,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What are the websites for all the partially virtual chartered schools located in San Joaquin?",
        "original_query": "SELECT Website FROM schools WHERE County = 'San Joaquin' AND Virtual = 'P' AND Charter = 1",
        "llm_output": "-- Reasoning\nI need to find schools that are \"partially virtual\", chartered, and located in \"San Joaquin\" county.\nThe `schools` table contains all the necessary information: `Website`, `Virtual` status, `Charter` status, and `County`.\nI will filter the `schools` table where `Virtual` is 'Partially', `Charter` is 1 (indicating chartered), and `County` is 'San Joaquin'.\n\n-- SQL Query\nSELECT Website\nFROM schools\nWHERE Virtual = 'Partially'\n  AND Charter = 1\n  AND County = 'San Joaquin';",
        "pred_query": "SELECT Website\nFROM schools\nWHERE Virtual = 'Partially'\n  AND Charter = 1\n  AND County = 'San Joaquin';",
        "pred_time": 0.017488479614257812,
        "orig_time": 0.015440225601196289,
        "time_ratio": 0.8828798124113862,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "How many chartered schools located in the city of Hickman are owned by the Elementary School District?",
        "original_query": "SELECT COUNT(School) FROM schools WHERE DOC = 52 AND Charter = 1 AND City = 'Hickman'",
        "llm_output": "-- Reasoning\nI need to count schools from the `schools` table.\nThe conditions are: the `Charter` column is 1 (indicating a chartered school), the `City` column is 'Hickman', and the `DOCType` column is 'Elementary School District'.\n\n-- SQL Query\nSELECT COUNT(CDSCode)\nFROM schools\nWHERE Charter = 1\n  AND City = 'Hickman'\n  AND DOCType = 'Elementary School District';",
        "pred_query": "SELECT COUNT(CDSCode)\nFROM schools\nWHERE Charter = 1\n  AND City = 'Hickman'\n  AND DOCType = 'Elementary School District';",
        "pred_time": 0.012109518051147461,
        "orig_time": 0.011340141296386719,
        "time_ratio": 0.9364651217735426,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the total number of non-chartered schools in the county of Los Angeles with a percent (%) of eligible free meals for grades 1 through 12 that is less than 0.18%?",
        "original_query": "SELECT COUNT(T2.School) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Los Angeles' AND T2.Charter = 0 AND CAST(T1.`Free Meal Count (K-12)` AS REAL) * 100 / T1.`Enrollment (K-12)` < 0.18",
        "llm_output": "-- Reasoning\nThe query counts distinct schools by joining the `schools` and `frpm` tables on `CDSCode`. It filters for schools located in 'Los Angeles' county and those that are not chartered (`'Charter School (Y/N)' = 0`). Finally, it applies the condition for the 'Percent (%) Eligible Free (K-12)' to be less than 0.18.\n\n-- SQL Query\nSELECT\n  COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.County = 'Los Angeles' AND T2.`Charter School (Y/N)` = 0 AND T2.`Percent (%) Eligible Free (K-12)` < 0.18;",
        "pred_query": "SELECT\n  COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.County = 'Los Angeles' AND T2.`Charter School (Y/N)` = 0 AND T2.`Percent (%) Eligible Free (K-12)` < 0.18;",
        "pred_time": 0.011457443237304688,
        "orig_time": 0.010066509246826172,
        "time_ratio": 0.8785999667055102,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "In chartered schools with charter number 00D2, what are the names of all the administrators? Include the name of the school and the city to which it belongs",
        "original_query": "SELECT AdmFName1, AdmLName1, School, City FROM schools WHERE Charter = 1 AND CharterNum = '00D2'",
        "llm_output": "-- Reasoning\nI need to retrieve school information from the `schools` table. I will filter for schools where `CharterNum` is '00D2' and `Charter` is 1. The query will select the `School` name, `City`, and all three administrator first and last names available in the table.\n\n-- SQL Query\nSELECT\n  School,\n  City,\n  AdmFName1,\n  AdmLName1,\n  AdmFName2,\n  AdmLName2,\n  AdmFName3,\n  AdmLName3\nFROM schools\nWHERE\n  Charter = 1 AND CharterNum = '00D2';",
        "pred_query": "SELECT\n  School,\n  City,\n  AdmFName1,\n  AdmLName1,\n  AdmFName2,\n  AdmLName2,\n  AdmFName3,\n  AdmLName3\nFROM schools\nWHERE\n  Charter = 1 AND CharterNum = '00D2';",
        "pred_time": 0.010178804397583008,
        "orig_time": null,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the total number of schools with a mailing city in Hickman belonging to the charter number 00D4?",
        "original_query": "SELECT COUNT(*) FROM schools WHERE CharterNum = '00D4' AND MailCity = 'Hickman'",
        "llm_output": "-- Reasoning\nI need to count the number of schools that meet two criteria: their mailing city is 'Hickman' and their charter number is '00D4'. Both of these columns (`MailCity` and `CharterNum`) are available in the `schools` table. I will filter the `schools` table using a `WHERE` clause with an `AND` condition and then count the resulting rows.\n\n-- SQL Query\nSELECT\n  COUNT(CDSCode)\nFROM schools\nWHERE\n  MailCity = 'Hickman' AND CharterNum = '00D4';",
        "pred_query": "SELECT\n  COUNT(CDSCode)\nFROM schools\nWHERE\n  MailCity = 'Hickman' AND CharterNum = '00D4';",
        "pred_time": 0.012926578521728516,
        "orig_time": 0.009790897369384766,
        "time_ratio": 0.7574237338153381,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the ratio in percentage of Santa Clara County schools that are locally funded compared to all other types of charter school funding?",
        "original_query": "SELECT CAST(SUM(CASE WHEN FundingType = 'Locally funded' THEN 1 ELSE 0 END) AS REAL) * 100 / SUM(CASE WHEN FundingType != 'Locally funded' THEN 1 ELSE 0 END) FROM schools WHERE County = 'Santa Clara' AND Charter = 1",
        "llm_output": "-- Reasoning\nI need to calculate the percentage ratio of charter schools with 'Locally Funded' type to those with 'all other types of charter school funding' within 'Santa Clara' County.\nI will filter the `frpm` table for schools in 'Santa Clara' County that are also charter schools.\nThen, I'll count schools with 'Locally Funded' charter type and schools with any other non-null charter funding type.\nFinally, I will calculate the percentage using the formula: (Count of Locally Funded * 100.0) / Count of Other Funded, handling division by zero with NULLIF.\n\n-- SQL Query\nSELECT\n  (SUM(CASE WHEN `Charter Funding Type` = 'Locally Funded' THEN 1 ELSE 0 END) * 100.0) /\n  NULLIF(SUM(CASE WHEN `Charter Funding Type` IS NOT NULL AND `Charter Funding Type` != 'Locally Funded' THEN 1 ELSE 0 END), 0)\nFROM\n  frpm\nWHERE\n  `County Name` = 'Santa Clara' AND `Charter School (Y/N)` = 1;",
        "pred_query": "SELECT\n  (SUM(CASE WHEN `Charter Funding Type` = 'Locally Funded' THEN 1 ELSE 0 END) * 100.0) /\n  NULLIF(SUM(CASE WHEN `Charter Funding Type` IS NOT NULL AND `Charter Funding Type` != 'Locally Funded' THEN 1 ELSE 0 END), 0)\nFROM\n  frpm\nWHERE\n  `County Name` = 'Santa Clara' AND `Charter School (Y/N)` = 1;",
        "pred_time": 0.004350900650024414,
        "orig_time": 0.00953364372253418,
        "time_ratio": 2.1911885582771657,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Between 1/1/2000 to 12/31/2005, how many directly funded schools opened in the county of Stanislaus?",
        "original_query": "SELECT COUNT(School) FROM schools WHERE strftime('%Y', OpenDate) BETWEEN '2000' AND '2005' AND County = 'Stanislaus' AND FundingType = 'Directly funded'",
        "llm_output": "-- Reasoning\nI need to query the `schools` table. I will filter schools based on their `OpenDate` being between '2000-01-01' and '2005-12-31' (inclusive). Additionally, I'll apply conditions to include only schools with `FundingType` equal to 'Directly Funded' and `County` equal to 'Stanislaus'. Finally, I will count the number of distinct `CDSCode` values that satisfy all these conditions.\n\n-- SQL Query\nSELECT\n  COUNT(CDSCode)\nFROM schools\nWHERE\n  OpenDate BETWEEN '2000-01-01' AND '2005-12-31' AND FundingType = 'Directly Funded' AND County = 'Stanislaus';",
        "pred_query": "SELECT\n  COUNT(CDSCode)\nFROM schools\nWHERE\n  OpenDate BETWEEN '2000-01-01' AND '2005-12-31' AND FundingType = 'Directly Funded' AND County = 'Stanislaus';",
        "pred_time": 0.011096954345703125,
        "orig_time": 0.012796163558959961,
        "time_ratio": 1.1531239257476795,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the total amount of Community College District closure in 1989 in the city of San Francisco?",
        "original_query": "SELECT COUNT(School) FROM schools WHERE strftime('%Y', ClosedDate) = '1989' AND City = 'San Francisco' AND DOCType = 'Community College District'",
        "llm_output": "-- Reasoning\nI need to count the number of schools that meet specific criteria: their `DOCType` is 'Community College District', they are located in 'San Francisco', and their `ClosedDate` falls within the year 1989. I will use the `schools` table to filter by these conditions and then count the resulting rows.\n\n-- SQL Query\nSELECT\n  COUNT(CDSCode)\nFROM schools\nWHERE\n  DOCType = 'Community College District' AND City = 'San Francisco' AND STRFTIME('%Y', ClosedDate) = '1989';",
        "pred_query": "SELECT\n  COUNT(CDSCode)\nFROM schools\nWHERE\n  DOCType = 'Community College District' AND City = 'San Francisco' AND STRFTIME('%Y', ClosedDate) = '1989';",
        "pred_time": 0.010479211807250977,
        "orig_time": 0.010720491409301758,
        "time_ratio": 1.023024594453166,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Which county reported the most number of school closure in the 1980s with school wonership code belonging to Youth Authority Facilities (CEA)?",
        "original_query": "SELECT County FROM schools WHERE strftime('%Y', ClosedDate) BETWEEN '1980' AND '1989' AND StatusType = 'Closed' AND SOC = 11 GROUP BY County ORDER BY COUNT(School) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to query the `schools` table to find school closures.\nFilter for schools with a `ClosedDate` within the 1980s (from '1980-01-01' to '1989-12-31').\nAdditionally, filter for schools where the `SOC` (School Ownership Code) is 'CEA', which stands for Youth Authority Facilities.\nThen, group the results by `County` and count the number of schools in each county.\nFinally, order the counties by this count in descending order and select the top one.\n\n-- SQL Query\nSELECT\n  County\nFROM schools\nWHERE\n  substr(ClosedDate, 1, 4) BETWEEN '1980' AND '1989' AND SOC = 'CEA'\nGROUP BY\n  County\nORDER BY\n  COUNT(CDSCode) DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  County\nFROM schools\nWHERE\n  substr(ClosedDate, 1, 4) BETWEEN '1980' AND '1989' AND SOC = 'CEA'\nGROUP BY\n  County\nORDER BY\n  COUNT(CDSCode) DESC\nLIMIT 1;",
        "pred_time": 0.010959386825561523,
        "orig_time": 0.011231184005737305,
        "time_ratio": 1.0248004002871625,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please provide the National Center for Educational Statistics school district identification number for all schools with a School Ownership Code that are part of the State Special Schools.",
        "original_query": "SELECT NCESDist FROM schools WHERE SOC = 31",
        "llm_output": "-- Reasoning\nI need to retrieve the National Center for Educational Statistics school district identification number (`NCESDist`) from the `schools` table.\nThe filtering condition is based on the `SOCType` column, which must be equal to 'State Special Schools'.\n\n-- SQL Query\nSELECT NCESDist FROM schools WHERE SOCType = 'State Special Schools';",
        "pred_query": "SELECT NCESDist FROM schools WHERE SOCType = 'State Special Schools';",
        "pred_time": 0.010711431503295898,
        "orig_time": 0.009735584259033203,
        "time_ratio": 0.908896654572974,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "How many active and closed District Community Day Schools are there in the county of Alpine?",
        "original_query": "SELECT COUNT(School) FROM schools WHERE (StatusType = 'Closed' OR StatusType = 'Active') AND County = 'Alpine'",
        "llm_output": "-- Reasoning\nThe question asks for a count of schools based on their `StatusType` (active/closed), `County`, and `DOCType`. All required filters (`StatusType`, `County`, `DOCType`) are available directly in the `schools` table. I will filter by 'Alpine' county and 'District Community Day' `DOCType`, then group the results by `StatusType` to count active and closed schools separately.\n\n-- SQL Query\nSELECT\n  StatusType,\n  COUNT(CDSCode)\nFROM schools\nWHERE\n  County = 'Alpine' AND DOCType = 'District Community Day'\nGROUP BY\n  StatusType;",
        "pred_query": "SELECT\n  StatusType,\n  COUNT(CDSCode)\nFROM schools\nWHERE\n  County = 'Alpine' AND DOCType = 'District Community Day'\nGROUP BY\n  StatusType;",
        "pred_time": 0.009479522705078125,
        "orig_time": 0.009587764739990234,
        "time_ratio": 1.0114185110663985,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the district code for the School that does not offer a magnet program in the city of Fresno?",
        "original_query": "SELECT T1.`District Code` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Fresno' AND T2.Magnet = 0",
        "llm_output": "-- Reasoning\nI need to find schools that are in 'Fresno' and do not have a magnet program. The `schools` table contains `City` and `Magnet` information. Once identified, I will join with the `frpm` table using `CDSCode` to retrieve the `District Code`. A magnet value of 0 indicates no magnet program.\n\n-- SQL Query\nSELECT T1.`District Code`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.City = 'Fresno' AND T2.Magnet = 0;",
        "pred_query": "SELECT T1.`District Code`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.City = 'Fresno' AND T2.Magnet = 0;",
        "pred_time": 0.010120153427124023,
        "orig_time": 0.00921010971069336,
        "time_ratio": 0.91007609489481,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "How many students from the ages of 5 to 17 are enrolled at the State Special School school in Fremont for the 2014-2015 academic year?",
        "original_query": "SELECT T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.EdOpsCode = 'SSS' AND T2.City = 'Fremont' AND T1.`Academic Year` BETWEEN 2014 AND 2015",
        "llm_output": "-- Reasoning\nI need to retrieve enrollment data from the `frpm` table. The question specifies a school name and academic year from `frpm`, and a city from the `schools` table. Therefore, I will join `frpm` and `schools` tables on `CDSCode`, filter by the `Academic Year`, `School Name`, and `City`, and then select the `Enrollment (Ages 5-17)` column.\n\n-- SQL Query\nSELECT T1.`Enrollment (Ages 5-17)`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`Academic Year` = '2014-2015' AND T1.`School Name` = 'State Special School' AND T2.City = 'Fremont';",
        "pred_query": "SELECT T1.`Enrollment (Ages 5-17)`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`Academic Year` = '2014-2015' AND T1.`School Name` = 'State Special School' AND T2.City = 'Fremont';",
        "pred_time": 0.009820222854614258,
        "orig_time": 0.00890207290649414,
        "time_ratio": 0.9065041637330356,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the free or reduced price meal count for ages 5 to 17 in the Youth Authority School with a mailing street address of PO Box 1040?",
        "original_query": "SELECT T1.`FRPM Count (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.MailStreet = 'PO Box 1040' AND T2.SOCType = 'Youth Authority Facilities'",
        "llm_output": "-- Reasoning\nI need to retrieve the 'FRPM Count (Ages 5-17)' from the `frpm` table.\nThe `frpm` table can be joined with the `schools` table using the `CDSCode`.\nI will filter the `schools` table where `School` is 'Youth Authority School' and `MailStreet` is 'PO Box 1040' to identify the specific school.\n\n-- SQL Query\nSELECT T1.`FRPM Count (Ages 5-17)`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.School = 'Youth Authority School' AND T2.MailStreet = 'PO Box 1040';",
        "pred_query": "SELECT T1.`FRPM Count (Ages 5-17)`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.School = 'Youth Authority School' AND T2.MailStreet = 'PO Box 1040';",
        "pred_time": 0.009717226028442383,
        "orig_time": 0.009375333786010742,
        "time_ratio": 0.9648158598522953,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the lowest grade for the District Special Education Consortia School with National Center for Educational Statistics school district identification number of 613360?",
        "original_query": "SELECT MIN(T1.`Low Grade`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.NCESDist = 613360 AND T2.EdOpsCode = 'SPECON'",
        "llm_output": "-- Reasoning\nTo find the lowest grade, I need to query the `frpm` table.\nThe school details like 'District Type' are in `frpm`, and 'NCESDist' is in the `schools` table.\nI will join `frpm` and `schools` tables on `CDSCode` and filter by the specified 'District Type' and 'NCESDist'.\n\n-- SQL Query\nSELECT\n  T1.`Low Grade`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`District Type` = 'District Special Education Consortia' AND T2.NCESDist = '613360';",
        "pred_query": "SELECT\n  T1.`Low Grade`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`District Type` = 'District Special Education Consortia' AND T2.NCESDist = '613360';",
        "pred_time": 0.003807544708251953,
        "orig_time": 0.009003162384033203,
        "time_ratio": 2.364558547276143,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the educational level name for the schools with Breakfast Provision 2 in county code 37? Indicate the name of the school.",
        "original_query": "SELECT T2.EILName, T2.School FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`NSLP Provision Status` = 'Breakfast Provision 2' AND T1.`County Code` = 37",
        "llm_output": "-- Reasoning\nThe question asks for the educational level name and school name for schools with 'Breakfast Provision 2' in 'county code 37'.\nI will query the `frpm` table to filter for `NSLP Provision Status` equal to 'Breakfast Provision 2' and `County Code` equal to '37'.\nThen, I will join the results with the `schools` table on `CDSCode` to retrieve the `EdOpsName` (educational level name) and `School` (school name).\n\n-- SQL Query\nSELECT\n  T2.EdOpsName,\n  T2.School\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`NSLP Provision Status` = 'Breakfast Provision 2' AND T1.`County Code` = '37';",
        "pred_query": "SELECT\n  T2.EdOpsName,\n  T2.School\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`NSLP Provision Status` = 'Breakfast Provision 2' AND T1.`County Code` = '37';",
        "pred_time": 0.0064008235931396484,
        "orig_time": 0.005559444427490234,
        "time_ratio": 0.8685514210153835,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the city location of the high school level school with Lunch Provision 2 whose lowest grade is 9 and the highest grade is 12 in the county of Merced?",
        "original_query": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`NSLP Provision Status` = 'Lunch Provision 2' AND T2.County = 'Merced' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12 AND T2.EILCode = 'HS'",
        "llm_output": "-- Reasoning\nI need to query the `frpm` table to filter for schools that are 'High School' type, have 'Provision 2' NSLP status, a lowest grade of '09', a highest grade of '12', and are located in 'Merced' county.\nThen, I will join the `frpm` table with the `schools` table using `CDSCode` to retrieve the `City` column from the `schools` table.\n\n-- SQL Query\nSELECT\n  T2.City\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`School Type` = 'High School' AND T1.`NSLP Provision Status` = 'Provision 2' AND T1.`Low Grade` = '09' AND T1.`High Grade` = '12' AND T1.`County Name` = 'Merced';",
        "pred_query": "SELECT\n  T2.City\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`School Type` = 'High School' AND T1.`NSLP Provision Status` = 'Provision 2' AND T1.`Low Grade` = '09' AND T1.`High Grade` = '12' AND T1.`County Name` = 'Merced';",
        "pred_time": 0.004714488983154297,
        "orig_time": 0.010181427001953125,
        "time_ratio": 2.15960351977344,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which schools served a grade span of Kindergarten to 9th grade in the county of Los Angeles and what is its Percent (%) Eligible FRPM (Ages 5-17)?",
        "original_query": "SELECT T2.School, T1.`FRPM Count (Ages 5-17)` * 100 / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Los Angeles' AND T2.GSserved = 'K-9'",
        "llm_output": "-- Reasoning\nI need to retrieve school names from the `schools` table and the FRPM eligibility percentage from the `frpm` table.\nI will join `schools` and `frpm` tables on their common `CDSCode`.\nThen, I will filter the results for schools in 'Los Angeles' county with a grade span served (`GSserved`) of 'K-9'.\n\n-- SQL Query\nSELECT\n  T1.School,\n  T2.`Percent (%) Eligible FRPM (Ages 5-17)`\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.County = 'Los Angeles' AND T1.GSserved = 'K-9';",
        "pred_query": "SELECT\n  T1.School,\n  T2.`Percent (%) Eligible FRPM (Ages 5-17)`\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.County = 'Los Angeles' AND T1.GSserved = 'K-9';",
        "pred_time": 0.009649276733398438,
        "orig_time": 0.008417129516601562,
        "time_ratio": 0.8723067799960467,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the most common type of grade span served in the city of Adelanto?",
        "original_query": "SELECT GSserved FROM schools WHERE City = 'Adelanto' GROUP BY GSserved ORDER BY COUNT(GSserved) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the `GSserved` (grade span served) from the `schools` table.\nI will filter the `schools` table for records where the `City` is 'Adelanto'.\nThen, I will group the results by `GSserved` and count the occurrences of each grade span.\nFinally, I will order the results by the count in descending order and take the top one to find the most common type.\n\n-- SQL Query\nSELECT GSserved\nFROM schools\nWHERE City = 'Adelanto'\nGROUP BY GSserved\nORDER BY COUNT(*) DESC\nLIMIT 1;",
        "pred_query": "SELECT GSserved\nFROM schools\nWHERE City = 'Adelanto'\nGROUP BY GSserved\nORDER BY COUNT(*) DESC\nLIMIT 1;",
        "pred_time": 0.010376453399658203,
        "orig_time": 0.009350299835205078,
        "time_ratio": 0.9011074858692155,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Between San Diego and Santa Barbara, which county offers the most number of schools that does not offer physical building? Indicate the amount.",
        "original_query": "SELECT County, COUNT(Virtual) FROM schools WHERE (County = 'San Diego' OR County = 'Santa Barbara') AND Virtual = 'F' GROUP BY County ORDER BY COUNT(Virtual) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to identify schools without a physical building in 'San Diego' and 'Santa Barbara' counties. The `schools` table contains a `County` column and a `Virtual` column, where 'Y' indicates a virtual school (no physical building). I will filter by these criteria, group the results by `County`, count the number of virtual schools in each county, and then order by this count to find the county with the most.\n\n-- SQL Query\nSELECT\n  County,\n  COUNT(CDSCode) AS VirtualSchoolCount\nFROM schools\nWHERE\n  County IN ('San Diego', 'Santa Barbara') AND Virtual = 'Y'\nGROUP BY\n  County\nORDER BY\n  VirtualSchoolCount DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  County,\n  COUNT(CDSCode) AS VirtualSchoolCount\nFROM schools\nWHERE\n  County IN ('San Diego', 'Santa Barbara') AND Virtual = 'Y'\nGROUP BY\n  County\nORDER BY\n  VirtualSchoolCount DESC\nLIMIT 1;",
        "pred_time": 0.010234594345092773,
        "orig_time": 0.009346485137939453,
        "time_ratio": 0.9132247769469098,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the school type of the school with the highest latitude? Indicate the name of the school as well as the latitude coordinates.",
        "original_query": "SELECT T1.`School Type`, T1.`School Name`, T2.Latitude FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T2.Latitude DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the school with the highest latitude. The `schools` table contains both the `Latitude` and `School` name. I will order the `schools` table by `Latitude` in descending order and limit the result to 1 to get the school with the highest latitude. From this record, I will select the `School` name, `School Type` (from `frpm` table), and `Latitude`. I will join `schools` and `frpm` tables on `CDSCode` to get the `School Type`.\n\n-- SQL Query\nSELECT\n  T1.School,\n  T2.`School Type`,\n  T1.Latitude\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.Latitude IS NOT NULL\nORDER BY\n  T1.Latitude DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  T1.School,\n  T2.`School Type`,\n  T1.Latitude\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.Latitude IS NOT NULL\nORDER BY\n  T1.Latitude DESC\nLIMIT 1;",
        "pred_time": 0.012827873229980469,
        "orig_time": 0.013922929763793945,
        "time_ratio": 1.085365400341982,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "In which city can you find the school in the state of California with the lowest latitude coordinates and what is its lowest grade? Indicate the school name.",
        "original_query": "SELECT T2.City, T1.`Low Grade`, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.State = 'CA' ORDER BY T2.Latitude ASC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find a school in the `schools` table.\nFirst, I'll filter for schools located in the state of California (`State` = 'CA').\nThen, I'll order these California schools by their `Latitude` in ascending order to find the one with the lowest latitude.\nFinally, I will select the `City`, `School` name, and `GSserved` (which represents the lowest grade served) for the top result.\n\n-- SQL Query\nSELECT City, School, GSserved\nFROM schools\nWHERE State = 'CA'\nORDER BY Latitude ASC\nLIMIT 1;",
        "pred_query": "SELECT City, School, GSserved\nFROM schools\nWHERE State = 'CA'\nORDER BY Latitude ASC\nLIMIT 1;",
        "pred_time": 0.011826515197753906,
        "orig_time": 0.012868404388427734,
        "time_ratio": 1.0880977340537052,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the grade span offered in the school with the highest longitude?",
        "original_query": "SELECT GSoffered FROM schools ORDER BY ABS(longitude) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nTo find the grade span offered for the school with the highest longitude, I need to query the `schools` table.\nI will first identify the maximum `Longitude` value in the `schools` table.\nThen, I will select the `GSoffered` column for the row(s) that have this maximum `Longitude`.\n\n-- SQL Query\nSELECT GSoffered\nFROM schools\nWHERE Longitude = (SELECT MAX(Longitude) FROM schools);",
        "pred_query": "SELECT GSoffered\nFROM schools\nWHERE Longitude = (SELECT MAX(Longitude) FROM schools);",
        "pred_time": 0.01961231231689453,
        "orig_time": 0.010074138641357422,
        "time_ratio": 0.5136639922197909,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Of the schools that offers a magnet program serving a grade span of Kindergarten to 8th grade, how many offers Multiple Provision Types? List the number of cities that offers a Kindergarten to 8th grade span and indicate how many schools are there serving such grade span for each city.",
        "original_query": "SELECT T2.City, COUNT(T2.CDSCode) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.Magnet = 1 AND T2.GSoffered = 'K-8' AND T1.`NSLP Provision Status` = 'Multiple Provision Types' GROUP BY T2.City",
        "llm_output": "-- Reasoning\n1.  The query involves data from both the `frpm` table (for `Low Grade`, `High Grade`, `NSLP Provision Status`) and the `schools` table (for `Magnet` status, `City`), thus an `INNER JOIN` on `CDSCode` is used.\n2.  For the first part of the question (\"how many offers Multiple Provision Types?\"), given that `frpm.CDSCode` is a primary key (meaning one `NSLP Provision Status` per school), I interpret \"Multiple Provision Types\" as schools where the `NSLP Provision Status` field itself contains multiple values, typically indicated by a comma, and is not NULL. This count is calculated using a scalar subquery.\n3.  For the second part of the question (\"List the number of cities that offers a Kindergarten to 8th grade span and indicate how many schools are there serving such grade span for each city\"), the data is filtered for `Low Grade`='K' and `High Grade`='8', then grouped by `schools.City` to count the number of relevant schools per city.\n4.  The two parts are combined into a single result set where the scalar count from the first part is included as a column in every row generated by the second part, providing a comprehensive answer in one query.\n\n-- SQL Query\nSELECT\n  (\n    SELECT\n      COUNT(DISTINCT T1.CDSCode)\n    FROM frpm AS T1\n    JOIN schools AS T2\n      ON T1.CDSCode = T2.CDSCode\n    WHERE\n      T2.Magnet = 1 AND T1.`Low Grade` = 'K' AND T1.`High Grade` = '8' AND T1.`NSLP Provision Status` IS NOT NULL AND INSTR(T1.`NSLP Provision Status`, ',') > 0\n  ) AS MultipleProvisionTypeMagnetK8Schools,\n  T2.City,\n  COUNT(T1.CDSCode) AS NumberOfK8SchoolsInCity\nFROM frpm AS T1\nJOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`Low Grade` = 'K' AND T1.`High Grade` = '8'\nGROUP BY\n  T2.City\nORDER BY\n  T2.City;",
        "pred_query": "SELECT\n  (\n    SELECT\n      COUNT(DISTINCT T1.CDSCode)\n    FROM frpm AS T1\n    JOIN schools AS T2\n      ON T1.CDSCode = T2.CDSCode\n    WHERE\n      T2.Magnet = 1 AND T1.`Low Grade` = 'K' AND T1.`High Grade` = '8' AND T1.`NSLP Provision Status` IS NOT NULL AND INSTR(T1.`NSLP Provision Status`, ',') > 0\n  ) AS MultipleProvisionTypeMagnetK8Schools,\n  T2.City,\n  COUNT(T1.CDSCode) AS NumberOfK8SchoolsInCity\nFROM frpm AS T1\nJOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`Low Grade` = 'K' AND T1.`High Grade` = '8'\nGROUP BY\n  T2.City\nORDER BY\n  T2.City;",
        "pred_time": 0.01219320297241211,
        "orig_time": 0.0043256282806396484,
        "time_ratio": 0.35475734230182626,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What are the two most common first names among the school administrators? Indicate the district to which they administer.",
        "original_query": "SELECT DISTINCT T1.AdmFName1, T1.District FROM schools AS T1 INNER JOIN ( SELECT admfname1 FROM schools GROUP BY admfname1 ORDER BY COUNT(admfname1) DESC LIMIT 2 ) AS T2 ON T1.AdmFName1 = T2.admfname1",
        "llm_output": "-- Reasoning\nTo find the most common administrator first names and their districts, I'll first combine all potential first names (AdmFName1, AdmFName2, AdmFName3) from the `schools` table into a single result set, along with their respective districts, filtering out any null or empty names. Then, I'll group these combined names by the administrator's first name and the district, count their occurrences, and finally order them in descending order of counts to select the top two.\n\n-- SQL Query\nSELECT\n  T1.AdmFName AS 'Administrator First Name',\n  T1.District AS 'District'\nFROM\n  (\n    SELECT\n      AdmFName1 AS AdmFName,\n      District\n    FROM schools\n    WHERE\n      AdmFName1 IS NOT NULL AND AdmFName1 != ''\n    UNION ALL\n    SELECT\n      AdmFName2 AS AdmFName,\n      District\n    FROM schools\n    WHERE\n      AdmFName2 IS NOT NULL AND AdmFName2 != ''\n    UNION ALL\n    SELECT\n      AdmFName3 AS AdmFName,\n      District\n    FROM schools\n    WHERE\n      AdmFName3 IS NOT NULL AND AdmFName3 != ''\n  ) AS T1\nGROUP BY\n  T1.AdmFName,\n  T1.District\nORDER BY\n  COUNT(*) DESC\nLIMIT 2;",
        "pred_query": "SELECT\n  T1.AdmFName AS 'Administrator First Name',\n  T1.District AS 'District'\nFROM\n  (\n    SELECT\n      AdmFName1 AS AdmFName,\n      District\n    FROM schools\n    WHERE\n      AdmFName1 IS NOT NULL AND AdmFName1 != ''\n    UNION ALL\n    SELECT\n      AdmFName2 AS AdmFName,\n      District\n    FROM schools\n    WHERE\n      AdmFName2 IS NOT NULL AND AdmFName2 != ''\n    UNION ALL\n    SELECT\n      AdmFName3 AS AdmFName,\n      District\n    FROM schools\n    WHERE\n      AdmFName3 IS NOT NULL AND AdmFName3 != ''\n  ) AS T1\nGROUP BY\n  T1.AdmFName,\n  T1.District\nORDER BY\n  COUNT(*) DESC\nLIMIT 2;",
        "pred_time": 0.0339200496673584,
        "orig_time": 0.03276252746582031,
        "time_ratio": 0.9658749850637164,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the Percent (%) Eligible Free (K-12) in the school administered by an administrator whose first name is Alusine. List the district code of the school.",
        "original_query": "SELECT T1.`Free Meal Count (K-12)` * 100 / T1.`Enrollment (K-12)`, T1.`District Code` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Alusine'",
        "llm_output": "-- Reasoning\nI need to retrieve the 'Percent (%) Eligible Free (K-12)' and 'District Code' from the `frpm` table.\nThe condition for filtering is based on the administrator's first name being 'Alusine', which is available in the `schools` table.\nI will join `frpm` and `schools` tables using their common `CDSCode` column and then apply the filter on the administrator's first name.\n\n-- SQL Query\nSELECT\n  T1.`Percent (%) Eligible Free (K-12)`,\n  T1.`District Code`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.AdmFName1 = 'Alusine' OR T2.AdmFName2 = 'Alusine' OR T2.AdmFName3 = 'Alusine';",
        "pred_query": "SELECT\n  T1.`Percent (%) Eligible Free (K-12)`,\n  T1.`District Code`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.AdmFName1 = 'Alusine' OR T2.AdmFName2 = 'Alusine' OR T2.AdmFName3 = 'Alusine';",
        "pred_time": 0.01780557632446289,
        "orig_time": 0.010962724685668945,
        "time_ratio": 0.6156905278380332,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the administrator's last name that oversees the school with Charter number 40? Indicate the district, the county where the school is situated, and the name of the school.",
        "original_query": "SELECT AdmLName1, District, County, School FROM schools WHERE CharterNum = '0040'",
        "llm_output": "-- Reasoning\nTo find the administrator's last name, district, county, and school name, I need to query the `schools` table. I will filter the records based on the `CharterNum` column being '40' and select the requested columns: `AdmLName1`, `District`, `County`, and `School`.\n\n-- SQL Query\nSELECT AdmLName1, District, County, School FROM schools WHERE CharterNum = '40';",
        "pred_query": "SELECT AdmLName1, District, County, School FROM schools WHERE CharterNum = '40';",
        "pred_time": 0.010066747665405273,
        "orig_time": 0.00882863998413086,
        "time_ratio": 0.8770101603391517,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the e-mail address of the administrator of the school located in the San Bernardino county, District of San Bernardino City Unified that opened between 1/1/2009 to 12/31/2010 whose school types are public Intermediate/Middle Schools and Unified Scools?",
        "original_query": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'San Bernardino' AND T2.City = 'San Bernardino' AND T2.DOC = 54 AND strftime('%Y', T2.OpenDate) BETWEEN '2009' AND '2010' AND T2.SOC = 62",
        "llm_output": "-- Reasoning\nThe query identifies the administrator's email from the `schools` table. It joins `schools` with the `frpm` table on `CDSCode` to filter by specific school and district types. Filters are applied for county, district, school opening date range, and `schools.StatusType` for \"public\" schools. Finally, `frpm.\"School Type\"` is filtered for \"Intermediate/Middle Schools\" and `frpm.\"District Type\"` for \"Unified Schools\".\n\n-- SQL Query\nSELECT\n  T1.AdmEmail1,\n  T1.AdmEmail2,\n  T1.AdmEmail3\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.County = 'San Bernardino' AND T1.District = 'San Bernardino City Unified' AND T1.OpenDate BETWEEN '2009-01-01' AND '2010-12-31' AND T1.StatusType = 'Active' AND (\n    T2.\"School Type\" = 'Intermediate School' OR T2.\"School Type\" = 'Middle School'\n  ) AND T2.\"District Type\" = 'Unified';",
        "pred_query": "SELECT\n  T1.AdmEmail1,\n  T1.AdmEmail2,\n  T1.AdmEmail3\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.County = 'San Bernardino' AND T1.District = 'San Bernardino City Unified' AND T1.OpenDate BETWEEN '2009-01-01' AND '2010-12-31' AND T1.StatusType = 'Active' AND (\n    T2.\"School Type\" = 'Intermediate School' OR T2.\"School Type\" = 'Middle School'\n  ) AND T2.\"District Type\" = 'Unified';",
        "pred_time": 0.004091978073120117,
        "orig_time": 0.008753061294555664,
        "time_ratio": 2.1390782497232417,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the administrator's email address for the school with the highest number of test takers who received SAT scores of at least 1500?Provide the name of the school.",
        "original_query": "SELECT T2.AdmEmail1, T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the school with the maximum 'NumGE1500' from the `satscores` table.\nThen, I will join this result with the `schools` table using the `cds` (from `satscores`) and `CDSCode` (from `schools`) to retrieve the school's name and the administrator's email address.\n\n-- SQL Query\nSELECT\n  T1.School,\n  T1.AdmEmail1\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nORDER BY\n  T2.NumGE1500 DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  T1.School,\n  T1.AdmEmail1\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nORDER BY\n  T2.NumGE1500 DESC\nLIMIT 1;",
        "pred_time": 0.013196468353271484,
        "orig_time": 0.002305269241333008,
        "time_ratio": 0.17468834688346885,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts who choose issuance after transaction are staying in East Bohemia region?",
        "original_query": "SELECT COUNT(T1.district_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE T1.A3 = 'East Bohemia' AND T2.frequency = 'POPLATEK PO OBRATU'",
        "llm_output": "-- Reasoning\nThe query needs to count accounts that satisfy two conditions: being in the 'East Bohemia' region and having a card issued after at least one transaction.\n1. Identify accounts in the 'East Bohemia' region by joining `account` with `district` on `district_id` and filtering `district.A3` for 'East Bohemia'.\n2. Identify accounts where a card was issued after a transaction by joining `account` with `disp`, `card`, and `trans` tables. Then filter for `card.issued > trans.date`.\n3. Combine both conditions using `AND` and count the distinct `account_id`s that meet both criteria.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN disp AS T3\n  ON T1.account_id = T3.account_id\nINNER JOIN card AS T4\n  ON T3.disp_id = T4.disp_id\nINNER JOIN trans AS T5\n  ON T1.account_id = T5.account_id\nWHERE\n  T2.A3 = 'East Bohemia' AND T4.issued > T5.date;",
        "pred_query": "SELECT\n  COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN disp AS T3\n  ON T1.account_id = T3.account_id\nINNER JOIN card AS T4\n  ON T3.disp_id = T4.disp_id\nINNER JOIN trans AS T5\n  ON T1.account_id = T5.account_id\nWHERE\n  T2.A3 = 'East Bohemia' AND T4.issued > T5.date;",
        "pred_time": 0.006139278411865234,
        "orig_time": 0.0011773109436035156,
        "time_ratio": 0.19176699029126212,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many accounts who have region in Prague are eligible for loans?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T1.district_id = T3.district_id WHERE T3.A3 = 'Prague'",
        "llm_output": "-- Reasoning\nThe question asks for the number of accounts from Prague that are \"eligible for loans\".\n1. Identify accounts located in 'Prague': Join `account` with `district` and filter `district.A3` (city/region name) for 'Prague'.\n2. Interpret \"eligible for loans\": An account is considered eligible if it does not have any loans with a 'bad' status. From the `loan` table, status 'B' (contract finished, loan not paid) and 'D' (running contract, client in debt) indicate bad loan status.\n3. Therefore, we need to count accounts that are in Prague AND whose `account_id` does not appear in the set of accounts having loans with status 'B' or 'D'.\n\n-- SQL Query\nite\nSELECT\n  COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A3 = 'Prague' AND T1.account_id NOT IN (\n    SELECT DISTINCT\n      account_id\n    FROM loan\n    WHERE\n      status IN ('B', 'D')\n  );\n",
        "pred_query": "SELECT\n  COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A3 = 'Prague' AND T1.account_id NOT IN (\n    SELECT DISTINCT\n      account_id\n    FROM loan\n    WHERE\n      status IN ('B', 'D')\n  );",
        "pred_time": 0.0033016204833984375,
        "orig_time": 0.0009582042694091797,
        "time_ratio": 0.29022241478913924,
        "check": false
    },
    {
        "id": "financial",
        "question": "The average unemployment ratio of 1995 and 1996, which one has higher percentage?",
        "original_query": "SELECT DISTINCT IIF(AVG(A13) > AVG(A12), '1996', '1995') FROM district",
        "llm_output": "-- Reasoning\nThe unemployment ratio (A10) is located in the `district` table. Since `district` has no date column, we need to link it to a year via another table. The `account` table has a `date` column representing the account opening date and is linked to `district` via `district_id`. We can calculate the average A10 for accounts opened in 1995 and 1996 respectively. Finally, we compare these averages to find the year with the higher percentage.\n\n-- SQL Query\nite\nSELECT\n  STRFTIME('%Y', T2.date) AS year,\n  AVG(T1.A10) AS average_unemployment_ratio\nFROM district AS T1\nINNER JOIN account AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  STRFTIME('%Y', T2.date) IN ('1995', '1996')\nGROUP BY\n  year\nORDER BY\n  average_unemployment_ratio DESC\nLIMIT 1;\n",
        "pred_query": "SELECT\n  STRFTIME('%Y', T2.date) AS year,\n  AVG(T1.A10) AS average_unemployment_ratio\nFROM district AS T1\nINNER JOIN account AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  STRFTIME('%Y', T2.date) IN ('1995', '1996')\nGROUP BY\n  year\nORDER BY\n  average_unemployment_ratio DESC\nLIMIT 1;",
        "pred_time": 0.003293275833129883,
        "orig_time": 0.0005304813385009766,
        "time_ratio": 0.161080141895316,
        "check": false
    },
    {
        "id": "financial",
        "question": "List out the no. of districts that have female average salary is more than 6000 but less than 10000?",
        "original_query": "SELECT DISTINCT T2.district_id FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' AND T2.A11 BETWEEN 6000 AND 10000",
        "llm_output": "-- Reasoning\nThe question asks for the number of districts where \"female average salary\" falls within a specific range.\n1. The `district` table contains various statistical information about each district. Based on common interpretations of this dataset, `A10` represents the 'average salary' for the district.\n2. The schema does not explicitly provide a separate column for 'female average salary'. Therefore, `A10` (the overall district average salary) is used as the best available proxy for \"average salary\" in this context.\n3. Filter the districts where `A10` is greater than 6000 and less than 10000.\n4. Count the number of `district_id`s that satisfy these conditions.\n\n-- SQL Query\nSELECT COUNT(district_id)\nFROM district\nWHERE A10 > 6000\n  AND A10 < 10000;",
        "pred_query": "SELECT COUNT(district_id)\nFROM district\nWHERE A10 > 6000\n  AND A10 < 10000;",
        "pred_time": 0.0007333755493164062,
        "orig_time": 0.005684375762939453,
        "time_ratio": 7.750975292587777,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many male customers who are living in North Bohemia have average salary greater than 8000?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'M' AND T2.A3 = 'North Bohemia' AND T2.A11 > 8000",
        "llm_output": "-- Reasoning\nI need to count male customers from 'North Bohemia' whose average salary is greater than 8000.\n1. Join `client` and `district` tables on `district_id` to access customer gender, district region, and average salary.\n2. Filter for male customers using `client.gender = 'M'`.\n3. Filter for customers from 'North Bohemia' using `district.A3 = 'North Bohemia'`.\n4. Filter for districts with an average salary greater than 8000, assuming `district.A11` represents the average salary.\n5. Count the distinct `client_id`s that meet all these conditions.\n\n-- SQL Query\nSELECT COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T1.gender = 'M' AND T2.A3 = 'North Bohemia' AND T2.A11 > 8000;",
        "pred_query": "SELECT COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T1.gender = 'M' AND T2.A3 = 'North Bohemia' AND T2.A11 > 8000;",
        "pred_time": 0.0014681816101074219,
        "orig_time": 0.0011646747589111328,
        "time_ratio": 0.7932770379993505,
        "check": true
    },
    {
        "id": "financial",
        "question": "List out the account numbers of female clients who are oldest and has lowest average salary, calculate the gap between this lowest average salary with the highest average salary?",
        "original_query": "SELECT T1.account_id , ( SELECT MAX(A11) - MIN(A11) FROM district ) FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.district_id = ( SELECT district_id FROM client WHERE gender = 'F' ORDER BY birth_date ASC LIMIT 1 ) ORDER BY T2.A11 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nThe query first defines a Common Table Expression (CTE) `AccountCreditAvg` to calculate the average amount of 'credit' transactions for each account, serving as the \"average salary\".\nThen, `OldestFemaleClients` identifies accounts linked to female clients who have the minimum birth date (oldest).\n`OldestFemaleClientsAvgSalary` joins these two CTEs to get the average salary for the oldest female clients' accounts.\n`TargetAccounts` filters for the specific accounts among the oldest female clients that have the lowest average salary.\nFinally, the main `SELECT` statement retrieves the comma-separated `account_id`s of these target accounts and calculates the `salary_gap` by subtracting the lowest average salary (found in `TargetAccounts`) from the overall highest average salary (found in `AccountCreditAvg`).\n\n-- SQL Query\nite\nWITH AccountCreditAvg AS (\n    SELECT\n        account_id,\n        AVG(amount) AS avg_credit_amount\n    FROM trans\n    WHERE type = 'credit'\n    GROUP BY account_id\n),\nOldestFemaleClients AS (\n    SELECT\n        c.client_id,\n        d.account_id\n    FROM client AS c\n    JOIN disp AS d ON c.client_id = d.client_id\n    WHERE c.gender = 'F'\n      AND c.birth_date = (SELECT MIN(birth_date) FROM client WHERE gender = 'F')\n),\nOldestFemaleClientsAvgSalary AS (\n    SELECT\n        ofc.account_id,\n        aca.avg_credit_amount\n    FROM OldestFemaleClients AS ofc\n    JOIN AccountCreditAvg AS aca ON ofc.account_id = aca.account_id\n),\nTargetAccounts AS (\n    SELECT\n        account_id,\n        avg_credit_amount AS target_avg_salary\n    FROM OldestFemaleClientsAvgSalary\n    WHERE avg_credit_amount = (SELECT MIN(avg_credit_amount) FROM OldestFemaleClientsAvgSalary)\n)\nSELECT\n    GROUP_CONCAT(DISTINCT ta.account_id) AS account_numbers,\n    (\n        (SELECT MAX(avg_credit_amount) FROM AccountCreditAvg) -\n        (SELECT target_avg_salary FROM TargetAccounts LIMIT 1)\n    ) AS salary_gap\nFROM TargetAccounts AS ta;\n",
        "pred_query": "SELECT\n        account_id,\n        AVG(amount) AS avg_credit_amount\n    FROM trans\n    WHERE type = 'credit'\n    GROUP BY account_id\n),\nOldestFemaleClients AS (\n    SELECT\n        c.client_id,\n        d.account_id\n    FROM client AS c\n    JOIN disp AS d ON c.client_id = d.client_id\n    WHERE c.gender = 'F'\n      AND c.birth_date = (SELECT MIN(birth_date) FROM client WHERE gender = 'F')\n),\nOldestFemaleClientsAvgSalary AS (\n    SELECT\n        ofc.account_id,\n        aca.avg_credit_amount\n    FROM OldestFemaleClients AS ofc\n    JOIN AccountCreditAvg AS aca ON ofc.account_id = aca.account_id\n),\nTargetAccounts AS (\n    SELECT\n        account_id,\n        avg_credit_amount AS target_avg_salary\n    FROM OldestFemaleClientsAvgSalary\n    WHERE avg_credit_amount = (SELECT MIN(avg_credit_amount) FROM OldestFemaleClientsAvgSalary)\n)\nSELECT\n    GROUP_CONCAT(DISTINCT ta.account_id) AS account_numbers,\n    (\n        (SELECT MAX(avg_credit_amount) FROM AccountCreditAvg) -\n        (SELECT target_avg_salary FROM TargetAccounts LIMIT 1)\n    ) AS salary_gap\nFROM TargetAccounts AS ta;",
        "pred_time": null,
        "orig_time": 0.0012776851654052734,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "List out the account numbers of clients who are youngest and have highest average salary?",
        "original_query": "SELECT T1.account_id FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.district_id = ( SELECT district_id FROM client ORDER BY birth_date DESC LIMIT 1 ) ORDER BY T2.A11 DESC LIMIT 1",
        "llm_output": "-- Reasoning\n1.  **Identify Youngest Clients:** Determine the maximum `birth_date` from the `client` table. Then select all `client_id`s that match this maximum `birth_date` to handle potential ties.\n2.  **Calculate Average Salary:** As \"salary\" isn't directly available, we approximate it by calculating the average `balance` for all transactions associated with each client. This involves joining `client`, `disp`, and `trans` tables, then grouping by `client_id` and calculating `AVG(trans.balance)`.\n3.  **Identify Highest Average Salary Clients:** From the calculated client average balances, find the maximum average balance. Then select all `client_id`s that have this maximum average balance.\n4.  **Combine Conditions:** Find the `client_id`s that are present in *both* the \"youngest clients\" set and the \"highest average salary clients\" set.\n5.  **Retrieve Account Numbers:** Finally, join the resulting `client_id`s with the `disp` table to get the distinct `account_id`s associated with these clients.\n\n-- SQL Query\nite\nWITH YoungestClients AS (\n    SELECT client_id\n    FROM client\n    WHERE birth_date = (SELECT MAX(birth_date) FROM client)\n),\nClientAvgBalances AS (\n    SELECT\n        c.client_id,\n        AVG(t.balance) AS client_avg_balance\n    FROM client AS c\n    JOIN disp AS d\n        ON c.client_id = d.client_id\n    JOIN trans AS t\n        ON d.account_id = t.account_id\n    GROUP BY\n        c.client_id\n),\nHighestSalaryClients AS (\n    SELECT client_id\n    FROM ClientAvgBalances\n    WHERE client_avg_balance = (SELECT MAX(client_avg_balance) FROM ClientAvgBalances)\n)\nSELECT DISTINCT d.account_id\nFROM disp AS d\nWHERE d.client_id IN (SELECT client_id FROM YoungestClients)\n  AND d.client_id IN (SELECT client_id FROM HighestSalaryClients);\n",
        "pred_query": "SELECT client_id\n    FROM client\n    WHERE birth_date = (SELECT MAX(birth_date) FROM client)\n),\nClientAvgBalances AS (\n    SELECT\n        c.client_id,\n        AVG(t.balance) AS client_avg_balance\n    FROM client AS c\n    JOIN disp AS d\n        ON c.client_id = d.client_id\n    JOIN trans AS t\n        ON d.account_id = t.account_id\n    GROUP BY\n        c.client_id\n),\nHighestSalaryClients AS (\n    SELECT client_id\n    FROM ClientAvgBalances\n    WHERE client_avg_balance = (SELECT MAX(client_avg_balance) FROM ClientAvgBalances)\n)\nSELECT DISTINCT d.account_id\nFROM disp AS d\nWHERE d.client_id IN (SELECT client_id FROM YoungestClients)\n  AND d.client_id IN (SELECT client_id FROM HighestSalaryClients);",
        "pred_time": null,
        "orig_time": 0.0013840198516845703,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many customers who choose statement of weekly issuance are Owner?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id WHERE T2.type = 'Owner' AND T1.frequency = 'POPLATEK TYDNE'",
        "llm_output": "-- Reasoning\nI need to find customers who meet two criteria: their account has a 'weekly issuance' frequency and their disposition type is 'Owner'. I will join the `account` and `disp` tables on `account_id`. Then, I'll filter for `account.frequency = 'weekly issuance'` and `disp.type = 'Owner'`, and finally count the distinct `client_id`s from the `disp` table to get the number of unique customers.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T2.client_id)\nFROM account AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.frequency = 'weekly issuance' AND T2.type = 'Owner';",
        "pred_query": "SELECT\n  COUNT(DISTINCT T2.client_id)\nFROM account AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.frequency = 'weekly issuance' AND T2.type = 'Owner';",
        "pred_time": 0.010357856750488281,
        "orig_time": 0.0009419918060302734,
        "time_ratio": 0.09094466439554369,
        "check": true
    },
    {
        "id": "financial",
        "question": "List out the clients who choose statement of issuance after transaction are Disponent?",
        "original_query": "SELECT T2.client_id FROM account AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id WHERE T1.frequency = 'POPLATEK PO OBRATU' AND T2.type = 'DISPONENT'",
        "llm_output": "-- Reasoning\nI need to find clients who have a 'Disponent' disposition type and also have a card of type 'statement of issuance after transaction'.\nI will join `client` with `disp` on `client_id`, and `disp` with `card` on `disp_id`.\nThen, I will filter the results based on `disp.type = 'Disponent'` and `card.type = 'statement of issuance after transaction'`.\nFinally, I will select the distinct `client_id` from the filtered results.\n\n-- SQL Query\nSELECT DISTINCT\n  T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nWHERE\n  T2.type = 'Disponent' AND T3.type = 'statement of issuance after transaction';",
        "pred_query": "SELECT DISTINCT\n  T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nWHERE\n  T2.type = 'Disponent' AND T3.type = 'statement of issuance after transaction';",
        "pred_time": 0.007893562316894531,
        "orig_time": 0.0014259815216064453,
        "time_ratio": 0.18065120212637428,
        "check": false
    },
    {
        "id": "financial",
        "question": "Among the accounts who have approved loan date in 1997, list out the accounts that have the lowest approved amount and choose weekly issuance statement.",
        "original_query": "SELECT T2.account_id FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE STRFTIME('%Y', T1.date) = '1997' AND T2.frequency = 'POPLATEK TYDNE' ORDER BY T1.amount LIMIT 1",
        "llm_output": "-- Reasoning\nThe query first identifies the minimum loan amount among all approved loans (`status = 'A'`) issued in the year 1997.\nThen, it joins the `account` and `loan` tables to find accounts that have an approved loan in 1997 with this specific minimum amount.\nFinally, it filters these accounts further to include only those with a `frequency` of 'weekly', and selects their unique `account_id`.\n\n-- SQL Query\nite\nSELECT DISTINCT T1.account_id\nFROM account AS T1\nJOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE T2.status = 'A'\n  AND strftime('%Y', T2.date) = '1997'\n  AND T2.amount = (\n    SELECT MIN(amount)\n    FROM loan\n    WHERE status = 'A' AND strftime('%Y', date) = '1997'\n  )\n  AND T1.frequency = 'weekly';\n",
        "pred_query": "SELECT DISTINCT T1.account_id\nFROM account AS T1\nJOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE T2.status = 'A'\n  AND strftime('%Y', T2.date) = '1997'\n  AND T2.amount = (\n    SELECT MIN(amount)\n    FROM loan\n    WHERE status = 'A' AND strftime('%Y', date) = '1997'\n  )\n  AND T1.frequency = 'weekly';",
        "pred_time": 0.0011601448059082031,
        "orig_time": 0.0008285045623779297,
        "time_ratio": 0.7141389231401561,
        "check": false
    },
    {
        "id": "financial",
        "question": "Among the accounts who have loan validity more than 12 months, list out the accounts that have the highest approved amount and have account opening date in 1993.",
        "original_query": "SELECT T1.account_id FROM loan AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id WHERE STRFTIME('%Y', T1.date) = '1993' AND T1.duration = 12 ORDER BY T1.amount DESC LIMIT 1",
        "llm_output": "-- Reasoning\n1.  Identify the relevant tables: `account` (for opening date) and `loan` (for loan duration, amount, and status).\n2.  Join `account` and `loan` tables on `account_id` to access information from both.\n3.  Filter the results based on three conditions:\n    a.  Loan validity (duration) more than 12 months: `loan.duration > 12`.\n    b.  Account opening date in 1993: `STRFTIME('%Y', account.date) = '1993'`.\n    c.  Loan status is 'approved': `loan.status = 'approved'`. (Assuming 'approved' is a valid status value for the `TEXT` status column).\n4.  To find accounts with the \"highest approved amount\" among the filtered set, use a subquery to calculate the `MAX(amount)` from the records that meet all the above conditions.\n5.  Finally, select the `account_id` from the main query where the `loan.amount` matches the maximum amount found by the subquery. This handles cases where multiple accounts might share the highest approved amount.\n\n-- SQL Query\nite\nSELECT\n  T1.account_id\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.duration > 12 AND STRFTIME('%Y', T1.date) = '1993' AND T2.status = 'approved' AND T2.amount = (\n    SELECT\n      MAX(T3.amount)\n    FROM account AS T4\n    INNER JOIN loan AS T3\n      ON T4.account_id = T3.account_id\n    WHERE\n      T3.duration > 12 AND STRFTIME('%Y', T4.date) = '1993' AND T3.status = 'approved'\n  );\n",
        "pred_query": "SELECT\n  T1.account_id\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.duration > 12 AND STRFTIME('%Y', T1.date) = '1993' AND T2.status = 'approved' AND T2.amount = (\n    SELECT\n      MAX(T3.amount)\n    FROM account AS T4\n    INNER JOIN loan AS T3\n      ON T4.account_id = T3.account_id\n    WHERE\n      T3.duration > 12 AND STRFTIME('%Y', T4.date) = '1993' AND T3.status = 'approved'\n  );",
        "pred_time": 0.0009930133819580078,
        "orig_time": 0.001726388931274414,
        "time_ratio": 1.7385354141656664,
        "check": false
    },
    {
        "id": "financial",
        "question": "Among the account opened, how many female customers who were born before 1950 and stayed in Slokolov?",
        "original_query": "SELECT COUNT(T2.client_id) FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T2.gender = 'F' AND STRFTIME('%Y', T2.birth_date) < '1950' AND T1.A2 = 'Slokolov'",
        "llm_output": "-- Reasoning\nThe question asks for the number of female customers born before 1950 who reside in the 'Slokolov' district.\n1. Identify female customers by filtering the `client` table where `gender = 'F'`.\n2. Filter these customers further by their birth date, specifically those born before 1950, using `birth_date < '1950-01-01'`.\n3. Join the `client` table with the `district` table on `district_id` to access district information.\n4. Filter the joined results to include only those where the district name (`A2`) is 'Slokolov'.\n5. Count the distinct `client_id`s that satisfy all these conditions.\n\n-- SQL Query\nSELECT\n  COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T1.gender = 'F' AND T1.birth_date < '1950-01-01' AND T2.A2 = 'Slokolov';",
        "pred_query": "SELECT\n  COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T1.gender = 'F' AND T1.birth_date < '1950-01-01' AND T2.A2 = 'Slokolov';",
        "pred_time": 0.0013523101806640625,
        "orig_time": 0.0015664100646972656,
        "time_ratio": 1.1583215796897037,
        "check": true
    },
    {
        "id": "financial",
        "question": "List out the accounts who have the earliest trading date in 1995 ?",
        "original_query": "SELECT account_id FROM trans WHERE STRFTIME('%Y', date) = '1995' ORDER BY date ASC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the earliest transaction date within the year 1995 from the `trans` table.\nThen, I will select the `account_id`s from the `trans` table that correspond to this earliest date in 1995.\nThis can be achieved by first finding the minimum date in 1995 and then selecting distinct account IDs having that date.\n\n-- SQL Query\nSELECT DISTINCT account_id\nFROM trans\nWHERE STRFTIME('%Y', date) = '1995' AND date = (\n    SELECT MIN(date)\n    FROM trans\n    WHERE STRFTIME('%Y', date) = '1995'\n);",
        "pred_query": "SELECT DISTINCT account_id\nFROM trans\nWHERE STRFTIME('%Y', date) = '1995' AND date = (\n    SELECT MIN(date)\n    FROM trans\n    WHERE STRFTIME('%Y', date) = '1995'\n);",
        "pred_time": 0.588324785232544,
        "orig_time": 0.28890228271484375,
        "time_ratio": 0.49105917337929406,
        "check": false
    },
    {
        "id": "financial",
        "question": "State different accounts who have account opening date before 1997 and own an amount of money greater than 3000USD",
        "original_query": "SELECT DISTINCT T2.account_id FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE STRFTIME('%Y', T2.date) < '1997' AND T1.amount > 3000",
        "llm_output": "-- Reasoning\nI need to select distinct account IDs.\nI will join the `account` table with the `loan` table using `account_id`.\nThen, I will filter for accounts opened before 1997 (`account.date < '1997-01-01'`) and loans with an amount greater than 3000 (`loan.amount > 3000`).\n\n-- SQL Query\nSELECT DISTINCT\n  T1.account_id\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.date < '1997-01-01' AND T2.amount > 3000;",
        "pred_query": "SELECT DISTINCT\n  T1.account_id\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.date < '1997-01-01' AND T2.amount > 3000;",
        "pred_time": 0.0016009807586669922,
        "orig_time": 0.20458483695983887,
        "time_ratio": 127.78719285182427,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which client issued his/her card in 1994/3/3, give his/her client id.",
        "original_query": "SELECT T2.client_id FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN card AS T3 ON T2.disp_id = T3.disp_id WHERE T3.issued = '1994-03-03'",
        "llm_output": "-- Reasoning\nTo find clients who issued a card on '1994-03-03', I need to link `client` records to `card` records. The `disp` table connects `client` to `card` via `client_id` and `disp_id`. I will join `client`, `disp`, and `card` tables, then filter by the `issued` date from the `card` table and select the `client_id`.\n\n-- SQL Query\nSELECT T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nWHERE\n  T3.issued = '1994-03-03';",
        "pred_query": "SELECT T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nWHERE\n  T3.issued = '1994-03-03';",
        "pred_time": 0.0008563995361328125,
        "orig_time": 0.0005958080291748047,
        "time_ratio": 0.6957126948775055,
        "check": true
    },
    {
        "id": "financial",
        "question": "The transaction of 840 USD happened in 1998/10/14, when was this account opened?",
        "original_query": "SELECT T1.date FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.amount = 840 AND T2.date = '1998-10-14'",
        "llm_output": "-- Reasoning\nFirst, I need to identify the `account_id` from the `trans` table that matches the given transaction `amount` and `date`.\nThen, I will use this `account_id` to query the `account` table and retrieve the `date` column, which represents when the account was opened.\n\n-- SQL Query\nSELECT T1.date\nFROM account AS T1\nINNER JOIN trans AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.amount = 840 AND T2.date = '1998-10-14';",
        "pred_query": "SELECT T1.date\nFROM account AS T1\nINNER JOIN trans AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.amount = 840 AND T2.date = '1998-10-14';",
        "pred_time": 0.0794062614440918,
        "orig_time": 0.07835817337036133,
        "time_ratio": 0.9868009391870387,
        "check": true
    },
    {
        "id": "financial",
        "question": "There was a loan approved in 1994/8/25, where was that account opened, give the district Id of the branch.",
        "original_query": "SELECT T1.district_id FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T2.date = '1994-08-25'",
        "llm_output": "-- Reasoning\nI need to find the `account_id` associated with the loan approved on '1994-08-25' from the `loan` table.\nThen, I will use this `account_id` to find the corresponding `district_id` in the `account` table, which represents where the account was opened.\n\n-- SQL Query\nSELECT T1.district_id\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.date = '1994-08-25';",
        "pred_query": "SELECT T1.district_id\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.date = '1994-08-25';",
        "pred_time": 0.0008845329284667969,
        "orig_time": 0.0005552768707275391,
        "time_ratio": 0.6277628032345014,
        "check": true
    },
    {
        "id": "financial",
        "question": "What is the biggest amount of transaction that the client whose card was opened in 1996/10/21 made?",
        "original_query": "SELECT T2.amount FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T1.date = '1996-10-21' ORDER BY T2.amount DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the maximum transaction amount. First, I will filter the `card` table for cards issued on '1996-10-21'. Then, I will join with the `disp` table to link these cards to their respective accounts. Finally, I will join with the `trans` table to get all transactions for those accounts and find the maximum `amount`.\n\n-- SQL Query\nSELECT MAX(T3.amount)\nFROM card AS T1\nJOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nJOIN trans AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.issued = '1996-10-21';",
        "pred_query": "SELECT MAX(T3.amount)\nFROM card AS T1\nJOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nJOIN trans AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.issued = '1996-10-21';",
        "pred_time": 0.8539113998413086,
        "orig_time": 0.1421489715576172,
        "time_ratio": 0.1664680569717587,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the gender of the oldest client who opened his/her account in the highest average salary branch?",
        "original_query": "SELECT T2.gender FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id ORDER BY T1.A11 DESC, T2.birth_date ASC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the gender of a client. This client is the oldest among those who opened an account in a specific branch. The specific branch is the one with the highest average salary.\n1. First, identify the `district_id` of the branch (district) that has the highest average salary (`A10` column in the `district` table).\n2. Then, join `client`, `disp`, `account`, and `district` tables to connect clients to the districts where their accounts were opened.\n3. Filter these joined records to include only those associated with the `district_id` identified in step 1.\n4. From the filtered results, find the client with the minimum `birth_date` (oldest).\n5. Select the `gender` of this client.\n\n-- SQL Query\nSELECT T1.gender\nFROM client AS T1\nJOIN disp AS T2\n  ON T1.client_id = T2.client_id\nJOIN account AS T3\n  ON T2.account_id = T3.account_id\nJOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  T4.district_id = (\n    SELECT\n      district_id\n    FROM district\n    ORDER BY\n      A10 DESC\n    LIMIT 1\n  )\nORDER BY\n  T1.birth_date ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.gender\nFROM client AS T1\nJOIN disp AS T2\n  ON T1.client_id = T2.client_id\nJOIN account AS T3\n  ON T2.account_id = T3.account_id\nJOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  T4.district_id = (\n    SELECT\n      district_id\n    FROM district\n    ORDER BY\n      A10 DESC\n    LIMIT 1\n  )\nORDER BY\n  T1.birth_date ASC\nLIMIT 1;",
        "pred_time": 0.002046346664428711,
        "orig_time": 0.0014851093292236328,
        "time_ratio": 0.7257369218222067,
        "check": false
    },
    {
        "id": "financial",
        "question": "For the client who applied the biggest loan, what was his/her first amount of transaction after opened the account?",
        "original_query": "SELECT T2.amount FROM loan AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id ORDER BY T1.amount DESC, T2.date ASC LIMIT 1",
        "llm_output": "-- Reasoning\nFirst, identify the `account_id` that is associated with the largest loan amount from the `loan` table.\nThen, use this `account_id` to query the `trans` table, ordering transactions by date (and `trans_id` for tie-breaking) in ascending order to find the earliest transaction.\nFinally, select the `amount` of this first transaction.\n\n-- SQL Query\nite\nSELECT T.amount\nFROM trans AS T\nWHERE T.account_id = (\n    SELECT account_id\n    FROM loan\n    ORDER BY amount DESC\n    LIMIT 1\n)\nORDER BY T.date ASC, T.trans_id ASC\nLIMIT 1;\n",
        "pred_query": "SELECT T.amount\nFROM trans AS T\nWHERE T.account_id = (\n    SELECT account_id\n    FROM loan\n    ORDER BY amount DESC\n    LIMIT 1\n)\nORDER BY T.date ASC, T.trans_id ASC\nLIMIT 1;",
        "pred_time": 0.07878518104553223,
        "orig_time": 0.7003986835479736,
        "time_ratio": 8.88997999691329,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many clients opened their accounts in Jesenik branch were women?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' AND T2.A2 = 'Jesenik'",
        "llm_output": "-- Reasoning\nI need to find clients who are female and whose accounts were opened in the 'Jesenik' district.\nI will join `client` (for gender), `disp` (to link client to account), `account` (for the district where the account was opened), and `district` (to filter by district name).\nFinally, I will count the distinct client IDs that meet both the gender and district criteria.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  T1.gender = 'F' AND T4.A2 = 'Jesenik';",
        "pred_query": "SELECT\n  COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  T1.gender = 'F' AND T4.A2 = 'Jesenik';",
        "pred_time": 0.0022897720336914062,
        "orig_time": 0.0011262893676757812,
        "time_ratio": 0.4918783840066639,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the disposition id of the client who made 5100 USD transaction in 1998/9/2?",
        "original_query": "SELECT T1.disp_id FROM disp AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.date = '1998-09-02' AND T2.amount = 5100",
        "llm_output": "-- Reasoning\nThe question asks for the `disp_id` of a client based on a specific transaction amount and date.\nI need to query the `trans` table to filter for the given amount (5100) and date ('1998-09-02').\nThen, I will join the `trans` table with the `disp` table on `account_id` to retrieve the corresponding `disp_id`.\n\n-- SQL Query\nSELECT T2.disp_id FROM trans AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id WHERE T1.amount = 5100 AND T1.date = '1998-09-02';",
        "pred_query": "SELECT T2.disp_id FROM trans AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id WHERE T1.amount = 5100 AND T1.date = '1998-09-02';",
        "pred_time": 0.08352470397949219,
        "orig_time": 0.1248025894165039,
        "time_ratio": 1.4941997214039415,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many accounts were opened in Litomerice in 1996?",
        "original_query": "SELECT COUNT(T2.account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T2.date) = '1996' AND T1.A2 = 'Litomerice'",
        "llm_output": "-- Reasoning\nI need to count accounts opened in a specific district and year.\nFirst, join the `account` table with the `district` table using `district_id`.\nFilter the results where `district.A2` is 'Litomerice' and the year of `account.date` is '1996'.\nFinally, count the number of distinct `account_id`s that satisfy these conditions.\n\n-- SQL Query\nSELECT\n  COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A2 = 'Litomerice' AND STRFTIME('%Y', T1.date) = '1996';",
        "pred_query": "SELECT\n  COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A2 = 'Litomerice' AND STRFTIME('%Y', T1.date) = '1996';",
        "pred_time": 0.0036001205444335938,
        "orig_time": 0.0033271312713623047,
        "time_ratio": 0.9241721854304635,
        "check": true
    },
    {
        "id": "financial",
        "question": "For the female client who was born in 1976/1/29, which district did she opened her account?",
        "original_query": "SELECT T1.A2 FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T2.birth_date = '1976-01-29' AND T2.gender = 'F'",
        "llm_output": "-- Reasoning\nFirst, I will identify the client by filtering the `client` table based on `gender` and `birth_date`.\nNext, I will join `client` with `disp` on `client_id` to find the account associated with this client.\nThen, I will join the result with the `account` table on `account_id` to get the district ID for that account.\nFinally, I will join with the `district` table on `district_id` to retrieve the district name (column `A2`).\n\n-- SQL Query\nSELECT\n  T4.A2\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  T1.gender = 'F' AND T1.birth_date = '1976-01-29';",
        "pred_query": "SELECT\n  T4.A2\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  T1.gender = 'F' AND T1.birth_date = '1976-01-29';",
        "pred_time": 0.0015642642974853516,
        "orig_time": 0.0009856224060058594,
        "time_ratio": 0.6300868770004573,
        "check": true
    },
    {
        "id": "financial",
        "question": "For the client who applied 98832 USD loan in 1996/1/3, when was his/her birthday?",
        "original_query": "SELECT T3.birth_date FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN client AS T3 ON T2.district_id = T3.district_id WHERE T1.date = '1996-01-03' AND T1.amount = 98832",
        "llm_output": "-- Reasoning\nFirst, I will find the `account_id` from the `loan` table by filtering on the given `amount` and `date`.\nNext, I will join `loan` with `disp` via the `account_id` to get the `client_id`.\nFinally, I will join `disp` with `client` on `client_id` to retrieve the `birth_date` of the specific client.\n\n-- SQL Query\nSELECT\n  T3.birth_date\nFROM loan AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN client AS T3\n  ON T2.client_id = T3.client_id\nWHERE\n  T1.amount = 98832 AND T1.date = '1996-01-03';",
        "pred_query": "SELECT\n  T3.birth_date\nFROM loan AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN client AS T3\n  ON T2.client_id = T3.client_id\nWHERE\n  T1.amount = 98832 AND T1.date = '1996-01-03';",
        "pred_time": 0.0016167163848876953,
        "orig_time": 0.004018545150756836,
        "time_ratio": 2.485621589736027,
        "check": false
    },
    {
        "id": "financial",
        "question": "For the first client who opened his/her account in Prague, what is his/her account ID?",
        "original_query": "SELECT T1.account_id FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A3 = 'Prague' ORDER BY T1.date ASC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the `account_id` of the client who opened an account earliest in the 'Prague' district.\nFirst, I'll identify the `district_id` for 'Prague' from the `district` table (column A3).\nThen, I'll join `district` with `client` to find clients in Prague, and then with `disp` to link clients to accounts.\nFinally, I'll join with the `account` table to get the account opening `date`, sort by this date, and pick the top one.\n\n-- SQL Query\nSELECT\n  T3.account_id\nFROM district AS T1\nINNER JOIN client AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN disp AS T4\n  ON T2.client_id = T4.client_id\nINNER JOIN account AS T3\n  ON T4.account_id = T3.account_id\nWHERE\n  T1.A3 = 'Prague'\nORDER BY\n  T3.date\nLIMIT 1;",
        "pred_query": "SELECT\n  T3.account_id\nFROM district AS T1\nINNER JOIN client AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN disp AS T4\n  ON T2.client_id = T4.client_id\nINNER JOIN account AS T3\n  ON T4.account_id = T3.account_id\nWHERE\n  T1.A3 = 'Prague'\nORDER BY\n  T3.date\nLIMIT 1;",
        "pred_time": 0.002482175827026367,
        "orig_time": 0.001323699951171875,
        "time_ratio": 0.5332821054653731,
        "check": false
    },
    {
        "id": "financial",
        "question": "For the branch which located in the south Bohemia with biggest number of inhabitants, what is the percentage of the male clients?",
        "original_query": "SELECT CAST(SUM(T1.gender = 'M') AS REAL) * 100 / COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A3 = 'south Bohemia' GROUP BY T2.A4 ORDER BY T2.A4 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nFirst, identify the `district_id` corresponding to 'south Bohemia' (`A3` column) with the largest number of inhabitants (`A4` column). Then, filter the `client` table by this specific `district_id`. Finally, calculate the percentage of male clients by dividing the count of male clients by the total count of clients and multiplying by 100, ensuring floating-point division.\n\n-- SQL Query\nite\nSELECT\n  CAST(SUM(CASE WHEN T1.gender = 'M' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(T1.client_id)\nFROM client AS T1\nWHERE\n  T1.district_id = (\n    SELECT\n      district_id\n    FROM district\n    WHERE\n      A3 = 'south Bohemia'\n    ORDER BY\n      A4 DESC\n    LIMIT 1\n  );\n",
        "pred_query": "SELECT\n  CAST(SUM(CASE WHEN T1.gender = 'M' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(T1.client_id)\nFROM client AS T1\nWHERE\n  T1.district_id = (\n    SELECT\n      district_id\n    FROM district\n    WHERE\n      A3 = 'south Bohemia'\n    ORDER BY\n      A4 DESC\n    LIMIT 1\n  );",
        "pred_time": 0.0012009143829345703,
        "orig_time": 0.0015337467193603516,
        "time_ratio": 1.2771490966845345,
        "check": true
    },
    {
        "id": "financial",
        "question": "For the client who first applied the loan in 1993/7/5, what is the increase rate of his/her account balance from 1993/3/22 to 1998/12/27?",
        "original_query": "SELECT CAST((SUM(IIF(T3.date = '1998-12-27', T3.balance, 0)) - SUM(IIF(T3.date = '1993-03-22', T3.balance, 0))) AS REAL) * 100 / SUM(IIF(T3.date = '1993-03-22', T3.balance, 0)) FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN trans AS T3 ON T3.account_id = T2.account_id WHERE T1.date = '1993-07-05'",
        "llm_output": "-- Reasoning\n1. **Identify the target account:** Find the `account_id` associated with a loan application on '1993-07-05' from the `loan` table. This `account_id` belongs to \"the client\" mentioned in the question.\n2. **Retrieve starting balance:** For the identified `account_id`, find the `balance` from the `trans` table corresponding to the latest transaction on or before '1993-03-22'.\n3. **Retrieve ending balance:** For the identified `account_id`, find the `balance` from the `trans` table corresponding to the latest transaction on or before '1998-12-27'.\n4. **Calculate the increase rate:** Compute `((ending_balance - starting_balance) * 100.0 / starting_balance)` to get the percentage increase rate.\n\n-- SQL Query\nite\nWITH TargetAccount AS (\n  SELECT\n    account_id\n  FROM loan\n  WHERE\n    date = '1993-07-05'\n  LIMIT 1\n), StartBalance AS (\n  SELECT\n    T2.balance\n  FROM trans AS T2\n  JOIN TargetAccount AS TA\n    ON T2.account_id = TA.account_id\n  WHERE\n    T2.date <= '1993-03-22'\n  ORDER BY\n    T2.date DESC,\n    T2.trans_id DESC\n  LIMIT 1\n), EndBalance AS (\n  SELECT\n    T2.balance\n  FROM trans AS T2\n  JOIN TargetAccount AS TA\n    ON T2.account_id = TA.account_id\n  WHERE\n    T2.date <= '1998-12-27'\n  ORDER BY\n    T2.date DESC,\n    T2.trans_id DESC\n  LIMIT 1\n)\nSELECT\n  CAST((EB.balance - SB.balance) AS REAL) * 100 / SB.balance\nFROM StartBalance AS SB, EndBalance AS EB;\n",
        "pred_query": "SELECT\n    account_id\n  FROM loan\n  WHERE\n    date = '1993-07-05'\n  LIMIT 1\n), StartBalance AS (\n  SELECT\n    T2.balance\n  FROM trans AS T2\n  JOIN TargetAccount AS TA\n    ON T2.account_id = TA.account_id\n  WHERE\n    T2.date <= '1993-03-22'\n  ORDER BY\n    T2.date DESC,\n    T2.trans_id DESC\n  LIMIT 1\n), EndBalance AS (\n  SELECT\n    T2.balance\n  FROM trans AS T2\n  JOIN TargetAccount AS TA\n    ON T2.account_id = TA.account_id\n  WHERE\n    T2.date <= '1998-12-27'\n  ORDER BY\n    T2.date DESC,\n    T2.trans_id DESC\n  LIMIT 1\n)\nSELECT\n  CAST((EB.balance - SB.balance) AS REAL) * 100 / SB.balance\nFROM StartBalance AS SB, EndBalance AS EB;",
        "pred_time": null,
        "orig_time": 0.6859772205352783,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the percentage of loan amount that has been fully paid with no issue.",
        "original_query": "SELECT (CAST(SUM(CASE WHEN status = 'A' THEN amount ELSE 0 END) AS REAL) * 100) / SUM(amount) FROM loan",
        "llm_output": "-- Reasoning\nTo find the percentage of fully paid loans with no issue, we first need to identify the loans that meet this criteria. The `loan` table contains a `status` column, where 'A' typically indicates a \"contract finished, no problems\" loan. We will sum the `amount` for these loans and divide it by the total `amount` of all loans, then multiply by 100 to get the percentage.\n\n-- SQL Query\nSELECT\n  CAST(SUM(CASE WHEN status = 'A' THEN amount ELSE 0 END) AS REAL) * 100 / SUM(amount)\nFROM loan;",
        "pred_query": "SELECT\n  CAST(SUM(CASE WHEN status = 'A' THEN amount ELSE 0 END) AS REAL) * 100 / SUM(amount)\nFROM loan;",
        "pred_time": 0.0012309551239013672,
        "orig_time": 0.0006723403930664062,
        "time_ratio": 0.5461940732132481,
        "check": true
    },
    {
        "id": "financial",
        "question": "For loan amount less than USD100,000, what is the percentage of accounts that is still running with no issue.",
        "original_query": "SELECT CAST(SUM(status = 'C') AS REAL) * 100 / COUNT(amount) FROM loan WHERE amount < 100000",
        "llm_output": "-- Reasoning\nI need to calculate the percentage of accounts where all their loans, specifically those with an amount less than 100,000, are \"running with no issue\".\n1. First, identify all distinct accounts that have at least one loan with an `amount` less than 100,000. This set of accounts will form the denominator for our percentage calculation.\n2. From this set, identify accounts where *all* of their loans (with `amount` less than 100,000) have a `status` of 'C' (which represents \"running, no problem\"). This set of accounts will form the numerator.\n3. The query uses a subquery to group loans by `account_id` and filter for `amount < 100000`. It counts the total number of such loans for each account (`total_loans_under_100k`) and the number of these loans with `status = 'C'` (`good_loans_under_100k`).\n4. The outer query then calculates the percentage: `(count of accounts where total_loans_under_100k = good_loans_under_100k) / (total count of accounts in the subquery result) * 100`.\n\n-- SQL Query\nite\nSELECT\n  CAST(SUM(CASE\n    WHEN T1.good_loans_under_100k = T1.total_loans_under_100k THEN 1\n    ELSE 0\n  END) AS REAL) * 100 / COUNT(T1.account_id)\nFROM (\n  SELECT\n    account_id,\n    COUNT(*) AS total_loans_under_100k,\n    SUM(CASE WHEN status = 'C' THEN 1 ELSE 0 END) AS good_loans_under_100k\n  FROM loan\n  WHERE amount < 100000\n  GROUP BY account_id\n) AS T1;\n",
        "pred_query": "SELECT\n  CAST(SUM(CASE\n    WHEN T1.good_loans_under_100k = T1.total_loans_under_100k THEN 1\n    ELSE 0\n  END) AS REAL) * 100 / COUNT(T1.account_id)\nFROM (\n  SELECT\n    account_id,\n    COUNT(*) AS total_loans_under_100k,\n    SUM(CASE WHEN status = 'C' THEN 1 ELSE 0 END) AS good_loans_under_100k\n  FROM loan\n  WHERE amount < 100000\n  GROUP BY account_id\n) AS T1;",
        "pred_time": 0.0011572837829589844,
        "orig_time": 0.0006895065307617188,
        "time_ratio": 0.595797280593325,
        "check": true
    },
    {
        "id": "financial",
        "question": "For accounts in 1993 with statement issued after transaction, list the account ID, district name and district region.",
        "original_query": "SELECT T1.account_id, T2.A2, T2.A3 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.frequency = 'POPLATEK PO OBRATU' AND STRFTIME('%Y', T1.date)= '1993'",
        "llm_output": "-- Reasoning\nI need to join the `account` table with the `district` table to get district details and with the `trans` table to compare dates. I will filter accounts opened in 1993 and where the account's date is after a transaction date. Finally, I will select the account ID, district name (A2), and district region (A3), ensuring distinct results.\n\n-- SQL Query\nSELECT DISTINCT\n  T1.account_id,\n  T2.A2,\n  T2.A3\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3\n  ON T1.account_id = T3.account_id\nWHERE\n  STRFTIME('%Y', T1.date) = '1993' AND T1.date > T3.date;",
        "pred_query": "SELECT DISTINCT\n  T1.account_id,\n  T2.A2,\n  T2.A3\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3\n  ON T1.account_id = T3.account_id\nWHERE\n  STRFTIME('%Y', T1.date) = '1993' AND T1.date > T3.date;",
        "pred_time": 0.3480556011199951,
        "orig_time": 0.0009851455688476562,
        "time_ratio": 0.00283042584482937,
        "check": false
    },
    {
        "id": "financial",
        "question": "From Year 1995 to 2000, who are the accounts holders from 'east Bohemia'. State the account ID the frequency of statement issuance.",
        "original_query": "SELECT T1.account_id, T1.frequency FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A3 = 'east Bohemia' AND STRFTIME('%Y', T1.date) BETWEEN '1995' AND '2000'",
        "llm_output": "-- Reasoning\nI need to retrieve `account_id` and `frequency` from the `account` table.\nI will join `account` with the `district` table on `district_id` to filter by district name.\nI will filter the results for `district.A3` being 'east Bohemia' and `account.date` between '1995-01-01' and '2000-12-31'.\n\n-- SQL Query\nSELECT\n  T1.account_id,\n  T1.frequency\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A3 = 'east Bohemia' AND STRFTIME('%Y', T1.date) BETWEEN '1995' AND '2000';",
        "pred_query": "SELECT\n  T1.account_id,\n  T1.frequency\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A3 = 'east Bohemia' AND STRFTIME('%Y', T1.date) BETWEEN '1995' AND '2000';",
        "pred_time": 0.002855539321899414,
        "orig_time": 0.002666473388671875,
        "time_ratio": 0.9337897637137847,
        "check": true
    },
    {
        "id": "financial",
        "question": "List account ID and account opening date for accounts from 'Prachatice'.",
        "original_query": "SELECT T1.account_id, T1.date FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A2 = 'Prachatice'",
        "llm_output": "-- Reasoning\nTo find accounts from 'Prachatice', I need to join the `account` table with the `district` table using `district_id`. Then, I will filter the results where the `A2` column (which represents the district name) in the `district` table is 'Prachatice'. Finally, I will select the `account_id` and `date` from the `account` table.\n\n-- SQL Query\nSELECT\n  T1.account_id,\n  T1.date\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A2 = 'Prachatice';",
        "pred_query": "SELECT\n  T1.account_id,\n  T1.date\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A2 = 'Prachatice';",
        "pred_time": 0.0015227794647216797,
        "orig_time": 0.0012362003326416016,
        "time_ratio": 0.8118052293721622,
        "check": true
    },
    {
        "id": "financial",
        "question": "State the district and region for loan ID '4990'.",
        "original_query": "SELECT T2.A2, T2.A3 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T3.loan_id = 4990",
        "llm_output": "-- Reasoning\nI need to join `loan` with `account` on `account_id` to get the `district_id`, and then join with `district` on `district_id` to retrieve the district name (A3) and region name (A2) for the specified `loan_id`.\n\n-- SQL Query\nSELECT T3.A3, T3.A2 FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.loan_id = 4990;",
        "pred_query": "SELECT T3.A3, T3.A2 FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.loan_id = 4990;",
        "pred_time": 0.0007803440093994141,
        "orig_time": 0.0004680156707763672,
        "time_ratio": 0.5997555759242286,
        "check": false
    },
    {
        "id": "financial",
        "question": "Provide the account ID, district and region for loan amount greater than USD300,000.",
        "original_query": "SELECT T1.account_id, T2.A2, T2.A3 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T3.amount > 300000",
        "llm_output": "-- Reasoning\nI need to retrieve account IDs, district names (A2), and region names (A3) for loans exceeding 300,000. I will join the `loan` table with the `account` table on `account_id`, and then join with the `district` table on `district_id` to get the district and region information. Finally, I'll filter the results based on the loan amount.\n\n-- SQL Query\nSELECT\n  T1.account_id,\n  T3.A2,\n  T3.A3\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.amount > 300000;",
        "pred_query": "SELECT\n  T1.account_id,\n  T3.A2,\n  T3.A3\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.amount > 300000;",
        "pred_time": 0.0009832382202148438,
        "orig_time": 0.0008096694946289062,
        "time_ratio": 0.8234723569350145,
        "check": true
    },
    {
        "id": "financial",
        "question": "List the loan ID, district and average salary for loan with duration of 60 months.",
        "original_query": "SELECT T3.loan_id, T2.A2, T2.A11 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T3.duration = 60",
        "llm_output": "-- Reasoning\nI need to retrieve `loan_id` from the `loan` table, and district name (A2) and average salary (A10) from the `district` table.\nTo link `loan` to `district`, I will join `loan` with `account` on `account_id`, and then `account` with `district` on `district_id`.\nFinally, I will filter the results to include only loans with a `duration` of 60 months.\n\n-- SQL Query\nSELECT\n  T1.loan_id,\n  T3.A2,\n  T3.A10\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.duration = 60;",
        "pred_query": "SELECT\n  T1.loan_id,\n  T3.A2,\n  T3.A10\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.duration = 60;",
        "pred_time": 0.0013303756713867188,
        "orig_time": 0.0008318424224853516,
        "time_ratio": 0.625268817204301,
        "check": false
    },
    {
        "id": "financial",
        "question": "For loans contracts which are still running where client are in debt, list the district of the and the state the percentage unemployment rate increment from year 1995 to 1996.",
        "original_query": "SELECT CAST((T3.A13 - T3.A12) AS REAL) * 100 / T3.A12 FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.status = 'D'",
        "llm_output": "-- Reasoning\nI need to identify loans that are currently running and where the client is in debt, which corresponds to a `status` of 'D' in the `loan` table. For these loans, I will retrieve the associated district's name (`A2`) and calculate the unemployment rate increment by subtracting the 1995 rate (`A12`) from the 1996 rate (`A13`) from the `district` table. I'll join `loan` to `account` and then to `district` to link the information.\n\n-- SQL Query\nSELECT\n  T3.A2,\n  T3.A13 - T3.A12\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.status = 'D';",
        "pred_query": "SELECT\n  T3.A2,\n  T3.A13 - T3.A12\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.status = 'D';",
        "pred_time": 0.0009665489196777344,
        "orig_time": null,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Calculate the percentage of account from 'Decin' district for all accounts are opened in 1993.",
        "original_query": "SELECT CAST(SUM(T1.A2 = 'Decin') AS REAL) * 100 / COUNT(account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T2.date) = '1993'",
        "llm_output": "-- Reasoning\nI need to count accounts from the 'Decin' district opened in 1993 and divide by the total count of accounts opened in 1993. I'll join `account` with `district` to filter by `district.A2` for 'Decin' and `account.date` for the year 1993. The ratio will then be multiplied by 100.0 for the percentage.\n\n-- SQL Query\nSELECT\n  CAST(SUM(CASE WHEN T2.A2 = 'Decin' THEN 1 ELSE 0 END) AS REAL) * 100.0 / COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  STRFTIME('%Y', T1.date) = '1993';",
        "pred_query": "SELECT\n  CAST(SUM(CASE WHEN T2.A2 = 'Decin' THEN 1 ELSE 0 END) AS REAL) * 100.0 / COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  STRFTIME('%Y', T1.date) = '1993';",
        "pred_time": 0.0023775100708007812,
        "orig_time": 0.002734661102294922,
        "time_ratio": 1.150220617729643,
        "check": true
    },
    {
        "id": "financial",
        "question": "List the account IDs with monthly issuance of statements.",
        "original_query": "SELECT account_id FROM account WHERE Frequency = 'POPLATEK MESICNE'",
        "llm_output": "-- Reasoning\nTo find accounts with monthly statement issuance, I need to look at the `account` table.\nThe `frequency` column in the `account` table stores this information.\nI will select the `account_id` from the `account` table where the `frequency` is 'monthly issuance'.\n\n-- SQL Query\nSELECT account_id FROM account WHERE frequency = 'monthly issuance';",
        "pred_query": "SELECT account_id FROM account WHERE frequency = 'monthly issuance';",
        "pred_time": 0.0011222362518310547,
        "orig_time": 0.0023250579833984375,
        "time_ratio": 2.071807945612917,
        "check": false
    },
    {
        "id": "financial",
        "question": "List the top ten districts, by descending order, from the highest to the lowest, the number of female account holders.",
        "original_query": "SELECT T2.A2, COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' GROUP BY T2.district_id, T2.A2 ORDER BY COUNT(T1.client_id) DESC LIMIT 10",
        "llm_output": "-- Reasoning\nI need to count the number of female account holders for each district.\n1. Filter the `client` table to include only female clients (`gender = 'F'`).\n2. Join `client` with `disp` on `client_id` to link clients to their accounts, ensuring only actual account holders are considered.\n3. Join the result with `account` on `account_id` to get the `district_id` associated with each account.\n4. Group the results by `account.district_id` and count the distinct `client_id`s to get the number of unique female account holders per district.\n5. Order the districts by this count in descending order and limit the output to the top 10.\n\n-- SQL Query\nSELECT\n  T3.district_id,\n  COUNT(DISTINCT T1.client_id) AS num_female_account_holders\nFROM client AS T1\nJOIN disp AS T2\n  ON T1.client_id = T2.client_id\nJOIN account AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.gender = 'F'\nGROUP BY\n  T3.district_id\nORDER BY\n  num_female_account_holders DESC\nLIMIT 10;",
        "pred_query": "SELECT\n  T3.district_id,\n  COUNT(DISTINCT T1.client_id) AS num_female_account_holders\nFROM client AS T1\nJOIN disp AS T2\n  ON T1.client_id = T2.client_id\nJOIN account AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.gender = 'F'\nGROUP BY\n  T3.district_id\nORDER BY\n  num_female_account_holders DESC\nLIMIT 10;",
        "pred_time": 0.0025527477264404297,
        "orig_time": 0.0020248889923095703,
        "time_ratio": 0.7932193891846455,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which are the top ten withdrawals (non-credit card) by district names for the month of January 1996?",
        "original_query": "SELECT T1.district_id FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T3.type = 'VYDAJ' AND T2.date LIKE '1996-01%' ORDER BY A2 ASC LIMIT 10",
        "llm_output": "-- Reasoning\nThe query first filters `trans` for withdrawals made in January 1996. It then joins `trans` with `account` and `district` to retrieve the district names. The total withdrawal amount is summed for each district, ordered in descending order, and limited to the top ten results.\n\n-- SQL Query\nite\nSELECT\n  T3.A2,\n  SUM(T1.amount) AS total_withdrawal_amount\nFROM trans AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.type = 'withdrawal' AND STRFTIME('%Y-%m', T1.date) = '1996-01'\nGROUP BY\n  T3.A2\nORDER BY\n  total_withdrawal_amount DESC\nLIMIT 10;\n",
        "pred_query": "SELECT\n  T3.A2,\n  SUM(T1.amount) AS total_withdrawal_amount\nFROM trans AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.type = 'withdrawal' AND STRFTIME('%Y-%m', T1.date) = '1996-01'\nGROUP BY\n  T3.A2\nORDER BY\n  total_withdrawal_amount DESC\nLIMIT 10;",
        "pred_time": 0.08515524864196777,
        "orig_time": 0.12656331062316895,
        "time_ratio": 1.4862655284502768,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many of the account holders in South Bohemia still do not own credit cards?",
        "original_query": "SELECT COUNT(T3.account_id) FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T2.client_id = T3.client_id WHERE T1.A3 = 'south Bohemia' AND T3.type != 'OWNER'",
        "llm_output": "-- Reasoning\n1. Identify the `district_id` for 'South Bohemia' from the `district` table, assuming `A3` contains district names.\n2. Select distinct `client_id`s for account holders (clients linked to accounts) in the 'South Bohemia' district by joining `client`, `disp`, `account`, and `district`.\n3. Create a subquery to find distinct `client_id`s of all clients who own a credit card by joining `disp` and `card`.\n4. Filter the clients from step 2 to exclude those whose `client_id` is present in the set of `client_id`s from step 3 (i.e., those who own a credit card).\n5. Count the remaining distinct `client_id`s.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  T4.A3 = 'south bohemia' AND T1.client_id NOT IN (\n    SELECT DISTINCT\n      T5.client_id\n    FROM disp AS T5\n    INNER JOIN card AS T6\n      ON T5.disp_id = T6.disp_id\n  );",
        "pred_query": "SELECT\n  COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  T4.A3 = 'south bohemia' AND T1.client_id NOT IN (\n    SELECT DISTINCT\n      T5.client_id\n    FROM disp AS T5\n    INNER JOIN card AS T6\n      ON T5.disp_id = T6.disp_id\n  );",
        "pred_time": 0.0038073062896728516,
        "orig_time": 0.0012161731719970703,
        "time_ratio": 0.31943139833427264,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which district has highest active loan?",
        "original_query": "SELECT T2.A3 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T3.status IN ('C', 'D') GROUP BY T2.A3 ORDER BY SUM(T3.amount) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to count active loans per district. I'll join the `loan` table with the `account` table to link loans to districts. I will filter for loans with status 'A' (assuming 'A' denotes active). Then, I'll group by district and count the active loans, finally ordering by the count in descending order and taking the top result.\n\n-- SQL Query\nSELECT\n  T2.A2\nFROM loan AS T1\nINNER JOIN account AS T3\n  ON T1.account_id = T3.account_id\nINNER JOIN district AS T2\n  ON T3.district_id = T2.district_id\nWHERE\n  T1.status = 'A'\nGROUP BY\n  T2.A2\nORDER BY\n  COUNT(T1.loan_id) DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  T2.A2\nFROM loan AS T1\nINNER JOIN account AS T3\n  ON T1.account_id = T3.account_id\nINNER JOIN district AS T2\n  ON T3.district_id = T2.district_id\nWHERE\n  T1.status = 'A'\nGROUP BY\n  T2.A2\nORDER BY\n  COUNT(T1.loan_id) DESC\nLIMIT 1;",
        "pred_time": 0.0012042522430419922,
        "orig_time": 0.0010733604431152344,
        "time_ratio": 0.8913086517521283,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the average loan amount by male borrowers?",
        "original_query": "SELECT AVG(T3.amount) FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id WHERE T1.gender = 'M'",
        "llm_output": "-- Reasoning\nTo find the average loan amount for male borrowers, I need to join the `loan` table with the `disp` table to link loans to specific clients, and then join with the `client` table to filter for male clients. Finally, I will calculate the average of the `amount` column from the `loan` table.\n\n-- SQL Query\nite\nSELECT\n  AVG(T1.amount)\nFROM loan AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN client AS T3\n  ON T2.client_id = T3.client_id\nWHERE\n  T3.gender = 'M';\n",
        "pred_query": "SELECT\n  AVG(T1.amount)\nFROM loan AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN client AS T3\n  ON T2.client_id = T3.client_id\nWHERE\n  T3.gender = 'M';",
        "pred_time": 0.0023238658905029297,
        "orig_time": 0.005182743072509766,
        "time_ratio": 2.2302246845183133,
        "check": false
    },
    {
        "id": "financial",
        "question": "In 1996, which districts have the highest unemployment rate? List their branch location and district name.",
        "original_query": "SELECT district_id, A2 FROM district ORDER BY A13 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nThe question asks for the district with the highest unemployment rate in 1996, including its branch location and district name.\nBased on common interpretations of this dataset schema, `district.A12` represents the unemployment rate in 1996, `district.A2` is the district name, and `district.A3` is the region or branch location.\nTo find the district with the highest rate, I will select these columns, order by `A12` in descending order, and limit the result to 1.\n\n-- SQL Query\nSELECT\n  A3,\n  A2\nFROM district\nORDER BY\n  A12 DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  A3,\n  A2\nFROM district\nORDER BY\n  A12 DESC\nLIMIT 1;",
        "pred_time": 0.0009853839874267578,
        "orig_time": 0.0005211830139160156,
        "time_ratio": 0.5289136220662957,
        "check": false
    },
    {
        "id": "financial",
        "question": "In the branch where the largest number of crimes were committed in 1996, how many accounts were opened?",
        "original_query": "SELECT COUNT(T2.account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id GROUP BY T1.A16 ORDER BY T1.A16 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nFirst, identify the `district_id` that had the largest number of crimes in 1996 by finding the maximum value in the `A14` column of the `district` table.\nThen, count the number of accounts from the `account` table that belong to this specific `district_id`.\n\n-- SQL Query\nSELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.district_id = (\n    SELECT\n      district_id\n    FROM district\n    ORDER BY\n      A14 DESC\n    LIMIT 1\n  );",
        "pred_query": "SELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.district_id = (\n    SELECT\n      district_id\n    FROM district\n    ORDER BY\n      A14 DESC\n    LIMIT 1\n  );",
        "pred_time": 0.0011942386627197266,
        "orig_time": 0.001988649368286133,
        "time_ratio": 1.6652026352565383,
        "check": true
    },
    {
        "id": "financial",
        "question": "After making a credit card withdrawal, how many account/s with monthly issuance has a negative balance?",
        "original_query": "SELECT COUNT(T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.balance < 0 AND T1.operation = 'VYBER KARTOU' AND T2.frequency = 'POPLATEK MESICNE'",
        "llm_output": "-- Reasoning\nI need to find accounts that have a 'monthly issuance' frequency and at least one transaction that is a 'credit card withdrawal' resulting in a negative balance. I will join the `account` and `trans` tables, filter by frequency, operation type, and negative balance, and then count the distinct account IDs.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN trans AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.frequency = 'monthly issuance' AND T2.operation = 'credit card withdrawal' AND T2.balance < 0;",
        "pred_query": "SELECT\n  COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN trans AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.frequency = 'monthly issuance' AND T2.operation = 'credit card withdrawal' AND T2.balance < 0;",
        "pred_time": 0.09058785438537598,
        "orig_time": 0.08279848098754883,
        "time_ratio": 0.9140130489823741,
        "check": false
    },
    {
        "id": "financial",
        "question": "Between 1/1/1995 and 12/31/1997, how many loans in the amount of at least 250,000 per account that chose monthly statement issuance were approved?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T2.date BETWEEN '1995-01-01' AND '1997-12-31' AND T1.frequency = 'POPLATEK MESICNE' AND T2.amount > 250000",
        "llm_output": "-- Reasoning\nThe query needs to count loans that meet several criteria. First, it joins the `loan` and `account` tables on `account_id` to access both loan details and account frequency. It then filters loans by date (`loan.date` between '1995-01-01' and '1997-12-31'), amount (`loan.amount` >= 250000), approval status (`loan.status` = 'A', assuming 'A' represents an approved loan), and account frequency (`account.frequency` = 'MONTHLY', assuming 'MONTHLY' signifies monthly statement issuance). Finally, it counts the distinct `loan_id`s that satisfy all these conditions.\n\n-- SQL Query\nSELECT\n  COUNT(T1.loan_id)\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.date BETWEEN '1995-01-01' AND '1997-12-31' AND T1.amount >= 250000 AND T1.status = 'A' AND T2.frequency = 'MONTHLY';",
        "pred_query": "SELECT\n  COUNT(T1.loan_id)\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.date BETWEEN '1995-01-01' AND '1997-12-31' AND T1.amount >= 250000 AND T1.status = 'A' AND T2.frequency = 'MONTHLY';",
        "pred_time": 0.0013210773468017578,
        "orig_time": 0.0008559226989746094,
        "time_ratio": 0.6478974914275402,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts have running contracts in Branch location 1?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T1.district_id = 1 AND (T3.status = 'C' OR T3.status = 'D')",
        "llm_output": "-- Reasoning\nI need to find accounts with a 'running contract' (which I interpret as `loan.status` = 'A') and are associated with 'Branch location 1' (which I interpret as `district.A2` = '1'). I will join `loan` with `account` on `account_id`, and then `account` with `district` on `district_id`. Finally, I'll filter by loan status and district A2, and count distinct `account_id`s.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T1.district_id = T3.district_id\nWHERE\n  T2.status = 'A' AND T3.A2 = '1';",
        "pred_query": "SELECT\n  COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T1.district_id = T3.district_id\nWHERE\n  T2.status = 'A' AND T3.A2 = '1';",
        "pred_time": 0.0010347366333007812,
        "orig_time": 0.0007631778717041016,
        "time_ratio": 0.7375576036866359,
        "check": false
    },
    {
        "id": "financial",
        "question": "In the branch where the second-highest number of crimes were committed in 1995 occurred, how many male clients are there?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'M' AND T2.A15 = (SELECT T3.A15 FROM district AS T3 ORDER BY T3.A15 DESC LIMIT 1, 1)",
        "llm_output": "-- Reasoning\n1. Identify the district with the second-highest number of crimes committed in 1995 by ordering the `district` table by `A9` (crimes in 1995) in descending order and using `LIMIT 1 OFFSET 1`.\n2. Filter the `client` table for clients whose gender is 'M' (male).\n3. Join the filtered clients with the district identified in step 1 using `district_id`.\n4. Count the number of such male clients.\n\n-- SQL Query\nSELECT COUNT(T1.client_id)\nFROM client AS T1\nWHERE T1.gender = 'M' AND T1.district_id = (\n  SELECT district_id\n  FROM district\n  ORDER BY A9 DESC\n  LIMIT 1 OFFSET 1\n);",
        "pred_query": "SELECT COUNT(T1.client_id)\nFROM client AS T1\nWHERE T1.gender = 'M' AND T1.district_id = (\n  SELECT district_id\n  FROM district\n  ORDER BY A9 DESC\n  LIMIT 1 OFFSET 1\n);",
        "pred_time": 0.0013537406921386719,
        "orig_time": 0.0014545917510986328,
        "time_ratio": 1.074498062698133,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many high-level credit cards have \"disponent\" type of disposition?",
        "original_query": "SELECT COUNT(T1.card_id) FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id WHERE T1.type = 'gold' AND T2.type = 'DISPONENT'",
        "llm_output": "-- Reasoning\nTo find the number of high-level credit cards with a 'disponent' disposition, I will join the `card` table with the `disp` table on `disp_id`.\nThen, I will filter the results where `card.type` is 'credit card' and `disp.type` is 'disponent'.\nFinally, I will count the number of resulting rows.\n\n-- SQL Query\nSELECT\n  COUNT(T1.card_id)\nFROM card AS T1\nINNER JOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nWHERE\n  T1.type = 'credit card' AND T2.type = 'disponent';",
        "pred_query": "SELECT\n  COUNT(T1.card_id)\nFROM card AS T1\nINNER JOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nWHERE\n  T1.type = 'credit card' AND T2.type = 'disponent';",
        "pred_time": 0.0008256435394287109,
        "orig_time": 0.0006887912750244141,
        "time_ratio": 0.8342477620560208,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many accounts are there in the district of \"Pisek\"?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A2 = 'Pisek'",
        "llm_output": "-- Reasoning\nI need to count accounts linked to a specific district.\nI will join the `account` table with the `district` table on `district_id`.\nThen, I'll filter the results where the `A2` column of the `district` table (representing the district name) is 'Pisek'.\nFinally, I will count the number of distinct `account_id`s or simply the rows that satisfy the condition.\n\n-- SQL Query\nSELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A2 = 'Pisek';",
        "pred_query": "SELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A2 = 'Pisek';",
        "pred_time": 0.0015721321105957031,
        "orig_time": 0.0017783641815185547,
        "time_ratio": 1.1311798604792236,
        "check": true
    },
    {
        "id": "financial",
        "question": "Which districts have transactions greater than USS$10,000 in 1997?",
        "original_query": "SELECT T1.district_id FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T1.account_id = T3.account_id WHERE STRFTIME('%Y', T3.date) = '1997' GROUP BY T1.district_id HAVING SUM(T3.amount) > 10000",
        "llm_output": "-- Reasoning\nI need to find districts based on transaction details. I will join `district` with `account` on `district_id`, and then `account` with `trans` on `account_id`. I'll filter transactions for `amount` greater than 10000 and the `date` falling within the year 1997, and finally select the distinct district names.\n\n-- SQL Query\nSELECT DISTINCT T1.A2\nFROM district AS T1\nINNER JOIN account AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T3.amount > 10000 AND STRFTIME('%Y', T3.date) = '1997';",
        "pred_query": "SELECT DISTINCT T1.A2\nFROM district AS T1\nINNER JOIN account AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T3.amount > 10000 AND STRFTIME('%Y', T3.date) = '1997';",
        "pred_time": 0.13272333145141602,
        "orig_time": 0.3692190647125244,
        "time_ratio": 2.7818700802253353,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which accounts placed orders for household payment in Pisek?",
        "original_query": "SELECT DISTINCT T2.account_id FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.k_symbol = 'SIPO' AND T3.A2 = 'Pisek'",
        "llm_output": "-- Reasoning\nI need to find accounts (`account_id`) that placed orders for a specific `k_symbol` ('household') and whose associated district's city (`A3`) is 'Pisek'.\nI will join `account` with `district` on `district_id` to filter by city.\nThen, I will join `account` with `order` on `account_id` to filter by `k_symbol`.\nFinally, I will select the distinct `account_id`s that satisfy both conditions.\n\n-- SQL Query\nSELECT DISTINCT T1.account_id\nFROM account AS T1\nINNER JOIN `order` AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T1.district_id = T3.district_id\nWHERE\n  T2.k_symbol = 'household' AND T3.A3 = 'Pisek';",
        "pred_query": "SELECT DISTINCT T1.account_id\nFROM account AS T1\nINNER JOIN `order` AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T1.district_id = T3.district_id\nWHERE\n  T2.k_symbol = 'household' AND T3.A3 = 'Pisek';",
        "pred_time": 0.013253450393676758,
        "orig_time": 0.10390305519104004,
        "time_ratio": 7.839698501502096,
        "check": false
    },
    {
        "id": "financial",
        "question": "What are the accounts that have both gold and junior credit cards?",
        "original_query": "SELECT T2.account_id FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id WHERE T1.type IN ('gold', 'junior')",
        "llm_output": "-- Reasoning\nThe query needs to identify `account_id`s that are linked to both 'gold' and 'junior' credit cards.\nThis involves joining `account` with `disp` and then `disp` with `card` to access card types.\nWe filter for records where `card.type` is either 'gold' or 'junior'.\nThen, we group by `account_id` and use the `HAVING` clause to ensure that an account has at least two distinct card types among 'gold' and 'junior', effectively confirming both are present.\n\n-- SQL Query\nSELECT\n  T1.account_id\nFROM account AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nWHERE\n  T3.type IN ('gold', 'junior')\nGROUP BY\n  T1.account_id\nHAVING\n  COUNT(DISTINCT T3.type) = 2;",
        "pred_query": "SELECT\n  T1.account_id\nFROM account AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nWHERE\n  T3.type IN ('gold', 'junior')\nGROUP BY\n  T1.account_id\nHAVING\n  COUNT(DISTINCT T3.type) = 2;",
        "pred_time": 0.0012888908386230469,
        "orig_time": 0.0007290840148925781,
        "time_ratio": 0.5656677765445801,
        "check": false
    },
    {
        "id": "financial",
        "question": "How much is the average amount in credit card made by account holders in a month, in year 2021?",
        "original_query": "SELECT AVG(T3.amount) FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE STRFTIME('%Y', T3.date) = '2021' AND T3.operation = 'VYBER KARTOU'",
        "llm_output": "-- Reasoning\nThe question asks for the average amount \"in credit card\" by month for the year 2021.\nI will use the `trans` table, which contains transaction details including `amount`, `date`, and `type`.\nThe most direct interpretation of \"credit card\" in the context of `trans.type` is to filter for `type = 'credit'`. This implies transactions where an amount is credited to an account, which could include credit card advances or similar credit line utilizations.\nI will filter these transactions for the year 2021 and then group them by month to calculate the average amount.\n\n-- SQL Query\nite\nSELECT\n  STRFTIME('%m', date) AS month,\n  AVG(amount) AS average_credit_card_amount\nFROM trans\nWHERE\n  STRFTIME('%Y', date) = '2021' AND type = 'credit'\nGROUP BY\n  STRFTIME('%m', date);\n",
        "pred_query": "SELECT\n  STRFTIME('%m', date) AS month,\n  AVG(amount) AS average_credit_card_amount\nFROM trans\nWHERE\n  STRFTIME('%Y', date) = '2021' AND type = 'credit'\nGROUP BY\n  STRFTIME('%m', date);",
        "pred_time": 0.2857625484466553,
        "orig_time": 0.2882823944091797,
        "time_ratio": 1.0088179713409673,
        "check": false
    },
    {
        "id": "financial",
        "question": "Who are the account holder identification numbers whose spent per month on the credit card is less than the average, in 1998?",
        "original_query": "SELECT T1.account_id FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE STRFTIME('%Y', T1.date) = '1998' AND T1.operation = 'VYBER KARTOU' AND T1.amount < (SELECT AVG(amount) FROM trans WHERE STRFTIME('%Y', date) = '1998')",
        "llm_output": "-- Reasoning\n1. Identify credit card spending: \"spent per month on the credit card\" is interpreted as transactions with `operation = 'VYBER KARTA'` in the `trans` table.\n2. Filter for 1998: Use `strftime('%Y', date) = '1998'` on the `trans.date` column.\n3. Calculate monthly spending per account: Group these filtered transactions by `account_id` and `strftime('%Y-%m', date)` and sum the `amount`. This forms a CTE called `AccountMonthlySpent`.\n4. Calculate the overall average monthly spending: Compute the `AVG(monthly_spent)` from the `AccountMonthlySpent` CTE.\n5. Identify relevant account holders: Join `AccountMonthlySpent` with the `disp` table (filtered for `disp.type = 'OWNER'`) and select `client_id` for those where `monthly_spent` is less than the overall average calculated in step 4. Use `DISTINCT` for client IDs.\n\n-- SQL Query\nite\nWITH AccountMonthlySpent AS (\n    SELECT\n        account_id,\n        strftime('%Y-%m', date) AS month,\n        SUM(amount) AS monthly_spent\n    FROM trans\n    WHERE operation = 'VYBER KARTA'\n      AND strftime('%Y', date) = '1998'\n    GROUP BY account_id, month\n)\nSELECT DISTINCT D.client_id\nFROM AccountMonthlySpent AS AMS\nJOIN disp AS D\n  ON AMS.account_id = D.account_id\nWHERE D.type = 'OWNER'\n  AND AMS.monthly_spent < (SELECT AVG(monthly_spent) FROM AccountMonthlySpent);\n",
        "pred_query": "SELECT\n        account_id,\n        strftime('%Y-%m', date) AS month,\n        SUM(amount) AS monthly_spent\n    FROM trans\n    WHERE operation = 'VYBER KARTA'\n      AND strftime('%Y', date) = '1998'\n    GROUP BY account_id, month\n)\nSELECT DISTINCT D.client_id\nFROM AccountMonthlySpent AS AMS\nJOIN disp AS D\n  ON AMS.account_id = D.account_id\nWHERE D.type = 'OWNER'\n  AND AMS.monthly_spent < (SELECT AVG(monthly_spent) FROM AccountMonthlySpent);",
        "pred_time": null,
        "orig_time": 0.6185653209686279,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Who are the female account holders who own credit cards and also have loans?",
        "original_query": "SELECT T1.client_id FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id INNER JOIN card AS T4 ON T2.disp_id = T4.disp_id WHERE T1.gender = 'F'",
        "llm_output": "-- Reasoning\nThe query identifies female clients from the `client` table. It then joins with the `disp` table to link clients to their accounts and dispositions. A subsequent join with `card` ensures the client has a credit card (via `disp_id`), and another join with `loan` ensures their account has an associated loan (via `account_id`). Finally, `DISTINCT client_id` is used to list unique female account holders satisfying all conditions.\n\n-- SQL Query\nSELECT DISTINCT T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nINNER JOIN loan AS T4\n  ON T2.account_id = T4.account_id\nWHERE\n  T1.gender = 'F';",
        "pred_query": "SELECT DISTINCT T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nINNER JOIN loan AS T4\n  ON T2.account_id = T4.account_id\nWHERE\n  T1.gender = 'F';",
        "pred_time": 0.0015757083892822266,
        "orig_time": 0.0013456344604492188,
        "time_ratio": 0.8539869874413678,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many female clients' accounts are in the region of South Bohemia?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' AND T2.A3 = 'south Bohemia'",
        "llm_output": "-- Reasoning\nI need to count accounts belonging to female clients in the 'south Bohemia' region.\nI will join `client` (filtered by gender), `disp` (to link clients to accounts), `account`, and `district` (filtered by region).\nFinally, I will count the distinct `account_id`s that satisfy both conditions.\n\n-- SQL Query\nite\nSELECT\n  COUNT(DISTINCT T3.account_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  T1.gender = 'F' AND T4.A3 = 'south Bohemia';\n",
        "pred_query": "SELECT\n  COUNT(DISTINCT T3.account_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  T1.gender = 'F' AND T4.A3 = 'south Bohemia';",
        "pred_time": 0.0023283958435058594,
        "orig_time": 0.001256704330444336,
        "time_ratio": 0.5397296743805038,
        "check": true
    },
    {
        "id": "financial",
        "question": "Please list the accounts whose district is Tabor that are eligible for loans.",
        "original_query": "SELECT T2.account_id FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T2.account_id = T3.account_id WHERE T3.type = 'OWNER' AND T1.A2 = 'Tabor'",
        "llm_output": "-- Reasoning\nI need to find accounts associated with the district 'Tabor' that also have a loan with an \"eligible\" status.\nI will join `account` with `district` on `district_id` to filter by district name 'Tabor'.\nThen, I will join the result with the `loan` table on `account_id` and filter for loan statuses 'A' or 'B', which typically signify a granted or eligible loan.\nFinally, I will select distinct `account_id`s.\n\n-- SQL Query\nSELECT DISTINCT T1.account_id\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3\n  ON T1.account_id = T3.account_id\nWHERE\n  T2.A2 = 'Tabor' AND T3.status IN ('A', 'B');",
        "pred_query": "SELECT DISTINCT T1.account_id\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3\n  ON T1.account_id = T3.account_id\nWHERE\n  T2.A2 = 'Tabor' AND T3.status IN ('A', 'B');",
        "pred_time": 0.0011036396026611328,
        "orig_time": 0.0017254352569580078,
        "time_ratio": 1.563404623028732,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please list the account types that are not eligible for loans, and the average income of residents in the district where the account is located exceeds $8000 but is no more than $9000.",
        "original_query": "SELECT T3.type FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T2.account_id = T3.account_id WHERE T3.type != 'OWNER' AND T1.A11 BETWEEN 8000 AND 9000",
        "llm_output": "-- Reasoning\nTo find account types not eligible for loans, we need to select `frequency` from the `account` table. We filter these accounts by ensuring their `account_id` does not exist in the `loan` table. Additionally, we join with the `district` table to apply the condition on `A10` (average income) being greater than 8000 and less than or equal to 9000. Finally, we select distinct `frequency` values.\n\n-- SQL Query\nSELECT DISTINCT T1.frequency\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T1.account_id NOT IN (\n    SELECT\n      account_id\n    FROM loan\n  ) AND T2.A10 > 8000 AND T2.A10 <= 9000;",
        "pred_query": "SELECT DISTINCT T1.frequency\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T1.account_id NOT IN (\n    SELECT\n      account_id\n    FROM loan\n  ) AND T2.A10 > 8000 AND T2.A10 <= 9000;",
        "pred_time": 0.0023941993713378906,
        "orig_time": 0.0020515918731689453,
        "time_ratio": 0.8569010157339175,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts in North Bohemia has made a transaction with the partner's bank being AB?",
        "original_query": "SELECT COUNT(T2.account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T3.bank = 'AB' AND T1.A3 = 'north Bohemia'",
        "llm_output": "-- Reasoning\nI need to count distinct `account_id`s.\nAn account is relevant if its associated district (via `district_id`) is 'North Bohemia' (column `A3` in `district` table) AND if it has a transaction (in the `trans` table) where the partner bank (`bank` column) is 'AB'.\nI will join `account` with `district` and `trans` tables, apply the filters, and then count the distinct `account_id`s.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3\n  ON T1.account_id = T3.account_id\nWHERE\n  T2.A3 = 'North Bohemia' AND T3.bank = 'AB';",
        "pred_query": "SELECT\n  COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3\n  ON T1.account_id = T3.account_id\nWHERE\n  T2.A3 = 'North Bohemia' AND T3.bank = 'AB';",
        "pred_time": 0.0920867919921875,
        "orig_time": 0.09596371650695801,
        "time_ratio": 1.0421007663628832,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please list the name of the districts with accounts that made withdrawal transactions.",
        "original_query": "SELECT DISTINCT T1.A2 FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T3.type = 'VYDAJ'",
        "llm_output": "-- Reasoning\nI need to find districts that have accounts with withdrawal transactions. I will join the `trans` table (filtered by `type = 'withdrawal'`) with the `account` table and then with the `district` table. Finally, I will select the distinct district names (`A2`).\n\n-- SQL Query\nSELECT DISTINCT\n  T3.A2\nFROM trans AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.type = 'withdrawal';",
        "pred_query": "SELECT DISTINCT\n  T3.A2\nFROM trans AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.type = 'withdrawal';",
        "pred_time": 0.08820986747741699,
        "orig_time": 0.17394065856933594,
        "time_ratio": 1.9718957021885026,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the average number of crimes committed in 1995 in regions where the number exceeds 4000 and the region has accounts that are opened starting from the year 1997?",
        "original_query": "SELECT AVG(T1.A15) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T2.date) >= '1997' AND T1.A15 > 4000",
        "llm_output": "-- Reasoning\nThe query needs to identify districts that satisfy two conditions: the number of crimes in 1995 (`A15`) is greater than 4000, and the district has at least one account opened in 1997 or later. First, a subquery identifies districts with accounts opened from 1997 onwards by checking the `date` column in the `account` table. Then, the main query filters the `district` table, applying both the crime count condition and using the `IN` operator to select districts from the subquery's result. Finally, it calculates the average of `A15` for the filtered districts.\n\n-- SQL Query\nSELECT AVG(T1.A15)\nFROM district AS T1\nWHERE T1.A15 > 4000\n  AND T1.district_id IN (SELECT DISTINCT T2.district_id FROM account AS T2 WHERE STRFTIME('%Y', T2.date) >= '1997');",
        "pred_query": "SELECT AVG(T1.A15)\nFROM district AS T1\nWHERE T1.A15 > 4000\n  AND T1.district_id IN (SELECT DISTINCT T2.district_id FROM account AS T2 WHERE STRFTIME('%Y', T2.date) >= '1997');",
        "pred_time": 0.0022780895233154297,
        "orig_time": 0.0019931793212890625,
        "time_ratio": 0.8749345892203035,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many 'classic' cards are eligible for loan?",
        "original_query": "SELECT COUNT(T1.card_id) FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id WHERE T1.type = 'classic' AND T2.type = 'Owner'",
        "llm_output": "-- Reasoning\nTo find 'classic' cards eligible for a loan, we need to link cards to accounts that have loans. We join `card` with `disp` using `disp_id`, then join `disp` with `loan` using `account_id`. Finally, we filter for cards with `type = 'classic'` and count the distinct `card_id`s.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.card_id)\nFROM card AS T1\nINNER JOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nINNER JOIN loan AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.type = 'classic';",
        "pred_query": "SELECT COUNT(DISTINCT T1.card_id)\nFROM card AS T1\nINNER JOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nINNER JOIN loan AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.type = 'classic';",
        "pred_time": 0.0011372566223144531,
        "orig_time": 0.0007195472717285156,
        "time_ratio": 0.6327044025157232,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many male clients in 'Hl.m. Praha' district?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'M' AND T2.A2 = 'Hl.m. Praha'",
        "llm_output": "-- Reasoning\nI need to count clients based on their gender and district.\nFirst, I will join the `client` and `district` tables using `district_id`.\nThen, I will filter the results for clients where `gender` is 'M' and the district name (`A2`) is 'Hl.m. Praha'.\nFinally, I will count the number of such clients.\n\n-- SQL Query\nSELECT\n  COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T1.gender = 'M' AND T2.A2 = 'Hl.m. Praha';",
        "pred_query": "SELECT\n  COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T1.gender = 'M' AND T2.A2 = 'Hl.m. Praha';",
        "pred_time": 0.0015146732330322266,
        "orig_time": 0.0011239051818847656,
        "time_ratio": 0.742011648040296,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many percent of 'Gold' cards were issued prior to 1998?",
        "original_query": "SELECT CAST(SUM(type = 'gold') AS REAL) * 100 / COUNT(card_id) FROM card WHERE STRFTIME('%Y', issued) < '1998'",
        "llm_output": "-- Reasoning\nFirst, I will count the total number of 'Gold' cards from the `card` table.\nThen, I will count the number of 'Gold' cards that were issued before 1998.\nFinally, I will divide the count of cards issued before 1998 by the total count of 'Gold' cards and multiply by 100 to get the percentage.\n\n-- SQL Query\nSELECT\n  CAST(SUM(CASE WHEN STRFTIME('%Y', issued) < '1998' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(card_id)\nFROM card\nWHERE\n  type = 'gold';",
        "pred_query": "SELECT\n  CAST(SUM(CASE WHEN STRFTIME('%Y', issued) < '1998' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(card_id)\nFROM card\nWHERE\n  type = 'gold';",
        "pred_time": 0.0010821819305419922,
        "orig_time": 0.0007383823394775391,
        "time_ratio": 0.6823088786076228,
        "check": false
    },
    {
        "id": "financial",
        "question": "Who is the owner of the account with the largest loan amount?",
        "original_query": "SELECT T1.client_id FROM disp AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T1.type = 'OWNER' ORDER BY T2.amount DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to find the client who owns the account associated with the largest loan amount.\nFirst, I will join the `loan` table with the `disp` table on `account_id` to link loans to dispositions.\nNext, I will filter the `disp` table records to only include `type = 'OWNER'` to ensure I'm identifying the actual account owner.\nThen, I will join with the `client` table on `client_id` to get the owner's details.\nFinally, I will order the results by `loan.amount` in descending order and take the top entry to find the client_id of the owner of the account with the largest loan.\n\n-- SQL Query\nite\nSELECT\n  T3.client_id\nFROM loan AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN client AS T3\n  ON T2.client_id = T3.client_id\nWHERE\n  T2.type = 'OWNER'\nORDER BY\n  T1.amount DESC\nLIMIT 1;\n",
        "pred_query": "SELECT\n  T3.client_id\nFROM loan AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN client AS T3\n  ON T2.client_id = T3.client_id\nWHERE\n  T2.type = 'OWNER'\nORDER BY\n  T1.amount DESC\nLIMIT 1;",
        "pred_time": 0.002071857452392578,
        "orig_time": 0.0011835098266601562,
        "time_ratio": 0.5712313003452244,
        "check": true
    },
    {
        "id": "financial",
        "question": "What is the number of committed crimes in 1995 in the district of the account with the id 532?",
        "original_query": "SELECT T1.A15 FROM district AS T1 INNER JOIN `account` AS T2 ON T1.district_id = T2.district_id WHERE T2.account_id = 532",
        "llm_output": "-- Reasoning\nI need to first find the `district_id` associated with `account_id` 532 from the `account` table.\nThen, I will use this `district_id` to query the `district` table.\nThe `district` table contains columns `A14` and `A15` which represent the number of committed crimes in 1995 and 1996 respectively. The question specifically asks for 1995, so I will select the value from column `A14`.\n\n-- SQL Query\nSELECT T1.A14\nFROM district AS T1\nINNER JOIN account AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.account_id = 532;",
        "pred_query": "SELECT T1.A14\nFROM district AS T1\nINNER JOIN account AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.account_id = 532;",
        "pred_time": 0.0010030269622802734,
        "orig_time": 0.0004723072052001953,
        "time_ratio": 0.47088186356073214,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the district Id of the account that placed the order with the id 33333?",
        "original_query": "SELECT T3.district_id FROM `order` AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.order_id = 33333",
        "llm_output": "-- Reasoning\nI need to find the `district_id` for a specific order.\nThe `order` table contains `order_id` and `account_id`.\nThe `account` table contains `account_id` and `district_id`.\nI will join `order` and `account` tables on `account_id` and filter by `order_id = 33333` to get the `district_id`.\n\n-- SQL Query\nSELECT T1.district_id FROM account AS T1 INNER JOIN `order` AS T2 ON T1.account_id = T2.account_id WHERE T2.order_id = 33333;",
        "pred_query": "SELECT T1.district_id FROM account AS T1 INNER JOIN `order` AS T2 ON T1.account_id = T2.account_id WHERE T2.order_id = 33333;",
        "pred_time": 0.0009009838104248047,
        "orig_time": 0.0006241798400878906,
        "time_ratio": 0.692775866631384,
        "check": true
    },
    {
        "id": "financial",
        "question": "List all the withdrawals in cash transactions that the client with the id 3356 makes.",
        "original_query": "SELECT T4.trans_id FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN trans AS T4 ON T3.account_id = T4.account_id WHERE T1.client_id = 3356 AND T4.operation = 'VYBER'",
        "llm_output": "-- Reasoning\nI need to find transactions (`trans` table) for a specific client (`client` table).\nThe `client` and `trans` tables are linked via `disp` and `account` tables.\nI will join `client` with `disp` and then `disp` with `trans` on `account_id`.\nFinally, I will filter transactions for the given `client_id` (3356) and for `type = 'withdrawal'` and `operation = 'cash withdrawal'`.\n\n-- SQL Query\nSELECT T.*\nFROM client AS C\nJOIN disp AS D\n  ON C.client_id = D.client_id\nJOIN trans AS T\n  ON D.account_id = T.account_id\nWHERE\n  C.client_id = 3356 AND T.type = 'withdrawal' AND T.operation = 'cash withdrawal';",
        "pred_query": "SELECT T.*\nFROM client AS C\nJOIN disp AS D\n  ON C.client_id = D.client_id\nJOIN trans AS T\n  ON D.account_id = T.account_id\nWHERE\n  C.client_id = 3356 AND T.type = 'withdrawal' AND T.operation = 'cash withdrawal';",
        "pred_time": 0.09618091583251953,
        "orig_time": 0.20964789390563965,
        "time_ratio": 2.179724450437766,
        "check": false
    },
    {
        "id": "financial",
        "question": "Among the weekly issuance accounts, how many have a loan of under 200000?",
        "original_query": "SELECT COUNT(T1.account_id) FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T2.frequency = 'POPLATEK TYDNE' AND T1.amount < 200000",
        "llm_output": "-- Reasoning\nI need to identify accounts with 'weekly issuance' frequency and then check if any of these accounts have a loan amount less than 200000. I will join the `account` and `loan` tables, filter by the specified conditions, and then count the distinct `account_id`s.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.frequency = 'weekly issuance' AND T2.amount < 200000;",
        "pred_query": "SELECT\n  COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.frequency = 'weekly issuance' AND T2.amount < 200000;",
        "pred_time": 0.0011866092681884766,
        "orig_time": 0.0007569789886474609,
        "time_ratio": 0.6379344986939923,
        "check": false
    },
    {
        "id": "financial",
        "question": "What type of credit card does the client with the id 13539 own?",
        "original_query": "SELECT T3.type FROM disp AS T1 INNER JOIN client AS T2 ON T1.client_id = T2.client_id INNER JOIN card AS T3 ON T1.disp_id = T3.disp_id WHERE T2.client_id = 13539",
        "llm_output": "-- Reasoning\nI need to find the credit card type for a given client.\nFirst, I will join the `client` table with the `disp` table using `client_id` to find the `disp_id` associated with the client.\nThen, I will join the `disp` table with the `card` table using `disp_id` to retrieve the `type` of the card.\nFinally, I will filter the results for `client_id` 13539.\n\n-- SQL Query\nSELECT\n  T3.type\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nWHERE\n  T1.client_id = 13539;",
        "pred_query": "SELECT\n  T3.type\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nWHERE\n  T1.client_id = 13539;",
        "pred_time": 0.0010936260223388672,
        "orig_time": 0.0006995201110839844,
        "time_ratio": 0.6396337475474166,
        "check": true
    },
    {
        "id": "financial",
        "question": "What is the region of the client with the id 3541 from?",
        "original_query": "SELECT T2.district_id, T1.A3 FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T2.client_id = 3541",
        "llm_output": "-- Reasoning\nTo find the region of a client, I need to join the `client` table with the `district` table on `district_id`.\nI will filter for the specific `client_id` 3541 in the `client` table.\nFinally, I will select the `A2` column from the `district` table, which represents the region.\n\n-- SQL Query\nSELECT T2.A2 FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.client_id = 3541;",
        "pred_query": "SELECT T2.A2 FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.client_id = 3541;",
        "pred_time": 0.0008912086486816406,
        "orig_time": 0.00048470497131347656,
        "time_ratio": 0.5438737292669877,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which district has the most accounts with loan contracts finished with no problems?",
        "original_query": "SELECT T1.district_id FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id WHERE T3.status = 'A' GROUP BY T1.district_id ORDER BY COUNT(T2.account_id) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nI need to count accounts per district that have a loan with a 'Finished' (status 'A') status.\nFirst, I'll filter the `loan` table for loans with 'A' status.\nThen, I'll join with the `account` table on `account_id` to get the `district_id`.\nI'll group the results by `district_id` and count the distinct accounts.\nFinally, I'll order by the count in descending order and limit to 1 to get the district with the most such accounts.\n\n-- SQL Query\nSELECT\n  T2.district_id\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.status = 'A'\nGROUP BY\n  T2.district_id\nORDER BY\n  COUNT(T2.account_id) DESC\nLIMIT 1;",
        "pred_query": "SELECT\n  T2.district_id\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.status = 'A'\nGROUP BY\n  T2.district_id\nORDER BY\n  COUNT(T2.account_id) DESC\nLIMIT 1;",
        "pred_time": 0.0012600421905517578,
        "orig_time": 0.0007812976837158203,
        "time_ratio": 0.6200567644276254,
        "check": true
    },
    {
        "id": "financial",
        "question": "Who placed the order with the id 32423?",
        "original_query": "SELECT T3.client_id FROM `order` AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN client AS T3 ON T2.district_id = T3.district_id WHERE T1.order_id = 32423",
        "llm_output": "-- Reasoning\nI need to find the `client_id` associated with a specific `order_id`.\nFirst, I'll find the `account_id` from the `order` table using the given `order_id`.\nThen, I'll join `account` with `disp` on `account_id` to get the `client_id`.\nFinally, I'll select the `client_id` from the `client` table.\n\n-- SQL Query\nSELECT T3.client_id\nFROM `order` AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN client AS T3\n  ON T2.client_id = T3.client_id\nWHERE\n  T1.order_id = 32423;",
        "pred_query": "SELECT T3.client_id\nFROM `order` AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN client AS T3\n  ON T2.client_id = T3.client_id\nWHERE\n  T1.order_id = 32423;",
        "pred_time": 0.0011930465698242188,
        "orig_time": 0.0009531974792480469,
        "time_ratio": 0.798960831334932,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please list all the transactions made by accounts from district 5.",
        "original_query": "SELECT T3.trans_id FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T1.district_id = 5",
        "llm_output": "-- Reasoning\nTo list all transactions made by accounts from district 5, I need to join the `trans` table with the `account` table on `account_id`. Then, I will filter the results from the `account` table where `district_id` is equal to 5. Finally, I will select all columns from the `trans` table.\n\n-- SQL Query\nSELECT T1.*\nFROM trans AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.district_id = 5;",
        "pred_query": "SELECT T1.*\nFROM trans AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.district_id = 5;",
        "pred_time": 0.11630535125732422,
        "orig_time": 0.17681646347045898,
        "time_ratio": 1.5202779713828871,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many of the accounts are from Jesenik district?",
        "original_query": "SELECT COUNT(T2.account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE T1.A2 = 'Jesenik'",
        "llm_output": "-- Reasoning\nI need to find the `district_id` for the district named 'Jesenik' from the `district` table using the `A2` column. Then, I will count the number of accounts in the `account` table that belong to this specific `district_id`.\n\n-- SQL Query\nite\nSELECT\n  COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A2 = 'Jesenik';\n",
        "pred_query": "SELECT\n  COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A2 = 'Jesenik';",
        "pred_time": 0.0021543502807617188,
        "orig_time": 0.0012362003326416016,
        "time_ratio": 0.5738158477202302,
        "check": true
    },
    {
        "id": "financial",
        "question": "List all the clients' IDs whose junior credit cards were issued after 1996.",
        "original_query": "SELECT T2.client_id FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id WHERE T1.type = 'junior' AND T1.issued >= '1997-01-01'",
        "llm_output": "-- Reasoning\nI need to identify clients with 'junior' credit cards.\nI will join the `card` table with the `disp` table on `disp_id` to link cards to clients.\nThen, I will filter for cards with `type = 'junior'` and `issued` date after '1996-12-31'.\nFinally, I will select the distinct `client_id` from the `disp` table.\n\n-- SQL Query\nSELECT DISTINCT T2.client_id\nFROM card AS T1\nINNER JOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nWHERE\n  T1.type = 'junior' AND T1.issued > '1996-12-31';",
        "pred_query": "SELECT DISTINCT T2.client_id\nFROM card AS T1\nINNER JOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nWHERE\n  T1.type = 'junior' AND T1.issued > '1996-12-31';",
        "pred_time": 0.0013325214385986328,
        "orig_time": 0.0010790824890136719,
        "time_ratio": 0.8098049740561818,
        "check": true
    },
    {
        "id": "financial",
        "question": "What percentage of clients who opened their accounts in the district with an average salary of over 10000 are women?",
        "original_query": "SELECT CAST(SUM(T2.gender = 'F') AS REAL) * 100 / COUNT(T2.client_id) FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T1.A11 > 10000",
        "llm_output": "-- Reasoning\n1. First, identify districts where the average salary (A10) is greater than 10000.\n2. Join these districts with the `account` table to find accounts associated with these districts.\n3. Join the resulting accounts with the `disp` table to link to `client_id`s.\n4. Join with the `client` table to get client details, specifically `gender`.\n5. Use a Common Table Expression (CTE) or subquery to select `DISTINCT client_id` and their `gender` for all clients whose accounts are in the qualified districts. This ensures each client is counted only once, even if they have multiple relevant accounts.\n6. Finally, calculate the percentage by dividing the count of female clients (where `gender = 'F'`) by the total count of distinct clients identified in the CTE, multiplying by 100.0 for percentage and ensuring float division using `CAST`.\n\n-- SQL Query\nite\nWITH QualifiedClients AS (\n  SELECT DISTINCT\n    C.client_id,\n    C.gender\n  FROM district AS D\n  JOIN account AS A\n    ON D.district_id = A.district_id\n  JOIN disp AS DI\n    ON A.account_id = DI.account_id\n  JOIN client AS C\n    ON DI.client_id = C.client_id\n  WHERE\n    D.A10 > 10000\n)\nSELECT\n  CAST(SUM(CASE WHEN gender = 'F' THEN 1 ELSE 0 END) AS REAL) * 100.0 / COUNT(client_id)\nFROM QualifiedClients;\n",
        "pred_query": "SELECT DISTINCT\n    C.client_id,\n    C.gender\n  FROM district AS D\n  JOIN account AS A\n    ON D.district_id = A.district_id\n  JOIN disp AS DI\n    ON A.account_id = DI.account_id\n  JOIN client AS C\n    ON DI.client_id = C.client_id\n  WHERE\n    D.A10 > 10000\n)\nSELECT\n  CAST(SUM(CASE WHEN gender = 'F' THEN 1 ELSE 0 END) AS REAL) * 100.0 / COUNT(client_id)\nFROM QualifiedClients;",
        "pred_time": null,
        "orig_time": 0.0014698505401611328,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "What was the growth rate of the total amount of loans across all accounts for a male client between 1996 and 1997?",
        "original_query": "SELECT CAST((SUM(CASE WHEN STRFTIME('%Y', T1.date) = '1997' THEN T1.amount ELSE 0 END) - SUM(CASE WHEN STRFTIME('%Y', T1.date) = '1996' THEN T1.amount ELSE 0 END)) AS REAL) * 100 / SUM(CASE WHEN STRFTIME('%Y', T1.date) = '1996' THEN T1.amount ELSE 0 END) FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN disp AS T3 ON T3.account_id = T2.account_id INNER JOIN client AS T4 ON T4.client_id = T3.client_id WHERE T4.gender = 'M' AND T3.type = 'OWNER'",
        "llm_output": "-- Reasoning\nThe query needs to calculate the growth rate of total loan amounts for male clients between 1996 and 1997.\n1. Join `client`, `disp`, `account`, and `loan` tables to link clients to their loans.\n2. Filter clients to include only 'M' (male) gender.\n3. Filter loans to include only those issued in 1996 or 1997.\n4. Calculate the total loan amount for 1996 and 1997 separately using conditional aggregation (`SUM` with `CASE`).\n5. Apply the growth rate formula: (Amount_1997 - Amount_1996) / Amount_1996, using `NULLIF` to prevent division by zero.\n\n-- SQL Query\nite\nSELECT\n  (SUM(CASE WHEN STRFTIME('%Y', T2.date) = '1997' THEN T2.amount ELSE 0 END) - SUM(CASE WHEN STRFTIME('%Y', T2.date) = '1996' THEN T2.amount ELSE 0 END)) * 1.0 /\n  NULLIF(SUM(CASE WHEN STRFTIME('%Y', T2.date) = '1996' THEN T2.amount ELSE 0 END), 0) AS growth_rate\nFROM client AS T1\nINNER JOIN disp AS T3\n  ON T1.client_id = T3.client_id\nINNER JOIN account AS T4\n  ON T3.account_id = T4.account_id\nINNER JOIN loan AS T2\n  ON T4.account_id = T2.account_id\nWHERE\n  T1.gender = 'M' AND STRFTIME('%Y', T2.date) BETWEEN '1996' AND '1997';\n",
        "pred_query": "SELECT\n  (SUM(CASE WHEN STRFTIME('%Y', T2.date) = '1997' THEN T2.amount ELSE 0 END) - SUM(CASE WHEN STRFTIME('%Y', T2.date) = '1996' THEN T2.amount ELSE 0 END)) * 1.0 /\n  NULLIF(SUM(CASE WHEN STRFTIME('%Y', T2.date) = '1996' THEN T2.amount ELSE 0 END), 0) AS growth_rate\nFROM client AS T1\nINNER JOIN disp AS T3\n  ON T1.client_id = T3.client_id\nINNER JOIN account AS T4\n  ON T3.account_id = T4.account_id\nINNER JOIN loan AS T2\n  ON T4.account_id = T2.account_id\nWHERE\n  T1.gender = 'M' AND STRFTIME('%Y', T2.date) BETWEEN '1996' AND '1997';",
        "pred_time": 0.002380847930908203,
        "orig_time": 0.0019927024841308594,
        "time_ratio": 0.8369717604646505,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many credit card withdrawals were recorded after 1995?",
        "original_query": "SELECT COUNT(account_id) FROM trans WHERE STRFTIME('%Y', date) > '1995' AND operation = 'VYBER KARTOU'",
        "llm_output": "-- Reasoning\nThe question asks for the number of credit card withdrawals recorded after 1995.\n1. Identify withdrawal transactions from the `trans` table using `type = 'withdrawal'` and filter by `date > '1995-12-31'`.\n2. Link these transactions to their respective accounts using `account_id`.\n3. Join `account` with `disp` to find the dispositions associated with these accounts.\n4. Join `disp` with `card` to find the cards linked through these dispositions and filter for `card.type = 'credit'`.\n5. Count the distinct `trans_id` to get the final result.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.trans_id)\nFROM trans AS T1\nJOIN account AS T2\n  ON T1.account_id = T2.account_id\nJOIN disp AS T3\n  ON T2.account_id = T3.account_id\nJOIN card AS T4\n  ON T3.disp_id = T4.disp_id\nWHERE T1.type = 'withdrawal' AND T4.type = 'credit' AND T1.date > '1995-12-31';",
        "pred_query": "SELECT COUNT(DISTINCT T1.trans_id)\nFROM trans AS T1\nJOIN account AS T2\n  ON T1.account_id = T2.account_id\nJOIN disp AS T3\n  ON T2.account_id = T3.account_id\nJOIN card AS T4\n  ON T3.disp_id = T4.disp_id\nWHERE T1.type = 'withdrawal' AND T4.type = 'credit' AND T1.date > '1995-12-31';",
        "pred_time": 0.09008264541625977,
        "orig_time": 0.3021271228790283,
        "time_ratio": 3.3538882154596994,
        "check": false
    },
    {
        "id": "financial",
        "question": "What was the difference in the number of crimes committed in East and North Bohemia in 1996?",
        "original_query": "SELECT SUM(IIF(A3 = 'East Bohemia', A16, 0)) - SUM(IIF(A3 = 'North Bohemia', A16, 0)) FROM district",
        "llm_output": "-- Reasoning\nI need to find the number of crimes for 'East Bohemia' and 'North Bohemia' in 1996.\nThe `district` table contains district-level information, with `A3` representing the region name and `A15` representing the number of committed crimes in 1996.\nI will query the `A15` value for each specified region and then calculate the absolute difference between them.\n\n-- SQL Query\nSELECT\n  ABS(\n    (SELECT A15 FROM district WHERE A3 = 'East Bohemia') -\n    (SELECT A15 FROM district WHERE A3 = 'North Bohemia')\n  );",
        "pred_query": "SELECT\n  ABS(\n    (SELECT A15 FROM district WHERE A3 = 'East Bohemia') -\n    (SELECT A15 FROM district WHERE A3 = 'North Bohemia')\n  );",
        "pred_time": 0.0008692741394042969,
        "orig_time": 0.0005023479461669922,
        "time_ratio": 0.5778935820076796,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many owner and disponent dispositions are there from account number 1 to account number 10?",
        "original_query": "SELECT SUM(type = 'Owner') , SUM(type = 'Disponent') FROM disp WHERE account_id BETWEEN 1 AND 10",
        "llm_output": "-- Reasoning\nI need to count the dispositions from the `disp` table. The question specifies two types of dispositions: 'owner' and 'disponent', and a range of account numbers from 1 to 10. I will filter the `disp` table by these conditions and then count the resulting rows.\n\n-- SQL Query\nSELECT COUNT(disp_id)\nFROM disp\nWHERE type IN ('owner', 'disponent') AND account_id BETWEEN 1 AND 10;",
        "pred_query": "SELECT COUNT(disp_id)\nFROM disp\nWHERE type IN ('owner', 'disponent') AND account_id BETWEEN 1 AND 10;",
        "pred_time": 0.0011970996856689453,
        "orig_time": 0.0007066726684570312,
        "time_ratio": 0.5903206532563234,
        "check": false
    },
    {
        "id": "financial",
        "question": "How often does account number 3 request an account statement to be released? What was the aim of debiting 3539 in total?",
        "original_query": "SELECT T1.frequency, T2.k_symbol FROM account AS T1 INNER JOIN `order` AS T2 ON T1.account_id = T2.account_id WHERE T1.account_id = 3 AND T2.amount = 3539",
        "llm_output": "-- Reasoning\n1.  To answer \"How often does account number 3 request an account statement to be released?\", we query the `trans` table. We filter for `account_id = 3` and identify transactions where the `operation` column is 'VYDAJ VYPIS', which represents an issued account statement. We then count these occurrences.\n2.  To answer \"What was the aim of debiting 3539 in total?\", we again query the `trans` table. We filter for debit transactions by setting `type = 'VYDAJ'`. We then group these transactions by their `k_symbol` (aim/purpose) and use a `HAVING` clause to find the group where the sum of `amount` equals 3539, retrieving the corresponding `k_symbol`.\n3.  Both answers are combined into a single query using scalar subqueries in the `SELECT` clause, returning the count and the `k_symbol` in a single result row.\n\n-- SQL Query\nSELECT\n  (SELECT\n     COUNT(*)\n   FROM trans\n   WHERE\n     account_id = 3 AND operation = 'VYDAJ VYPIS'\n  ) AS statement_release_count,\n  (SELECT\n     k_symbol\n   FROM trans\n   WHERE\n     type = 'VYDAJ'\n   GROUP BY\n     k_symbol\n   HAVING\n     SUM(amount) = 3539\n  ) AS aim_for_total_debit_3539;",
        "pred_query": "SELECT\n  (SELECT\n     COUNT(*)\n   FROM trans\n   WHERE\n     account_id = 3 AND operation = 'VYDAJ VYPIS'\n  ) AS statement_release_count,\n  (SELECT\n     k_symbol\n   FROM trans\n   WHERE\n     type = 'VYDAJ'\n   GROUP BY\n     k_symbol\n   HAVING\n     SUM(amount) = 3539\n  ) AS aim_for_total_debit_3539;",
        "pred_time": 0.3935995101928711,
        "orig_time": 0.001107931137084961,
        "time_ratio": 0.002814869196717379,
        "check": false
    },
    {
        "id": "financial",
        "question": "What year was account owner number 130 born?",
        "original_query": "SELECT STRFTIME('%Y', T1.birth_date) FROM client AS T1 INNER JOIN disp AS T3 ON T1.client_id = T3.client_id INNER JOIN account AS T2 ON T3.account_id = T2.account_id WHERE T2.account_id = 130",
        "llm_output": "-- Reasoning\nThe question asks for the birth year of account owner number 130. The `client` table contains `client_id` and `birth_date`. Assuming \"account owner number 130\" refers to `client_id` 130, we can directly query the `client` table. We need to select the `birth_date` for `client_id` 130 and then extract the year component from it using `STRFTIME`.\n\n-- SQL Query\nSELECT STRFTIME('%Y', birth_date) FROM client WHERE client_id = 130;",
        "pred_query": "SELECT STRFTIME('%Y', birth_date) FROM client WHERE client_id = 130;",
        "pred_time": 0.0008511543273925781,
        "orig_time": 0.0008113384246826172,
        "time_ratio": 0.9532212885154062,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts have an owner disposition and request for a statement to be generated upon a transaction?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id WHERE T2.type = 'OWNER' AND T1.frequency = 'POPLATEK PO OBRATU'",
        "llm_output": "-- Reasoning\nThe question asks for the number of accounts that satisfy two conditions: having an 'owner' disposition and requesting a statement upon a transaction.\n1.  **Owner Disposition**: This information is available in the `disp` table, where `disp.type` should be 'owner'.\n2.  **Request for statement upon a transaction**: The `account` table has a `frequency` column. A common value for this column in banking datasets to indicate a statement being generated after each transaction is 'issuance after transaction'. This directly maps to the second condition.\n3.  We join the `disp` and `account` tables on `account_id` to link these conditions.\n4.  Finally, we count the distinct `account_id`s that meet both criteria using `COUNT(DISTINCT account.account_id)`.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T1.account_id)\nFROM disp AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.type = 'owner' AND T2.frequency = 'issuance after transaction';",
        "pred_query": "SELECT\n  COUNT(DISTINCT T1.account_id)\nFROM disp AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.type = 'owner' AND T2.frequency = 'issuance after transaction';",
        "pred_time": 0.0012242794036865234,
        "orig_time": 0.0013799667358398438,
        "time_ratio": 1.1271665043816943,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the amount of debt that client number 992 has, and how is this client doing with payments?",
        "original_query": "SELECT T3.amount, T3.status FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id WHERE T1.client_id = 992",
        "llm_output": "-- Reasoning\nI need to find the total loan amount and the status of these loans for client_id 992.\n1. Join `client` and `disp` tables on `client_id` to link the client to their associated account.\n2. Join `disp` and `loan` tables on `account_id` to get the loan details for that account.\n3. Filter the results for `client_id = 992`.\n4. Calculate the sum of `amount` from the `loan` table for the total debt.\n5. Aggregate distinct `status` values from the `loan` table using `GROUP_CONCAT` to show how the client is doing with payments.\n\n-- SQL Query\nSELECT\n  SUM(T2.amount),\n  GROUP_CONCAT(DISTINCT T2.status)\nFROM client AS T1\nINNER JOIN disp AS T3\n  ON T1.client_id = T3.client_id\nINNER JOIN loan AS T2\n  ON T3.account_id = T2.account_id\nWHERE\n  T1.client_id = 992;",
        "pred_query": "SELECT\n  SUM(T2.amount),\n  GROUP_CONCAT(DISTINCT T2.status)\nFROM client AS T1\nINNER JOIN disp AS T3\n  ON T1.client_id = T3.client_id\nINNER JOIN loan AS T2\n  ON T3.account_id = T2.account_id\nWHERE\n  T1.client_id = 992;",
        "pred_time": 0.0017523765563964844,
        "orig_time": 0.00080108642578125,
        "time_ratio": 0.45714285714285713,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the sum that client number 4's account has following transaction 851? Who owns this account, a man or a woman?",
        "original_query": "SELECT T3.balance, T1.gender FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T1.client_id = 4 AND T3.trans_id = 851",
        "llm_output": "-- Reasoning\nI need to find the balance for a specific transaction (trans_id = 851) belonging to a specific client (client_id = 4) and also determine the gender of that client. I will join the `trans`, `disp`, and `client` tables. I'll filter by the given `trans_id` and `client_id` and then select the balance and client's gender.\n\n-- SQL Query\nSELECT\n  T1.balance,\n  T3.gender\nFROM trans AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN client AS T3\n  ON T2.client_id = T3.client_id\nWHERE\n  T1.trans_id = 851 AND T3.client_id = 4;",
        "pred_query": "SELECT\n  T1.balance,\n  T3.gender\nFROM trans AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN client AS T3\n  ON T2.client_id = T3.client_id\nWHERE\n  T1.trans_id = 851 AND T3.client_id = 4;",
        "pred_time": 0.0012118816375732422,
        "orig_time": 0.0004894733428955078,
        "time_ratio": 0.4038953373991737,
        "check": true
    },
    {
        "id": "financial",
        "question": "Which kind of credit card does client number 9 possess?",
        "original_query": "SELECT T3.type FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN card AS T3 ON T2.disp_id = T3.disp_id WHERE T1.client_id = 9",
        "llm_output": "-- Reasoning\nI need to find the credit card type for a specific client. I will join the `client` table with the `disp` table on `client_id` and then with the `card` table on `disp_id`. Finally, I will filter by the given client ID and select the card type.\n\n-- SQL Query\nSELECT\n  T3.type\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nWHERE\n  T1.client_id = 9;",
        "pred_query": "SELECT\n  T3.type\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nWHERE\n  T1.client_id = 9;",
        "pred_time": 0.001085519790649414,
        "orig_time": 0.0007030963897705078,
        "time_ratio": 0.6477048100153745,
        "check": true
    },
    {
        "id": "financial",
        "question": "How much, in total, did client number 617 pay for all of the transactions in 1998?",
        "original_query": "SELECT SUM(T3.amount) FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE STRFTIME('%Y', T3.date)= '1998' AND T1.client_id = 617",
        "llm_output": "-- Reasoning\nThe question asks for the total amount paid by client 617 for all transactions in 1998.\n1. Identify the `account_id` associated with `client_id` 617 by joining the `client` and `disp` tables.\n2. Filter the `trans` table for these `account_id`s.\n3. Filter transactions to the year 1998 using `strftime('%Y', trans.date) = '1998'`.\n4. Assume \"paid for\" refers to outgoing transactions, which are typically indicated by a `type` such as 'withdrawal' in banking datasets.\n5. Sum the `amount` for these filtered transactions.\n\n-- SQL Query\nite\nSELECT\n  SUM(T2.amount)\nFROM client AS T1\nINNER JOIN disp AS T3\n  ON T1.client_id = T3.client_id\nINNER JOIN trans AS T2\n  ON T3.account_id = T2.account_id\nWHERE\n  T1.client_id = 617 AND STRFTIME('%Y', T2.date) = '1998' AND T2.type = 'withdrawal';\n",
        "pred_query": "SELECT\n  SUM(T2.amount)\nFROM client AS T1\nINNER JOIN disp AS T3\n  ON T1.client_id = T3.client_id\nINNER JOIN trans AS T2\n  ON T3.account_id = T2.account_id\nWHERE\n  T1.client_id = 617 AND STRFTIME('%Y', T2.date) = '1998' AND T2.type = 'withdrawal';",
        "pred_time": 0.2904391288757324,
        "orig_time": 0.29380035400390625,
        "time_ratio": 1.0115729073461448,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please provide a list of clients who were born between 1983 and 1987 and whose account branch is in East Bohemia, along with their IDs.",
        "original_query": "SELECT T1.client_id, T3.account_id FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN account AS T3 ON T2.district_id = T3.district_id WHERE T2.A3 = 'east Bohemia' AND STRFTIME('%Y', T1.birth_date) BETWEEN '1983' AND '1987'",
        "llm_output": "-- Reasoning\nI need to retrieve `client_id` from the `client` table.\nI will filter clients based on their `birth_date` being between '1983-01-01' and '1987-12-31'.\nThen, I will join `client` with `disp`, `disp` with `account`, and `account` with `district` to connect clients to their account's branch district.\nFinally, I will filter the `district` table where the district name (`A3` column) is 'East Bohemia'.\n\n-- SQL Query\nSELECT\n  T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  T1.birth_date BETWEEN '1983-01-01' AND '1987-12-31' AND T4.A3 = 'east Bohemia';",
        "pred_query": "SELECT\n  T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  T1.birth_date BETWEEN '1983-01-01' AND '1987-12-31' AND T4.A3 = 'east Bohemia';",
        "pred_time": 0.002003908157348633,
        "orig_time": 0.0039021968841552734,
        "time_ratio": 1.947293277810827,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please provide the IDs of the 3 female clients with the largest loans.",
        "original_query": "SELECT T1.client_id FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id WHERE T1.gender = 'F' ORDER BY T3.amount DESC LIMIT 3",
        "llm_output": "-- Reasoning\nI need to find clients, their gender, and the loans associated with them.\nI will join `client` with `disp` on `client_id` to link clients to their display records, and then join `disp` with `loan` on `account_id` to link display records to loan information.\nI'll filter for clients where `gender` is 'F', order the results by the `amount` of the loan in descending order, and take the top 3 `client_id`s.\n\n-- SQL Query\nSELECT\n  T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN loan AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.gender = 'F'\nORDER BY\n  T3.amount DESC\nLIMIT 3;",
        "pred_query": "SELECT\n  T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN loan AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.gender = 'F'\nORDER BY\n  T3.amount DESC\nLIMIT 3;",
        "pred_time": 0.002008199691772461,
        "orig_time": 0.005995512008666992,
        "time_ratio": 2.9855158494598126,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many male customers who were born between 1974 and 1976 have made a payment on their home in excess of $4000?",
        "original_query": "SELECT COUNT(T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN client AS T3 ON T2.district_id = T3.district_id WHERE STRFTIME('%Y', T3.birth_date) BETWEEN '1974' AND '1976' AND T3.gender = 'M' AND T1.amount > 4000 AND T1.k_symbol = 'SIPO'",
        "llm_output": "-- Reasoning\nThe query first identifies male clients born between 1974 and 1976 from the `client` table.\nIt then joins `client` to `disp` and `account` to link clients to their bank accounts, and finally to the `trans` table to access transaction details.\nFilters are applied to `trans.k_symbol` for 'home' related payments and `trans.amount` to be greater than 4000.\nFinally, it counts the distinct `client_id` to get the number of unique customers meeting all criteria.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN trans AS T4\n  ON T3.account_id = T4.account_id\nWHERE\n  T1.gender = 'M' AND T1.birth_date BETWEEN '1974-01-01' AND '1976-12-31' AND T4.k_symbol = 'home' AND T4.amount > 4000;",
        "pred_query": "SELECT\n  COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN trans AS T4\n  ON T3.account_id = T4.account_id\nWHERE\n  T1.gender = 'M' AND T1.birth_date BETWEEN '1974-01-01' AND '1976-12-31' AND T4.k_symbol = 'home' AND T4.amount > 4000;",
        "pred_time": 0.09277796745300293,
        "orig_time": 0.16132211685180664,
        "time_ratio": 1.738797704676221,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts in Beroun were opened after 1996?",
        "original_query": "SELECT COUNT(account_id) FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T1.date) > '1996' AND T2.A2 = 'Beroun'",
        "llm_output": "-- Reasoning\nI need to join the `account` table with the `district` table on `district_id` to filter by district name.\nThen, I will filter for districts named 'Beroun' and accounts with a 'date' after 1996.\nFinally, I will count the number of distinct `account_id`s that satisfy these conditions.\n\n-- SQL Query\nSELECT\n  COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A2 = 'Beroun' AND T1.date > '1996-12-31';",
        "pred_query": "SELECT\n  COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A2 = 'Beroun' AND T1.date > '1996-12-31';",
        "pred_time": 0.0014488697052001953,
        "orig_time": 0.0019116401672363281,
        "time_ratio": 1.3194010202402502,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many female customers have a junior credit card?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN card AS T3 ON T2.disp_id = T3.disp_id WHERE T1.gender = 'F' AND T3.type = 'junior'",
        "llm_output": "-- Reasoning\nI need to find clients who are female and have a 'junior' type card.\nI will join `client` (for gender), `disp` (to link client to card), and `card` (for card type) tables.\nThen, I will filter by `gender = 'F'` and `card.type = 'junior'`, and finally count the distinct `client_id`s.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nWHERE\n  T1.gender = 'F' AND T3.type = 'junior';",
        "pred_query": "SELECT\n  COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nWHERE\n  T1.gender = 'F' AND T3.type = 'junior';",
        "pred_time": 0.0014123916625976562,
        "orig_time": 0.000934600830078125,
        "time_ratio": 0.6617150573936529,
        "check": true
    },
    {
        "id": "financial",
        "question": "What proportion of customers who have accounts at the Prague branch are female?",
        "original_query": "SELECT CAST(SUM(T2.gender = 'F') AS REAL) / COUNT(T2.client_id) * 100 FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T1.A3 = 'Prague'",
        "llm_output": "-- Reasoning\nI need to find the proportion of female customers among all customers who have at least one account associated with the 'Prague' district.\n1. Join `client`, `disp`, `account`, and `district` tables to link clients to the districts where their accounts are located.\n2. Filter these joined results to include only records where the district name (`A3` in the `district` table) is 'Prague'.\n3. Use a subquery or a Common Table Expression (CTE) to get a distinct list of `client_id` and their `gender` for all customers who satisfy the 'Prague' condition, ensuring each customer is counted only once.\n4. In the outer query, calculate the sum of female customers (where `gender = 'F'`) and divide it by the total count of customers from the distinct list, casting to `REAL` for floating-point division.\n\n-- SQL Query\nite\nSELECT\n  CAST(SUM(CASE WHEN T1.gender = 'F' THEN 1 ELSE 0 END) AS REAL) * 1.0 / COUNT(T1.client_id)\nFROM (\n  SELECT DISTINCT\n    C.client_id,\n    C.gender\n  FROM client AS C\n  JOIN disp AS D\n    ON C.client_id = D.client_id\n  JOIN account AS A\n    ON D.account_id = A.account_id\n  JOIN district AS DI\n    ON A.district_id = DI.district_id\n  WHERE DI.A3 = 'Prague'\n) AS T1;\n",
        "pred_query": "SELECT\n  CAST(SUM(CASE WHEN T1.gender = 'F' THEN 1 ELSE 0 END) AS REAL) * 1.0 / COUNT(T1.client_id)\nFROM (\n  SELECT DISTINCT\n    C.client_id,\n    C.gender\n  FROM client AS C\n  JOIN disp AS D\n    ON C.client_id = D.client_id\n  JOIN account AS A\n    ON D.account_id = A.account_id\n  JOIN district AS DI\n    ON A.district_id = DI.district_id\n  WHERE DI.A3 = 'Prague'\n) AS T1;",
        "pred_time": 0.002325773239135742,
        "orig_time": 0.0017571449279785156,
        "time_ratio": 0.7555099948744234,
        "check": false
    },
    {
        "id": "financial",
        "question": "What percentage of male clients request for weekly statements to be issued?",
        "original_query": "SELECT CAST(SUM(T1.gender = 'M') AS REAL) * 100 / COUNT(T1.client_id) FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE T2.frequency = 'POPLATEK TYDNE'",
        "llm_output": "-- Reasoning\n1. Identify all male clients from the `client` table by filtering `gender = 'M'`.\n2. For each male client, determine if they have at least one associated account (via `disp` table) that has a `frequency` of 'weekly' in the `account` table.\n3. Count the number of such male clients (who request weekly statements) and the total number of male clients.\n4. Calculate the percentage by dividing the count of male clients with weekly statements by the total count of male clients and multiplying by 100.\n\n-- SQL Query\nSELECT\n  CAST(SUM(CASE WHEN EXISTS (\n    SELECT 1\n    FROM disp AS D\n    INNER JOIN account AS A\n      ON D.account_id = A.account_id\n    WHERE D.client_id = C.client_id AND A.frequency = 'weekly'\n  ) THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(C.client_id)\nFROM client AS C\nWHERE C.gender = 'M';",
        "pred_query": "SELECT\n  CAST(SUM(CASE WHEN EXISTS (\n    SELECT 1\n    FROM disp AS D\n    INNER JOIN account AS A\n      ON D.account_id = A.account_id\n    WHERE D.client_id = C.client_id AND A.frequency = 'weekly'\n  ) THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(C.client_id)\nFROM client AS C\nWHERE C.gender = 'M';",
        "pred_time": 0.6115918159484863,
        "orig_time": 0.010102510452270508,
        "time_ratio": 0.016518387245916696,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many clients who choose statement of weekly issuance are User?",
        "original_query": "SELECT COUNT(T2.account_id) FROM account AS T1 INNER JOIN disp AS T2 ON T2.account_id = T1.account_id WHERE T1.frequency = 'POPLATEK TYDNE' AND T2.type = 'USER'",
        "llm_output": "-- Reasoning\nI need to count clients that satisfy two conditions: their associated account has a 'weekly issuance' frequency and their disposition type is 'User'. I will join the `account` and `disp` tables on `account_id`. Then, I'll filter by `account.frequency = 'weekly issuance'` and `disp.type = 'User'` and count the distinct `client_id`.\n\n-- SQL Query\nSELECT\n  COUNT(DISTINCT T2.client_id)\nFROM account AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.frequency = 'weekly issuance' AND T2.type = 'User';",
        "pred_query": "SELECT\n  COUNT(DISTINCT T2.client_id)\nFROM account AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.frequency = 'weekly issuance' AND T2.type = 'User';",
        "pred_time": 0.0013515949249267578,
        "orig_time": 0.0008265972137451172,
        "time_ratio": 0.6115717057682131,
        "check": true
    },
    {
        "id": "financial",
        "question": "Among the accounts who have loan validity more than 24 months, list out the accounts that have the lowest approved amount and have account opening date before 1997.",
        "original_query": "SELECT T1.account_id FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.duration > 24 AND STRFTIME('%Y', T2.date) < '1997' ORDER BY T1.amount ASC LIMIT 1",
        "llm_output": "-- Reasoning\nThe query first joins the `account` and `loan` tables to access account opening dates and loan details. It filters for loans with a duration greater than 24 months and accounts opened before 1997. Finally, it identifies and returns the `account_id`s that correspond to the minimum loan amount among this filtered set of accounts.\n\n-- SQL Query\nite\nSELECT T1.account_id\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.duration > 24 AND STRFTIME('%Y', T1.date) < '1997'\n  AND T2.amount = (\n    SELECT\n      MIN(T3.amount)\n    FROM loan AS T3\n    INNER JOIN account AS T4\n      ON T3.account_id = T4.account_id\n    WHERE\n      T3.duration > 24 AND STRFTIME('%Y', T4.date) < '1997'\n  );\n",
        "pred_query": "SELECT T1.account_id\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.duration > 24 AND STRFTIME('%Y', T1.date) < '1997'\n  AND T2.amount = (\n    SELECT\n      MIN(T3.amount)\n    FROM loan AS T3\n    INNER JOIN account AS T4\n      ON T3.account_id = T4.account_id\n    WHERE\n      T3.duration > 24 AND STRFTIME('%Y', T4.date) < '1997'\n  );",
        "pred_time": 0.001325845718383789,
        "orig_time": 0.0008721351623535156,
        "time_ratio": 0.6577953605466643,
        "check": true
    },
    {
        "id": "financial",
        "question": "Name the account numbers of female clients who are oldest and have lowest average salary?",
        "original_query": "SELECT T3.account_id FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN account AS T3 ON T2.district_id = T3.district_id WHERE T1.gender = 'F' ORDER BY T1.birth_date ASC, T2.A11 ASC LIMIT 1",
        "llm_output": "-- Reasoning\nFirst, identify the minimum `birth_date` among all female clients. Then, select all `client_id`s for female clients who share this minimum `birth_date`. In parallel, calculate the average `amount` of 'credit' transactions for each `account_id`, interpreting this as the average salary. Finally, join these two sets, find the minimum average salary among the oldest female clients, and return the `account_id`s that match this minimum.\n\n-- SQL Query\nite\nWITH OldestFemaleClients AS (\n    SELECT\n        client_id\n    FROM\n        client\n    WHERE\n        gender = 'F'\n        AND birth_date = (SELECT MIN(birth_date) FROM client WHERE gender = 'F')\n),\nClientAvgSalary AS (\n    SELECT\n        c.client_id,\n        a.account_id,\n        AVG(t.amount) AS avg_salary\n    FROM\n        client AS c\n    JOIN disp AS d\n        ON c.client_id = d.client_id\n    JOIN account AS a\n        ON d.account_id = a.account_id\n    JOIN trans AS t\n        ON a.account_id = t.account_id\n    WHERE\n        t.type = 'credit' -- Assuming 'credit' transactions represent income/salary\n    GROUP BY\n        c.client_id, a.account_id\n)\nSELECT\n    cas.account_id\nFROM\n    ClientAvgSalary AS cas\nJOIN\n    OldestFemaleClients AS ofc\n    ON cas.client_id = ofc.client_id\nWHERE\n    cas.avg_salary = (\n        SELECT MIN(cas2.avg_salary)\n        FROM ClientAvgSalary AS cas2\n        JOIN OldestFemaleClients AS ofc2\n            ON cas2.client_id = ofc2.client_id\n    )\nORDER BY\n    cas.account_id;\n",
        "pred_query": "SELECT\n        client_id\n    FROM\n        client\n    WHERE\n        gender = 'F'\n        AND birth_date = (SELECT MIN(birth_date) FROM client WHERE gender = 'F')\n),\nClientAvgSalary AS (\n    SELECT\n        c.client_id,\n        a.account_id,\n        AVG(t.amount) AS avg_salary\n    FROM\n        client AS c\n    JOIN disp AS d\n        ON c.client_id = d.client_id\n    JOIN account AS a\n        ON d.account_id = a.account_id\n    JOIN trans AS t\n        ON a.account_id = t.account_id\n    WHERE\n        t.type = 'credit' -- Assuming 'credit' transactions represent income/salary\n    GROUP BY\n        c.client_id, a.account_id\n)\nSELECT\n    cas.account_id\nFROM\n    ClientAvgSalary AS cas\nJOIN\n    OldestFemaleClients AS ofc\n    ON cas.client_id = ofc.client_id\nWHERE\n    cas.avg_salary = (\n        SELECT MIN(cas2.avg_salary)\n        FROM ClientAvgSalary AS cas2\n        JOIN OldestFemaleClients AS ofc2\n            ON cas2.client_id = ofc2.client_id\n    )\nORDER BY\n    cas.account_id;",
        "pred_time": null,
        "orig_time": 0.024205684661865234,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many clients who were born in 1920 stay in east Bohemia?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T1.birth_date) = '1920' AND T2.A3 = 'east Bohemia'",
        "llm_output": "-- Reasoning\nI need to count clients based on their birth year and the district they reside in.\nI will join the `client` table with the `district` table using `district_id`.\nThen, I'll filter for clients born in the year 1920 and districts named 'east Bohemia'.\nFinally, I will count the distinct client_ids that satisfy these conditions.\n\n-- SQL Query\nSELECT\n  COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  STRFTIME('%Y', T1.birth_date) = '1920' AND T2.A3 = 'east Bohemia';",
        "pred_query": "SELECT\n  COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  STRFTIME('%Y', T1.birth_date) = '1920' AND T2.A3 = 'east Bohemia';",
        "pred_time": 0.0023086071014404297,
        "orig_time": 0.001810312271118164,
        "time_ratio": 0.7841578023339874,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many loan accounts are for pre-payment of duration of 24 months with weekly issuance of statement.",
        "original_query": "SELECT COUNT(T2.account_id) FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T2.duration = 24 AND T1.frequency = 'POPLATEK TYDNE'",
        "llm_output": "-- Reasoning\nI need to count accounts that have a loan with a duration of 24 months and an account frequency of 'weekly issuance of statement'. I will join the `loan` and `account` tables on `account_id`, filter by the specified duration and frequency, and then count the distinct `account_id`s.\n\n-- SQL Query\nSELECT\n  COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.duration = 24 AND T1.frequency = 'weekly issuance of statement';",
        "pred_query": "SELECT\n  COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.duration = 24 AND T1.frequency = 'weekly issuance of statement';",
        "pred_time": 0.0009570121765136719,
        "orig_time": 0.0006422996520996094,
        "time_ratio": 0.6711509715994021,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the average amount of loan which are still on running contract with statement issuance after each transaction?",
        "original_query": "SELECT AVG(T2.payments) FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T2.status IN ('C', 'D') AND T1.frequency = 'POPLATEK PO OBRATU'",
        "llm_output": "-- Reasoning\nThe query needs to calculate the average loan amount based on two conditions. First, \"still on running contract\" refers to loans with a status of 'C' in the `loan` table. Second, \"with statement issuance after each transaction\" is interpreted as loans whose associated accounts have at least one transaction recorded in the `trans` table. This ensures the account is active with transaction history. The `EXISTS` clause efficiently checks for the presence of related transactions without duplicating loan rows.\n\n-- SQL Query\nSELECT AVG(T1.amount) FROM loan AS T1 WHERE T1.status = 'C' AND EXISTS (SELECT 1 FROM trans AS T2 WHERE T1.account_id = T2.account_id);",
        "pred_query": "SELECT AVG(T1.amount) FROM loan AS T1 WHERE T1.status = 'C' AND EXISTS (SELECT 1 FROM trans AS T2 WHERE T1.account_id = T2.account_id);",
        "pred_time": 19.7926607131958,
        "orig_time": 0.0009458065032958984,
        "time_ratio": 4.778571799926463e-05,
        "check": false
    },
    {
        "id": "financial",
        "question": "List all ID and district for clients that can only have the right to issue permanent orders or apply for loans.",
        "original_query": "SELECT T3.client_id, T2.district_id, T2.A2 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T1.account_id = T3.account_id WHERE T3.type = 'OWNER'",
        "llm_output": "-- Reasoning\n1.  The question asks for clients who \"can only have the right to issue permanent orders or apply for loans.\" This implies two conditions:\n    a. The client *must* have the right to issue orders or apply for loans. In this schema, having an account (linked via the `disp` table) grants these potential rights.\n    b. The client *must not* have other types of rights, specifically, the right to obtain a card. This means none of their `disp` records should be associated with a `card`.\n2.  To satisfy condition (a), we select clients who have at least one entry in the `disp` table. This is achieved using an `EXISTS` clause checking `disp` for the client's ID.\n3.  To satisfy condition (b), we exclude clients for whom *any* of their `disp` records are linked to a `card`. This is achieved using a `NOT EXISTS` clause, which checks if there's any `disp` record for the client that also has a corresponding `card` entry.\n4.  Finally, we select the `client_id` and `district_id` from the `client` table for those who meet both criteria.\n\n-- SQL Query\nSELECT T1.client_id, T1.district_id\nFROM client AS T1\nWHERE EXISTS (\n    SELECT 1\n    FROM disp AS T2\n    WHERE T2.client_id = T1.client_id\n) AND NOT EXISTS (\n    SELECT 1\n    FROM disp AS T3\n    INNER JOIN card AS T4\n    ON T3.disp_id = T4.disp_id\n    WHERE T3.client_id = T1.client_id\n);",
        "pred_query": "SELECT T1.client_id, T1.district_id\nFROM client AS T1\nWHERE EXISTS (\n    SELECT 1\n    FROM disp AS T2\n    WHERE T2.client_id = T1.client_id\n) AND NOT EXISTS (\n    SELECT 1\n    FROM disp AS T3\n    INNER JOIN card AS T4\n    ON T3.disp_id = T4.disp_id\n    WHERE T3.client_id = T1.client_id\n);",
        "pred_time": 1.4324653148651123,
        "orig_time": 0.003975629806518555,
        "time_ratio": 0.002775375965660236,
        "check": false
    },
    {
        "id": "financial",
        "question": "Provide the IDs and age of the client with high level credit card, which is eligible for loans.",
        "original_query": "SELECT T1.client_id, STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', T3.birth_date) FROM disp AS T1 INNER JOIN card AS T2 ON T2.disp_id = T1.disp_id INNER JOIN client AS T3 ON T1.client_id = T3.client_id WHERE T2.type = 'gold' AND T1.type = 'OWNER'",
        "llm_output": "-- Reasoning\nThe question asks for the `client_id` and age of clients who possess a \"high level credit card\" and are \"eligible for loans\".\n1.  **High-level credit card**: This is inferred from the `card` table where `type`='credit' is assumed to represent a high-level credit card.\n2.  **Eligible for loans**: This is interpreted as having a successful loan history, specifically a loan with `status`='A' (contract finished, no problems) in the `loan` table.\n3.  **Age calculation**: Age is calculated from `client.birth_date` using `strftime('%Y', 'now') - strftime('%Y', birth_date)`.\n4.  **Table relationships**: We need to join `client` (for ID and birth date) -> `disp` (to link client to account and card) -> `card` (for card type) and `account` (from disp, to link to loan) -> `loan` (for loan status).\n5.  **De-duplication**: `GROUP BY` `client_id` and `birth_date` is used to ensure each client is listed only once, even if they have multiple matching cards or loans.\n\n-- SQL Query\nite\nSELECT\n  T1.client_id,\n  CAST(STRFTIME('%Y', 'now') - STRFTIME('%Y', T1.birth_date) AS INTEGER) AS age\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nINNER JOIN account AS T4\n  ON T2.account_id = T4.account_id\nINNER JOIN loan AS T5\n  ON T4.account_id = T5.account_id\nWHERE\n  T3.type = 'credit' AND T5.status = 'A'\nGROUP BY\n  T1.client_id,\n  T1.birth_date;\n",
        "pred_query": "SELECT\n  T1.client_id,\n  CAST(STRFTIME('%Y', 'now') - STRFTIME('%Y', T1.birth_date) AS INTEGER) AS age\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nINNER JOIN account AS T4\n  ON T2.account_id = T4.account_id\nINNER JOIN loan AS T5\n  ON T4.account_id = T5.account_id\nWHERE\n  T3.type = 'credit' AND T5.status = 'A'\nGROUP BY\n  T1.client_id,\n  T1.birth_date;",
        "pred_time": 0.0011935234069824219,
        "orig_time": 0.0009834766387939453,
        "time_ratio": 0.8240111865761087,
        "check": false
    },
    {
        "id": "toxicology",
        "question": "What is the most common bond type?",
        "original_query": "SELECT T.bond_type FROM ( SELECT bond_type, COUNT(bond_id) FROM bond GROUP BY bond_type ORDER BY COUNT(bond_id) DESC LIMIT 1 ) AS T",
        "llm_output": "-- Reasoning\nTo find the most common bond type, I will group the `bond` table by `bond_type`. Then, I will count the occurrences for each type. Finally, I will order these counts in descending order and select the `bond_type` from the top row, which represents the most common one.\n\n-- SQL Query\nSELECT bond_type\nFROM bond\nGROUP BY bond_type\nORDER BY COUNT(bond_type) DESC\nLIMIT 1;",
        "pred_query": "SELECT bond_type\nFROM bond\nGROUP BY bond_type\nORDER BY COUNT(bond_type) DESC\nLIMIT 1;",
        "pred_time": 0.004586935043334961,
        "orig_time": 0.00464177131652832,
        "time_ratio": 1.0119548833099434,
        "check": true
    },
    {
        "id": "toxicology",
        "question": "In the non-carcinogenic molecules, how many contain chlorine atoms?",
        "original_query": "SELECT COUNT(DISTINCT T1.molecule_id) FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T2.element = 'cl' AND T1.label = '-'",
        "llm_output": "-- Reasoning\nThe question requires counting molecules that are both \"non-carcinogenic\" and contain \"chlorine atoms\".\n1. Identify molecules containing chlorine atoms by joining `molecule` with `atom` and filtering `atom.element = 'Cl'`.\n2. Infer \"non-carcinogenic\" status from the `molecule.label` column, assuming it contains the string 'non-carcinogenic'.\n3. Count the distinct `molecule_id`s that satisfy both conditions using an `INNER JOIN` and `WHERE` clause.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.molecule_id) FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label LIKE '%non-carcinogenic%' AND T2.element = 'Cl';",
        "pred_query": "SELECT COUNT(DISTINCT T1.molecule_id) FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.label LIKE '%non-carcinogenic%' AND T2.element = 'Cl';",
        "pred_time": 0.001626729965209961,
        "orig_time": 0.0013492107391357422,
        "time_ratio": 0.8294005569397626,
        "check": false
    },
    {
        "id": "toxicology",
        "question": "Calculate the average number of oxygen atoms in single-bonded molecules.",
        "original_query": "SELECT AVG(oxygen_count) FROM (SELECT T1.molecule_id, COUNT(T1.element) AS oxygen_count FROM atom AS T1 INNER JOIN bond AS T2 ON T1.molecule_id = T2.molecule_id  WHERE T2.bond_type = '-' AND T1.element = 'o'  GROUP BY T1.molecule_id) AS oxygen_counts",
        "llm_output": "-- Reasoning\nI need to first identify molecules that contain only single bonds. This can be done by grouping bonds by `molecule_id` and ensuring no bond type is anything other than 'single'. Then, for these identified molecules, I will count the number of 'O' (oxygen) atoms for each. Finally, I will calculate the average of these oxygen atom counts.\n\n-- SQL Query\n\nSELECT\n  AVG(oxygen_count)\nFROM (\n  SELECT\n    m.molecule_id,\n    SUM(CASE WHEN a.element = 'O' THEN 1 ELSE 0 END) AS oxygen_count\n  FROM molecule AS m\n  JOIN (\n    SELECT\n      molecule_id\n    FROM bond\n    GROUP BY\n      molecule_id\n    HAVING\n      COUNT(CASE WHEN bond_type != 'single' THEN 1 END) = 0\n  ) AS single_bonded_molecules\n    ON m.molecule_id = single_bonded_molecules.molecule_id\n  LEFT JOIN atom AS a\n    ON m.molecule_id = a.molecule_id\n  GROUP BY\n    m.molecule_id\n);\n",
        "pred_query": "SELECT\n  AVG(oxygen_count)\nFROM (\n  SELECT\n    m.molecule_id,\n    SUM(CASE WHEN a.element = 'O' THEN 1 ELSE 0 END) AS oxygen_count\n  FROM molecule AS m\n  JOIN (\n    SELECT\n      molecule_id\n    FROM bond\n    GROUP BY\n      molecule_id\n    HAVING\n      COUNT(CASE WHEN bond_type != 'single' THEN 1 END) = 0\n  ) AS single_bonded_molecules\n    ON m.molecule_id = single_bonded_molecules.molecule_id\n  LEFT JOIN atom AS a\n    ON m.molecule_id = a.molecule_id\n  GROUP BY\n    m.molecule_id\n);",
        "pred_time": 0.004301309585571289,
        "orig_time": 0.013063192367553711,
        "time_ratio": 3.037026772351865,
        "check": false
    },
    {
        "id": "toxicology",
        "question": "On average how many carcinogenic molecules are single bonded?",
        "original_query": "SELECT AVG(single_bond_count) FROM (SELECT T3.molecule_id, COUNT(T1.bond_type) AS single_bond_count FROM bond AS T1  INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id INNER JOIN molecule AS T3 ON T3.molecule_id = T2.molecule_id WHERE T1.bond_type = '-' AND T3.label = '+' GROUP BY T3.molecule_id) AS subquery",
        "llm_output": "-- Reasoning\nI need to first identify molecules labeled as 'carcinogenic' from the `molecule` table.\nThen, for these specific molecules, I will count the number of 'single' bonds from the `bond` table.\nFinally, I will calculate the average of these counts to answer the question.\n\n-- SQL Query\nSELECT\n  AVG(single_bond_count)\nFROM (\n  SELECT\n    T1.molecule_id,\n    COUNT(T2.bond_id) AS single_bond_count\n  FROM molecule AS T1\n  INNER JOIN bond AS T2\n    ON T1.molecule_id = T2.molecule_id\n  WHERE\n    T1.label = 'carcinogenic' AND T2.bond_type = 'single'\n  GROUP BY\n    T1.molecule_id\n);",
        "pred_query": "SELECT\n  AVG(single_bond_count)\nFROM (\n  SELECT\n    T1.molecule_id,\n    COUNT(T2.bond_id) AS single_bond_count\n  FROM molecule AS T1\n  INNER JOIN bond AS T2\n    ON T1.molecule_id = T2.molecule_id\n  WHERE\n    T1.label = 'carcinogenic' AND T2.bond_type = 'single'\n  GROUP BY\n    T1.molecule_id\n);",
        "pred_time": 0.0017015933990478516,
        "orig_time": 0.11763429641723633,
        "time_ratio": 69.13184811545467,
        "check": false
    },
    {
        "id": "toxicology",
        "question": "In the molecule containing sodium atoms, how many are non-carcinogenic?",
        "original_query": "SELECT COUNT(DISTINCT T2.molecule_id) FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.element = 'na' AND T2.label = '-'",
        "llm_output": "-- Reasoning\nTo find molecules containing sodium atoms, we query the `atom` table for `element` = 'Na'.\nTo identify non-carcinogenic molecules, we assume 'non-carcinogenic' is a specific value in the `label` column of the `molecule` table.\nWe join the `atom` and `molecule` tables on `molecule_id` and apply both conditions to filter the results. Finally, we count the distinct `molecule_id`s that meet both criteria.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.molecule_id) FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.element = 'Na' AND T2.label = 'non-carcinogenic';",
        "pred_query": "SELECT COUNT(DISTINCT T1.molecule_id) FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.element = 'Na' AND T2.label = 'non-carcinogenic';",
        "pred_time": 0.0017018318176269531,
        "orig_time": 0.0012345314025878906,
        "time_ratio": 0.7254132810311011,
        "check": false
    }
]