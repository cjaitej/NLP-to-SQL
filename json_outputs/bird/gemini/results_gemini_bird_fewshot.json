[
    {
        "id": "california_schools",
        "question": "What is the highest eligible free rate for K-12 students in the schools in Alameda County?",
        "original_query": "SELECT `Free Meal Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the highest percentage of K-12 students eligible for free meals in schools located in Alameda County. We will query the `frpm` table, filter by `County Name` for 'Alameda', and then select the maximum value from the `Percent (%) Eligible Free (K-12)` column.\n\n-- SQL Query\nSELECT MAX(`Percent (%) Eligible Free (K-12)`)\nFROM frpm\nWHERE `County Name` = 'Alameda';",
        "pred_query": "SELECT MAX(`Percent (%) Eligible Free (K-12)`)\nFROM frpm\nWHERE `County Name` = 'Alameda';",
        "pred_time": 0.004494428634643555,
        "orig_time": 0.004044294357299805,
        "time_ratio": 0.8998461620073206,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Please list the lowest three eligible free rates for students aged 5-17 in continuation schools.",
        "original_query": "SELECT `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` FROM frpm WHERE `Educational Option Type` = 'Continuation School' AND `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` IS NOT NULL ORDER BY `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` ASC LIMIT 3",
        "llm_output": "-- Reasoning\nWe need to select the 'Percent (%) Eligible Free (Ages 5-17)' from the `frpm` table. We filter for `School Type` being 'Continuation', order the results in ascending order, and limit to the top three to get the lowest rates.\n\n-- SQL Query\nSELECT `Percent (%) Eligible Free (Ages 5-17)`\nFROM frpm\nWHERE `School Type` = 'Continuation'\nORDER BY `Percent (%) Eligible Free (Ages 5-17)` ASC\nLIMIT 3;",
        "pred_query": "SELECT `Percent (%) Eligible Free (Ages 5-17)`\nFROM frpm\nWHERE `School Type` = 'Continuation'\nORDER BY `Percent (%) Eligible Free (Ages 5-17)` ASC\nLIMIT 3;",
        "pred_time": 0.004792213439941406,
        "orig_time": 0.003730297088623047,
        "time_ratio": 0.7784079601990049,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please list the zip code of all the charter schools in Fresno County Office of Education.",
        "original_query": "SELECT T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`District Name` = 'Fresno County Office of Education' AND T1.`Charter School (Y/N)` = 1",
        "llm_output": "-- Reasoning\nWe need to find the zip codes of charter schools. We will query the `schools` table, filtering for records where the `County` is 'Fresno County Office of Education' and `Charter` is set to 1 (indicating a charter school). Finally, we select the distinct `Zip` codes.\n\n-- SQL Query\nSELECT DISTINCT Zip\nFROM schools\nWHERE County = 'Fresno County Office of Education' AND Charter = 1;",
        "pred_query": "SELECT DISTINCT Zip\nFROM schools\nWHERE County = 'Fresno County Office of Education' AND Charter = 1;",
        "pred_time": 0.009634256362915039,
        "orig_time": 0.01052403450012207,
        "time_ratio": 1.0923556633423248,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the unabbreviated mailing address of the school with the highest FRPM count for K-12 students?",
        "original_query": "SELECT T2.MailStreet FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to join the `schools` table with the `frpm` table on `CDSCode`. Then, we order the results by `FRPM Count (K-12)` in descending order to find the school with the highest count. Finally, we select the mailing address components from the top result.\n\n-- SQL Query\nSELECT T1.MailStreet, T1.MailCity, T1.MailState, T1.MailZip\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nORDER BY\n  T2.`FRPM Count (K-12)` DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.MailStreet, T1.MailCity, T1.MailState, T1.MailZip\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nORDER BY\n  T2.`FRPM Count (K-12)` DESC\nLIMIT 1;",
        "pred_time": 0.02891373634338379,
        "orig_time": 0.008518218994140625,
        "time_ratio": 0.2946080331153678,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.",
        "original_query": "SELECT T2.Phone FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`Charter School (Y/N)` = 1 AND T2.OpenDate > '2000-01-01'",
        "llm_output": "-- Reasoning\nWe need to select the phone numbers from the `schools` table. The conditions are that the `FundingType` must be 'Direct Charter' and the `OpenDate` must be after '2000-01-01'.\n\n-- SQL Query\nSELECT Phone\nFROM schools\nWHERE FundingType = 'Direct Charter' AND OpenDate > '2000-01-01';",
        "pred_query": "SELECT Phone\nFROM schools\nWHERE FundingType = 'Direct Charter' AND OpenDate > '2000-01-01';",
        "pred_time": 0.009441852569580078,
        "orig_time": null,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?",
        "original_query": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400",
        "llm_output": "-- Reasoning\nWe need to count schools that satisfy two conditions: their average SAT Math score is less than 400, and they are exclusively virtual. We will join the `schools` table with the `satscores` table on `CDSCode` and `cds` respectively. Then, we filter by `AvgScrMath < 400` and `Virtual = 'Yes'` and count the distinct `CDSCode`.\n\n-- SQL Query\nSELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.AvgScrMath < 400 AND T1.Virtual = 'Yes';",
        "pred_query": "SELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.AvgScrMath < 400 AND T1.Virtual = 'Yes';",
        "pred_time": 0.009341239929199219,
        "orig_time": 0.011924505233764648,
        "time_ratio": 1.276544155181215,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.",
        "original_query": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Magnet = 1 AND T1.NumTstTakr > 500",
        "llm_output": "-- Reasoning\nWe need to combine information from the `schools` table (for school name and magnet status) and the `satscores` table (for the number of test takers). We will join these tables on `CDSCode`/`cds`. Then, we filter for schools with `NumTstTakr` greater than 500 and where the `Magnet` column in the `schools` table is 1 (indicating a magnet school or program). Finally, we select the school name.\n\n-- SQL Query\nSELECT T1.School\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.NumTstTakr > 500 AND T1.Magnet = 1;",
        "pred_query": "SELECT T1.School\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.NumTstTakr > 500 AND T1.Magnet = 1;",
        "pred_time": 0.020062685012817383,
        "orig_time": 0.00897359848022461,
        "time_ratio": 0.44727804251981607,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the phone number of the school that has the highest number of test takers with an SAT score of over 1500?",
        "original_query": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the school with the highest `NumGE1500` (number of test takers with SAT scores greater than or equal to 1500). This information is in the `satscores` table. Once we identify that school, we need to retrieve its phone number from the `schools` table. We can achieve this by joining the two tables on their respective CDS codes, ordering by `NumGE1500` in descending order, and limiting the result to one.\n\n-- SQL Query\nSELECT T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2\nON T1.CDSCode = T2.cds\nORDER BY T2.NumGE1500 DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2\nON T1.CDSCode = T2.cds\nORDER BY T2.NumGE1500 DESC\nLIMIT 1;",
        "pred_time": 0.013427019119262695,
        "orig_time": 0.002232789993286133,
        "time_ratio": 0.16629081804783635,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the number of SAT test takers of the schools with the highest FRPM count for K-12 students?",
        "original_query": "SELECT NumTstTakr FROM satscores WHERE cds = ( SELECT CDSCode FROM frpm ORDER BY `FRPM Count (K-12)` DESC LIMIT 1 )",
        "llm_output": "-- Reasoning\nWe need to find the maximum `FRPM Count (K-12)` from the `frpm` table. Then, we join the `frpm` and `satscores` tables on their common school identifier (`CDSCode` and `cds`) and filter for schools that match this maximum FRPM count. Finally, we select the `NumTstTakr` for these schools.\n\n-- SQL Query\nSELECT T2.NumTstTakr\nFROM frpm AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.`FRPM Count (K-12)` = (\n    SELECT\n      MAX(`FRPM Count (K-12)`)\n    FROM frpm\n  );",
        "pred_query": "SELECT T2.NumTstTakr\nFROM frpm AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.`FRPM Count (K-12)` = (\n    SELECT\n      MAX(`FRPM Count (K-12)`)\n    FROM frpm\n  );",
        "pred_time": 0.007724285125732422,
        "orig_time": 0.004043102264404297,
        "time_ratio": 0.5234273720600037,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Among the schools with the average score in Math over 560 in the SAT test, how many schools are directly charter-funded?",
        "original_query": "SELECT COUNT(T2.`School Code`) FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath > 560 AND T2.`Charter Funding Type` = 'Directly funded'",
        "llm_output": "-- Reasoning\nWe need to join the `schools` table with the `satscores` table using their common CDS code. We will then filter for schools where the average Math SAT score is greater than 560 and the funding type is 'Directly Funded'. Finally, we count the number of schools that meet these criteria.\n\n-- SQL Query\nSELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.AvgScrMath > 560 AND T1.FundingType = 'Directly Funded';",
        "pred_query": "SELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.AvgScrMath > 560 AND T1.FundingType = 'Directly Funded';",
        "pred_time": 0.010669469833374023,
        "orig_time": 0.004803895950317383,
        "time_ratio": 0.45024692185649484,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "For the school with the highest average score in Reading in the SAT test, what is its FRPM count for students aged 5-17?",
        "original_query": "SELECT T2.`FRPM Count (Ages 5-17)` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrRead DESC LIMIT 1",
        "llm_output": "-- Reasoning\nFirst, identify the school with the highest average reading score from the satscores table. Then, join this result with the frpm table on the CDSCode to retrieve the FRPM count for students aged 5-17 for that specific school.\n\n-- SQL Query\nSELECT T2.`FRPM Count (Ages 5-17)`\nFROM satscores AS T1\nINNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode\nORDER BY T1.AvgScrRead DESC\nLIMIT 1;",
        "pred_query": "SELECT T2.`FRPM Count (Ages 5-17)`\nFROM satscores AS T1\nINNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode\nORDER BY T1.AvgScrRead DESC\nLIMIT 1;",
        "pred_time": 0.0019876956939697266,
        "orig_time": 0.0015456676483154297,
        "time_ratio": 0.7776178481468154,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Please list the codes of the schools with a total enrollment of over 500.",
        "original_query": "SELECT T2.CDSCode FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` + T2.`Enrollment (Ages 5-17)` > 500",
        "llm_output": "-- Reasoning\nWe need to find schools with an enrollment greater than 500. The `frpm` table contains the `Enrollment (K-12)` column and `CDSCode` which uniquely identifies the school. We will filter `frpm` records where `Enrollment (K-12)` is greater than 500 and select their `CDSCode`.\n\n-- SQL Query\nSELECT CDSCode\nFROM frpm\nWHERE `Enrollment (K-12)` > 500;",
        "pred_query": "SELECT CDSCode\nFROM frpm\nWHERE `Enrollment (K-12)` > 500;",
        "pred_time": 0.007126331329345703,
        "orig_time": 0.010716438293457031,
        "time_ratio": 1.5037805286048846,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Among the schools with an SAT excellence rate of over 0.3, what is the highest eligible free rate for students aged 5-17?",
        "original_query": "SELECT MAX(CAST(T1.`Free Meal Count (Ages 5-17)` AS REAL) / T1.`Enrollment (Ages 5-17)`) FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE CAST(T2.NumGE1500 AS REAL) / T2.NumTstTakr > 0.3",
        "llm_output": "-- Reasoning\nWe need to calculate the SAT excellence rate by dividing `NumGE1500` by `NumTstTakr` from the `satscores` table. Then, we join `satscores` with `frpm` using the common `CDSCode`. We filter for schools where this rate is greater than 0.3 and select the maximum `Percent (%) Eligible Free (Ages 5-17)` from the `frpm` table.\n\n-- SQL Query\nSELECT MAX(T2.`Percent (%) Eligible Free (Ages 5-17)`)\nFROM satscores AS T1\nINNER JOIN frpm AS T2\n  ON T1.cds = T2.CDSCode\nWHERE\n  T1.NumTstTakr > 0 AND CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr > 0.3;",
        "pred_query": "SELECT MAX(T2.`Percent (%) Eligible Free (Ages 5-17)`)\nFROM satscores AS T1\nINNER JOIN frpm AS T2\n  ON T1.cds = T2.CDSCode\nWHERE\n  T1.NumTstTakr > 0 AND CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr > 0.3;",
        "pred_time": 0.004094362258911133,
        "orig_time": 0.0029790401458740234,
        "time_ratio": 0.7275956443253945,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please list the phone numbers of the schools with the top 3 SAT excellence rate.",
        "original_query": "SELECT T1.Phone FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY CAST(T2.NumGE1500 AS REAL) / T2.NumTstTakr DESC LIMIT 3",
        "llm_output": "-- Reasoning\nWe need to calculate the SAT excellence rate for each school, which can be defined as the number of students scoring 1500 or more divided by the total number of test takers. We join the `schools` and `satscores` tables on their common CDS codes, filter for valid data (where `NumGE1500` is not null and `NumTstTakr` is greater than 0), calculate the rate, order by this rate in descending order, and retrieve the phone numbers for the top 3 schools.\n\n-- SQL Query\nSELECT T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.NumGE1500 IS NOT NULL AND T2.NumTstTakr > 0\nORDER BY (CAST(T2.NumGE1500 AS REAL) * 1.0 / T2.NumTstTakr) DESC\nLIMIT 3;",
        "pred_query": "SELECT T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.NumGE1500 IS NOT NULL AND T2.NumTstTakr > 0\nORDER BY (CAST(T2.NumGE1500 AS REAL) * 1.0 / T2.NumTstTakr) DESC\nLIMIT 3;",
        "pred_time": 0.0023651123046875,
        "orig_time": 0.012670516967773438,
        "time_ratio": 5.357258064516129,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "List the top five schools, by descending order, from the highest to the lowest, the most number of Enrollment (Ages 5-17). Please give their NCES school identification number.",
        "original_query": "SELECT T1.NCESSchool FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T2.`Enrollment (Ages 5-17)` DESC LIMIT 5",
        "llm_output": "-- Reasoning\nWe need to find the NCES school identification number for the top five schools based on enrollment for ages 5-17. We can achieve this by joining the `schools` table with the `frpm` table on `CDSCode`, ordering the results by `Enrollment (Ages 5-17)` in descending order, and limiting the output to the top 5.\n\n-- SQL Query\nSELECT T1.NCESSchool\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nORDER BY\n  T2.`Enrollment (Ages 5-17)` DESC\nLIMIT 5;",
        "pred_query": "SELECT T1.NCESSchool\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nORDER BY\n  T2.`Enrollment (Ages 5-17)` DESC\nLIMIT 5;",
        "pred_time": 0.016879558563232422,
        "orig_time": 0.01580333709716797,
        "time_ratio": 0.9362411367552755,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Which active district has the highest average score in Reading?",
        "original_query": "SELECT T1.District FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.StatusType = 'Active' ORDER BY T2.AvgScrRead DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need the district name and the corresponding average reading score. Join the schools table with satscores using CDSCode, filter for active districts, sort by reading score in descending order, and return the top one.\n\n-- SQL Query\nSELECT T1.District\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.StatusType = 'Active'\nORDER BY\n  T2.AvgScrRead DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.District\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.StatusType = 'Active'\nORDER BY\n  T2.AvgScrRead DESC\nLIMIT 1;",
        "pred_time": 0.011946439743041992,
        "orig_time": 0.010048866271972656,
        "time_ratio": 0.8411599177759594,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "How many schools in merged Alameda have number of test takers less than 100?",
        "original_query": "SELECT COUNT(T1.CDSCode) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.StatusType = 'Merged' AND T2.NumTstTakr < 100 AND T1.County = 'Alameda'",
        "llm_output": "-- Reasoning\nWe need to count schools that are in Alameda county and have fewer than 100 test takers. We will join the `schools` table with the `satscores` table using their common CDSCode, filter by 'Alameda' in the `County` column, and apply the condition for `NumTstTakr` being less than 100, then count the distinct `CDSCode`s.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Alameda' AND T2.NumTstTakr < 100;",
        "pred_query": "SELECT COUNT(DISTINCT T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Alameda' AND T2.NumTstTakr < 100;",
        "pred_time": 0.009994745254516602,
        "orig_time": 0.008040189743041992,
        "time_ratio": 0.8044416879368336,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the charter number of the school that the average score in Writing is 499?",
        "original_query": "SELECT T1.CharterNum FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.AvgScrWrite = 499",
        "llm_output": "-- Reasoning\nWe need to find the charter number of a school. This information is in the `frpm` table. The condition on the average writing score is in the `satscores` table. We can join these two tables on their common CDSCode/cds column, filter for an average writing score of 499, and then select the charter number.\n\n-- SQL Query\nSELECT T1.`Charter School Number`\nFROM frpm AS T1\nINNER JOIN satscores AS T2\nON T1.CDSCode = T2.cds\nWHERE T2.AvgScrWrite = 499;",
        "pred_query": "SELECT T1.`Charter School Number`\nFROM frpm AS T1\nINNER JOIN satscores AS T2\nON T1.CDSCode = T2.cds\nWHERE T2.AvgScrWrite = 499;",
        "pred_time": 0.0012552738189697266,
        "orig_time": 0.0007884502410888672,
        "time_ratio": 0.6281101614434947,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "How many schools in Contra Costa (directly funded) have number of test takers not more than 250?",
        "original_query": "SELECT COUNT(T1.CDSCode) FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`County Name` = 'Contra Costa' AND T2.NumTstTakr <= 250",
        "llm_output": "-- Reasoning\nWe need to count schools that satisfy specific conditions. First, join the `schools` table with `satscores` on their common CDSCode/cds column. Then, filter the results for schools in 'Contra Costa' county, with 'Directly Funded' funding type, and where the number of test takers is less than or equal to 250. Finally, count the distinct schools that meet all criteria.\n\n-- SQL Query\nSELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Contra Costa' AND T1.FundingType = 'Directly Funded' AND T2.NumTstTakr <= 250;",
        "pred_query": "SELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Contra Costa' AND T1.FundingType = 'Directly Funded' AND T2.NumTstTakr <= 250;",
        "pred_time": 0.009365558624267578,
        "orig_time": 0.0038645267486572266,
        "time_ratio": 0.41263173972811973,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the phone number of the school that has the highest average score in Math?",
        "original_query": "SELECT T1.Phone FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the phone number of the school with the highest average Math score. We can achieve this by joining the `schools` table with the `satscores` table on their common CDSCode/cds, ordering the results by `AvgScrMath` in descending order, and then selecting the phone number of the top record.\n\n-- SQL Query\nSELECT T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nORDER BY T2.AvgScrMath DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nORDER BY T2.AvgScrMath DESC\nLIMIT 1;",
        "pred_time": 0.01173710823059082,
        "orig_time": 0.009649991989135742,
        "time_ratio": 0.8221779845213187,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "How many schools in Amador which the Low Grade is 9 and the High Grade is 12?",
        "original_query": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12",
        "llm_output": "-- Reasoning\nWe need to count the number of schools that meet the given criteria. All necessary information is present in the `frpm` table. We will filter rows where `County Name` is 'Amador', `Low Grade` is '9', and `High Grade` is '12', then count the distinct `CDSCode` or `School Name`.\n\n-- SQL Query\nSELECT COUNT(DISTINCT `School Name`)\nFROM frpm\nWHERE `County Name` = 'Amador'\n  AND `Low Grade` = '9'\n  AND `High Grade` = '12';",
        "pred_query": "SELECT COUNT(DISTINCT `School Name`)\nFROM frpm\nWHERE `County Name` = 'Amador'\n  AND `Low Grade` = '9'\n  AND `High Grade` = '12';",
        "pred_time": 0.005992889404296875,
        "orig_time": 0.013703584671020508,
        "time_ratio": 2.2866406747294716,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12?",
        "original_query": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `Free Meal Count (K-12)` < 700",
        "llm_output": "-- Reasoning\nWe need to count the number of schools in the 'Los Angeles' county that satisfy two conditions: `Free Meal Count (K-12)` is greater than 500 and `FRPM Count (K-12)` is less than 700. All necessary columns are available in the `frpm` table.\n\n-- SQL Query\nSELECT COUNT(CDSCode)\nFROM frpm\nWHERE `County Name` = 'Los Angeles'\n  AND `Free Meal Count (K-12)` > 500\n  AND `FRPM Count (K-12)` < 700;",
        "pred_query": "SELECT COUNT(CDSCode)\nFROM frpm\nWHERE `County Name` = 'Los Angeles'\n  AND `Free Meal Count (K-12)` > 500\n  AND `FRPM Count (K-12)` < 700;",
        "pred_time": 0.004765033721923828,
        "orig_time": 0.00398564338684082,
        "time_ratio": 0.8364355048533973,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which school in Contra Costa has the highest number of test takers?",
        "original_query": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND sname IS NOT NULL ORDER BY NumTstTakr DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need the school name from the `schools` table and the number of test takers from the `satscores` table. We join these tables using their common CDSCode/cds identifier. Then, we filter for schools located in 'Contra Costa' county, order the results by the number of test takers in descending order, and retrieve the school name from the top record.\n\n-- SQL Query\nSELECT T1.School\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Contra Costa'\nORDER BY\n  T2.NumTstTakr DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.School\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Contra Costa'\nORDER BY\n  T2.NumTstTakr DESC\nLIMIT 1;",
        "pred_time": 0.010444879531860352,
        "orig_time": 0.0008771419525146484,
        "time_ratio": 0.08397817799995434,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools.",
        "original_query": "SELECT T1.School, T1.StreetAbr FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30",
        "llm_output": "-- Reasoning\nWe need to join the `frpm` table with the `schools` table using `CDSCode` to get both enrollment data and address information. We then calculate the absolute difference between `Enrollment (K-12)` and `Enrollment (Ages 5-17)` from the `frpm` table. Finally, we filter for schools where this difference is greater than 30 and select the school name and construct the full street address using Street, City, and Zip from the `schools` table.\n\n-- SQL Query\nSELECT\n  T1.`School Name`,\n  T2.Street || ', ' || T2.City || ', ' || T2.Zip\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  ABS(T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > 30;",
        "pred_query": "SELECT\n  T1.`School Name`,\n  T2.Street || ', ' || T2.City || ', ' || T2.Zip\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  ABS(T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > 30;",
        "pred_time": 0.00831913948059082,
        "orig_time": null,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500?",
        "original_query": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS REAL) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0",
        "llm_output": "-- Reasoning\nWe need to join the `frpm` and `satscores` tables using their common CDSCode. Then, we filter the results based on two conditions: the percentage of eligible free meals in K-12 being greater than 0.1 and the number of test takers scoring 1500 or more being greater than 0. Finally, we select the school names.\n\n-- SQL Query\nSELECT T1.`School Name`\nFROM frpm AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.`Percent (%) Eligible Free (K-12)` > 0.1\n  AND T2.NumGE1500 > 0;",
        "pred_query": "SELECT T1.`School Name`\nFROM frpm AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.`Percent (%) Eligible Free (K-12)` > 0.1\n  AND T2.NumGE1500 > 0;",
        "pred_time": 0.007172822952270508,
        "orig_time": 0.004283428192138672,
        "time_ratio": 0.5971746717633372,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools?",
        "original_query": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / COUNT(T1.cds) > 400",
        "llm_output": "-- Reasoning\nWe need to join the `schools` table with the `satscores` table using the `CDSCode`. We will filter for schools located in 'Riverside' county and where the average SAT math score is greater than 400. Finally, we select the school name and its funding type.\n\n-- SQL Query\nSELECT T1.School, T1.FundingType\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.County = 'Riverside' AND T2.AvgScrMath > 400;",
        "pred_query": "SELECT T1.School, T1.FundingType\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.County = 'Riverside' AND T2.AvgScrMath > 400;",
        "pred_time": null,
        "orig_time": 0.003663301467895508,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17?",
        "original_query": "SELECT T1.`School Name`, T2.Zip, T2.Street, T2.City, T2.State FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'",
        "llm_output": "-- Reasoning\nWe need to find high schools in Monterey County. We can identify high schools by checking the `High Grade` column in the `frpm` table for '12'. We join the `schools` table with the `frpm` table on `CDSCode`. We filter for schools in 'Monterey' county and where the `FRPM Count (Ages 5-17)` is greater than 800. Finally, we select the school name and its mailing address details.\n\n-- SQL Query\nSELECT\n  T1.School,\n  T1.MailStreet,\n  T1.MailCity,\n  T1.MailState,\n  T1.MailZip\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.County = 'Monterey' AND T2.`High Grade` = '12' AND T2.`FRPM Count (Ages 5-17)` > 800;",
        "pred_query": "SELECT\n  T1.School,\n  T1.MailStreet,\n  T1.MailCity,\n  T1.MailState,\n  T1.MailZip\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.County = 'Monterey' AND T2.`High Grade` = '12' AND T2.`FRPM Count (Ages 5-17)` > 800;",
        "pred_time": 0.009100198745727539,
        "orig_time": 0.007738351821899414,
        "time_ratio": 0.8503497602766643,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any.",
        "original_query": "SELECT T2.School, T1.AvgScrWrite, T2.Phone, strftime('%Y', T2.OpenDate), strftime('%Y', T2.ClosedDate) FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE strftime('%Y', T2.OpenDate) > '1991' AND strftime('%Y', T2.ClosedDate) < '2000'",
        "llm_output": "-- Reasoning\nWe need to join the `schools` table with the `satscores` table using `CDSCode`. Then, we filter for schools where their `OpenDate` is after 1991 (meaning the year part of `OpenDate` is greater than 1991) OR their `ClosedDate` is before 2000 (meaning the year part of `ClosedDate` is less than 2000). Finally, we select the school name, average writing score, and phone number for these filtered schools.\n\n-- SQL Query\nSELECT\n  T1.School,\n  T2.AvgScrWrite,\n  T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  STRFTIME('%Y', T1.OpenDate) > '1991' OR STRFTIME('%Y', T1.ClosedDate) < '2000';",
        "pred_query": "SELECT\n  T1.School,\n  T2.AvgScrWrite,\n  T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  STRFTIME('%Y', T1.OpenDate) > '1991' OR STRFTIME('%Y', T1.ClosedDate) < '2000';",
        "pred_time": null,
        "orig_time": 0.010821342468261719,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average.",
        "original_query": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')",
        "llm_output": "-- Reasoning\nFirst, calculate the average enrollment difference (K-12 enrollment minus 5-17 enrollment) for all 'Locally Funded' schools by joining `frpm` and `schools` tables. Then, select the school name and DOC type from 'Locally Funded' schools where their individual enrollment difference exceeds this calculated average.\n\n-- SQL Query\nSELECT T1.School, T1.DOCType\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.FundingType = 'Locally Funded' AND (T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\") > (\n    SELECT AVG(T3.\"Enrollment (K-12)\" - T3.\"Enrollment (Ages 5-17)\")\n    FROM frpm AS T3\n    INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode\n    WHERE T4.FundingType = 'Locally Funded'\n);",
        "pred_query": "SELECT T1.School, T1.DOCType\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.FundingType = 'Locally Funded' AND (T2.\"Enrollment (K-12)\" - T2.\"Enrollment (Ages 5-17)\") > (\n    SELECT AVG(T3.\"Enrollment (K-12)\" - T3.\"Enrollment (Ages 5-17)\")\n    FROM frpm AS T3\n    INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode\n    WHERE T4.FundingType = 'Locally Funded'\n);",
        "pred_time": 0.009213685989379883,
        "orig_time": 0.017455577850341797,
        "time_ratio": 1.8945271057057833,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "When did the first-through-twelfth-grade school with the largest enrollment open?",
        "original_query": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the school with the largest 'Enrollment (K-12)' from the 'frpm' table. Once we identify that school's CDSCode, we can join with the 'schools' table to retrieve its 'OpenDate'.\n\n-- SQL Query\nSELECT T2.OpenDate\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nORDER BY T1.`Enrollment (K-12)` DESC\nLIMIT 1;",
        "pred_query": "SELECT T2.OpenDate\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nORDER BY T1.`Enrollment (K-12)` DESC\nLIMIT 1;",
        "pred_time": 0.00876617431640625,
        "orig_time": 0.0073604583740234375,
        "time_ratio": 0.8396431679721497,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Which cities have the top 5 lowest enrollment number for students in grades 1 through 12?",
        "original_query": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5",
        "llm_output": "-- Reasoning\nWe need to find cities corresponding to schools with the lowest enrollment in grades K-12. We join the `schools` table with the `frpm` table using `CDSCode`. We then filter out null enrollment values, order the results by `Enrollment (K-12)` in ascending order, take the top 5, and ensure distinct city names are returned.\n\n-- SQL Query\nSELECT DISTINCT T1.City\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.\"Enrollment (K-12)\" IS NOT NULL\nORDER BY T2.\"Enrollment (K-12)\" ASC\nLIMIT 5;",
        "pred_query": "SELECT DISTINCT T1.City\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.\"Enrollment (K-12)\" IS NOT NULL\nORDER BY T2.\"Enrollment (K-12)\" ASC\nLIMIT 5;",
        "pred_time": 0.01703810691833496,
        "orig_time": 0.01481771469116211,
        "time_ratio": 0.8696808138477254,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12?",
        "original_query": "SELECT CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 9, 2",
        "llm_output": "-- Reasoning\nWe need to retrieve the 'Percent (%) Eligible Free (K-12)' from the `frpm` table. First, we order the schools by `Enrollment (K-12)` in descending order to find those with the highest enrollment. Then, we use `LIMIT` and `OFFSET` to select the 10th and 11th entries in this sorted list.\n\n-- SQL Query\nSELECT `Percent (%) Eligible Free (K-12)`\nFROM frpm\nORDER BY `Enrollment (K-12)` DESC\nLIMIT 2 OFFSET 9;",
        "pred_query": "SELECT `Percent (%) Eligible Free (K-12)`\nFROM frpm\nORDER BY `Enrollment (K-12)` DESC\nLIMIT 2 OFFSET 9;",
        "pred_time": 0.0057408809661865234,
        "orig_time": 0.004492998123168945,
        "time_ratio": 0.7826321691100129,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66?",
        "original_query": "SELECT CAST(T1.`FRPM Count (K-12)` AS REAL) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5",
        "llm_output": "-- Reasoning\nWe need to find the free or reduced price meal rate. This corresponds to the `Percent (%) Eligible FRPM (K-12)` column in the `frpm` table. The selection criteria involve joining `frpm` with `schools` on `CDSCode` to filter schools by their ownership code (`SOC`) which must be '66'. We then sort these schools by `FRPM Count (K-12)` in descending order to identify the top 5 schools with the highest counts. Finally, we select the desired percentage rate for these top 5 schools.\n\n-- SQL Query\nSELECT T1.`Percent (%) Eligible FRPM (K-12)`\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.SOC = '66'\nORDER BY T1.`FRPM Count (K-12)` DESC\nLIMIT 5;",
        "pred_query": "SELECT T1.`Percent (%) Eligible FRPM (K-12)`\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.SOC = '66'\nORDER BY T1.`FRPM Count (K-12)` DESC\nLIMIT 5;",
        "pred_time": 0.013664722442626953,
        "orig_time": 0.011046648025512695,
        "time_ratio": 0.808406323062428,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school.",
        "original_query": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND T2.Website IS NOT NULL",
        "llm_output": "-- Reasoning\nWe need to find schools with a specific free meal count. We will join the `frpm` table with the `schools` table using `CDSCode`. Then, filter the results for `Free Meal Count (Ages 5-17)` between 1900 and 2000, and select the school name and its website.\n\n-- SQL Query\nSELECT T1.School, T1.Website\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.`Free Meal Count (Ages 5-17)` >= 1900 AND T2.`Free Meal Count (Ages 5-17)` <= 2000;",
        "pred_query": "SELECT T1.School, T1.Website\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.`Free Meal Count (Ages 5-17)` >= 1900 AND T2.`Free Meal Count (Ages 5-17)` <= 2000;",
        "pred_time": 0.005265235900878906,
        "orig_time": 0.0035872459411621094,
        "time_ratio": 0.6813077341061402,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson?",
        "original_query": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS REAL) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'",
        "llm_output": "-- Reasoning\nWe need to find the free rate for students aged 5-17. This information is available in the `frpm` table under the column `Percent (%) Eligible Free (Ages 5-17)`. The school is identified by the administrator's name, Kacey Gibson, which is stored in the `schools` table. We will join `schools` and `frpm` tables using `CDSCode`, filter by the administrator's name, and then select the required percentage.\n\n-- SQL Query\nSELECT T2.`Percent (%) Eligible Free (Ages 5-17)`\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  (\n    T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\n  )\n  OR (\n    T1.AdmFName2 = 'Kacey' AND T1.AdmLName2 = 'Gibson'\n  )\n  OR (\n    T1.AdmFName3 = 'Kacey' AND T1.AdmLName3 = 'Gibson'\n  );",
        "pred_query": "SELECT T2.`Percent (%) Eligible Free (Ages 5-17)`\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  (\n    T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'\n  )\n  OR (\n    T1.AdmFName2 = 'Kacey' AND T1.AdmLName2 = 'Gibson'\n  )\n  OR (\n    T1.AdmFName3 = 'Kacey' AND T1.AdmLName3 = 'Gibson'\n  );",
        "pred_time": 0.011344432830810547,
        "orig_time": 0.008405685424804688,
        "time_ratio": 0.7409524610146694,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12?",
        "original_query": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the administrator's email address for a chartered school with the lowest enrollment in grades K-12 (as a proxy for 1-12, given `Enrollment (K-12)` is the most relevant enrollment column). We join the `schools` table with the `frpm` table using `CDSCode`, filter for chartered schools, order by `Enrollment (K-12)` in ascending order, and limit the result to one to get the school with the fewest students, then select its primary administrator's email.\n\n-- SQL Query\nSELECT T1.AdmEmail1\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.Charter = 1 AND T2.`Enrollment (K-12)` IS NOT NULL\nORDER BY\n  T2.`Enrollment (K-12)` ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.AdmEmail1\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.Charter = 1 AND T2.`Enrollment (K-12)` IS NOT NULL\nORDER BY\n  T2.`Enrollment (K-12)` ASC\nLIMIT 1;",
        "pred_time": 0.012368917465209961,
        "orig_time": 0.004932880401611328,
        "time_ratio": 0.39881262167736464,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Under whose administration does the school with the highest number of test takers whose total SAT Scores are greater or equal to 1500 belong to? Indicate his or her full name.",
        "original_query": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the school with the highest `NumGE1500` from the `satscores` table. Then, we join this with the `schools` table using `CDSCode` to retrieve the first administrator's first and last name (`AdmFName1`, `AdmLName1`).\n\n-- SQL Query\nSELECT T1.AdmFName1, T1.AdmLName1\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nORDER BY T2.NumGE1500 DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.AdmFName1, T1.AdmLName1\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nORDER BY T2.NumGE1500 DESC\nLIMIT 1;",
        "pred_time": 0.012630462646484375,
        "orig_time": 0.0021126270294189453,
        "time_ratio": 0.16726442162488675,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State.",
        "original_query": "SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the school with the lowest \"excellence rate\". Based on the `satscores` table, `NumGE1500` (Number of test takers scoring greater than or equal to 1500) can be considered a proxy for excellence. We will find the school with the minimum `NumGE1500` value. Then, we join the `satscores` table with the `schools` table using their common CDS codes to retrieve the address details (Street, City, Zip, State) for that specific school. We order by `NumGE1500` in ascending order and take the first result.\n\n-- SQL Query\nSELECT T1.Street, T1.City, T1.Zip, T1.State\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.NumGE1500 IS NOT NULL\nORDER BY\n  T2.NumGE1500 ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.Street, T1.City, T1.Zip, T1.State\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.NumGE1500 IS NOT NULL\nORDER BY\n  T2.NumGE1500 ASC\nLIMIT 1;",
        "pred_time": 0.0026814937591552734,
        "orig_time": 0.0020401477813720703,
        "time_ratio": 0.7608251089179336,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers?",
        "original_query": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'",
        "llm_output": "-- Reasoning\nWe need to find the website of a school. We will join the `schools` table with `satscores` using `CDSCode` and `cds`. We will filter for schools in 'Los Angeles' county and those that have between 2000 and 3000 test takers.\n\n-- SQL Query\nSELECT T1.Website\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;",
        "pred_query": "SELECT T1.Website\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Los Angeles' AND T2.NumTstTakr BETWEEN 2000 AND 3000;",
        "pred_time": 0.010241985321044922,
        "orig_time": 0.00833272933959961,
        "time_ratio": 0.8135853624470413,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980?",
        "original_query": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) = '1980' AND T2.County = 'Fresno'",
        "llm_output": "-- Reasoning\nWe need to join the `schools` table with the `satscores` table on their common CDSCode/cds column. Then, we filter the schools by 'Fresno' county and an opening date within the year 1980. Finally, we calculate the average of `NumTstTakr` from the filtered results.\n\n-- SQL Query\nSELECT AVG(T2.NumTstTakr)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Fresno' AND STRFTIME('%Y', T1.OpenDate) = '1980';",
        "pred_query": "SELECT AVG(T2.NumTstTakr)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.County = 'Fresno' AND STRFTIME('%Y', T1.OpenDate) = '1980';",
        "pred_time": 0.009748458862304688,
        "orig_time": 0.01149296760559082,
        "time_ratio": 1.1789522598317355,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the telephone number for the school with the lowest average score in reading in Fresno Unified?",
        "original_query": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need the phone number of a school. We will join the `schools` table (for phone number and district name) with the `satscores` table (for average reading score) using their common CDSCode. We then filter for schools in the 'Fresno Unified' district, order the results by `AvgScrRead` in ascending order to find the lowest score, and finally limit to 1 to get the phone number of that specific school.\n\n-- SQL Query\nSELECT T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.District = 'Fresno Unified'\nORDER BY\n  T2.AvgScrRead ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.District = 'Fresno Unified'\nORDER BY\n  T2.AvgScrRead ASC\nLIMIT 1;",
        "pred_time": 0.009680747985839844,
        "orig_time": 0.008501768112182617,
        "time_ratio": 0.878213969067087,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which exclusively virtual schools have the top 5 highest average reading scores?",
        "original_query": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' ORDER BY T1.AvgScrRead DESC LIMIT 5",
        "llm_output": "-- Reasoning\nWe need to join the `schools` table with the `satscores` table on `CDSCode` and `cds` respectively. Then, filter for schools where the `Virtual` column is 'Exclusively Virtual'. Finally, order the results by `AvgScrRead` in descending order and limit to the top 5 school names.\n\n-- SQL Query\nSELECT T1.School\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.Virtual = 'Exclusively Virtual'\nORDER BY\n  T2.AvgScrRead DESC\nLIMIT 5;",
        "pred_query": "SELECT T1.School\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.Virtual = 'Exclusively Virtual'\nORDER BY\n  T2.AvgScrRead DESC\nLIMIT 5;",
        "pred_time": 0.010996818542480469,
        "orig_time": 0.009491205215454102,
        "time_ratio": 0.8630864625791345,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the type of education offered in the school who scored the highest average in Math?",
        "original_query": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the school with the highest average math score and then retrieve its educational option type. We can achieve this by joining the `schools` table with the `satscores` table using their common CDSCode. Then, we order the results by `AvgScrMath` in descending order and select the `EdOpsName` from the top record.\n\n-- SQL Query\nSELECT T1.EdOpsName\nFROM schools AS T1\nINNER JOIN satscores AS T2\nON T1.CDSCode = T2.cds\nORDER BY T2.AvgScrMath DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.EdOpsName\nFROM schools AS T1\nINNER JOIN satscores AS T2\nON T1.CDSCode = T2.cds\nORDER BY T2.AvgScrMath DESC\nLIMIT 1;",
        "pred_time": 0.012202024459838867,
        "orig_time": 0.0020177364349365234,
        "time_ratio": 0.16536079251255398,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the average math score of the school with the lowest average score for all subjects, and in which county is it located?",
        "original_query": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath IS NOT NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the school with the lowest combined score across reading, math, and writing. The `satscores` table contains all the necessary score data and the county name (`cname`). We sum the three average scores, filter out records where any score is null to ensure a meaningful comparison, order by this sum in ascending order, and limit to the top one. Finally, we select the `AvgScrMath` and `cname` for that school.\n\n-- SQL Query\nSELECT T1.AvgScrMath, T1.cname\nFROM satscores AS T1\nWHERE T1.AvgScrRead IS NOT NULL\n  AND T1.AvgScrMath IS NOT NULL\n  AND T1.AvgScrWrite IS NOT NULL\nORDER BY (T1.AvgScrRead + T1.AvgScrMath + T1.AvgScrWrite) ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.AvgScrMath, T1.cname\nFROM satscores AS T1\nWHERE T1.AvgScrRead IS NOT NULL\n  AND T1.AvgScrMath IS NOT NULL\n  AND T1.AvgScrWrite IS NOT NULL\nORDER BY (T1.AvgScrRead + T1.AvgScrMath + T1.AvgScrWrite) ASC\nLIMIT 1;",
        "pred_time": 0.0015177726745605469,
        "orig_time": 0.0018985271453857422,
        "time_ratio": 1.2508639648130695,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated.",
        "original_query": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the school with the highest number of test takers who scored 1500 or more on the SAT. This information is available in the `satscores` table using the `NumGE1500` column. We will join `satscores` with the `schools` table on their common CDSCode/cds identifier to retrieve the average writing score and the city of that school. We order the results by `NumGE1500` in descending order and limit to the top entry.\n\n-- SQL Query\nSELECT T2.AvgScrWrite, T1.City\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nORDER BY\n  T2.NumGE1500 DESC\nLIMIT 1;",
        "pred_query": "SELECT T2.AvgScrWrite, T1.City\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nORDER BY\n  T2.NumGE1500 DESC\nLIMIT 1;",
        "pred_time": 0.011800050735473633,
        "orig_time": 0.002123594284057617,
        "time_ratio": 0.1799648435132241,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores.",
        "original_query": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'",
        "llm_output": "-- Reasoning\nWe need to join the `schools` table with the `satscores` table using `CDSCode` and `cds` respectively. We filter the `schools` table to find those managed by 'Ricci Ulrich' by checking the administrator first and last names. Finally, we select the school name and its average writing score.\n\n-- SQL Query\nSELECT T1.School, T2.AvgScrWrite\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE (T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich')\n   OR (T1.AdmFName2 = 'Ricci' AND T1.AdmLName2 = 'Ulrich')\n   OR (T1.AdmFName3 = 'Ricci' AND T1.AdmLName3 = 'Ulrich');",
        "pred_query": "SELECT T1.School, T2.AvgScrWrite\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE (T1.AdmFName1 = 'Ricci' AND T1.AdmLName1 = 'Ulrich')\n   OR (T1.AdmFName2 = 'Ricci' AND T1.AdmLName2 = 'Ulrich')\n   OR (T1.AdmFName3 = 'Ricci' AND T1.AdmLName3 = 'Ulrich');",
        "pred_time": 0.011314630508422852,
        "orig_time": 0.00839543342590332,
        "time_ratio": 0.7419980192595402,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Which state special schools have the highest number of enrollees from grades 1 through 12?",
        "original_query": "SELECT T2.School FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.DOC = 31 ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find schools that are classified as 'State Special School' from the `frpm` table. Then, we identify the one with the highest `Enrollment (K-12)` and return its `School Name`.\n\n-- SQL Query\nSELECT `School Name`\nFROM frpm\nWHERE `School Type` = 'State Special School'\nORDER BY `Enrollment (K-12)` DESC\nLIMIT 1;",
        "pred_query": "SELECT `School Name`\nFROM frpm\nWHERE `School Type` = 'State Special School'\nORDER BY `Enrollment (K-12)` DESC\nLIMIT 1;",
        "pred_time": 0.004769802093505859,
        "orig_time": 0.01006007194519043,
        "time_ratio": 2.109117264820554,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the monthly average number of schools that opened in Alameda County under the jurisdiction of the Elementary School District in 1980?",
        "original_query": "SELECT CAST(COUNT(School) AS REAL) / 12 FROM schools WHERE DOC = 52 AND County = 'Alameda' AND strftime('%Y', OpenDate) = '1980'",
        "llm_output": "-- Reasoning\nWe need to filter the 'schools' table by 'Alameda' county, 'Elementary School District' type, and 'OpenDate' in the year 1980. We then count the schools for each month within that year and finally calculate the average of these monthly counts.\n\n-- SQL Query\nSELECT AVG(SchoolsOpened)\nFROM (\n    SELECT COUNT(CDSCode) AS SchoolsOpened\n    FROM schools\n    WHERE County = 'ALAMEDA'\n      AND DOCType = 'Elementary School District'\n      AND STRFTIME('%Y', OpenDate) = '1980'\n    GROUP BY STRFTIME('%m', OpenDate)\n);",
        "pred_query": "SELECT AVG(SchoolsOpened)\nFROM (\n    SELECT COUNT(CDSCode) AS SchoolsOpened\n    FROM schools\n    WHERE County = 'ALAMEDA'\n      AND DOCType = 'Elementary School District'\n      AND STRFTIME('%Y', OpenDate) = '1980'\n    GROUP BY STRFTIME('%m', OpenDate)\n);",
        "pred_time": 0.009542226791381836,
        "orig_time": 0.00878286361694336,
        "time_ratio": 0.9204207580641132,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the ratio of merged Unified School District schools in Orange County to merged Elementary School District schools?",
        "original_query": "SELECT CAST(SUM(CASE WHEN DOC = 54 THEN 1 ELSE 0 END) AS REAL) / SUM(CASE WHEN DOC = 52 THEN 1 ELSE 0 END) FROM schools WHERE StatusType = 'Merged' AND County = 'Orange'",
        "llm_output": "-- Reasoning\nWe need to calculate two counts from the `schools` table:\n1. The number of schools with `StatusType` 'Merged', `County` 'Orange', and `DOCType` 'Unified'.\n2. The number of schools with `StatusType` 'Merged' and `DOCType` 'Elementary'.\nFinally, we divide the first count by the second count to get the desired ratio.\n\n-- SQL Query\nSELECT\n  CAST(SUM(CASE WHEN StatusType = 'Merged' AND County = 'Orange' AND DOCType = 'Unified' THEN 1 ELSE 0 END) AS REAL) /\n  SUM(CASE WHEN StatusType = 'Merged' AND DOCType = 'Elementary' THEN 1 ELSE 0 END)\nFROM schools;",
        "pred_query": "SELECT\n  CAST(SUM(CASE WHEN StatusType = 'Merged' AND County = 'Orange' AND DOCType = 'Unified' THEN 1 ELSE 0 END) AS REAL) /\n  SUM(CASE WHEN StatusType = 'Merged' AND DOCType = 'Elementary' THEN 1 ELSE 0 END)\nFROM schools;",
        "pred_time": 0.009885311126708984,
        "orig_time": 0.007573843002319336,
        "time_ratio": 0.7661714340842217,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which different county has the most number of closed schools? Please provide the name of each school as well as the closure date.",
        "original_query": "SELECT DISTINCT County, School, ClosedDate FROM schools WHERE County = ( SELECT County FROM schools WHERE StatusType = 'Closed' GROUP BY County ORDER BY COUNT(School) DESC LIMIT 1 ) AND StatusType = 'Closed' AND school IS NOT NULL",
        "llm_output": "-- Reasoning\nFirst, we need to identify the county that has the highest number of closed schools. To do this, we filter the `schools` table for `StatusType = 'Closed'`, group the results by `County`, count the schools in each county, and then order by this count in descending order to get the top county.\nOnce we have identified this county, we select the `School` name and `ClosedDate` for all schools within that specific county that are marked as 'Closed'.\n\n-- SQL Query\nSELECT School, ClosedDate\nFROM schools\nWHERE StatusType = 'Closed' AND County = (\n    SELECT County\n    FROM schools\n    WHERE StatusType = 'Closed'\n    GROUP BY County\n    ORDER BY COUNT(CDSCode) DESC\n    LIMIT 1\n);",
        "pred_query": "SELECT School, ClosedDate\nFROM schools\nWHERE StatusType = 'Closed' AND County = (\n    SELECT County\n    FROM schools\n    WHERE StatusType = 'Closed'\n    GROUP BY County\n    ORDER BY COUNT(CDSCode) DESC\n    LIMIT 1\n);",
        "pred_time": null,
        "orig_time": 0.015883684158325195,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the postal street address for the school with the 6th highest Math average? Indicate the school's name.",
        "original_query": "SELECT T2.MailStreet, T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 5, 1",
        "llm_output": "-- Reasoning\nWe need to join the schools table with the satscores table on CDSCode to link school information with SAT scores. Then, we order the results by the average Math score in descending order and use LIMIT and OFFSET to retrieve the 6th highest score. Finally, we select the street address and school name.\n\n-- SQL Query\nSELECT T1.Street, T1.School\nFROM schools AS T1\nINNER JOIN satscores AS T2\nON T1.CDSCode = T2.cds\nORDER BY T2.AvgScrMath DESC\nLIMIT 1 OFFSET 5;",
        "pred_query": "SELECT T1.Street, T1.School\nFROM schools AS T1\nINNER JOIN satscores AS T2\nON T1.CDSCode = T2.cds\nORDER BY T2.AvgScrMath DESC\nLIMIT 1 OFFSET 5;",
        "pred_time": 0.012606382369995117,
        "orig_time": 0.002281665802001953,
        "time_ratio": 0.18099290780141844,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "In which mailing street address can you find the school that has the lowest average score in reading? Also give the school's name.",
        "original_query": "SELECT T2.MailStreet, T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the school with the lowest average reading score. This requires joining the `schools` table with `satscores` on their common CDSCode/cds column. We will order the results by `AvgScrRead` in ascending order to get the lowest score, limit to one result, and select the `MailStreet` and `School` name from the `schools` table.\n\n-- SQL Query\nSELECT T1.MailStreet, T1.School\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nORDER BY T2.AvgScrRead ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.MailStreet, T1.School\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nORDER BY T2.AvgScrRead ASC\nLIMIT 1;",
        "pred_time": 0.01202249526977539,
        "orig_time": 0.0021026134490966797,
        "time_ratio": 0.17488993773053582,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the total number of schools whose total SAT scores are greater or equal to 1500 whose mailing city is Lakeport?",
        "original_query": "SELECT COUNT(T1.cds) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.MailCity = 'Lakeport' AND (T1.AvgScrRead + T1.AvgScrMath + T1.AvgScrWrite) >= 1500",
        "llm_output": "-- Reasoning\nWe need to count schools that satisfy two conditions: their mailing city is 'Lakeport' and they have at least one student whose total SAT score is greater than or equal to 1500. We can achieve this by joining the `schools` and `satscores` tables on `CDSCode` and `cds`, then filtering by `MailCity = 'Lakeport'` and `NumGE1500 >= 1`, and finally counting the distinct schools.\n\n-- SQL Query\nSELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.MailCity = 'Lakeport' AND T2.NumGE1500 >= 1;",
        "pred_query": "SELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T1.MailCity = 'Lakeport' AND T2.NumGE1500 >= 1;",
        "pred_time": 0.009345769882202148,
        "orig_time": 0.007733583450317383,
        "time_ratio": 0.8274955993775351,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "How many test takers are there at the school/s whose mailing city address is in Fresno?",
        "original_query": "SELECT T1.NumTstTakr FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.MailCity = 'Fresno'",
        "llm_output": "-- Reasoning\nWe need to join the `schools` table with the `satscores` table using their common CDSCode. Then, we filter for schools where the mailing city is 'Fresno' and sum the number of test takers from the `satscores` table.\n\n-- SQL Query\nSELECT SUM(T2.NumTstTakr)\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.MailCity = 'Fresno';",
        "pred_query": "SELECT SUM(T2.NumTstTakr)\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.MailCity = 'Fresno';",
        "pred_time": 0.010059356689453125,
        "orig_time": 0.007926702499389648,
        "time_ratio": 0.7879929844520288,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please specify all of the schools and their related mailing zip codes that are under Avetik Atoian's administration.",
        "original_query": "SELECT School, MailZip FROM schools WHERE AdmFName1 = 'Avetik' AND AdmLName1 = 'Atoian'",
        "llm_output": "-- Reasoning\nWe need to find schools administered by a specific person. We will query the `schools` table, filtering by the administrator's first and last names (AdmFName1 and AdmLName1). From the filtered results, we will select the school name and its mailing zip code.\n\n-- SQL Query\nSELECT School, MailZip\nFROM schools\nWHERE AdmFName1 = 'Avetik' AND AdmLName1 = 'Atoian';",
        "pred_query": "SELECT School, MailZip\nFROM schools\nWHERE AdmFName1 = 'Avetik' AND AdmLName1 = 'Atoian';",
        "pred_time": 0.010990142822265625,
        "orig_time": 0.008338212966918945,
        "time_ratio": 0.7586992363762582,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Of the schools with a mailing state address in California, what is the ratio of the schools located in the county of Colusa against the school located in the county of Humboldt?",
        "original_query": "SELECT CAST(SUM(CASE WHEN County = 'Colusa' THEN 1 ELSE 0 END) AS REAL) / SUM(CASE WHEN County = 'Humboldt' THEN 1 ELSE 0 END) FROM schools WHERE MailState = 'CA'",
        "llm_output": "-- Reasoning\nWe need to count the number of schools in 'COLUSA' county and 'HUMBOLDT' county, specifically for schools whose mailing state is 'CA'. Then, we will divide the count for Colusa by the count for Humboldt to get the ratio. We can use subqueries or conditional aggregation for counting. Conditional aggregation with `SUM(CASE WHEN ... THEN 1 ELSE 0 END)` is efficient.\n\n-- SQL Query\nSELECT\n  CAST(SUM(CASE WHEN County = 'COLUSA' THEN 1 ELSE 0 END) AS REAL) /\n  SUM(CASE WHEN County = 'HUMBOLDT' THEN 1 ELSE 0 END)\nFROM schools\nWHERE MailState = 'CA';",
        "pred_query": "SELECT\n  CAST(SUM(CASE WHEN County = 'COLUSA' THEN 1 ELSE 0 END) AS REAL) /\n  SUM(CASE WHEN County = 'HUMBOLDT' THEN 1 ELSE 0 END)\nFROM schools\nWHERE MailState = 'CA';",
        "pred_time": 0.010576248168945312,
        "orig_time": 0.008615970611572266,
        "time_ratio": 0.8146528403967538,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Of all the schools with a mailing state address in California, how many are active in San Joaquin?",
        "original_query": "SELECT COUNT(CDSCode) FROM schools WHERE City = 'San Joaquin' AND MailState = 'CA' AND StatusType = 'Active'",
        "llm_output": "-- Reasoning\nWe need to count schools from the `schools` table. We will filter for schools where the `MailState` is 'CA', the `StatusType` is 'Active', and the `County` is 'San Joaquin'.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM schools\nWHERE MailState = 'CA' AND StatusType = 'Active' AND County = 'San Joaquin';",
        "pred_query": "SELECT COUNT(*)\nFROM schools\nWHERE MailState = 'CA' AND StatusType = 'Active' AND County = 'San Joaquin';",
        "pred_time": 0.009974956512451172,
        "orig_time": 0.0073473453521728516,
        "time_ratio": 0.7365791863855825,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the phone number and extension number for the school that had the 333rd highest average writing score?",
        "original_query": "SELECT T2.Phone, T2.Ext FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrWrite DESC LIMIT 332, 1",
        "llm_output": "-- Reasoning\nWe need to join the `schools` table with the `satscores` table using their common CDSCode/cds column. Then, we order the results by the average writing score in descending order to find the highest scores. To get the 333rd highest, we use LIMIT 1 OFFSET 332 (since OFFSET 0 is the 1st result). Finally, we select the phone number and extension for that school.\n\n-- SQL Query\nSELECT T1.Phone, T1.Ext\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.AvgScrWrite IS NOT NULL\nORDER BY\n  T2.AvgScrWrite DESC\nLIMIT 1 OFFSET 332;",
        "pred_query": "SELECT T1.Phone, T1.Ext\nFROM schools AS T1\nINNER JOIN satscores AS T2\n  ON T1.CDSCode = T2.cds\nWHERE\n  T2.AvgScrWrite IS NOT NULL\nORDER BY\n  T2.AvgScrWrite DESC\nLIMIT 1 OFFSET 332;",
        "pred_time": 0.0057830810546875,
        "orig_time": 0.005471944808959961,
        "time_ratio": 0.9461988786279684,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the phone number and extension number for the school with the zip code 95203-3704? Indicate the school's name.",
        "original_query": "SELECT Phone, Ext, School FROM schools WHERE Zip = '95203-3704'",
        "llm_output": "-- Reasoning\nWe need to retrieve the phone number, extension number, and school name from the 'schools' table. We will filter the results based on the given zip code.\n\n-- SQL Query\nSELECT School, Phone, Ext\nFROM schools\nWHERE Zip = '95203-3704';",
        "pred_query": "SELECT School, Phone, Ext\nFROM schools\nWHERE Zip = '95203-3704';",
        "pred_time": 0.00964975357055664,
        "orig_time": 0.007693290710449219,
        "time_ratio": 0.797252557197213,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the website for the schools under the administrations of Mike Larson and Dante Alvarez?",
        "original_query": "SELECT Website FROM schools WHERE (AdmFName1 = 'Mike' AND AdmLName1 = 'Larson') OR (AdmFName1 = 'Dante' AND AdmLName1 = 'Alvarez')",
        "llm_output": "-- Reasoning\nWe need to find the website from the `schools` table. The condition is that the school must have both 'Mike Larson' and 'Dante Alvarez' listed as administrators. We check for 'Mike Larson' in any of the three administrator name fields (`AdmFName1`/`AdmLName1`, `AdmFName2`/`AdmLName2`, `AdmFName3`/`AdmLName3`) and similarly for 'Dante Alvarez'. Both conditions must be true for the same school.\n\n-- SQL Query\nSELECT Website\nFROM schools\nWHERE\n    (\n        (AdmFName1 = 'Mike' AND AdmLName1 = 'Larson') OR\n        (AdmFName2 = 'Mike' AND AdmLName2 = 'Larson') OR\n        (AdmFName3 = 'Mike' AND AdmLName3 = 'Larson')\n    )\nAND\n    (\n        (AdmFName1 = 'Dante' AND AdmLName1 = 'Alvarez') OR\n        (AdmFName2 = 'Dante' AND AdmLName2 = 'Alvarez') OR\n        (AdmFName3 = 'Dante' AND AdmLName3 = 'Alvarez')\n    );",
        "pred_query": "SELECT Website\nFROM schools\nWHERE\n    (\n        (AdmFName1 = 'Mike' AND AdmLName1 = 'Larson') OR\n        (AdmFName2 = 'Mike' AND AdmLName2 = 'Larson') OR\n        (AdmFName3 = 'Mike' AND AdmLName3 = 'Larson')\n    )\nAND\n    (\n        (AdmFName1 = 'Dante' AND AdmLName1 = 'Alvarez') OR\n        (AdmFName2 = 'Dante' AND AdmLName2 = 'Alvarez') OR\n        (AdmFName3 = 'Dante' AND AdmLName3 = 'Alvarez')\n    );",
        "pred_time": 0.011174678802490234,
        "orig_time": 0.009186267852783203,
        "time_ratio": 0.8220610198421165,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What are the websites for all the partially virtual chartered schools located in San Joaquin?",
        "original_query": "SELECT Website FROM schools WHERE County = 'San Joaquin' AND Virtual = 'P' AND Charter = 1",
        "llm_output": "-- Reasoning\nWe need to find the websites of schools. We will query the `schools` table and filter for schools that are 'Partially' virtual, are chartered (Charter = 1), and are located in the 'San Joaquin' county.\n\n-- SQL Query\nSELECT Website\nFROM schools\nWHERE Virtual = 'Partially' AND Charter = 1 AND County = 'San Joaquin';",
        "pred_query": "SELECT Website\nFROM schools\nWHERE Virtual = 'Partially' AND Charter = 1 AND County = 'San Joaquin';",
        "pred_time": 0.010716915130615234,
        "orig_time": 0.007366180419921875,
        "time_ratio": 0.68734149054505,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "How many chartered schools located in the city of Hickman are owned by the Elementary School District?",
        "original_query": "SELECT COUNT(School) FROM schools WHERE DOC = 52 AND Charter = 1 AND City = 'Hickman'",
        "llm_output": "-- Reasoning\nWe need to count schools from the `schools` table that meet three conditions: they are chartered (Charter = 1), their city is 'Hickman', and their district type is 'Elementary School District'.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM schools\nWHERE Charter = 1\n  AND City = 'Hickman'\n  AND DOCType = 'Elementary School District';",
        "pred_query": "SELECT COUNT(*)\nFROM schools\nWHERE Charter = 1\n  AND City = 'Hickman'\n  AND DOCType = 'Elementary School District';",
        "pred_time": 0.009777307510375977,
        "orig_time": 0.008340835571289062,
        "time_ratio": 0.8530810309931967,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the total number of non-chartered schools in the county of Los Angeles with a percent (%) of eligible free meals for grades 1 through 12 that is less than 0.18%?",
        "original_query": "SELECT COUNT(T2.School) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Los Angeles' AND T2.Charter = 0 AND CAST(T1.`Free Meal Count (K-12)` AS REAL) * 100 / T1.`Enrollment (K-12)` < 0.18",
        "llm_output": "-- Reasoning\nWe need to count schools that meet three criteria: not chartered, located in Los Angeles County, and have a low percentage of eligible free meals. We will join the `schools` table with the `frpm` table on `CDSCode`, then apply filters for `schools.Charter = 0`, `schools.County = 'Los Angeles'`, and `frpm.'Percent (%) Eligible Free (K-12)' < 0.18`. Finally, we count the distinct `CDSCode` values.\n\n-- SQL Query\nSELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.Charter = 0 AND T1.County = 'Los Angeles' AND T2.'Percent (%) Eligible Free (K-12)' < 0.18;",
        "pred_query": "SELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.Charter = 0 AND T1.County = 'Los Angeles' AND T2.'Percent (%) Eligible Free (K-12)' < 0.18;",
        "pred_time": 0.011748313903808594,
        "orig_time": 0.008389949798583984,
        "time_ratio": 0.7141407581784236,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "In chartered schools with charter number 00D2, what are the names of all the administrators? Include the name of the school and the city to which it belongs",
        "original_query": "SELECT AdmFName1, AdmLName1, School, City FROM schools WHERE Charter = 1 AND CharterNum = '00D2'",
        "llm_output": "-- Reasoning\nWe need to retrieve school information from the `schools` table. We will filter for schools where the `CharterNum` column matches '00D2'. For each matching school, we will select its `School` name, `City`, and concatenate the first and last names of each of the three possible administrators to form their full names.\n\n-- SQL Query\nSELECT\n  School,\n  City,\n  T1.AdmFName1 || ' ' || T1.AdmLName1 AS Administrator1,\n  T1.AdmFName2 || ' ' || T1.AdmLName2 AS Administrator2,\n  T1.AdmFName3 || ' ' || T1.AdmLName3 AS Administrator3\nFROM schools AS T1\nWHERE\n  CharterNum = '00D2';",
        "pred_query": "SELECT\n  School,\n  City,\n  T1.AdmFName1 || ' ' || T1.AdmLName1 AS Administrator1,\n  T1.AdmFName2 || ' ' || T1.AdmLName2 AS Administrator2,\n  T1.AdmFName3 || ' ' || T1.AdmLName3 AS Administrator3\nFROM schools AS T1\nWHERE\n  CharterNum = '00D2';",
        "pred_time": 0.009371519088745117,
        "orig_time": null,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the total number of schools with a mailing city in Hickman belonging to the charter number 00D4?",
        "original_query": "SELECT COUNT(*) FROM schools WHERE CharterNum = '00D4' AND MailCity = 'Hickman'",
        "llm_output": "-- Reasoning\nWe need to count schools from the `schools` table. We will filter the schools based on their mailing city being 'Hickman' and their charter number being '00D4'.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM schools\nWHERE MailCity = 'Hickman' AND CharterNum = '00D4';",
        "pred_query": "SELECT COUNT(*)\nFROM schools\nWHERE MailCity = 'Hickman' AND CharterNum = '00D4';",
        "pred_time": 0.010091066360473633,
        "orig_time": 0.008507490158081055,
        "time_ratio": 0.843071470761961,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the ratio in percentage of Santa Clara County schools that are locally funded compared to all other types of charter school funding?",
        "original_query": "SELECT CAST(SUM(CASE WHEN FundingType = 'Locally funded' THEN 1 ELSE 0 END) AS REAL) * 100 / SUM(CASE WHEN FundingType != 'Locally funded' THEN 1 ELSE 0 END) FROM schools WHERE County = 'Santa Clara' AND Charter = 1",
        "llm_output": "-- Reasoning\nWe need to calculate a percentage ratio of charter schools in Santa Clara County. First, we filter the `schools` table for `County` 'Santa Clara' and ensure they are charter schools by checking `Charter = 1`. Then, we count schools with `FundingType` 'Locally Funded' and compare it to the count of schools with any other `FundingType`. The ratio is calculated as (Locally Funded Count / Other Funded Count) * 100, handling potential division by zero.\n\n-- SQL Query\nSELECT\n    (CAST(SUM(CASE WHEN T1.FundingType = 'Locally Funded' THEN 1 ELSE 0 END) AS REAL) * 100.0) /\n    NULLIF(SUM(CASE WHEN T1.FundingType != 'Locally Funded' THEN 1 ELSE 0 END), 0)\nFROM schools AS T1\nWHERE\n    T1.County = 'Santa Clara' AND T1.Charter = 1;",
        "pred_query": "SELECT\n    (CAST(SUM(CASE WHEN T1.FundingType = 'Locally Funded' THEN 1 ELSE 0 END) AS REAL) * 100.0) /\n    NULLIF(SUM(CASE WHEN T1.FundingType != 'Locally Funded' THEN 1 ELSE 0 END), 0)\nFROM schools AS T1\nWHERE\n    T1.County = 'Santa Clara' AND T1.Charter = 1;",
        "pred_time": 0.009487390518188477,
        "orig_time": 0.008803367614746094,
        "time_ratio": 0.9279018922926143,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Between 1/1/2000 to 12/31/2005, how many directly funded schools opened in the county of Stanislaus?",
        "original_query": "SELECT COUNT(School) FROM schools WHERE strftime('%Y', OpenDate) BETWEEN '2000' AND '2005' AND County = 'Stanislaus' AND FundingType = 'Directly funded'",
        "llm_output": "-- Reasoning\nWe need to count schools from the `schools` table. Filter by `OpenDate` between '2000-01-01' and '2005-12-31', `FundingType` as 'Directly Funded', and `County` as 'Stanislaus'.\n\n-- SQL Query\nSELECT COUNT(CDSCode)\nFROM schools\nWHERE OpenDate BETWEEN '2000-01-01' AND '2005-12-31'\n  AND FundingType = 'Directly Funded'\n  AND County = 'Stanislaus';",
        "pred_query": "SELECT COUNT(CDSCode)\nFROM schools\nWHERE OpenDate BETWEEN '2000-01-01' AND '2005-12-31'\n  AND FundingType = 'Directly Funded'\n  AND County = 'Stanislaus';",
        "pred_time": 0.011273384094238281,
        "orig_time": 0.011421918869018555,
        "time_ratio": 1.0131757042551393,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the total amount of Community College District closure in 1989 in the city of San Francisco?",
        "original_query": "SELECT COUNT(School) FROM schools WHERE strftime('%Y', ClosedDate) = '1989' AND City = 'San Francisco' AND DOCType = 'Community College District'",
        "llm_output": "-- Reasoning\nWe need to find districts that are classified as 'Community College', are located in 'San Francisco', and had schools within them close in the year 1989. We join the `schools` table with `frpm` using `CDSCode` to get district type information. Then we filter by `ClosedDate` for the year 1989, `City` as 'San Francisco', and `District Type` as 'Community College'. The \"total amount\" in this context refers to the count of such distinct districts.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.District)\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE STRFTIME('%Y', T1.ClosedDate) = '1989'\n  AND T1.City = 'San Francisco'\n  AND T2.`District Type` = 'Community College';",
        "pred_query": "SELECT COUNT(DISTINCT T1.District)\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE STRFTIME('%Y', T1.ClosedDate) = '1989'\n  AND T1.City = 'San Francisco'\n  AND T2.`District Type` = 'Community College';",
        "pred_time": 0.003929615020751953,
        "orig_time": 0.009623289108276367,
        "time_ratio": 2.4489139667516078,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which county reported the most number of school closure in the 1980s with school wonership code belonging to Youth Authority Facilities (CEA)?",
        "original_query": "SELECT County FROM schools WHERE strftime('%Y', ClosedDate) BETWEEN '1980' AND '1989' AND StatusType = 'Closed' AND SOC = 11 GROUP BY County ORDER BY COUNT(School) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to count school closures per county within the 1980s that have a 'Youth Authority Facilities' ownership type. We will filter the schools table by `ClosedDate` to be between '1980-01-01' and '1989-12-31' and by `SOCType` to be 'Youth Authority Facilities'. Then, we group by `County` and order by the count of closures in descending order to find the county with the most closures.\n\n-- SQL Query\nSELECT County\nFROM schools\nWHERE ClosedDate BETWEEN '1980-01-01' AND '1989-12-31'\n  AND SOCType = 'Youth Authority Facilities'\nGROUP BY County\nORDER BY COUNT(CDSCode) DESC\nLIMIT 1;",
        "pred_query": "SELECT County\nFROM schools\nWHERE ClosedDate BETWEEN '1980-01-01' AND '1989-12-31'\n  AND SOCType = 'Youth Authority Facilities'\nGROUP BY County\nORDER BY COUNT(CDSCode) DESC\nLIMIT 1;",
        "pred_time": 0.01081991195678711,
        "orig_time": 0.009948253631591797,
        "time_ratio": 0.9194394253228152,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Please provide the National Center for Educational Statistics school district identification number for all schools with a School Ownership Code that are part of the State Special Schools.",
        "original_query": "SELECT NCESDist FROM schools WHERE SOC = 31",
        "llm_output": "-- Reasoning\nWe need to retrieve the `NCESDist` from the `schools` table. We will filter the schools by checking if their `SOC` (School Ownership Code) is not null and their `SOCType` is 'State Special Schools'.\n\n-- SQL Query\nSELECT NCESDist\nFROM schools\nWHERE SOC IS NOT NULL AND SOCType = 'State Special Schools';",
        "pred_query": "SELECT NCESDist\nFROM schools\nWHERE SOC IS NOT NULL AND SOCType = 'State Special Schools';",
        "pred_time": 0.01114797592163086,
        "orig_time": 0.008249521255493164,
        "time_ratio": 0.7400017109371658,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "How many active and closed District Community Day Schools are there in the county of Alpine?",
        "original_query": "SELECT COUNT(School) FROM schools WHERE (StatusType = 'Closed' OR StatusType = 'Active') AND County = 'Alpine'",
        "llm_output": "-- Reasoning\nWe need to count the number of schools from the `schools` table that satisfy three conditions: their status type is either 'Active' or 'Closed', their `DOCType` is 'District Community Day School', and their county is 'Alpine'.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM schools\nWHERE StatusType IN ('Active', 'Closed')\n  AND DOCType = 'District Community Day School'\n  AND County = 'Alpine';",
        "pred_query": "SELECT COUNT(*)\nFROM schools\nWHERE StatusType IN ('Active', 'Closed')\n  AND DOCType = 'District Community Day School'\n  AND County = 'Alpine';",
        "pred_time": 0.010654926300048828,
        "orig_time": 0.00777888298034668,
        "time_ratio": 0.7300738420228239,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the district code for the School that does not offer a magnet program in the city of Fresno?",
        "original_query": "SELECT T1.`District Code` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Fresno' AND T2.Magnet = 0",
        "llm_output": "-- Reasoning\nWe need to find the district code for schools that meet two criteria: located in 'Fresno' and do not have a magnet program. We can achieve this by joining the `frpm` and `schools` tables on `CDSCode`, filtering for `City = 'Fresno'` and `Magnet = 0`, and then selecting the `District Code`.\n\n-- SQL Query\nSELECT T1.`District Code`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.City = 'Fresno' AND T2.Magnet = 0;",
        "pred_query": "SELECT T1.`District Code`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.City = 'Fresno' AND T2.Magnet = 0;",
        "pred_time": 0.009036064147949219,
        "orig_time": 0.007928133010864258,
        "time_ratio": 0.8773878627968338,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "How many students from the ages of 5 to 17 are enrolled at the State Special School school in Fremont for the 2014-2015 academic year?",
        "original_query": "SELECT T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.EdOpsCode = 'SSS' AND T2.City = 'Fremont' AND T1.`Academic Year` BETWEEN 2014 AND 2015",
        "llm_output": "-- Reasoning\nWe need to find the enrollment count for students aged 5-17. We can query the `frpm` table, filtering by `School Name`, `District Name`, and `Academic Year` to match the specific criteria given in the question.\n\n-- SQL Query\nSELECT `Enrollment (Ages 5-17)`\nFROM frpm\nWHERE `School Name` = 'State Special School'\n  AND `District Name` = 'Fremont'\n  AND `Academic Year` = '2014-2015';",
        "pred_query": "SELECT `Enrollment (Ages 5-17)`\nFROM frpm\nWHERE `School Name` = 'State Special School'\n  AND `District Name` = 'Fremont'\n  AND `Academic Year` = '2014-2015';",
        "pred_time": 0.004904508590698242,
        "orig_time": 0.009002685546875,
        "time_ratio": 1.835593797092995,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the free or reduced price meal count for ages 5 to 17 in the Youth Authority School with a mailing street address of PO Box 1040?",
        "original_query": "SELECT T1.`FRPM Count (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.MailStreet = 'PO Box 1040' AND T2.SOCType = 'Youth Authority Facilities'",
        "llm_output": "-- Reasoning\nWe need to find the 'FRPM Count (Ages 5-17)' from the `frpm` table. To identify the correct school, we must join `frpm` with the `schools` table using `CDSCode`. Then, we filter for schools where the `School Type` is 'Youth Authority School' and the mailing street is 'PO Box 1040'.\n\n-- SQL Query\nSELECT T1.`FRPM Count (Ages 5-17)`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`School Type` = 'Youth Authority School' AND T2.MailStreet = 'PO Box 1040';",
        "pred_query": "SELECT T1.`FRPM Count (Ages 5-17)`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`School Type` = 'Youth Authority School' AND T2.MailStreet = 'PO Box 1040';",
        "pred_time": 0.004045963287353516,
        "orig_time": 0.009003162384033203,
        "time_ratio": 2.225220978196818,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the lowest grade for the District Special Education Consortia School with National Center for Educational Statistics school district identification number of 613360?",
        "original_query": "SELECT MIN(T1.`Low Grade`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.NCESDist = 613360 AND T2.EdOpsCode = 'SPECON'",
        "llm_output": "-- Reasoning\nWe need to find the `Low Grade` from the `frpm` table. We are given two conditions for identifying the school: its `District Type` and its `NCESSchool` identification number. The `District Type` is in the `frpm` table, and `NCESSchool` is in the `schools` table. We will join these two tables on `CDSCode`, filter by the given conditions, and select the `Low Grade`.\n\n-- SQL Query\nSELECT T1.`Low Grade`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`District Type` = 'Special Education Consortia School' AND T2.NCESSchool = '613360';",
        "pred_query": "SELECT T1.`Low Grade`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.`District Type` = 'Special Education Consortia School' AND T2.NCESSchool = '613360';",
        "pred_time": 0.005220651626586914,
        "orig_time": 0.00881052017211914,
        "time_ratio": 1.6876284422523633,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the educational level name for the schools with Breakfast Provision 2 in county code 37? Indicate the name of the school.",
        "original_query": "SELECT T2.EILName, T2.School FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`NSLP Provision Status` = 'Breakfast Provision 2' AND T1.`County Code` = 37",
        "llm_output": "-- Reasoning\nWe need to find schools with 'Breakfast Provision 2' in 'County Code' 37. The `frpm` table contains the 'Educational Option Type', 'School Name', 'NSLP Provision Status', and 'County Code'. We will filter this table based on the given conditions and select the requested columns.\n\n-- SQL Query\nSELECT `Educational Option Type`, `School Name`\nFROM frpm\nWHERE `NSLP Provision Status` = 'Breakfast Provision 2' AND `County Code` = '37';",
        "pred_query": "SELECT `Educational Option Type`, `School Name`\nFROM frpm\nWHERE `NSLP Provision Status` = 'Breakfast Provision 2' AND `County Code` = '37';",
        "pred_time": 0.004476785659790039,
        "orig_time": 0.004014492034912109,
        "time_ratio": 0.8967353677371253,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the city location of the high school level school with Lunch Provision 2 whose lowest grade is 9 and the highest grade is 12 in the county of Merced?",
        "original_query": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`NSLP Provision Status` = 'Lunch Provision 2' AND T2.County = 'Merced' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12 AND T2.EILCode = 'HS'",
        "llm_output": "-- Reasoning\nWe need to join the `schools` table with the `frpm` table using `CDSCode` to combine school location information with grade and lunch program details. We then filter for schools in 'Merced' county, that have a 'Low Grade' of '09' and a 'High Grade' of '12', and whose 'NSLP Provision Status' is 'Provision 2'. Finally, we select the `City` from the `schools` table.\n\n-- SQL Query\nSELECT T1.City\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.County = 'Merced' AND T2.`Low Grade` = '09' AND T2.`High Grade` = '12' AND T2.`NSLP Provision Status` = 'Provision 2';",
        "pred_query": "SELECT T1.City\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.County = 'Merced' AND T2.`Low Grade` = '09' AND T2.`High Grade` = '12' AND T2.`NSLP Provision Status` = 'Provision 2';",
        "pred_time": 0.009896278381347656,
        "orig_time": 0.007526397705078125,
        "time_ratio": 0.7605280909704153,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which schools served a grade span of Kindergarten to 9th grade in the county of Los Angeles and what is its Percent (%) Eligible FRPM (Ages 5-17)?",
        "original_query": "SELECT T2.School, T1.`FRPM Count (Ages 5-17)` * 100 / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Los Angeles' AND T2.GSserved = 'K-9'",
        "llm_output": "-- Reasoning\nWe need to identify schools in Los Angeles county that serve grades K-9. We can find this information in the 'schools' table. Then, we join with the 'frpm' table using CDSCode to retrieve the 'Percent (%) Eligible FRPM (Ages 5-17)'.\n\n-- SQL Query\nSELECT T1.School, T2.`Percent (%) Eligible FRPM (Ages 5-17)`\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.County = 'Los Angeles' AND T1.GSserved = 'K-9';",
        "pred_query": "SELECT T1.School, T2.`Percent (%) Eligible FRPM (Ages 5-17)`\nFROM schools AS T1\nINNER JOIN frpm AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T1.County = 'Los Angeles' AND T1.GSserved = 'K-9';",
        "pred_time": 0.009850502014160156,
        "orig_time": 0.008445024490356445,
        "time_ratio": 0.8573191983735114,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the most common type of grade span served in the city of Adelanto?",
        "original_query": "SELECT GSserved FROM schools WHERE City = 'Adelanto' GROUP BY GSserved ORDER BY COUNT(GSserved) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to count the occurrences of each grade span served in schools located in the city of Adelanto. We will filter the schools table by city, group by the grade span served, order by the count in descending order, and take the top result.\n\n-- SQL Query\nSELECT GSserved\nFROM schools\nWHERE City = 'Adelanto'\nGROUP BY GSserved\nORDER BY COUNT(*) DESC\nLIMIT 1;",
        "pred_query": "SELECT GSserved\nFROM schools\nWHERE City = 'Adelanto'\nGROUP BY GSserved\nORDER BY COUNT(*) DESC\nLIMIT 1;",
        "pred_time": 0.01192164421081543,
        "orig_time": 0.012518167495727539,
        "time_ratio": 1.0500369977801332,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Between San Diego and Santa Barbara, which county offers the most number of schools that does not offer physical building? Indicate the amount.",
        "original_query": "SELECT County, COUNT(Virtual) FROM schools WHERE (County = 'San Diego' OR County = 'Santa Barbara') AND Virtual = 'F' GROUP BY County ORDER BY COUNT(Virtual) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to count schools that are virtual (indicated by 'Y' in the Virtual column) within 'San Diego' and 'Santa Barbara' counties. We filter the schools table for these conditions, group by county, and then order by the count in descending order to find the county with the most such schools.\n\n-- SQL Query\nSELECT County, COUNT(CDSCode) AS VirtualSchoolCount\nFROM schools\nWHERE County IN ('San Diego', 'Santa Barbara') AND Virtual = 'Y'\nGROUP BY County\nORDER BY VirtualSchoolCount DESC\nLIMIT 1;",
        "pred_query": "SELECT County, COUNT(CDSCode) AS VirtualSchoolCount\nFROM schools\nWHERE County IN ('San Diego', 'Santa Barbara') AND Virtual = 'Y'\nGROUP BY County\nORDER BY VirtualSchoolCount DESC\nLIMIT 1;",
        "pred_time": 0.009998559951782227,
        "orig_time": 0.008672952651977539,
        "time_ratio": 0.8674201778858764,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the school type of the school with the highest latitude? Indicate the name of the school as well as the latitude coordinates.",
        "original_query": "SELECT T1.`School Type`, T1.`School Name`, T2.Latitude FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T2.Latitude DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the school type, school name, and latitude of the school with the highest latitude. We can achieve this by joining the `schools` table with the `frpm` table on `CDSCode`, ordering the results by latitude in descending order, and limiting the output to the top one record.\n\n-- SQL Query\nSELECT T1.`School Type`, T2.School, T2.Latitude\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nORDER BY\n  T2.Latitude DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.`School Type`, T2.School, T2.Latitude\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nORDER BY\n  T2.Latitude DESC\nLIMIT 1;",
        "pred_time": 0.015552043914794922,
        "orig_time": 0.011940240859985352,
        "time_ratio": 0.7677602330216158,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "In which city can you find the school in the state of California with the lowest latitude coordinates and what is its lowest grade? Indicate the school name.",
        "original_query": "SELECT T2.City, T1.`Low Grade`, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.State = 'CA' ORDER BY T2.Latitude ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find a school in California with the lowest latitude. We will filter the `schools` table for `State = 'CA'`, order the results by `Latitude` in ascending order, and limit to one to get the school with the lowest latitude. Then, we will select its `City`, `School` name, and `GSoffered` which represents the lowest grade.\n\n-- SQL Query\nSELECT City, School, GSoffered\nFROM schools\nWHERE State = 'CA'\nORDER BY Latitude ASC\nLIMIT 1;",
        "pred_query": "SELECT City, School, GSoffered\nFROM schools\nWHERE State = 'CA'\nORDER BY Latitude ASC\nLIMIT 1;",
        "pred_time": 0.012231111526489258,
        "orig_time": 0.012550830841064453,
        "time_ratio": 1.0261398413286291,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the grade span offered in the school with the highest longitude?",
        "original_query": "SELECT GSoffered FROM schools ORDER BY ABS(longitude) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the grade span offered (`GSoffered`) for the school that has the highest longitude. We can achieve this by selecting `GSoffered` from the `schools` table, ordering the results by `Longitude` in descending order, and then limiting the result to one.\n\n-- SQL Query\nSELECT GSoffered\nFROM schools\nORDER BY Longitude DESC\nLIMIT 1;",
        "pred_query": "SELECT GSoffered\nFROM schools\nORDER BY Longitude DESC\nLIMIT 1;",
        "pred_time": 0.010901451110839844,
        "orig_time": 0.008946418762207031,
        "time_ratio": 0.8206631090893185,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Of the schools that offers a magnet program serving a grade span of Kindergarten to 8th grade, how many offers Multiple Provision Types? List the number of cities that offers a Kindergarten to 8th grade span and indicate how many schools are there serving such grade span for each city.",
        "original_query": "SELECT T2.City, COUNT(T2.CDSCode) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.Magnet = 1 AND T2.GSoffered = 'K-8' AND T1.`NSLP Provision Status` = 'Multiple Provision Types' GROUP BY T2.City",
        "llm_output": "-- Reasoning\nThe question asks for two pieces of information.\nFirst, a count of schools that meet specific criteria: have a magnet program (`Magnet = 1`), serve grades K-8 (checked via `GSserved LIKE '%K-8%'`), and have an 'NSLP Provision Status' of 'Multiple Provision Types'. This requires joining `schools` with `frpm` on `CDSCode` and applying the filters.\nSecond, a list of cities that offer K-8 grades, along with the number of such schools in each city. This involves filtering the `schools` table for `GSserved LIKE '%K-8%'`, then grouping the results by `City` and counting the schools in each group.\nTo answer both parts in a single query, the scalar count from the first part is included as a subquery in the SELECT clause of the main query that provides the grouped results for the second part.\n\n-- SQL Query\nSELECT\n    T1.City,\n    COUNT(T1.CDSCode) AS NumberOfSchoolsK8,\n    (SELECT COUNT(DISTINCT S.CDSCode)\n     FROM schools AS S\n     INNER JOIN frpm AS F ON S.CDSCode = F.CDSCode\n     WHERE S.Magnet = 1\n       AND S.GSserved LIKE '%K-8%'\n       AND F.`NSLP Provision Status` = 'Multiple Provision Types') AS MagnetK8MultipleProvisionSchools\nFROM schools AS T1\nWHERE T1.GSserved LIKE '%K-8%'\nGROUP BY T1.City;",
        "pred_query": "SELECT\n    T1.City,\n    COUNT(T1.CDSCode) AS NumberOfSchoolsK8,\n    (SELECT COUNT(DISTINCT S.CDSCode)\n     FROM schools AS S\n     INNER JOIN frpm AS F ON S.CDSCode = F.CDSCode\n     WHERE S.Magnet = 1\n       AND S.GSserved LIKE '%K-8%'\n       AND F.`NSLP Provision Status` = 'Multiple Provision Types') AS MagnetK8MultipleProvisionSchools\nFROM schools AS T1\nWHERE T1.GSserved LIKE '%K-8%'\nGROUP BY T1.City;",
        "pred_time": null,
        "orig_time": 0.003770589828491211,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What are the two most common first names among the school administrators? Indicate the district to which they administer.",
        "original_query": "SELECT DISTINCT T1.AdmFName1, T1.District FROM schools AS T1 INNER JOIN ( SELECT admfname1 FROM schools GROUP BY admfname1 ORDER BY COUNT(admfname1) DESC LIMIT 2 ) AS T2 ON T1.AdmFName1 = T2.admfname1",
        "llm_output": "-- Reasoning\nWe need to find the most common administrator first names along with their districts. We can achieve this by combining all `AdmFName` columns from the `schools` table using `UNION ALL`, filtering out NULL names. Then, we group the combined results by the administrator's first name and district, count the occurrences, order by the count in descending order, and finally limit to the top two.\n\n-- SQL Query\nSELECT T1.admin_first_name, T1.District\nFROM (\n    SELECT AdmFName1 AS admin_first_name, District\n    FROM schools\n    WHERE AdmFName1 IS NOT NULL\n    UNION ALL\n    SELECT AdmFName2 AS admin_first_name, District\n    FROM schools\n    WHERE AdmFName2 IS NOT NULL\n    UNION ALL\n    SELECT AdmFName3 AS admin_first_name, District\n    FROM schools\n    WHERE AdmFName3 IS NOT NULL\n) AS T1\nGROUP BY T1.admin_first_name, T1.District\nORDER BY COUNT(*) DESC\nLIMIT 2;",
        "pred_query": "SELECT T1.admin_first_name, T1.District\nFROM (\n    SELECT AdmFName1 AS admin_first_name, District\n    FROM schools\n    WHERE AdmFName1 IS NOT NULL\n    UNION ALL\n    SELECT AdmFName2 AS admin_first_name, District\n    FROM schools\n    WHERE AdmFName2 IS NOT NULL\n    UNION ALL\n    SELECT AdmFName3 AS admin_first_name, District\n    FROM schools\n    WHERE AdmFName3 IS NOT NULL\n) AS T1\nGROUP BY T1.admin_first_name, T1.District\nORDER BY COUNT(*) DESC\nLIMIT 2;",
        "pred_time": 0.03205585479736328,
        "orig_time": 0.029407739639282227,
        "time_ratio": 0.9173905929253563,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the Percent (%) Eligible Free (K-12) in the school administered by an administrator whose first name is Alusine. List the district code of the school.",
        "original_query": "SELECT T1.`Free Meal Count (K-12)` * 100 / T1.`Enrollment (K-12)`, T1.`District Code` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Alusine'",
        "llm_output": "-- Reasoning\nWe need to retrieve the 'Percent (%) Eligible Free (K-12)' and 'District Code' from the `frpm` table. To link this to the administrator's name, we join `frpm` with the `schools` table using the `CDSCode`. We then filter the `schools` table for records where any of the administrator's first name fields (`AdmFName1`, `AdmFName2`, `AdmFName3`) is 'Alusine'.\n\n-- SQL Query\nSELECT T1.`Percent (%) Eligible Free (K-12)`, T1.`District Code`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.AdmFName1 = 'Alusine' OR T2.AdmFName2 = 'Alusine' OR T2.AdmFName3 = 'Alusine';",
        "pred_query": "SELECT T1.`Percent (%) Eligible Free (K-12)`, T1.`District Code`\nFROM frpm AS T1\nINNER JOIN schools AS T2\n  ON T1.CDSCode = T2.CDSCode\nWHERE\n  T2.AdmFName1 = 'Alusine' OR T2.AdmFName2 = 'Alusine' OR T2.AdmFName3 = 'Alusine';",
        "pred_time": 0.015581369400024414,
        "orig_time": 0.008098840713500977,
        "time_ratio": 0.5197772099215032,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the administrator's last name that oversees the school with Charter number 40? Indicate the district, the county where the school is situated, and the name of the school.",
        "original_query": "SELECT AdmLName1, District, County, School FROM schools WHERE CharterNum = '0040'",
        "llm_output": "-- Reasoning\nWe need to find the administrator's last name, district, county, and school name. This information is available in the `schools` table. We are given a condition on `Charter School Number`, which is in the `frpm` table. Therefore, we will join `schools` and `frpm` tables using `CDSCode` and filter by `Charter School Number`.\n\n-- SQL Query\nSELECT T1.AdmLName1, T1.District, T1.County, T1.School\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.`Charter School Number` = '40';",
        "pred_query": "SELECT T1.AdmLName1, T1.District, T1.County, T1.School\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.`Charter School Number` = '40';",
        "pred_time": 0.004488706588745117,
        "orig_time": 0.008492231369018555,
        "time_ratio": 1.891910553991608,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the e-mail address of the administrator of the school located in the San Bernardino county, District of San Bernardino City Unified that opened between 1/1/2009 to 12/31/2010 whose school types are public Intermediate/Middle Schools and Unified Scools?",
        "original_query": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'San Bernardino' AND T2.City = 'San Bernardino' AND T2.DOC = 54 AND strftime('%Y', T2.OpenDate) BETWEEN '2009' AND '2010' AND T2.SOC = 62",
        "llm_output": "-- Reasoning\nWe need to find the administrator's email address from the `schools` table. The conditions are to filter by county, district, and an `OpenDate` range. Additionally, we need to filter schools based on their type: 'public' (indicated by `StatusType = 'Active'`), 'Unified' (indicated by `DOCType = 'Unified'`), and 'Intermediate/Middle Schools' (indicated by `GSserved = '6-8'`). We will select the first administrator's email (`AdmEmail1`).\n\n-- SQL Query\nSELECT AdmEmail1\nFROM schools\nWHERE\n    County = 'San Bernardino' AND\n    District = 'San Bernardino City Unified' AND\n    OpenDate BETWEEN '2009-01-01' AND '2010-12-31' AND\n    StatusType = 'Active' AND\n    DOCType = 'Unified' AND\n    GSserved = '6-8';",
        "pred_query": "SELECT AdmEmail1\nFROM schools\nWHERE\n    County = 'San Bernardino' AND\n    District = 'San Bernardino City Unified' AND\n    OpenDate BETWEEN '2009-01-01' AND '2010-12-31' AND\n    StatusType = 'Active' AND\n    DOCType = 'Unified' AND\n    GSserved = '6-8';",
        "pred_time": 0.009515762329101562,
        "orig_time": 0.0086669921875,
        "time_ratio": 0.9108037682902386,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the administrator's email address for the school with the highest number of test takers who received SAT scores of at least 1500?Provide the name of the school.",
        "original_query": "SELECT T2.AdmEmail1, T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the school with the highest 'NumGE1500' from the satscores table. Then, we join this with the schools table using the CDSCode to retrieve the school's name and the administrator's email address. We order by the number of test takers who scored at least 1500 in descending order and pick the top one.\n\n-- SQL Query\nSELECT T1.AdmEmail1, T1.School\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nORDER BY T2.NumGE1500 DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.AdmEmail1, T1.School\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nORDER BY T2.NumGE1500 DESC\nLIMIT 1;",
        "pred_time": 0.012048482894897461,
        "orig_time": 0.002057790756225586,
        "time_ratio": 0.17079252003561887,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many accounts who choose issuance after transaction are staying in East Bohemia region?",
        "original_query": "SELECT COUNT(T1.district_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE T1.A3 = 'East Bohemia' AND T2.frequency = 'POPLATEK PO OBRATU'",
        "llm_output": "-- Reasoning\nWe need to count accounts that satisfy two conditions: their associated district is 'East Bohemia' and their transaction frequency is 'issuance after transaction'.\nWe will join the `account` table with the `district` table using `district_id`.\nThe 'East Bohemia' region is represented by the `A3` column in the `district` table.\nThe 'issuance after transaction' frequency corresponds to the value 'POPLATEK DISPOZICNI' in the `frequency` column of the `account` table (a common interpretation for this banking schema).\nFinally, we count the distinct `account_id`s that meet these criteria.\n\n-- SQL Query\nSELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A3 = 'East Bohemia' AND T1.frequency = 'POPLATEK DISPOZICNI';",
        "pred_query": "SELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A3 = 'East Bohemia' AND T1.frequency = 'POPLATEK DISPOZICNI';",
        "pred_time": 0.001455068588256836,
        "orig_time": 0.0008366107940673828,
        "time_ratio": 0.5749631328854662,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many accounts who have region in Prague are eligible for loans?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T1.district_id = T3.district_id WHERE T3.A3 = 'Prague'",
        "llm_output": "We need to count accounts that are associated with districts in Prague and also have entries in the loan table. We will join the `account` table with the `district` table to filter for 'Prague' regions, then join with the `loan` table to ensure the account has a loan, and finally count the distinct account IDs.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3 ON T1.account_id = T3.account_id\nWHERE T2.A3 = 'Prague';",
        "pred_query": "SELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3 ON T1.account_id = T3.account_id\nWHERE T2.A3 = 'Prague';",
        "pred_time": 0.0014750957489013672,
        "orig_time": 0.0008547306060791016,
        "time_ratio": 0.5794407628899305,
        "check": true
    },
    {
        "id": "financial",
        "question": "The average unemployment ratio of 1995 and 1996, which one has higher percentage?",
        "original_query": "SELECT DISTINCT IIF(AVG(A13) > AVG(A12), '1996', '1995') FROM district",
        "llm_output": "-- Reasoning\nWe need to compare the average unemployment ratio (A13) for the years 1995 and 1996 (A14). We filter the district table for these two years, group by year, calculate the average unemployment ratio for each, and then select the year with the highest average.\n\n-- SQL Query\nSELECT A14\nFROM district\nWHERE A14 IN (1995, 1996)\nGROUP BY A14\nORDER BY AVG(A13) DESC\nLIMIT 1;",
        "pred_query": "SELECT A14\nFROM district\nWHERE A14 IN (1995, 1996)\nGROUP BY A14\nORDER BY AVG(A13) DESC\nLIMIT 1;",
        "pred_time": 0.0008044242858886719,
        "orig_time": 0.0004830360412597656,
        "time_ratio": 0.6004742145820984,
        "check": false
    },
    {
        "id": "financial",
        "question": "List out the no. of districts that have female average salary is more than 6000 but less than 10000?",
        "original_query": "SELECT DISTINCT T2.district_id FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' AND T2.A11 BETWEEN 6000 AND 10000",
        "llm_output": "-- Reasoning\nThe question asks for the number of districts based on a \"female average salary\" metric. Since there's no explicit salary information for individuals or a direct \"female average salary\" column, it's inferred that one of the `REAL` columns in the `district` table (e.g., `A10`) represents this aggregated value for the district. We will count the districts where this assumed column (`A10`) is greater than 6000 and less than 10000.\n\n-- SQL Query\nSELECT COUNT(district_id)\nFROM district\nWHERE A10 > 6000 AND A10 < 10000;",
        "pred_query": "SELECT COUNT(district_id)\nFROM district\nWHERE A10 > 6000 AND A10 < 10000;",
        "pred_time": 0.0009961128234863281,
        "orig_time": 0.0015747547149658203,
        "time_ratio": 1.5808999521302058,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many male customers who are living in North Bohemia have average salary greater than 8000?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'M' AND T2.A3 = 'North Bohemia' AND T2.A11 > 8000",
        "llm_output": "-- Reasoning\nWe need to count clients who meet specific criteria. First, we identify male clients from 'North Bohemia' by joining the `client` and `district` tables and filtering on `gender = 'M'` and `A3 = 'North Bohemia'`. Then, to determine their \"average salary,\" we interpret it as the average of all credit transactions associated with their accounts. This involves joining `client` with `disp`, `disp` with `account`, and `account` with `trans`. We filter `trans` entries for `type = 'credit'`, group the results by `client_id`, and then use a `HAVING` clause to ensure their `AVG(amount)` is greater than 8000. Finally, we count the distinct `client_id`s that satisfy all conditions.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN disp AS T3\n  ON T1.client_id = T3.client_id\nINNER JOIN account AS T4\n  ON T3.account_id = T4.account_id\nINNER JOIN trans AS T5\n  ON T4.account_id = T5.account_id\nWHERE\n  T1.gender = 'M' AND T2.A3 = 'North Bohemia' AND T5.type = 'credit'\nGROUP BY\n  T1.client_id\nHAVING\n  AVG(T5.amount) > 8000;",
        "pred_query": "SELECT COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN disp AS T3\n  ON T1.client_id = T3.client_id\nINNER JOIN account AS T4\n  ON T3.account_id = T4.account_id\nINNER JOIN trans AS T5\n  ON T4.account_id = T5.account_id\nWHERE\n  T1.gender = 'M' AND T2.A3 = 'North Bohemia' AND T5.type = 'credit'\nGROUP BY\n  T1.client_id\nHAVING\n  AVG(T5.amount) > 8000;",
        "pred_time": 0.0018012523651123047,
        "orig_time": 0.001146554946899414,
        "time_ratio": 0.6365320979483785,
        "check": false
    },
    {
        "id": "financial",
        "question": "List out the account numbers of female clients who are oldest and has lowest average salary, calculate the gap between this lowest average salary with the highest average salary?",
        "original_query": "SELECT T1.account_id , ( SELECT MAX(A11) - MIN(A11) FROM district ) FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.district_id = ( SELECT district_id FROM client WHERE gender = 'F' ORDER BY birth_date ASC LIMIT 1 ) ORDER BY T2.A11 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find female clients who are both the oldest and have the lowest average salary, and also calculate the gap between the highest and lowest average salary. We define \"average salary\" as the average amount of credit transactions (`trans.type = 'credit'`).\n\n1.  First, we calculate the average credit transaction amount for each female client's account, along with their birth date. This is done by joining `client`, `disp`, `account`, and `trans` tables, filtering for female clients and credit transactions, then grouping by client, birth date, and account to get the average.\n2.  Next, we find the overall minimum birth date, overall minimum average salary, and overall maximum average salary among all female clients identified in the previous step.\n3.  Finally, we select the account IDs that match both the overall minimum birth date and the overall minimum average salary. For these identified accounts, we also calculate the difference between the overall maximum and minimum average salaries found.\n\n-- SQL Query\nWITH FemaleClientAccounts AS (\n    -- Calculate average credit transaction amount for each female client's account\n    SELECT\n        C.client_id,\n        C.birth_date,\n        A.account_id,\n        AVG(T.amount) AS avg_credit_salary\n    FROM\n        client AS C\n    JOIN\n        disp AS D ON C.client_id = D.client_id\n    JOIN\n        account AS A ON D.account_id = A.account_id\n    JOIN\n        trans AS T ON A.account_id = T.account_id\n    WHERE\n        C.gender = 'F' AND T.type = 'credit'\n    GROUP BY\n        C.client_id, C.birth_date, A.account_id\n),\nAggregatedSalaries AS (\n    -- Get overall minimum birth date, minimum average salary, and maximum average salary among all female client accounts\n    SELECT\n        MIN(birth_date) AS overall_min_birth_date,\n        MIN(avg_credit_salary) AS overall_min_avg_salary,\n        MAX(avg_credit_salary) AS overall_max_avg_salary\n    FROM\n        FemaleClientAccounts\n)\n-- Select the account_id(s) that match both the overall minimum birth date and overall minimum average salary\n-- And calculate the gap between the overall max and min average salaries\nSELECT\n    FCA.account_id,\n    (ASal.overall_max_avg_salary - ASal.overall_min_avg_salary) AS salary_gap\nFROM\n    FemaleClientAccounts AS FCA,\n    AggregatedSalaries AS ASal\nWHERE\n    FCA.birth_date = ASal.overall_min_birth_date\n    AND FCA.avg_credit_salary = ASal.overall_min_avg_salary;",
        "pred_query": "SELECT\n        C.client_id,\n        C.birth_date,\n        A.account_id,\n        AVG(T.amount) AS avg_credit_salary\n    FROM\n        client AS C\n    JOIN\n        disp AS D ON C.client_id = D.client_id\n    JOIN\n        account AS A ON D.account_id = A.account_id\n    JOIN\n        trans AS T ON A.account_id = T.account_id\n    WHERE\n        C.gender = 'F' AND T.type = 'credit'\n    GROUP BY\n        C.client_id, C.birth_date, A.account_id\n),\nAggregatedSalaries AS (\n    -- Get overall minimum birth date, minimum average salary, and maximum average salary among all female client accounts\n    SELECT\n        MIN(birth_date) AS overall_min_birth_date,\n        MIN(avg_credit_salary) AS overall_min_avg_salary,\n        MAX(avg_credit_salary) AS overall_max_avg_salary\n    FROM\n        FemaleClientAccounts\n)\n-- Select the account_id(s) that match both the overall minimum birth date and overall minimum average salary\n-- And calculate the gap between the overall max and min average salaries\nSELECT\n    FCA.account_id,\n    (ASal.overall_max_avg_salary - ASal.overall_min_avg_salary) AS salary_gap\nFROM\n    FemaleClientAccounts AS FCA,\n    AggregatedSalaries AS ASal\nWHERE\n    FCA.birth_date = ASal.overall_min_birth_date\n    AND FCA.avg_credit_salary = ASal.overall_min_avg_salary;",
        "pred_time": null,
        "orig_time": 0.0011665821075439453,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "List out the account numbers of clients who are youngest and have highest average salary?",
        "original_query": "SELECT T1.account_id FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.district_id = ( SELECT district_id FROM client ORDER BY birth_date DESC LIMIT 1 ) ORDER BY T2.A11 DESC LIMIT 1",
        "llm_output": "We need to identify clients who satisfy two conditions: being the youngest overall and belonging to a district with the highest average salary (assuming A13 in the district table represents average salary). We will first find the maximum birth date from the client table and the maximum average salary (A13) from the district table. Then, we join client, district, disp, and account tables to filter for clients whose birth date matches the maximum and whose district's A13 matches the maximum, finally selecting their corresponding account numbers.\n\n-- SQL Query\nSELECT T3.account_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN account AS T3 ON T2.account_id = T3.account_id\nINNER JOIN district AS T4 ON T1.district_id = T4.district_id\nWHERE T1.birth_date = (SELECT MAX(birth_date) FROM client)\n  AND T4.A13 = (SELECT MAX(A13) FROM district);",
        "pred_query": "SELECT T3.account_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN account AS T3 ON T2.account_id = T3.account_id\nINNER JOIN district AS T4 ON T1.district_id = T4.district_id\nWHERE T1.birth_date = (SELECT MAX(birth_date) FROM client)\n  AND T4.A13 = (SELECT MAX(A13) FROM district);",
        "pred_time": 0.0021982192993164062,
        "orig_time": 0.0010285377502441406,
        "time_ratio": 0.4678958785249458,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many customers who choose statement of weekly issuance are Owner?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id WHERE T2.type = 'Owner' AND T1.frequency = 'POPLATEK TYDNE'",
        "llm_output": "-- Reasoning\nWe need to count distinct clients. We can join the `client`, `disp`, and `account` tables. We filter for `account.frequency` being 'weekly issuance' and `disp.type` being 'Owner'.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T3.frequency = 'weekly issuance' AND T2.type = 'Owner';",
        "pred_query": "SELECT COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T3.frequency = 'weekly issuance' AND T2.type = 'Owner';",
        "pred_time": 0.0013039112091064453,
        "orig_time": 0.0007956027984619141,
        "time_ratio": 0.6101663923934906,
        "check": true
    },
    {
        "id": "financial",
        "question": "List out the clients who choose statement of issuance after transaction are Disponent?",
        "original_query": "SELECT T2.client_id FROM account AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id WHERE T1.frequency = 'POPLATEK PO OBRATU' AND T2.type = 'DISPONENT'",
        "llm_output": "-- Reasoning\nWe need to find clients (`client` table) who are designated as 'DISPONENT' in the `disp` table. Additionally, the question implies a condition about \"issuance after transaction\". This translates to finding clients for whom an associated card (`card` table) was issued after a transaction (`trans` table) occurred on their associated account (`account` table). We join `client` with `disp`, `disp` with `card`, `disp` with `account`, and `account` with `trans`, then filter by `disp.type = 'DISPONENT'` and `card.issued > trans.date`, selecting distinct client IDs.\n\n-- SQL Query\nSELECT DISTINCT T1.client_id\nFROM client AS T1\nJOIN disp AS T2 ON T1.client_id = T2.client_id\nJOIN card AS T3 ON T2.disp_id = T3.disp_id\nJOIN account AS T4 ON T2.account_id = T4.account_id\nJOIN trans AS T5 ON T4.account_id = T5.account_id\nWHERE T2.type = 'DISPONENT'\n  AND T3.issued > T5.date;",
        "pred_query": "SELECT DISTINCT T1.client_id\nFROM client AS T1\nJOIN disp AS T2 ON T1.client_id = T2.client_id\nJOIN card AS T3 ON T2.disp_id = T3.disp_id\nJOIN account AS T4 ON T2.account_id = T4.account_id\nJOIN trans AS T5 ON T4.account_id = T5.account_id\nWHERE T2.type = 'DISPONENT'\n  AND T3.issued > T5.date;",
        "pred_time": 0.0011365413665771484,
        "orig_time": 0.0010519027709960938,
        "time_ratio": 0.9255296832389344,
        "check": false
    },
    {
        "id": "financial",
        "question": "Among the accounts who have approved loan date in 1997, list out the accounts that have the lowest approved amount and choose weekly issuance statement.",
        "original_query": "SELECT T2.account_id FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE STRFTIME('%Y', T1.date) = '1997' AND T2.frequency = 'POPLATEK TYDNE' ORDER BY T1.amount LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to join the `account` and `loan` tables on `account_id`. We then filter for loans approved in 1997 (`status = 'A'`) and accounts with a 'weekly issuance' frequency. Finally, we order by the loan amount in ascending order and take the top result to find the account with the lowest approved amount under these conditions.\n\n-- SQL Query\nSELECT T1.account_id\nFROM account AS T1\nINNER JOIN loan AS T2 ON T1.account_id = T2.account_id\nWHERE T2.status = 'A'\n  AND STRFTIME('%Y', T2.date) = '1997'\n  AND T1.frequency = 'weekly issuance'\nORDER BY T2.amount ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.account_id\nFROM account AS T1\nINNER JOIN loan AS T2 ON T1.account_id = T2.account_id\nWHERE T2.status = 'A'\n  AND STRFTIME('%Y', T2.date) = '1997'\n  AND T1.frequency = 'weekly issuance'\nORDER BY T2.amount ASC\nLIMIT 1;",
        "pred_time": 0.0012352466583251953,
        "orig_time": 0.0008404254913330078,
        "time_ratio": 0.6803705848291836,
        "check": false
    },
    {
        "id": "financial",
        "question": "Among the accounts who have loan validity more than 12 months, list out the accounts that have the highest approved amount and have account opening date in 1993.",
        "original_query": "SELECT T1.account_id FROM loan AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id WHERE STRFTIME('%Y', T1.date) = '1993' AND T1.duration = 12 ORDER BY T1.amount DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to identify accounts that have loans with a duration greater than 12 months, were opened in 1993, and whose loan status is 'A' (which typically denotes approved in such schemas). Among these, we find the maximum loan amount and then return the `account_id` for all accounts that match this maximum amount and the initial filtering criteria.\n\n-- SQL Query\nSELECT T1.account_id\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.duration > 12 AND T2.status = 'A' AND STRFTIME('%Y', T1.date) = '1993'\n  AND T2.amount = (\n    SELECT MAX(T3.amount)\n    FROM loan AS T3\n    INNER JOIN account AS T4\n      ON T3.account_id = T4.account_id\n    WHERE\n      T3.duration > 12 AND T3.status = 'A' AND STRFTIME('%Y', T4.date) = '1993'\n  );",
        "pred_query": "SELECT T1.account_id\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.duration > 12 AND T2.status = 'A' AND STRFTIME('%Y', T1.date) = '1993'\n  AND T2.amount = (\n    SELECT MAX(T3.amount)\n    FROM loan AS T3\n    INNER JOIN account AS T4\n      ON T3.account_id = T4.account_id\n    WHERE\n      T3.duration > 12 AND T3.status = 'A' AND STRFTIME('%Y', T4.date) = '1993'\n  );",
        "pred_time": 0.0012295246124267578,
        "orig_time": 0.001718759536743164,
        "time_ratio": 1.3979057591623036,
        "check": false
    },
    {
        "id": "financial",
        "question": "Among the account opened, how many female customers who were born before 1950 and stayed in Slokolov?",
        "original_query": "SELECT COUNT(T2.client_id) FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T2.gender = 'F' AND STRFTIME('%Y', T2.birth_date) < '1950' AND T1.A2 = 'Slokolov'",
        "llm_output": "-- Reasoning\nWe need to count unique clients who are female, born before 1950, and live in 'Slokolov'. This requires joining the `client` table (for gender, birth date, and district_id) with the `district` table (for the city name, A3 column). Additionally, to ensure these are customers \"among the account opened\", we need to link them to an account through the `disp` table. We will filter by gender, birth year, and city, then count the distinct `client_id`s.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN disp AS T3\n  ON T1.client_id = T3.client_id\nWHERE\n  T1.gender = 'F' AND STRFTIME('%Y', T1.birth_date) < '1950' AND T2.A3 = 'Slokolov';",
        "pred_query": "SELECT COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN disp AS T3\n  ON T1.client_id = T3.client_id\nWHERE\n  T1.gender = 'F' AND STRFTIME('%Y', T1.birth_date) < '1950' AND T2.A3 = 'Slokolov';",
        "pred_time": 0.002491474151611328,
        "orig_time": 0.0015730857849121094,
        "time_ratio": 0.6313875598086124,
        "check": true
    },
    {
        "id": "financial",
        "question": "List out the accounts who have the earliest trading date in 1995 ?",
        "original_query": "SELECT account_id FROM trans WHERE STRFTIME('%Y', date) = '1995' ORDER BY date ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the earliest transaction date in 1995 from the `trans` table. Then, we select all distinct account IDs that have a transaction on that specific earliest date in 1995.\n\n-- SQL Query\nSELECT DISTINCT account_id\nFROM trans\nWHERE STRFTIME('%Y', date) = '1995' AND date = (\n    SELECT MIN(date)\n    FROM trans\n    WHERE STRFTIME('%Y', date) = '1995'\n);",
        "pred_query": "SELECT DISTINCT account_id\nFROM trans\nWHERE STRFTIME('%Y', date) = '1995' AND date = (\n    SELECT MIN(date)\n    FROM trans\n    WHERE STRFTIME('%Y', date) = '1995'\n);",
        "pred_time": 0.5421473979949951,
        "orig_time": 0.2634739875793457,
        "time_ratio": 0.4859822043852694,
        "check": false
    },
    {
        "id": "financial",
        "question": "State different accounts who have account opening date before 1997 and own an amount of money greater than 3000USD",
        "original_query": "SELECT DISTINCT T2.account_id FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE STRFTIME('%Y', T2.date) < '1997' AND T1.amount > 3000",
        "llm_output": "-- Reasoning\nWe need to find accounts that were opened before 1997 and have a transaction balance greater than 3000. We will join the account and trans tables on account_id, filter for accounts opened before 1997 and transactions with a balance over 3000, and then select distinct account IDs.\n\n-- SQL Query\nSELECT DISTINCT T1.account_id\nFROM account AS T1\nINNER JOIN trans AS T2 ON T1.account_id = T2.account_id\nWHERE T1.date < '1997-01-01' AND T2.balance > 3000;",
        "pred_query": "SELECT DISTINCT T1.account_id\nFROM account AS T1\nINNER JOIN trans AS T2 ON T1.account_id = T2.account_id\nWHERE T1.date < '1997-01-01' AND T2.balance > 3000;",
        "pred_time": 0.17908287048339844,
        "orig_time": 0.18593049049377441,
        "time_ratio": 1.0382371579810632,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which client issued his/her card in 1994/3/3, give his/her client id.",
        "original_query": "SELECT T2.client_id FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN card AS T3 ON T2.disp_id = T3.disp_id WHERE T3.issued = '1994-03-03'",
        "llm_output": "-- Reasoning\nWe need to find the client ID for clients who issued a card on a specific date. We can join the `client`, `disp`, and `card` tables. Then, we filter the results by the `issued` date in the `card` table and select the `client_id`.\n\n-- SQL Query\nSELECT T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE T3.issued = '1994-03-03';",
        "pred_query": "SELECT T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE T3.issued = '1994-03-03';",
        "pred_time": 0.0011386871337890625,
        "orig_time": 0.0005712509155273438,
        "time_ratio": 0.501675041876047,
        "check": true
    },
    {
        "id": "financial",
        "question": "The transaction of 840 USD happened in 1998/10/14, when was this account opened?",
        "original_query": "SELECT T1.date FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.amount = 840 AND T2.date = '1998-10-14'",
        "llm_output": "-- Reasoning\nFirst, we find the account_id associated with the transaction of 840 USD on '1998-10-14' from the 'trans' table. Then, using this account_id, we query the 'account' table to retrieve the opening date of that account.\n\n-- SQL Query\nSELECT T1.date\nFROM account AS T1\nINNER JOIN trans AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.amount = 840 AND T2.date = '1998-10-14';",
        "pred_query": "SELECT T1.date\nFROM account AS T1\nINNER JOIN trans AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.amount = 840 AND T2.date = '1998-10-14';",
        "pred_time": 0.07477688789367676,
        "orig_time": 0.07206988334655762,
        "time_ratio": 0.9637989140311889,
        "check": true
    },
    {
        "id": "financial",
        "question": "There was a loan approved in 1994/8/25, where was that account opened, give the district Id of the branch.",
        "original_query": "SELECT T1.district_id FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T2.date = '1994-08-25'",
        "llm_output": "-- Reasoning\nWe need to find the district_id of the account associated with a specific loan. We can achieve this by joining the `loan` table with the `account` table on `account_id` and then filtering for the loan approved on '1994-08-25'.\n\n-- SQL Query\nSELECT T2.district_id\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.date = '1994-08-25';",
        "pred_query": "SELECT T2.district_id\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.date = '1994-08-25';",
        "pred_time": 0.0011091232299804688,
        "orig_time": 0.0005474090576171875,
        "time_ratio": 0.4935511607910576,
        "check": true
    },
    {
        "id": "financial",
        "question": "What is the biggest amount of transaction that the client whose card was opened in 1996/10/21 made?",
        "original_query": "SELECT T2.amount FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T1.date = '1996-10-21' ORDER BY T2.amount DESC LIMIT 1",
        "llm_output": "-- Reasoning\nFirst, we identify the `disp_id` associated with a card issued on '1996-10-21' from the `card` table. Then, using this `disp_id`, we find the corresponding `account_id` in the `disp` table. Finally, we query the `trans` table to find the maximum transaction `amount` for that specific `account_id`.\n\n-- SQL Query\nSELECT MAX(T3.amount)\nFROM card AS T1\nINNER JOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nINNER JOIN trans AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.issued = '1996-10-21';",
        "pred_query": "SELECT MAX(T3.amount)\nFROM card AS T1\nINNER JOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nINNER JOIN trans AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.issued = '1996-10-21';",
        "pred_time": 0.45005273818969727,
        "orig_time": 0.18230748176574707,
        "time_ratio": 0.4050802634799312,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the gender of the oldest client who opened his/her account in the highest average salary branch?",
        "original_query": "SELECT T2.gender FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id ORDER BY T1.A11 DESC, T2.birth_date ASC LIMIT 1",
        "llm_output": "-- Reasoning\nFirst, we need to identify the district with the highest average salary by finding the maximum value in the `A10` column of the `district` table.\nNext, we filter accounts that were opened in this specific district using the `account.district_id`.\nThen, we join these accounts with the `disp` table to link them to their respective clients.\nFinally, we join with the `client` table to access client details. From these clients, we find the oldest one by ordering their `birth_date` in ascending order and limiting to one, then select their `gender`.\n\n-- SQL Query\nSELECT T1.gender\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T3.district_id = (\n    SELECT\n      district_id\n    FROM district\n    ORDER BY\n      A10 DESC\n    LIMIT 1\n  )\nORDER BY\n  T1.birth_date ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.gender\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T3.district_id = (\n    SELECT\n      district_id\n    FROM district\n    ORDER BY\n      A10 DESC\n    LIMIT 1\n  )\nORDER BY\n  T1.birth_date ASC\nLIMIT 1;",
        "pred_time": 0.0023806095123291016,
        "orig_time": 0.0014982223510742188,
        "time_ratio": 0.629344016024036,
        "check": false
    },
    {
        "id": "financial",
        "question": "For the client who applied the biggest loan, what was his/her first amount of transaction after opened the account?",
        "original_query": "SELECT T2.amount FROM loan AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id ORDER BY T1.amount DESC, T2.date ASC LIMIT 1",
        "llm_output": "-- Reasoning\nFirst, we need to identify the `account_id` that is associated with the largest loan amount by querying the `loan` table. Then, using this specific `account_id`, we query the `trans` table to find all transactions for that account. Finally, we order these transactions by `date` (and `trans_id` for tie-breaking) in ascending order and select the `amount` of the very first transaction.\n\n-- SQL Query\nSELECT T1.amount\nFROM trans AS T1\nWHERE T1.account_id = (\n    SELECT account_id\n    FROM loan\n    ORDER BY amount DESC\n    LIMIT 1\n)\nORDER BY T1.date ASC, T1.trans_id ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.amount\nFROM trans AS T1\nWHERE T1.account_id = (\n    SELECT account_id\n    FROM loan\n    ORDER BY amount DESC\n    LIMIT 1\n)\nORDER BY T1.date ASC, T1.trans_id ASC\nLIMIT 1;",
        "pred_time": 0.07497882843017578,
        "orig_time": 0.6387145519256592,
        "time_ratio": 8.518598720443647,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many clients opened their accounts in Jesenik branch were women?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' AND T2.A2 = 'Jesenik'",
        "llm_output": "-- Reasoning\nWe need to count female clients associated with the 'Jesenik' district. We join the `client` table with the `district` table on `district_id`, then filter for clients whose gender is 'F' (female) and whose district name (A2) is 'Jesenik'.\n\n-- SQL Query\nSELECT COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.gender = 'F' AND T2.A2 = 'Jesenik';",
        "pred_query": "SELECT COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.gender = 'F' AND T2.A2 = 'Jesenik';",
        "pred_time": 0.001680612564086914,
        "orig_time": 0.001110076904296875,
        "time_ratio": 0.6605192225847638,
        "check": true
    },
    {
        "id": "financial",
        "question": "What is the disposition id of the client who made 5100 USD transaction in 1998/9/2?",
        "original_query": "SELECT T1.disp_id FROM disp AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.date = '1998-09-02' AND T2.amount = 5100",
        "llm_output": "-- Reasoning\nWe need to find the `disp_id` from the `disp` table. This table is linked to the `account` table via `account_id`. The `trans` table also uses `account_id` and contains the transaction details like `amount` and `date`. So, we join `disp` and `trans` tables on `account_id`, then filter for the specified amount and date.\n\n-- SQL Query\nSELECT T1.disp_id\nFROM disp AS T1\nINNER JOIN trans AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.amount = 5100 AND T2.date = '1998-09-02';",
        "pred_query": "SELECT T1.disp_id\nFROM disp AS T1\nINNER JOIN trans AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.amount = 5100 AND T2.date = '1998-09-02';",
        "pred_time": 0.07648992538452148,
        "orig_time": 0.10407066345214844,
        "time_ratio": 1.360580010099058,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many accounts were opened in Litomerice in 1996?",
        "original_query": "SELECT COUNT(T2.account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T2.date) = '1996' AND T1.A2 = 'Litomerice'",
        "llm_output": "-- Reasoning\nWe need to count accounts. Join the `account` table with the `district` table on `district_id`. Filter the results where the district name (`A3`) is 'Litomerice' and the account opening date is in 1996.\n\n-- SQL Query\nSELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A3 = 'Litomerice' AND STRFTIME('%Y', T1.date) = '1996';",
        "pred_query": "SELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A3 = 'Litomerice' AND STRFTIME('%Y', T1.date) = '1996';",
        "pred_time": 0.002477884292602539,
        "orig_time": 0.0018839836120605469,
        "time_ratio": 0.760319445780814,
        "check": false
    },
    {
        "id": "financial",
        "question": "For the female client who was born in 1976/1/29, which district did she opened her account?",
        "original_query": "SELECT T1.A2 FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T2.birth_date = '1976-01-29' AND T2.gender = 'F'",
        "llm_output": "-- Reasoning\nWe need to find the `district_id` associated with a specific client. First, locate the client in the `client` table using their gender ('F' for female) and birth date ('1976-01-29'). Then, join the `client` table with the `disp` table on `client_id` to find the associated `account_id`. Finally, join `disp` with the `account` table on `account_id` to retrieve the `district_id`.\n\n-- SQL Query\nSELECT T3.district_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN account AS T3 ON T2.account_id = T3.account_id\nWHERE T1.gender = 'F' AND T1.birth_date = '1976-01-29';",
        "pred_query": "SELECT T3.district_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN account AS T3 ON T2.account_id = T3.account_id\nWHERE T1.gender = 'F' AND T1.birth_date = '1976-01-29';",
        "pred_time": 0.001922607421875,
        "orig_time": 0.0009429454803466797,
        "time_ratio": 0.4904513888888889,
        "check": false
    },
    {
        "id": "financial",
        "question": "For the client who applied 98832 USD loan in 1996/1/3, when was his/her birthday?",
        "original_query": "SELECT T3.birth_date FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN client AS T3 ON T2.district_id = T3.district_id WHERE T1.date = '1996-01-03' AND T1.amount = 98832",
        "llm_output": "-- Reasoning\nWe need to find the client's birth date. First, we identify the loan record using the given amount and date. Then, we join `loan` with `disp` on `account_id` to find the `client_id`. Finally, we join with the `client` table on `client_id` to retrieve the `birth_date`.\n\n-- SQL Query\nSELECT T3.birth_date\nFROM loan AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nINNER JOIN client AS T3 ON T2.client_id = T3.client_id\nWHERE T1.amount = 98832 AND T1.date = '1996-01-03';",
        "pred_query": "SELECT T3.birth_date\nFROM loan AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nINNER JOIN client AS T3 ON T2.client_id = T3.client_id\nWHERE T1.amount = 98832 AND T1.date = '1996-01-03';",
        "pred_time": 0.0018973350524902344,
        "orig_time": 0.003698110580444336,
        "time_ratio": 1.9491078160341795,
        "check": false
    },
    {
        "id": "financial",
        "question": "For the first client who opened his/her account in Prague, what is his/her account ID?",
        "original_query": "SELECT T1.account_id FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A3 = 'Prague' ORDER BY T1.date ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to link clients to districts to filter for 'Prague', then link clients to accounts through the disp table to find the account ID and the account opening date. We will filter districts for 'Prague' (column A3), order the results by the account opening date in ascending order, and then select the account_id of the first record.\n\n-- SQL Query\nSELECT T3.account_id\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN disp AS T3\n  ON T1.client_id = T3.client_id\nINNER JOIN account AS T4\n  ON T3.account_id = T4.account_id\nWHERE\n  T2.A3 = 'Prague'\nORDER BY\n  T4.date ASC\nLIMIT 1;",
        "pred_query": "SELECT T3.account_id\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN disp AS T3\n  ON T1.client_id = T3.client_id\nINNER JOIN account AS T4\n  ON T3.account_id = T4.account_id\nWHERE\n  T2.A3 = 'Prague'\nORDER BY\n  T4.date ASC\nLIMIT 1;",
        "pred_time": 0.00270843505859375,
        "orig_time": 0.0013110637664794922,
        "time_ratio": 0.4840669014084507,
        "check": false
    },
    {
        "id": "financial",
        "question": "For the branch which located in the south Bohemia with biggest number of inhabitants, what is the percentage of the male clients?",
        "original_query": "SELECT CAST(SUM(T1.gender = 'M') AS REAL) * 100 / COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A3 = 'south Bohemia' GROUP BY T2.A4 ORDER BY T2.A4 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nFirst, identify the `district_id` for the branch located in 'south Bohemia' that has the largest number of inhabitants. This involves querying the `district` table, filtering by `A3` (region) for 'south Bohemia', and ordering by `A8` (inhabitants) in descending order to find the top one. Then, using this `district_id`, query the `client` table to count the total number of clients and the number of male clients (where `gender` is 'M'). Finally, calculate the percentage of male clients by dividing the male count by the total count and multiplying by 100.\n\n-- SQL Query\nSELECT CAST(SUM(CASE WHEN T1.gender = 'M' THEN 1 ELSE 0 END) AS REAL) * 100.0 / COUNT(T1.client_id)\nFROM client AS T1\nWHERE T1.district_id = (\n    SELECT T2.district_id\n    FROM district AS T2\n    WHERE T2.A3 = 'south Bohemia'\n    ORDER BY T2.A8 DESC\n    LIMIT 1\n);",
        "pred_query": "SELECT CAST(SUM(CASE WHEN T1.gender = 'M' THEN 1 ELSE 0 END) AS REAL) * 100.0 / COUNT(T1.client_id)\nFROM client AS T1\nWHERE T1.district_id = (\n    SELECT T2.district_id\n    FROM district AS T2\n    WHERE T2.A3 = 'south Bohemia'\n    ORDER BY T2.A8 DESC\n    LIMIT 1\n);",
        "pred_time": 0.0012042522430419922,
        "orig_time": 0.001348257064819336,
        "time_ratio": 1.1195802811324491,
        "check": false
    },
    {
        "id": "financial",
        "question": "For the client who first applied the loan in 1993/7/5, what is the increase rate of his/her account balance from 1993/3/22 to 1998/12/27?",
        "original_query": "SELECT CAST((SUM(IIF(T3.date = '1998-12-27', T3.balance, 0)) - SUM(IIF(T3.date = '1993-03-22', T3.balance, 0))) AS REAL) * 100 / SUM(IIF(T3.date = '1993-03-22', T3.balance, 0)) FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN trans AS T3 ON T3.account_id = T2.account_id WHERE T1.date = '1993-07-05'",
        "llm_output": "-- Reasoning\nFirst, identify the client's account who applied their first loan on '1993-07-05'. Then, retrieve the account balance from the `trans` table for this specific account on or before '1993-03-22' (initial balance) and on or before '1998-12-27' (final balance). Finally, calculate the increase rate using the formula: (final balance - initial balance) / initial balance.\n\n-- SQL Query\nWITH ClientFirstLoanDate AS (\n    SELECT\n        T1.client_id,\n        MIN(T4.date) AS first_loan_date\n    FROM client AS T1\n    INNER JOIN disp AS T2 ON T1.client_id = T2.client_id\n    INNER JOIN account AS T3 ON T2.account_id = T3.account_id\n    INNER JOIN loan AS T4 ON T3.account_id = T4.account_id\n    GROUP BY T1.client_id\n),\nTargetAccount AS (\n    SELECT\n        T3.account_id\n    FROM client AS T1\n    INNER JOIN disp AS T2 ON T1.client_id = T2.client_id\n    INNER JOIN account AS T3 ON T2.account_id = T3.account_id\n    INNER JOIN ClientFirstLoanDate AS CFLD ON T1.client_id = CFLD.client_id\n    WHERE CFLD.first_loan_date = '1993-07-05'\n    LIMIT 1\n),\nBalance1993 AS (\n    SELECT balance\n    FROM trans\n    WHERE account_id = (SELECT account_id FROM TargetAccount)\n    AND date <= '1993-03-22'\n    ORDER BY date DESC\n    LIMIT 1\n),\nBalance1998 AS (\n    SELECT balance\n    FROM trans\n    WHERE account_id = (SELECT account_id FROM TargetAccount)\n    AND date <= '1998-12-27'\n    ORDER BY date DESC\n    LIMIT 1\n)\nSELECT\n    (CAST((SELECT balance FROM Balance1998) AS REAL) - (SELECT balance FROM Balance1993)) / (SELECT balance FROM Balance1993);",
        "pred_query": "SELECT\n        T1.client_id,\n        MIN(T4.date) AS first_loan_date\n    FROM client AS T1\n    INNER JOIN disp AS T2 ON T1.client_id = T2.client_id\n    INNER JOIN account AS T3 ON T2.account_id = T3.account_id\n    INNER JOIN loan AS T4 ON T3.account_id = T4.account_id\n    GROUP BY T1.client_id\n),\nTargetAccount AS (\n    SELECT\n        T3.account_id\n    FROM client AS T1\n    INNER JOIN disp AS T2 ON T1.client_id = T2.client_id\n    INNER JOIN account AS T3 ON T2.account_id = T3.account_id\n    INNER JOIN ClientFirstLoanDate AS CFLD ON T1.client_id = CFLD.client_id\n    WHERE CFLD.first_loan_date = '1993-07-05'\n    LIMIT 1\n),\nBalance1993 AS (\n    SELECT balance\n    FROM trans\n    WHERE account_id = (SELECT account_id FROM TargetAccount)\n    AND date <= '1993-03-22'\n    ORDER BY date DESC\n    LIMIT 1\n),\nBalance1998 AS (\n    SELECT balance\n    FROM trans\n    WHERE account_id = (SELECT account_id FROM TargetAccount)\n    AND date <= '1998-12-27'\n    ORDER BY date DESC\n    LIMIT 1\n)\nSELECT\n    (CAST((SELECT balance FROM Balance1998) AS REAL) - (SELECT balance FROM Balance1993)) / (SELECT balance FROM Balance1993);",
        "pred_time": null,
        "orig_time": 0.6198465824127197,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the percentage of loan amount that has been fully paid with no issue.",
        "original_query": "SELECT (CAST(SUM(CASE WHEN status = 'A' THEN amount ELSE 0 END) AS REAL) * 100) / SUM(amount) FROM loan",
        "llm_output": "-- Reasoning\nWe need to sum the 'amount' for loans with a status indicating full payment with no issue (status 'A') and divide it by the total sum of 'amount' for all loans. Then multiply by 100 to get the percentage.\n\n-- SQL Query\nSELECT CAST(SUM(CASE WHEN status = 'A' THEN amount ELSE 0 END) AS REAL) * 100 / SUM(amount)\nFROM loan;",
        "pred_query": "SELECT CAST(SUM(CASE WHEN status = 'A' THEN amount ELSE 0 END) AS REAL) * 100 / SUM(amount)\nFROM loan;",
        "pred_time": 0.001047372817993164,
        "orig_time": 0.0005400180816650391,
        "time_ratio": 0.5155929888458912,
        "check": true
    },
    {
        "id": "financial",
        "question": "For loan amount less than USD100,000, what is the percentage of accounts that is still running with no issue.",
        "original_query": "SELECT CAST(SUM(status = 'C') AS REAL) * 100 / COUNT(amount) FROM loan WHERE amount < 100000",
        "llm_output": "-- Reasoning\nFirst, identify all unique accounts that have at least one loan with an amount less than 100,000. This will be the denominator for our percentage calculation.\nNext, from this set of accounts, identify those where *all* their loans (that are under 100,000) have a 'C' status (meaning 'running with no problems'). This will be the numerator.\nFinally, calculate the percentage by dividing the numerator count by the denominator count and multiplying by 100.\n\n-- SQL Query\nSELECT\n  CAST(\n    (\n      SELECT COUNT(T1.account_id)\n      FROM (\n        SELECT account_id\n        FROM loan\n        WHERE amount < 100000\n        GROUP BY account_id\n        HAVING MAX(CASE WHEN status != 'C' THEN 1 ELSE 0 END) = 0\n      ) AS T1\n    )\n    AS REAL\n  ) * 100.0 /\n  (\n    SELECT COUNT(DISTINCT account_id)\n    FROM loan\n    WHERE amount < 100000\n  );",
        "pred_query": "SELECT\n  CAST(\n    (\n      SELECT COUNT(T1.account_id)\n      FROM (\n        SELECT account_id\n        FROM loan\n        WHERE amount < 100000\n        GROUP BY account_id\n        HAVING MAX(CASE WHEN status != 'C' THEN 1 ELSE 0 END) = 0\n      ) AS T1\n    )\n    AS REAL\n  ) * 100.0 /\n  (\n    SELECT COUNT(DISTINCT account_id)\n    FROM loan\n    WHERE amount < 100000\n  );",
        "pred_time": 0.001211404800415039,
        "orig_time": 0.0005469322204589844,
        "time_ratio": 0.45148592796693565,
        "check": true
    },
    {
        "id": "financial",
        "question": "For accounts in 1993 with statement issued after transaction, list the account ID, district name and district region.",
        "original_query": "SELECT T1.account_id, T2.A2, T2.A3 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.frequency = 'POPLATEK PO OBRATU' AND STRFTIME('%Y', T1.date)= '1993'",
        "llm_output": "-- Reasoning\nWe need to retrieve the account ID, district name, and district region. First, we filter accounts created in the year 1993 from the `account` table. Then, we join `account` with `district` to get the district name (A2) and region (A3). To apply the condition \"statement issued after transaction\", we assume \"statement\" refers to a card, as the `card` table has an `issued` date. We join `account` to `disp` then to `card` to get the card issuance date, and join `account` to `trans` to get transaction dates. Finally, we filter for accounts where any associated card's issued date is later than any associated transaction date, and use `DISTINCT` to ensure unique account entries.\n\n-- SQL Query\nSELECT DISTINCT\n  T1.account_id,\n  T5.A2,\n  T5.A3\nFROM account AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nINNER JOIN trans AS T4\n  ON T1.account_id = T4.account_id\nINNER JOIN district AS T5\n  ON T1.district_id = T5.district_id\nWHERE\n  STRFTIME('%Y', T1.date) = '1993' AND T3.issued > T4.date;",
        "pred_query": "SELECT DISTINCT\n  T1.account_id,\n  T5.A2,\n  T5.A3\nFROM account AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nINNER JOIN trans AS T4\n  ON T1.account_id = T4.account_id\nINNER JOIN district AS T5\n  ON T1.district_id = T5.district_id\nWHERE\n  STRFTIME('%Y', T1.date) = '1993' AND T3.issued > T4.date;",
        "pred_time": 0.5643620491027832,
        "orig_time": 0.0010113716125488281,
        "time_ratio": 0.001792061698969121,
        "check": false
    },
    {
        "id": "financial",
        "question": "From Year 1995 to 2000, who are the accounts holders from 'east Bohemia'. State the account ID the frequency of statement issuance.",
        "original_query": "SELECT T1.account_id, T1.frequency FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A3 = 'east Bohemia' AND STRFTIME('%Y', T1.date) BETWEEN '1995' AND '2000'",
        "llm_output": "-- Reasoning\nWe need to retrieve `account_id` and `frequency` from the `account` table. We join `account` with the `district` table using `district_id`. We filter the `district` table where the district name (A3) is 'east Bohemia' and filter the `account` table for dates between 1995 and 2000.\n\n-- SQL Query\nSELECT T1.account_id, T1.frequency\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A3 = 'east Bohemia' AND STRFTIME('%Y', T1.date) BETWEEN '1995' AND '2000';",
        "pred_query": "SELECT T1.account_id, T1.frequency\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A3 = 'east Bohemia' AND STRFTIME('%Y', T1.date) BETWEEN '1995' AND '2000';",
        "pred_time": 0.0031120777130126953,
        "orig_time": 0.0023941993713378906,
        "time_ratio": 0.7693250593733242,
        "check": true
    },
    {
        "id": "financial",
        "question": "List account ID and account opening date for accounts from 'Prachatice'.",
        "original_query": "SELECT T1.account_id, T1.date FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A2 = 'Prachatice'",
        "llm_output": "-- Reasoning\nWe need to retrieve the account ID and the account opening date.\nThe account ID and date are in the `account` table.\nThe district information, specifically the district name ('Prachatice'), is in the `district` table.\nWe will join the `account` and `district` tables using `district_id`.\nFinally, we will filter the results where the district name (column A3 in the `district` table) is 'Prachatice'.\n\n-- SQL Query\nSELECT T1.account_id, T1.date\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A3 = 'Prachatice';",
        "pred_query": "SELECT T1.account_id, T1.date\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A3 = 'Prachatice';",
        "pred_time": 0.0019409656524658203,
        "orig_time": 0.0012717247009277344,
        "time_ratio": 0.6552020636285468,
        "check": false
    },
    {
        "id": "financial",
        "question": "State the district and region for loan ID '4990'.",
        "original_query": "SELECT T2.A2, T2.A3 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T3.loan_id = 4990",
        "llm_output": "-- Reasoning\nWe need to find the district and region related to a specific loan. We start by filtering the loan table for the given loan ID. Then, we join the loan table with the account table to get the district ID, and finally join with the district table to retrieve the district name (A2) and region (A3).\n\n-- SQL Query\nSELECT T3.A2, T3.A3\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.loan_id = '4990';",
        "pred_query": "SELECT T3.A2, T3.A3\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.loan_id = '4990';",
        "pred_time": 0.0009672641754150391,
        "orig_time": 0.00047516822814941406,
        "time_ratio": 0.4912496918905595,
        "check": true
    },
    {
        "id": "financial",
        "question": "Provide the account ID, district and region for loan amount greater than USD300,000.",
        "original_query": "SELECT T1.account_id, T2.A2, T2.A3 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T3.amount > 300000",
        "llm_output": "-- Reasoning\nWe need to join the `loan` table with the `account` table on `account_id`, and then with the `district` table on `district_id`. We will filter for loans where the amount is greater than 300,000 and select the account ID, district name (A2), and region (A3).\n\n-- SQL Query\nSELECT\n  T1.account_id,\n  T3.A2,\n  T3.A3\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.amount > 300000;",
        "pred_query": "SELECT\n  T1.account_id,\n  T3.A2,\n  T3.A3\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.amount > 300000;",
        "pred_time": 0.0013918876647949219,
        "orig_time": 0.0007154941558837891,
        "time_ratio": 0.5140459061322371,
        "check": true
    },
    {
        "id": "financial",
        "question": "List the loan ID, district and average salary for loan with duration of 60 months.",
        "original_query": "SELECT T3.loan_id, T2.A2, T2.A11 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T3.duration = 60",
        "llm_output": "-- Reasoning\nWe need to join the `loan` table with the `account` table using `account_id`, and then join with the `district` table using `district_id`. We will filter for loans with a duration of 60 months and select the loan ID, district name (A2), and average salary (A12) from the joined tables.\n\n-- SQL Query\nSELECT T1.loan_id, T3.A2, T3.A12\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.duration = 60;",
        "pred_query": "SELECT T1.loan_id, T3.A2, T3.A12\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.duration = 60;",
        "pred_time": 0.0013103485107421875,
        "orig_time": 0.0008707046508789062,
        "time_ratio": 0.6644832605531296,
        "check": false
    },
    {
        "id": "financial",
        "question": "For loans contracts which are still running where client are in debt, list the district of the and the state the percentage unemployment rate increment from year 1995 to 1996.",
        "original_query": "SELECT CAST((T3.A13 - T3.A12) AS REAL) * 100 / T3.A12 FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.status = 'D'",
        "llm_output": "-- Reasoning\nTo answer the question, we first identify loan contracts that are \"still running where clients are in debt\" by filtering the `loan` table for `status = 'D'`. We then join this result with the `account` table on `account_id` to link to the corresponding `district`. Finally, we join with the `district` table on `district_id` to retrieve the district's name (A2), its state (A3), and calculate the unemployment rate increment by subtracting the 1995 rate (A12) from the 1996 rate (A13).\n\n-- SQL Query\nSELECT T3.A2, T3.A3, (T3.A13 - T3.A12)\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.status = 'D';",
        "pred_query": "SELECT T3.A2, T3.A3, (T3.A13 - T3.A12)\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.status = 'D';",
        "pred_time": 0.0012919902801513672,
        "orig_time": null,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Calculate the percentage of account from 'Decin' district for all accounts are opened in 1993.",
        "original_query": "SELECT CAST(SUM(T1.A2 = 'Decin') AS REAL) * 100 / COUNT(account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T2.date) = '1993'",
        "llm_output": "-- Reasoning\nWe need to calculate the percentage of accounts from the 'Decin' district that were opened in 1993, relative to all accounts opened in 1993. First, we count accounts opened in 1993 from 'Decin' by joining `account` with `district` and filtering on `A3` for 'Decin' and the year 1993. Second, we count all accounts opened in 1993. Finally, we divide the first count by the second and multiply by 100 to get the percentage.\n\n-- SQL Query\nSELECT CAST(SUM(CASE WHEN T2.A3 = 'Decin' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE STRFTIME('%Y', T1.date) = '1993';",
        "pred_query": "SELECT CAST(SUM(CASE WHEN T2.A3 = 'Decin' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE STRFTIME('%Y', T1.date) = '1993';",
        "pred_time": 0.002460479736328125,
        "orig_time": 0.0022144317626953125,
        "time_ratio": 0.9,
        "check": false
    },
    {
        "id": "financial",
        "question": "List the account IDs with monthly issuance of statements.",
        "original_query": "SELECT account_id FROM account WHERE Frequency = 'POPLATEK MESICNE'",
        "llm_output": "-- Reasoning\nWe need to select the account IDs from the `account` table where the `frequency` column indicates 'monthly' issuance of statements.\n\n-- SQL Query\nSELECT account_id\nFROM account\nWHERE frequency = 'monthly';",
        "pred_query": "SELECT account_id\nFROM account\nWHERE frequency = 'monthly';",
        "pred_time": 0.0014519691467285156,
        "orig_time": 0.002177000045776367,
        "time_ratio": 1.499343185550082,
        "check": false
    },
    {
        "id": "financial",
        "question": "List the top ten districts, by descending order, from the highest to the lowest, the number of female account holders.",
        "original_query": "SELECT T2.A2, COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' GROUP BY T2.district_id, T2.A2 ORDER BY COUNT(T1.client_id) DESC LIMIT 10",
        "llm_output": "-- Reasoning\nWe need to find the number of female account holders per district. An account holder is a client linked to an account via the `disp` table. We join the `client` and `disp` tables, filter for female clients, group by district, count the distinct female clients, and then order and limit the results to the top ten districts.\n\n-- SQL Query\nSELECT T1.district_id\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nWHERE\n  T1.gender = 'F'\nGROUP BY\n  T1.district_id\nORDER BY\n  COUNT(DISTINCT T1.client_id) DESC\nLIMIT 10;",
        "pred_query": "SELECT T1.district_id\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nWHERE\n  T1.gender = 'F'\nGROUP BY\n  T1.district_id\nORDER BY\n  COUNT(DISTINCT T1.client_id) DESC\nLIMIT 10;",
        "pred_time": 0.0027577877044677734,
        "orig_time": 0.0018970966339111328,
        "time_ratio": 0.6879052476873865,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which are the top ten withdrawals (non-credit card) by district names for the month of January 1996?",
        "original_query": "SELECT T1.district_id FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T3.type = 'VYDAJ' AND T2.date LIKE '1996-01%' ORDER BY A2 ASC LIMIT 10",
        "llm_output": "-- Reasoning\nWe need to identify withdrawals from the `trans` table, specifically for January 1996, and exclude any related to credit cards. We then join this data with the `account` table and subsequently with the `district` table to get the district names. The transactions are then grouped by district, their amounts summed, and the top ten districts with the highest total withdrawal amounts are selected.\n\n-- SQL Query\nSELECT T3.A2\nFROM trans AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.type = 'withdrawal' AND STRFTIME('%Y-%m', T1.date) = '1996-01' AND T1.k_symbol <> 'credit card'\nGROUP BY\n  T3.A2\nORDER BY\n  SUM(T1.amount) DESC\nLIMIT 10;",
        "pred_query": "SELECT T3.A2\nFROM trans AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.type = 'withdrawal' AND STRFTIME('%Y-%m', T1.date) = '1996-01' AND T1.k_symbol <> 'credit card'\nGROUP BY\n  T3.A2\nORDER BY\n  SUM(T1.amount) DESC\nLIMIT 10;",
        "pred_time": 0.0771031379699707,
        "orig_time": 0.11137008666992188,
        "time_ratio": 1.4444300141622912,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many of the account holders in South Bohemia still do not own credit cards?",
        "original_query": "SELECT COUNT(T3.account_id) FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T2.client_id = T3.client_id WHERE T1.A3 = 'south Bohemia' AND T3.type != 'OWNER'",
        "llm_output": "-- Reasoning\nWe need to count clients from 'South Bohemia' who do not have any credit cards.\nFirst, we identify all `client_id`s who possess at least one credit card by joining `disp` and `card` tables and filtering for `card.type = 'credit'`.\nThen, we count the distinct `client_id`s from the `client` table that are linked to 'South Bohemia' (via the `district` table) and whose `client_id` is NOT in the previously identified set of credit card holders.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE T2.A3 = 'South Bohemia' AND T1.client_id NOT IN (\n    SELECT T3.client_id\n    FROM disp AS T3\n    INNER JOIN card AS T4\n      ON T3.disp_id = T4.disp_id\n    WHERE T4.type = 'credit'\n);",
        "pred_query": "SELECT COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE T2.A3 = 'South Bohemia' AND T1.client_id NOT IN (\n    SELECT T3.client_id\n    FROM disp AS T3\n    INNER JOIN card AS T4\n      ON T3.disp_id = T4.disp_id\n    WHERE T4.type = 'credit'\n);",
        "pred_time": 0.002325296401977539,
        "orig_time": 0.0012011528015136719,
        "time_ratio": 0.5165590074848765,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which district has highest active loan?",
        "original_query": "SELECT T2.A3 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T3.status IN ('C', 'D') GROUP BY T2.A3 ORDER BY SUM(T3.amount) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the district with the highest total amount of active loans. This requires joining the `district`, `account`, and `loan` tables. We will filter the `loan` table for 'Active' status, sum the loan amounts for each district, and then select the district with the maximum sum.\n\n-- SQL Query\nSELECT T1.district_id\nFROM district AS T1\nINNER JOIN account AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T3.status = 'A' -- Assuming 'A' represents active status based on common database patterns\nGROUP BY\n  T1.district_id\nORDER BY\n  SUM(T3.amount) DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.district_id\nFROM district AS T1\nINNER JOIN account AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T3.status = 'A' -- Assuming 'A' represents active status based on common database patterns\nGROUP BY\n  T1.district_id\nORDER BY\n  SUM(T3.amount) DESC\nLIMIT 1;",
        "pred_time": 0.00151824951171875,
        "orig_time": 0.0009479522705078125,
        "time_ratio": 0.6243718592964824,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the average loan amount by male borrowers?",
        "original_query": "SELECT AVG(T3.amount) FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id WHERE T1.gender = 'M'",
        "llm_output": "-- Reasoning\nWe need to link clients to loans to filter by gender. We will join `client` (for gender), `disp` (to link client to account), and `loan` (for loan amount) tables. Then, we filter for male clients and calculate the average loan amount.\n\n-- SQL Query\nSELECT AVG(T3.amount)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN loan AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.gender = 'M';",
        "pred_query": "SELECT AVG(T3.amount)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN loan AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.gender = 'M';",
        "pred_time": 0.002195119857788086,
        "orig_time": 0.004926204681396484,
        "time_ratio": 2.2441620506136637,
        "check": false
    },
    {
        "id": "financial",
        "question": "In 1996, which districts have the highest unemployment rate? List their branch location and district name.",
        "original_query": "SELECT district_id, A2 FROM district ORDER BY A13 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the district with the highest unemployment rate for the year 1996. The `district` table contains district names in column `A2`, branch locations in column `A3`, and the unemployment rate for 1996 in column `A10`. We will select these columns, order by `A10` in descending order, and take the top result.\n\n-- SQL Query\nSELECT A3, A2\nFROM district\nORDER BY A10 DESC\nLIMIT 1;",
        "pred_query": "SELECT A3, A2\nFROM district\nORDER BY A10 DESC\nLIMIT 1;",
        "pred_time": 0.0010387897491455078,
        "orig_time": 0.0004870891571044922,
        "time_ratio": 0.46890061969244895,
        "check": false
    },
    {
        "id": "financial",
        "question": "In the branch where the largest number of crimes were committed in 1996, how many accounts were opened?",
        "original_query": "SELECT COUNT(T2.account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id GROUP BY T1.A16 ORDER BY T1.A16 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nFirst, identify the district with the highest number of crimes committed in 1996 by selecting the district_id where the A10 column (number of crimes in 1996) is maximized. Then, count the total number of accounts from the account table that belong to this specific district.\n\n-- SQL Query\nSELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nORDER BY T2.A10 DESC\nLIMIT 1;",
        "pred_query": "SELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nORDER BY T2.A10 DESC\nLIMIT 1;",
        "pred_time": 0.0017750263214111328,
        "orig_time": 0.0019218921661376953,
        "time_ratio": 1.0827400940228342,
        "check": false
    },
    {
        "id": "financial",
        "question": "After making a credit card withdrawal, how many account/s with monthly issuance has a negative balance?",
        "original_query": "SELECT COUNT(T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.balance < 0 AND T1.operation = 'VYBER KARTOU' AND T2.frequency = 'POPLATEK MESICNE'",
        "llm_output": "-- Reasoning\nWe need to count accounts that satisfy three conditions:\n1. The account's frequency is 'monthly'.\n2. The account has made at least one 'credit card withdrawal', identified by `type = 'withdrawal'` and `operation = 'credit card withdrawal'` in the `trans` table.\n3. The account's overall latest transaction balance is negative. The latest transaction for an account is determined by the maximum `date`, and then by the maximum `trans_id` if dates are tied.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nWHERE T1.frequency = 'monthly'\n  AND T1.account_id IN (\n    SELECT DISTINCT T2.account_id\n    FROM trans AS T2\n    WHERE T2.type = 'withdrawal' AND T2.operation = 'credit card withdrawal'\n  )\n  AND T1.account_id IN (\n    SELECT T3.account_id\n    FROM trans AS T3\n    WHERE T3.balance < 0\n      AND NOT EXISTS (\n        SELECT 1\n        FROM trans AS T4\n        WHERE T4.account_id = T3.account_id\n          AND (T4.date > T3.date OR (T4.date = T3.date AND T4.trans_id > T3.trans_id))\n      )\n  );",
        "pred_query": "SELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nWHERE T1.frequency = 'monthly'\n  AND T1.account_id IN (\n    SELECT DISTINCT T2.account_id\n    FROM trans AS T2\n    WHERE T2.type = 'withdrawal' AND T2.operation = 'credit card withdrawal'\n  )\n  AND T1.account_id IN (\n    SELECT T3.account_id\n    FROM trans AS T3\n    WHERE T3.balance < 0\n      AND NOT EXISTS (\n        SELECT 1\n        FROM trans AS T4\n        WHERE T4.account_id = T3.account_id\n          AND (T4.date > T3.date OR (T4.date = T3.date AND T4.trans_id > T3.trans_id))\n      )\n  );",
        "pred_time": 0.07854270935058594,
        "orig_time": 0.07361960411071777,
        "time_ratio": 0.9373193860948542,
        "check": false
    },
    {
        "id": "financial",
        "question": "Between 1/1/1995 and 12/31/1997, how many loans in the amount of at least 250,000 per account that chose monthly statement issuance were approved?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T2.date BETWEEN '1995-01-01' AND '1997-12-31' AND T1.frequency = 'POPLATEK MESICNE' AND T2.amount > 250000",
        "llm_output": "-- Reasoning\nWe need to count loans that meet several conditions. We will join the `loan` table with the `account` table on `account_id` to access the loan details and the account's frequency. Then, we filter by the date range, amount, loan status, and account frequency, and finally count the resulting loans.\n\n-- SQL Query\nSELECT COUNT(T1.loan_id)\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.date BETWEEN '1995-01-01' AND '1997-12-31' AND T1.amount >= 250000 AND T1.status = 'Approved' AND T2.frequency = 'monthly statement';",
        "pred_query": "SELECT COUNT(T1.loan_id)\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.date BETWEEN '1995-01-01' AND '1997-12-31' AND T1.amount >= 250000 AND T1.status = 'Approved' AND T2.frequency = 'monthly statement';",
        "pred_time": 0.0011491775512695312,
        "orig_time": 0.0007123947143554688,
        "time_ratio": 0.6199170124481328,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts have running contracts in Branch location 1?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T1.district_id = 1 AND (T3.status = 'C' OR T3.status = 'D')",
        "llm_output": "-- Reasoning\nWe need to count accounts that are associated with loans having a 'running' status and belong to 'Branch location 1'. We will join the `account`, `loan`, and `district` tables. We filter for loans with status 'C' (representing running contracts) and districts with `district_id` equal to 1 (representing Branch location 1), then count the distinct account IDs.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T1.district_id = T3.district_id\nWHERE\n  T2.status = 'C' AND T3.district_id = 1;",
        "pred_query": "SELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T1.district_id = T3.district_id\nWHERE\n  T2.status = 'C' AND T3.district_id = 1;",
        "pred_time": 0.0015070438385009766,
        "orig_time": 0.0007221698760986328,
        "time_ratio": 0.4791963296946686,
        "check": false
    },
    {
        "id": "financial",
        "question": "In the branch where the second-highest number of crimes were committed in 1995 occurred, how many male clients are there?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'M' AND T2.A15 = (SELECT T3.A15 FROM district AS T3 ORDER BY T3.A15 DESC LIMIT 1, 1)",
        "llm_output": "-- Reasoning\nFirst, we need to find the `district_id` of the district that had the second-highest number of crimes committed in 1995, which is represented by column `A14` in the `district` table. Then, we count the number of male clients in that specific district by filtering the `client` table based on gender and the identified `district_id`.\n\n-- SQL Query\nSELECT COUNT(T1.client_id)\nFROM client AS T1\nWHERE T1.gender = 'M' AND T1.district_id = (\n    SELECT T2.district_id\n    FROM district AS T2\n    ORDER BY T2.A14 DESC\n    LIMIT 1 OFFSET 1\n);",
        "pred_query": "SELECT COUNT(T1.client_id)\nFROM client AS T1\nWHERE T1.gender = 'M' AND T1.district_id = (\n    SELECT T2.district_id\n    FROM district AS T2\n    ORDER BY T2.A14 DESC\n    LIMIT 1 OFFSET 1\n);",
        "pred_time": 0.0016160011291503906,
        "orig_time": 0.0017743110656738281,
        "time_ratio": 1.0979640011802891,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many high-level credit cards have \"disponent\" type of disposition?",
        "original_query": "SELECT COUNT(T1.card_id) FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id WHERE T1.type = 'gold' AND T2.type = 'DISPONENT'",
        "llm_output": "-- Reasoning\nWe need to count cards that are both \"high-level\" and have a \"disponent\" disposition. We can assume \"high-level\" refers to a card type like 'gold' in the `card` table. We will join the `card` table with the `disp` table on `disp_id` to access the disposition type. Then, we filter for cards with `type = 'gold'` and disposition `type = 'disponent'`, and finally count the matching records.\n\n-- SQL Query\nSELECT COUNT(T1.card_id)\nFROM card AS T1\nINNER JOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nWHERE\n  T1.type = 'gold' AND T2.type = 'disponent';",
        "pred_query": "SELECT COUNT(T1.card_id)\nFROM card AS T1\nINNER JOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nWHERE\n  T1.type = 'gold' AND T2.type = 'disponent';",
        "pred_time": 0.0012612342834472656,
        "orig_time": 0.0006301403045654297,
        "time_ratio": 0.4996219281663516,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many accounts are there in the district of \"Pisek\"?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A2 = 'Pisek'",
        "llm_output": "-- Reasoning\nWe need to count the accounts. We can join the `account` table with the `district` table on `district_id`. Then, we filter for districts where the `A2` column (which represents the district name) is 'Pisek' and count the distinct `account_id`s.\n\n-- SQL Query\nSELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A2 = 'Pisek';",
        "pred_query": "SELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A2 = 'Pisek';",
        "pred_time": 0.0017864704132080078,
        "orig_time": 0.001207590103149414,
        "time_ratio": 0.6759642332843988,
        "check": true
    },
    {
        "id": "financial",
        "question": "Which districts have transactions greater than USS$10,000 in 1997?",
        "original_query": "SELECT T1.district_id FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T1.account_id = T3.account_id WHERE STRFTIME('%Y', T3.date) = '1997' GROUP BY T1.district_id HAVING SUM(T3.amount) > 10000",
        "llm_output": "-- Reasoning\nWe need to find districts based on transaction data. This requires joining the `district`, `account`, and `trans` tables. We will filter transactions by year 1997 and amount greater than 10,000, then select the distinct district IDs.\n\n-- SQL Query\nSELECT DISTINCT T1.district_id\nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nWHERE STRFTIME('%Y', T3.date) = '1997' AND T3.amount > 10000;",
        "pred_query": "SELECT DISTINCT T1.district_id\nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nWHERE STRFTIME('%Y', T3.date) = '1997' AND T3.amount > 10000;",
        "pred_time": 0.27942681312561035,
        "orig_time": 0.4109013080596924,
        "time_ratio": 1.470514956898501,
        "check": true
    },
    {
        "id": "financial",
        "question": "Which accounts placed orders for household payment in Pisek?",
        "original_query": "SELECT DISTINCT T2.account_id FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.k_symbol = 'SIPO' AND T3.A2 = 'Pisek'",
        "llm_output": "-- Reasoning\nWe need to find account IDs that are linked to orders for household payments and are located in the district 'Pisek'. We will join the `account` table with the `order` table on `account_id` and with the `district` table on `district_id`. Then, we filter for orders with `k_symbol` 'HOUSEHOLD' and districts named 'Pisek' (column A3). Finally, we select the distinct account IDs.\n\n-- SQL Query\nSELECT DISTINCT T1.account_id\nFROM account AS T1\nINNER JOIN `order` AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T1.district_id = T3.district_id\nWHERE T2.k_symbol = 'HOUSEHOLD' AND T3.A3 = 'Pisek';",
        "pred_query": "SELECT DISTINCT T1.account_id\nFROM account AS T1\nINNER JOIN `order` AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T1.district_id = T3.district_id\nWHERE T2.k_symbol = 'HOUSEHOLD' AND T3.A3 = 'Pisek';",
        "pred_time": 0.0013399124145507812,
        "orig_time": 0.09230446815490723,
        "time_ratio": 68.88843416370106,
        "check": false
    },
    {
        "id": "financial",
        "question": "What are the accounts that have both gold and junior credit cards?",
        "original_query": "SELECT T2.account_id FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id WHERE T1.type IN ('gold', 'junior')",
        "llm_output": "-- Reasoning\nWe need to find account IDs that are associated with both 'gold' and 'junior' credit card types. We join the `card` table with the `disp` table on `disp_id`, filter for card types 'gold' or 'junior', group by `account_id`, and ensure that both distinct types are present for each account.\n\n-- SQL Query\nSELECT T2.account_id\nFROM card AS T1\nINNER JOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nWHERE\n  T1.type IN ('gold', 'junior')\nGROUP BY\n  T2.account_id\nHAVING\n  COUNT(DISTINCT T1.type) = 2;",
        "pred_query": "SELECT T2.account_id\nFROM card AS T1\nINNER JOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nWHERE\n  T1.type IN ('gold', 'junior')\nGROUP BY\n  T2.account_id\nHAVING\n  COUNT(DISTINCT T1.type) = 2;",
        "pred_time": 0.0013997554779052734,
        "orig_time": 0.0007555484771728516,
        "time_ratio": 0.5397717594958269,
        "check": false
    },
    {
        "id": "financial",
        "question": "How much is the average amount in credit card made by account holders in a month, in year 2021?",
        "original_query": "SELECT AVG(T3.amount) FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE STRFTIME('%Y', T3.date) = '2021' AND T3.operation = 'VYBER KARTOU'",
        "llm_output": "-- Reasoning\nWe need to calculate the average transaction amount for credit card related transactions in the year 2021.\nFirst, we join the `trans` table with the `disp` table using `account_id`, and then join `disp` with the `card` table using `disp_id`. This links transactions to specific cards.\nWe assume that the card types 'junior', 'classic', and 'gold' in the `card` table represent various forms of credit cards.\nThen, we filter these linked transactions to include only those that occurred in the year 2021.\nFinally, we compute the average of the `amount` for these filtered transactions.\n\n-- SQL Query\nSELECT AVG(T1.amount)\nFROM trans AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE STRFTIME('%Y', T1.date) = '2021';",
        "pred_query": "SELECT AVG(T1.amount)\nFROM trans AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE STRFTIME('%Y', T1.date) = '2021';",
        "pred_time": 0.2819783687591553,
        "orig_time": 0.4164888858795166,
        "time_ratio": 1.477024240236137,
        "check": true
    },
    {
        "id": "financial",
        "question": "Who are the account holder identification numbers whose spent per month on the credit card is less than the average, in 1998?",
        "original_query": "SELECT T1.account_id FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE STRFTIME('%Y', T1.date) = '1998' AND T1.operation = 'VYBER KARTOU' AND T1.amount < (SELECT AVG(amount) FROM trans WHERE STRFTIME('%Y', date) = '1998')",
        "llm_output": "-- Reasoning\nWe need to find the account holder identification numbers (`disp_id`) whose monthly spending on a credit card in 1998 was less than the overall average monthly credit card spending.\nFirst, we identify all transactions that represent 'withdrawal by credit card' in the year 1998 from the `trans` table.\nWe then join `trans` with `disp` (using `account_id`) and `card` (using `disp_id`) to link these transactions to specific account holders.\nFor each unique `disp_id` and month, we calculate the total amount spent.\nNext, we calculate the average of all these individual monthly spending amounts.\nFinally, we select the distinct `disp_id`s for whom any of their calculated monthly spending amounts was less than this overall average.\n\n-- SQL Query\nWITH MonthlySpentPerDisp AS (\n    SELECT\n        D.disp_id,\n        STRFTIME('%Y-%m', T.date) AS transaction_month,\n        SUM(T.amount) AS monthly_spent\n    FROM trans AS T\n    JOIN disp AS D ON T.account_id = D.account_id\n    JOIN card AS C ON D.disp_id = C.disp_id -- Ensure disp_id is associated with a card\n    WHERE T.operation = 'withdrawal by credit card'\n      AND STRFTIME('%Y', T.date) = '1998'\n    GROUP BY D.disp_id, STRFTIME('%Y-%m', T.date)\n)\nSELECT DISTINCT MS.disp_id\nFROM MonthlySpentPerDisp AS MS\nWHERE MS.monthly_spent < (SELECT AVG(monthly_spent) FROM MonthlySpentPerDisp);",
        "pred_query": "SELECT\n        D.disp_id,\n        STRFTIME('%Y-%m', T.date) AS transaction_month,\n        SUM(T.amount) AS monthly_spent\n    FROM trans AS T\n    JOIN disp AS D ON T.account_id = D.account_id\n    JOIN card AS C ON D.disp_id = C.disp_id -- Ensure disp_id is associated with a card\n    WHERE T.operation = 'withdrawal by credit card'\n      AND STRFTIME('%Y', T.date) = '1998'\n    GROUP BY D.disp_id, STRFTIME('%Y-%m', T.date)\n)\nSELECT DISTINCT MS.disp_id\nFROM MonthlySpentPerDisp AS MS\nWHERE MS.monthly_spent < (SELECT AVG(monthly_spent) FROM MonthlySpentPerDisp);",
        "pred_time": null,
        "orig_time": 0.5979187488555908,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Who are the female account holders who own credit cards and also have loans?",
        "original_query": "SELECT T1.client_id FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id INNER JOIN card AS T4 ON T2.disp_id = T4.disp_id WHERE T1.gender = 'F'",
        "llm_output": "-- Reasoning\nWe need to find the `client_id` for female clients who are linked to an account that has a loan, and also linked to a disposition that has a credit card. We join the `client`, `disp`, `card`, and `loan` tables, filter for female clients and credit card types, and use `DISTINCT` to ensure unique client IDs.\n\n-- SQL Query\nSELECT DISTINCT T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nINNER JOIN loan AS T4 ON T2.account_id = T4.account_id\nWHERE T1.gender = 'F' AND T3.type = 'credit';",
        "pred_query": "SELECT DISTINCT T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nINNER JOIN loan AS T4 ON T2.account_id = T4.account_id\nWHERE T1.gender = 'F' AND T3.type = 'credit';",
        "pred_time": 0.0013051033020019531,
        "orig_time": 0.0011763572692871094,
        "time_ratio": 0.9013518450858604,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many female clients' accounts are in the region of South Bohemia?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' AND T2.A3 = 'south Bohemia'",
        "llm_output": "-- Reasoning\nWe need to count clients based on gender and district region. Join the `client` table with the `district` table using `district_id`. Filter for female clients (`gender = 'F'`) and for districts in 'South Bohemia' (column `A3`). Finally, count the resulting clients.\n\n-- SQL Query\nSELECT COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T1.gender = 'F' AND T2.A3 = 'south Bohemia';",
        "pred_query": "SELECT COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T1.gender = 'F' AND T2.A3 = 'south Bohemia';",
        "pred_time": 0.0015492439270019531,
        "orig_time": 0.0011143684387207031,
        "time_ratio": 0.7192982456140351,
        "check": true
    },
    {
        "id": "financial",
        "question": "Please list the accounts whose district is Tabor that are eligible for loans.",
        "original_query": "SELECT T2.account_id FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T2.account_id = T3.account_id WHERE T3.type = 'OWNER' AND T1.A2 = 'Tabor'",
        "llm_output": "-- Reasoning\nWe need to find accounts that belong to the 'Tabor' district and have approved or successfully completed loans. We will join the `district` table with the `account` table on `district_id`, and then join with the `loan` table on `account_id`. We filter for districts named 'Tabor' (assuming `A2` contains the district name) and loans with a status of 'A' (approved) or 'C' (contract finished, implying eligibility). Finally, we select distinct account IDs.\n\n-- SQL Query\nSELECT DISTINCT T1.account_id\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3\n  ON T1.account_id = T3.account_id\nWHERE\n  T2.A2 = 'Tabor' AND T3.status IN ('A', 'C');",
        "pred_query": "SELECT DISTINCT T1.account_id\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3\n  ON T1.account_id = T3.account_id\nWHERE\n  T2.A2 = 'Tabor' AND T3.status IN ('A', 'C');",
        "pred_time": 0.0011000633239746094,
        "orig_time": 0.001726388931274414,
        "time_ratio": 1.569354139575206,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please list the account types that are not eligible for loans, and the average income of residents in the district where the account is located exceeds $8000 but is no more than $9000.",
        "original_query": "SELECT T3.type FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T2.account_id = T3.account_id WHERE T3.type != 'OWNER' AND T1.A11 BETWEEN 8000 AND 9000",
        "llm_output": "-- Reasoning\nWe need to find the distinct `frequency` values (interpreted as account types) from the `account` table. We join `account` with `district` on `district_id` to access the average income information (`A11`). We filter the districts where `A11` exceeds 8000 but is no more than 9000. Finally, we exclude accounts that already have a corresponding entry in the `loan` table, thus identifying those \"not eligible\" for loans.\n\n-- SQL Query\nSELECT DISTINCT T1.frequency\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE T2.A11 > 8000 AND T2.A11 <= 9000 AND T1.account_id NOT IN (\n  SELECT account_id\n  FROM loan\n);",
        "pred_query": "SELECT DISTINCT T1.frequency\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE T2.A11 > 8000 AND T2.A11 <= 9000 AND T1.account_id NOT IN (\n  SELECT account_id\n  FROM loan\n);",
        "pred_time": 0.002508878707885742,
        "orig_time": 0.0014333724975585938,
        "time_ratio": 0.5713199657892236,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts in North Bohemia has made a transaction with the partner's bank being AB?",
        "original_query": "SELECT COUNT(T2.account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T3.bank = 'AB' AND T1.A3 = 'north Bohemia'",
        "llm_output": "-- Reasoning\nWe need to count distinct account IDs. We will join `district`, `account`, and `trans` tables. First, filter the `district` table for 'North Bohemia' (column A3). Then, join with `account` on `district_id` and with `trans` on `account_id`. Finally, filter `trans` records where the partner bank is 'AB' and count the distinct `account_id`s.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3\n  ON T1.account_id = T3.account_id\nWHERE\n  T2.A3 = 'North Bohemia' AND T3.bank = 'AB';",
        "pred_query": "SELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3\n  ON T1.account_id = T3.account_id\nWHERE\n  T2.A3 = 'North Bohemia' AND T3.bank = 'AB';",
        "pred_time": 0.08822512626647949,
        "orig_time": 0.08990049362182617,
        "time_ratio": 1.0189896849825562,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please list the name of the districts with accounts that made withdrawal transactions.",
        "original_query": "SELECT DISTINCT T1.A2 FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T3.type = 'VYDAJ'",
        "llm_output": "-- Reasoning\nWe need to find districts associated with withdrawal transactions.\nJoin the `district` table with `account` using `district_id`.\nThen, join `account` with `trans` using `account_id`.\nFilter transactions where the `type` is 'withdrawal'.\nSelect the distinct district names (A2 column) from the `district` table.\n\n-- SQL Query\nSELECT DISTINCT T3.A2\nFROM trans AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.type = 'withdrawal';",
        "pred_query": "SELECT DISTINCT T3.A2\nFROM trans AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN district AS T3\n  ON T2.district_id = T3.district_id\nWHERE\n  T1.type = 'withdrawal';",
        "pred_time": 0.08248114585876465,
        "orig_time": 0.165557861328125,
        "time_ratio": 2.0072206757604403,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the average number of crimes committed in 1995 in regions where the number exceeds 4000 and the region has accounts that are opened starting from the year 1997?",
        "original_query": "SELECT AVG(T1.A15) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T2.date) >= '1997' AND T1.A15 > 4000",
        "llm_output": "-- Reasoning\nWe need to find districts that satisfy two conditions: first, the number of crimes committed in 1995 (represented by A16) exceeds 4000; second, the district has at least one account opened in 1997 or later. We will use a subquery to identify districts with accounts opened from 1997 onwards. Then, we will filter the main district table based on both conditions and calculate the average of A16 for these qualifying districts.\n\n-- SQL Query\nSELECT AVG(T1.A16)\nFROM district AS T1\nWHERE T1.A16 > 4000 AND T1.district_id IN (\n    SELECT DISTINCT T2.district_id\n    FROM account AS T2\n    WHERE STRFTIME('%Y', T2.date) >= '1997'\n);",
        "pred_query": "SELECT AVG(T1.A16)\nFROM district AS T1\nWHERE T1.A16 > 4000 AND T1.district_id IN (\n    SELECT DISTINCT T2.district_id\n    FROM account AS T2\n    WHERE STRFTIME('%Y', T2.date) >= '1997'\n);",
        "pred_time": 0.0032219886779785156,
        "orig_time": 0.0032198429107666016,
        "time_ratio": 0.9993340239751369,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many 'classic' cards are eligible for loan?",
        "original_query": "SELECT COUNT(T1.card_id) FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id WHERE T1.type = 'classic' AND T2.type = 'Owner'",
        "llm_output": "-- Reasoning\nWe need to count cards of type 'classic' that are associated with an account that has a loan. We will join the `card` table with `disp`, then `disp` with `account`, and finally `account` with `loan`. We filter for 'classic' card types and then count the distinct card IDs.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.card_id)\nFROM card AS T1\nINNER JOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN loan AS T4\n  ON T3.account_id = T4.account_id\nWHERE\n  T1.type = 'classic';",
        "pred_query": "SELECT COUNT(DISTINCT T1.card_id)\nFROM card AS T1\nINNER JOIN disp AS T2\n  ON T1.disp_id = T2.disp_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN loan AS T4\n  ON T3.account_id = T4.account_id\nWHERE\n  T1.type = 'classic';",
        "pred_time": 0.0014910697937011719,
        "orig_time": 0.0007016658782958984,
        "time_ratio": 0.4705788295490886,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many male clients in 'Hl.m. Praha' district?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'M' AND T2.A2 = 'Hl.m. Praha'",
        "llm_output": "-- Reasoning\nWe need to count clients from the `client` table. We join `client` with `district` on `district_id` to access the district name. We filter for gender 'MALE' and the district named 'Hl.m. Praha' using the `A3` column in the `district` table.\n\n-- SQL Query\nSELECT COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.gender = 'MALE' AND T2.A3 = 'Hl.m. Praha';",
        "pred_query": "SELECT COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.gender = 'MALE' AND T2.A3 = 'Hl.m. Praha';",
        "pred_time": 0.0011861324310302734,
        "orig_time": 0.0011701583862304688,
        "time_ratio": 0.986532663316583,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many percent of 'Gold' cards were issued prior to 1998?",
        "original_query": "SELECT CAST(SUM(type = 'gold') AS REAL) * 100 / COUNT(card_id) FROM card WHERE STRFTIME('%Y', issued) < '1998'",
        "llm_output": "-- Reasoning\nWe need to calculate two counts: the total number of 'Gold' cards and the number of 'Gold' cards issued before 1998. Then, we divide the latter by the former and multiply by 100 to get the percentage. We can achieve this by filtering the `card` table for 'Gold' type and using a conditional count for the year check.\n\n-- SQL Query\nSELECT CAST(SUM(CASE WHEN STRFTIME('%Y', issued) < '1998' THEN 1 ELSE 0 END) AS REAL) * 100.0 / COUNT(*)\nFROM card\nWHERE type = 'Gold';",
        "pred_query": "SELECT CAST(SUM(CASE WHEN STRFTIME('%Y', issued) < '1998' THEN 1 ELSE 0 END) AS REAL) * 100.0 / COUNT(*)\nFROM card\nWHERE type = 'Gold';",
        "pred_time": 0.0008924007415771484,
        "orig_time": 0.0009584426879882812,
        "time_ratio": 1.0740048089767567,
        "check": false
    },
    {
        "id": "financial",
        "question": "Who is the owner of the account with the largest loan amount?",
        "original_query": "SELECT T1.client_id FROM disp AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T1.type = 'OWNER' ORDER BY T2.amount DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the client (owner) associated with the account that has the highest loan amount. We will join the `loan` table with the `disp` table on `account_id`, and then join `disp` with the `client` table on `client_id`. Finally, we order by the loan amount in descending order and select the `client_id` of the top record.\n\n-- SQL Query\nSELECT T3.client_id\nFROM loan AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN client AS T3\n  ON T2.client_id = T3.client_id\nORDER BY T1.amount DESC\nLIMIT 1;",
        "pred_query": "SELECT T3.client_id\nFROM loan AS T1\nINNER JOIN disp AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN client AS T3\n  ON T2.client_id = T3.client_id\nORDER BY T1.amount DESC\nLIMIT 1;",
        "pred_time": 0.0018184185028076172,
        "orig_time": 0.0015163421630859375,
        "time_ratio": 0.8338796381277042,
        "check": true
    },
    {
        "id": "financial",
        "question": "What is the number of committed crimes in 1995 in the district of the account with the id 532?",
        "original_query": "SELECT T1.A15 FROM district AS T1 INNER JOIN `account` AS T2 ON T1.district_id = T2.district_id WHERE T2.account_id = 532",
        "llm_output": "-- Reasoning\nFirst, find the district ID associated with the account ID 532 from the `account` table. Then, use this district ID to retrieve the number of committed crimes in 1995 (represented by column A16) from the `district` table.\n\n-- SQL Query\nSELECT T2.A16\nFROM account AS T1\nINNER JOIN district AS T2\nON T1.district_id = T2.district_id\nWHERE T1.account_id = 532;",
        "pred_query": "SELECT T2.A16\nFROM account AS T1\nINNER JOIN district AS T2\nON T1.district_id = T2.district_id\nWHERE T1.account_id = 532;",
        "pred_time": 0.0007927417755126953,
        "orig_time": 0.00048661231994628906,
        "time_ratio": 0.6138345864661654,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the district Id of the account that placed the order with the id 33333?",
        "original_query": "SELECT T3.district_id FROM `order` AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.order_id = 33333",
        "llm_output": "-- Reasoning\nWe need to find the `district_id` linked to a specific order. We can join the `order` table with the `account` table on `account_id`, filter for the given `order_id`, and then select the corresponding `district_id`.\n\n-- SQL Query\nSELECT T2.district_id\nFROM `order` AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.order_id = 33333;",
        "pred_query": "SELECT T2.district_id\nFROM `order` AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.order_id = 33333;",
        "pred_time": 0.0009090900421142578,
        "orig_time": 0.0005357265472412109,
        "time_ratio": 0.5892997639653816,
        "check": true
    },
    {
        "id": "financial",
        "question": "List all the withdrawals in cash transactions that the client with the id 3356 makes.",
        "original_query": "SELECT T4.trans_id FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN trans AS T4 ON T3.account_id = T4.account_id WHERE T1.client_id = 3356 AND T4.operation = 'VYBER'",
        "llm_output": "-- Reasoning\nWe need to identify transactions made by the client with ID 3356. We'll join the `client`, `disp`, `account`, and `trans` tables. Then, we filter for transactions where the client_id is 3356, the transaction type is 'withdrawal', and the operation is 'cash in withdrawal'.\n\n-- SQL Query\nSELECT T4.*\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN account AS T3 ON T2.account_id = T3.account_id\nINNER JOIN trans AS T4 ON T3.account_id = T4.account_id\nWHERE T1.client_id = 3356 AND T4.type = 'withdrawal' AND T4.operation = 'cash in withdrawal';",
        "pred_query": "SELECT T4.*\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN account AS T3 ON T2.account_id = T3.account_id\nINNER JOIN trans AS T4 ON T3.account_id = T4.account_id\nWHERE T1.client_id = 3356 AND T4.type = 'withdrawal' AND T4.operation = 'cash in withdrawal';",
        "pred_time": 0.08999228477478027,
        "orig_time": 0.21252202987670898,
        "time_ratio": 2.36155833145673,
        "check": false
    },
    {
        "id": "financial",
        "question": "Among the weekly issuance accounts, how many have a loan of under 200000?",
        "original_query": "SELECT COUNT(T1.account_id) FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T2.frequency = 'POPLATEK TYDNE' AND T1.amount < 200000",
        "llm_output": "-- Reasoning\nWe need to count accounts that are issued weekly and have a loan amount less than 200000. We can join the `account` and `loan` tables on `account_id`, filter for `frequency = 'weekly'` and `amount < 200000`, and then count the distinct `account_id`s.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.frequency = 'weekly' AND T2.amount < 200000;",
        "pred_query": "SELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.frequency = 'weekly' AND T2.amount < 200000;",
        "pred_time": 0.0015108585357666016,
        "orig_time": 0.0008630752563476562,
        "time_ratio": 0.5712482247120089,
        "check": false
    },
    {
        "id": "financial",
        "question": "What type of credit card does the client with the id 13539 own?",
        "original_query": "SELECT T3.type FROM disp AS T1 INNER JOIN client AS T2 ON T1.client_id = T2.client_id INNER JOIN card AS T3 ON T1.disp_id = T3.disp_id WHERE T2.client_id = 13539",
        "llm_output": "-- Reasoning\nWe need to link the client to their card. We join the `client` table with the `disp` table on `client_id`, and then join `disp` with the `card` table on `disp_id`. Finally, we filter by the given client_id and select the card type.\n\n-- SQL Query\nSELECT T3.type\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE T1.client_id = 13539;",
        "pred_query": "SELECT T3.type\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE T1.client_id = 13539;",
        "pred_time": 0.0011303424835205078,
        "orig_time": 0.0012576580047607422,
        "time_ratio": 1.1126344653026787,
        "check": true
    },
    {
        "id": "financial",
        "question": "What is the region of the client with the id 3541 from?",
        "original_query": "SELECT T2.district_id, T1.A3 FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T2.client_id = 3541",
        "llm_output": "-- Reasoning\nWe need to find the district ID for the client with client_id 3541 from the client table, and then join with the district table using the district_id to retrieve the region, which is stored in column A3.\n\n-- SQL Query\nSELECT T2.A3\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T1.client_id = 3541;",
        "pred_query": "SELECT T2.A3\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T1.client_id = 3541;",
        "pred_time": 0.0008721351623535156,
        "orig_time": 0.0005059242248535156,
        "time_ratio": 0.580098414434117,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which district has the most accounts with loan contracts finished with no problems?",
        "original_query": "SELECT T1.district_id FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id WHERE T3.status = 'A' GROUP BY T1.district_id ORDER BY COUNT(T2.account_id) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to count the number of accounts with successfully finished loans for each district. We join the `district`, `account`, and `loan` tables. We filter for loans with status 'A' (assuming 'A' means 'finished, no problems'). Then, we group by district and count the distinct accounts, ordering by this count to find the district with the most such accounts.\n\n-- SQL Query\nSELECT T1.district_id\nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3 ON T2.account_id = T3.account_id\nWHERE T3.status = 'A'\nGROUP BY T1.district_id\nORDER BY COUNT(DISTINCT T2.account_id) DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.district_id\nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3 ON T2.account_id = T3.account_id\nWHERE T3.status = 'A'\nGROUP BY T1.district_id\nORDER BY COUNT(DISTINCT T2.account_id) DESC\nLIMIT 1;",
        "pred_time": 0.001165151596069336,
        "orig_time": 0.0007429122924804688,
        "time_ratio": 0.637609985676284,
        "check": true
    },
    {
        "id": "financial",
        "question": "Who placed the order with the id 32423?",
        "original_query": "SELECT T3.client_id FROM `order` AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN client AS T3 ON T2.district_id = T3.district_id WHERE T1.order_id = 32423",
        "llm_output": "-- Reasoning\nTo find out who placed the order, we need to connect the `order` table to the `client` table. We can achieve this by joining `order` with `account` on `account_id`, then joining `account` with `disp` on `account_id`, and finally joining `disp` with `client` on `client_id`. We filter the result by the given `order_id` and select the `client_id`.\n\n-- SQL Query\nSELECT T3.client_id\nFROM `order` AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN disp AS T4 ON T2.account_id = T4.account_id\nINNER JOIN client AS T3 ON T4.client_id = T3.client_id\nWHERE T1.order_id = 32423;",
        "pred_query": "SELECT T3.client_id\nFROM `order` AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN disp AS T4 ON T2.account_id = T4.account_id\nINNER JOIN client AS T3 ON T4.client_id = T3.client_id\nWHERE T1.order_id = 32423;",
        "pred_time": 0.0013422966003417969,
        "orig_time": 0.0010144710540771484,
        "time_ratio": 0.7557726465364121,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please list all the transactions made by accounts from district 5.",
        "original_query": "SELECT T3.trans_id FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T1.district_id = 5",
        "llm_output": "-- Reasoning\nWe need to retrieve all columns from the `trans` table. To link transactions to districts, we join the `trans` table with the `account` table using `account_id`. Then, we filter the results for accounts belonging to `district_id` 5.\n\n-- SQL Query\nSELECT T1.*\nFROM trans AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.district_id = 5;",
        "pred_query": "SELECT T1.*\nFROM trans AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.district_id = 5;",
        "pred_time": 0.15609979629516602,
        "orig_time": 0.10468649864196777,
        "time_ratio": 0.6706382783742917,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many of the accounts are from Jesenik district?",
        "original_query": "SELECT COUNT(T2.account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE T1.A2 = 'Jesenik'",
        "llm_output": "-- Reasoning\nWe need to count the accounts that belong to the 'Jesenik' district. We can achieve this by joining the `account` table with the `district` table on `district_id` and then filtering for districts where the `A2` column (which appears to be the district name) is 'Jesenik'.\n\n-- SQL Query\nSELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A2 = 'Jesenik';",
        "pred_query": "SELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A2 = 'Jesenik';",
        "pred_time": 0.0020203590393066406,
        "orig_time": 0.001485586166381836,
        "time_ratio": 0.7353080009440642,
        "check": true
    },
    {
        "id": "financial",
        "question": "List all the clients' IDs whose junior credit cards were issued after 1996.",
        "original_query": "SELECT T2.client_id FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id WHERE T1.type = 'junior' AND T1.issued >= '1997-01-01'",
        "llm_output": "-- Reasoning\nWe need to find clients associated with 'junior' type cards issued after 1996. This involves joining the `client`, `disp`, and `card` tables. We filter for card type 'junior' and issuance date greater than '1996-12-31', then select the distinct client IDs.\n\n-- SQL Query\nSELECT DISTINCT T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE T3.type = 'junior' AND T3.issued > '1996-12-31';",
        "pred_query": "SELECT DISTINCT T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE T3.type = 'junior' AND T3.issued > '1996-12-31';",
        "pred_time": 0.0015001296997070312,
        "orig_time": 0.0009639263153076172,
        "time_ratio": 0.6425619834710744,
        "check": true
    },
    {
        "id": "financial",
        "question": "What percentage of clients who opened their accounts in the district with an average salary of over 10000 are women?",
        "original_query": "SELECT CAST(SUM(T2.gender = 'F') AS REAL) * 100 / COUNT(T2.client_id) FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T1.A11 > 10000",
        "llm_output": "-- Reasoning\nFirst, identify districts where the average salary (A10) is greater than 10000. Then, join these districts with the client table to get all clients belonging to these specific districts. Finally, calculate the percentage of these clients who are women by counting female clients and dividing by the total count of clients from the filtered districts.\n\n-- SQL Query\nSELECT\n  CAST(SUM(CASE WHEN T1.gender = 'F' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A10 > 10000;",
        "pred_query": "SELECT\n  CAST(SUM(CASE WHEN T1.gender = 'F' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A10 > 10000;",
        "pred_time": 0.0016508102416992188,
        "orig_time": 0.0013277530670166016,
        "time_ratio": 0.8043038705950317,
        "check": false
    },
    {
        "id": "financial",
        "question": "What was the growth rate of the total amount of loans across all accounts for a male client between 1996 and 1997?",
        "original_query": "SELECT CAST((SUM(CASE WHEN STRFTIME('%Y', T1.date) = '1997' THEN T1.amount ELSE 0 END) - SUM(CASE WHEN STRFTIME('%Y', T1.date) = '1996' THEN T1.amount ELSE 0 END)) AS REAL) * 100 / SUM(CASE WHEN STRFTIME('%Y', T1.date) = '1996' THEN T1.amount ELSE 0 END) FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN disp AS T3 ON T3.account_id = T2.account_id INNER JOIN client AS T4 ON T4.client_id = T3.client_id WHERE T4.gender = 'M' AND T3.type = 'OWNER'",
        "llm_output": "-- Reasoning\nWe need to calculate the growth rate of total loan amounts for male clients between 1996 and 1997. This requires joining the `client`, `disp`, and `loan` tables to link clients to their loans. We will filter for male clients and loans made in either 1996 or 1997. Then, we use conditional aggregation to sum the loan amounts for each year and apply the growth rate formula.\n\n-- SQL Query\nSELECT\n    (CAST(SUM(CASE WHEN STRFTIME('%Y', T3.date) = '1997' THEN T3.amount ELSE 0 END) AS REAL) -\n     CAST(SUM(CASE WHEN STRFTIME('%Y', T3.date) = '1996' THEN T3.amount ELSE 0 END) AS REAL)) * 100.0 /\n    CAST(SUM(CASE WHEN STRFTIME('%Y', T3.date) = '1996' THEN T3.amount ELSE 0 END) AS REAL)\nFROM client AS T1\nJOIN disp AS T2\n  ON T1.client_id = T2.client_id\nJOIN loan AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.gender = 'M' AND STRFTIME('%Y', T3.date) IN ('1996', '1997');",
        "pred_query": "SELECT\n    (CAST(SUM(CASE WHEN STRFTIME('%Y', T3.date) = '1997' THEN T3.amount ELSE 0 END) AS REAL) -\n     CAST(SUM(CASE WHEN STRFTIME('%Y', T3.date) = '1996' THEN T3.amount ELSE 0 END) AS REAL)) * 100.0 /\n    CAST(SUM(CASE WHEN STRFTIME('%Y', T3.date) = '1996' THEN T3.amount ELSE 0 END) AS REAL)\nFROM client AS T1\nJOIN disp AS T2\n  ON T1.client_id = T2.client_id\nJOIN loan AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.gender = 'M' AND STRFTIME('%Y', T3.date) IN ('1996', '1997');",
        "pred_time": 0.0019969940185546875,
        "orig_time": 0.001985311508178711,
        "time_ratio": 0.9941499522445081,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many credit card withdrawals were recorded after 1995?",
        "original_query": "SELECT COUNT(account_id) FROM trans WHERE STRFTIME('%Y', date) > '1995' AND operation = 'VYBER KARTOU'",
        "llm_output": "-- Reasoning\nWe need to count transactions that are withdrawals and were made using a credit card after the year 1995. We will join the `trans` table with `account`, `disp`, and `card` tables to link transactions to the type of card used. Then, we filter for transaction type 'withdrawal', card type 'credit', and transaction dates after 1995.\n\n-- SQL Query\nSELECT COUNT(T1.trans_id)\nFROM trans AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN disp AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN card AS T4\n  ON T3.disp_id = T4.disp_id\nWHERE\n  T1.type = 'withdrawal' AND T4.type = 'credit' AND STRFTIME('%Y', T1.date) > '1995';",
        "pred_query": "SELECT COUNT(T1.trans_id)\nFROM trans AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nINNER JOIN disp AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN card AS T4\n  ON T3.disp_id = T4.disp_id\nWHERE\n  T1.type = 'withdrawal' AND T4.type = 'credit' AND STRFTIME('%Y', T1.date) > '1995';",
        "pred_time": 0.001300811767578125,
        "orig_time": 0.2853684425354004,
        "time_ratio": 219.37719941348973,
        "check": false
    },
    {
        "id": "financial",
        "question": "What was the difference in the number of crimes committed in East and North Bohemia in 1996?",
        "original_query": "SELECT SUM(IIF(A3 = 'East Bohemia', A16, 0)) - SUM(IIF(A3 = 'North Bohemia', A16, 0)) FROM district",
        "llm_output": "-- Reasoning\nWe need to find the number of crimes for both 'East Bohemia' and 'North Bohemia' districts. Assuming that the `A3` column in the `district` table represents the region and `A16` represents the number of crimes committed in 1996 (a common convention in datasets with such schema structures), we can query these two values and calculate their absolute difference.\n\n-- SQL Query\nSELECT ABS(\n    (SELECT A16 FROM district WHERE A3 = 'East Bohemia') -\n    (SELECT A16 FROM district WHERE A3 = 'North Bohemia')\n);",
        "pred_query": "SELECT ABS(\n    (SELECT A16 FROM district WHERE A3 = 'East Bohemia') -\n    (SELECT A16 FROM district WHERE A3 = 'North Bohemia')\n);",
        "pred_time": 0.0007524490356445312,
        "orig_time": 0.00046181678771972656,
        "time_ratio": 0.6137515842839036,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many owner and disponent dispositions are there from account number 1 to account number 10?",
        "original_query": "SELECT SUM(type = 'Owner') , SUM(type = 'Disponent') FROM disp WHERE account_id BETWEEN 1 AND 10",
        "llm_output": "-- Reasoning\nWe need to count the number of dispositions from the 'disp' table. We will filter for 'owner' or 'disponent' types and account IDs ranging from 1 to 10.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM disp\nWHERE type IN ('owner', 'disponent') AND account_id BETWEEN 1 AND 10;",
        "pred_query": "SELECT COUNT(*)\nFROM disp\nWHERE type IN ('owner', 'disponent') AND account_id BETWEEN 1 AND 10;",
        "pred_time": 0.0014796257019042969,
        "orig_time": 0.0007231235504150391,
        "time_ratio": 0.4887205929745408,
        "check": false
    },
    {
        "id": "financial",
        "question": "How often does account number 3 request an account statement to be released? What was the aim of debiting 3539 in total?",
        "original_query": "SELECT T1.frequency, T2.k_symbol FROM account AS T1 INNER JOIN `order` AS T2 ON T1.account_id = T2.account_id WHERE T1.account_id = 3 AND T2.amount = 3539",
        "llm_output": "-- Reasoning\nThe question asks for two independent pieces of information. The first part asks for the frequency of account statements for a specific account number (3), which can be retrieved directly from the `account` table. The second part asks for the operation (aim) associated with a total debited amount of 3539. This requires filtering the `trans` table for debit transactions, grouping them by operation, and then finding the operation where the sum of amounts is 3539. These two separate results can be combined into a single query using `UNION ALL`.\n\n-- SQL Query\nSELECT T1.frequency\nFROM account AS T1\nWHERE T1.account_id = 3\nUNION ALL\nSELECT T2.operation\nFROM trans AS T2\nWHERE T2.type = 'debit'\nGROUP BY T2.operation\nHAVING SUM(T2.amount) = 3539;",
        "pred_query": "SELECT T1.frequency\nFROM account AS T1\nWHERE T1.account_id = 3\nUNION ALL\nSELECT T2.operation\nFROM trans AS T2\nWHERE T2.type = 'debit'\nGROUP BY T2.operation\nHAVING SUM(T2.amount) = 3539;",
        "pred_time": 0.0789041519165039,
        "orig_time": 0.0009715557098388672,
        "time_ratio": 0.012313112634008968,
        "check": false
    },
    {
        "id": "financial",
        "question": "What year was account owner number 130 born?",
        "original_query": "SELECT STRFTIME('%Y', T1.birth_date) FROM client AS T1 INNER JOIN disp AS T3 ON T1.client_id = T3.client_id INNER JOIN account AS T2 ON T3.account_id = T2.account_id WHERE T2.account_id = 130",
        "llm_output": "-- Reasoning\nWe need to find the birth year of the client whose `client_id` is 130. We can directly query the `client` table, filter by `client_id` and extract the year from the `birth_date` column.\n\n-- SQL Query\nSELECT STRFTIME('%Y', birth_date)\nFROM client\nWHERE client_id = 130;",
        "pred_query": "SELECT STRFTIME('%Y', birth_date)\nFROM client\nWHERE client_id = 130;",
        "pred_time": 0.0010035037994384766,
        "orig_time": 0.0008482933044433594,
        "time_ratio": 0.8453314326443335,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts have an owner disposition and request for a statement to be generated upon a transaction?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id WHERE T2.type = 'OWNER' AND T1.frequency = 'POPLATEK PO OBRATU'",
        "llm_output": "-- Reasoning\nWe need to count accounts that meet two criteria: having an 'owner' disposition and having a frequency setting that implies a statement is generated upon a transaction.\nWe will join the `account` table with the `disp` table using `account_id`.\nFilter `disp` records for `type = 'owner'`.\nFilter `account` records for `frequency = 'after transaction issuance'`, which is the most appropriate interpretation for \"request for a statement to be generated upon a transaction\" based on common banking database patterns.\nFinally, count the distinct `account_id`s that satisfy both conditions.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nWHERE T2.type = 'owner' AND T1.frequency = 'after transaction issuance';",
        "pred_query": "SELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nWHERE T2.type = 'owner' AND T1.frequency = 'after transaction issuance';",
        "pred_time": 0.001359701156616211,
        "orig_time": 0.0013349056243896484,
        "time_ratio": 0.9817639838681396,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the amount of debt that client number 992 has, and how is this client doing with payments?",
        "original_query": "SELECT T3.amount, T3.status FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id WHERE T1.client_id = 992",
        "llm_output": "-- Reasoning\nTo find the debt amount and payment status for client 992, we need to link the client to their loans. We start by joining the `client` table with the `disp` table using `client_id` to find the associated `account_id`. Then, we join `disp` with the `loan` table using `account_id` to access the loan details. We filter for `client_id` 992, calculate the sum of all loan amounts for that client, and aggregate the distinct loan statuses to describe their payment situation.\n\n-- SQL Query\nSELECT SUM(T3.amount), GROUP_CONCAT(DISTINCT T3.status)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN loan AS T3\n  ON T2.account_id = T3.account_id\nWHERE T1.client_id = 992;",
        "pred_query": "SELECT SUM(T3.amount), GROUP_CONCAT(DISTINCT T3.status)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN loan AS T3\n  ON T2.account_id = T3.account_id\nWHERE T1.client_id = 992;",
        "pred_time": 0.009338855743408203,
        "orig_time": 0.0010786056518554688,
        "time_ratio": 0.1154965534848098,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the sum that client number 4's account has following transaction 851? Who owns this account, a man or a woman?",
        "original_query": "SELECT T3.balance, T1.gender FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T1.client_id = 4 AND T3.trans_id = 851",
        "llm_output": "-- Reasoning\nWe need to find client 4's account ID by joining the `client` and `disp` tables. Then, we find the date of transaction 851 from the `trans` table. Next, we select all transactions for client 4's account that occurred after the date of transaction 851 and sum their amounts. Finally, we retrieve the gender of client 4 from the `client` table.\n\n-- SQL Query\nSELECT\n  SUM(T4.amount),\n  T1.gender\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN trans AS T4\n  ON T2.account_id = T4.account_id\nWHERE\n  T1.client_id = 4 AND T4.date > (\n    SELECT\n      date\n    FROM trans\n    WHERE\n      trans_id = 851\n  );",
        "pred_query": "SELECT\n  SUM(T4.amount),\n  T1.gender\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN trans AS T4\n  ON T2.account_id = T4.account_id\nWHERE\n  T1.client_id = 4 AND T4.date > (\n    SELECT\n      date\n    FROM trans\n    WHERE\n      trans_id = 851\n  );",
        "pred_time": 0.696566104888916,
        "orig_time": 0.0006997585296630859,
        "time_ratio": 0.0010045830894609478,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which kind of credit card does client number 9 possess?",
        "original_query": "SELECT T3.type FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN card AS T3 ON T2.disp_id = T3.disp_id WHERE T1.client_id = 9",
        "llm_output": "-- Reasoning\nWe need to find the type of card associated with client 9. We can achieve this by joining the `client` table with the `disp` table using `client_id`, and then joining `disp` with the `card` table using `disp_id`. Finally, we filter for client_id = 9 and select the card type.\n\n-- SQL Query\nSELECT T3.type\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE T1.client_id = 9;",
        "pred_query": "SELECT T3.type\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE T1.client_id = 9;",
        "pred_time": 0.001013040542602539,
        "orig_time": 0.0006885528564453125,
        "time_ratio": 0.6796893386679219,
        "check": true
    },
    {
        "id": "financial",
        "question": "How much, in total, did client number 617 pay for all of the transactions in 1998?",
        "original_query": "SELECT SUM(T3.amount) FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE STRFTIME('%Y', T3.date)= '1998' AND T1.client_id = 617",
        "llm_output": "-- Reasoning\nWe need to sum the transaction amounts for a specific client and year. We will join the `client`, `disp`, `account`, and `trans` tables. We filter by `client_id` 617 and transactions occurring in 1998, then sum the `amount` from the `trans` table.\n\n-- SQL Query\nSELECT SUM(T4.amount)\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN account AS T3 ON T2.account_id = T3.account_id\nINNER JOIN trans AS T4 ON T3.account_id = T4.account_id\nWHERE T1.client_id = 617 AND STRFTIME('%Y', T4.date) = '1998';",
        "pred_query": "SELECT SUM(T4.amount)\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN account AS T3 ON T2.account_id = T3.account_id\nINNER JOIN trans AS T4 ON T3.account_id = T4.account_id\nWHERE T1.client_id = 617 AND STRFTIME('%Y', T4.date) = '1998';",
        "pred_time": 0.49796175956726074,
        "orig_time": 0.3155181407928467,
        "time_ratio": 0.6336192182047042,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please provide a list of clients who were born between 1983 and 1987 and whose account branch is in East Bohemia, along with their IDs.",
        "original_query": "SELECT T1.client_id, T3.account_id FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN account AS T3 ON T2.district_id = T3.district_id WHERE T2.A3 = 'east Bohemia' AND STRFTIME('%Y', T1.birth_date) BETWEEN '1983' AND '1987'",
        "llm_output": "-- Reasoning\nWe need to identify clients based on two criteria: their birth year and the district of their associated account. We will join the `client`, `disp`, `account`, and `district` tables. First, we filter clients born between 1983 and 1987. Then, we filter the districts to 'East Bohemia' using the `A3` column in the `district` table. Finally, we select the unique `client_id` for those matching both conditions.\n\n-- SQL Query\nSELECT DISTINCT T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  STRFTIME('%Y', T1.birth_date) BETWEEN '1983' AND '1987' AND T4.A3 = 'East Bohemia';",
        "pred_query": "SELECT DISTINCT T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  STRFTIME('%Y', T1.birth_date) BETWEEN '1983' AND '1987' AND T4.A3 = 'East Bohemia';",
        "pred_time": 0.0025517940521240234,
        "orig_time": 0.004175901412963867,
        "time_ratio": 1.6364570681117443,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please provide the IDs of the 3 female clients with the largest loans.",
        "original_query": "SELECT T1.client_id FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id WHERE T1.gender = 'F' ORDER BY T3.amount DESC LIMIT 3",
        "llm_output": "-- Reasoning\nWe need to connect clients to their loans. We will join `client` with `disp` (which links clients to accounts) and then `account` with `loan`. Filter clients by gender 'F', group by client ID, sum the loan amounts, order by the sum in descending order, and take the top 3 client IDs.\n\n-- SQL Query\nSELECT T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN account AS T3 ON T2.account_id = T3.account_id\nINNER JOIN loan AS T4 ON T3.account_id = T4.account_id\nWHERE T1.gender = 'F'\nGROUP BY T1.client_id\nORDER BY SUM(T4.amount) DESC\nLIMIT 3;",
        "pred_query": "SELECT T1.client_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN account AS T3 ON T2.account_id = T3.account_id\nINNER JOIN loan AS T4 ON T3.account_id = T4.account_id\nWHERE T1.gender = 'F'\nGROUP BY T1.client_id\nORDER BY SUM(T4.amount) DESC\nLIMIT 3;",
        "pred_time": 0.0036644935607910156,
        "orig_time": 0.005538225173950195,
        "time_ratio": 1.5113207547169811,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many male customers who were born between 1974 and 1976 have made a payment on their home in excess of $4000?",
        "original_query": "SELECT COUNT(T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN client AS T3 ON T2.district_id = T3.district_id WHERE STRFTIME('%Y', T3.birth_date) BETWEEN '1974' AND '1976' AND T3.gender = 'M' AND T1.amount > 4000 AND T1.k_symbol = 'SIPO'",
        "llm_output": "-- Reasoning\nWe need to count distinct male customers who were born between 1974 and 1976 and have made a transaction with an amount greater than $4000, specifically identifying the transaction as a 'payment for statement' (which is the most appropriate operation representing a payment in the `trans` table given the schema). We achieve this by joining the `client`, `disp`, `account`, and `trans` tables, applying the date and gender filters on the `client` table, and the operation and amount filters on the `trans` table.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN trans AS T4\n  ON T3.account_id = T4.account_id\nWHERE\n  T1.gender = 'M' AND T1.birth_date BETWEEN '1974-01-01' AND '1976-12-31' AND T4.operation = 'payment for statement' AND T4.amount > 4000;",
        "pred_query": "SELECT COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN trans AS T4\n  ON T3.account_id = T4.account_id\nWHERE\n  T1.gender = 'M' AND T1.birth_date BETWEEN '1974-01-01' AND '1976-12-31' AND T4.operation = 'payment for statement' AND T4.amount > 4000;",
        "pred_time": 0.08925867080688477,
        "orig_time": 0.16431427001953125,
        "time_ratio": 1.840877401984091,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts in Beroun were opened after 1996?",
        "original_query": "SELECT COUNT(account_id) FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T1.date) > '1996' AND T2.A2 = 'Beroun'",
        "llm_output": "-- Reasoning\nWe need to find accounts associated with the district 'Beroun'. We join the `account` table with the `district` table on `district_id`. We filter for districts where `A2` (likely the district name) is 'Beroun' and then filter for accounts opened after the year 1996 using the `date` column in the `account` table. Finally, we count the number of such accounts.\n\n-- SQL Query\nSELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A2 = 'Beroun' AND STRFTIME('%Y', T1.date) > '1996';",
        "pred_query": "SELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  T2.A2 = 'Beroun' AND STRFTIME('%Y', T1.date) > '1996';",
        "pred_time": 0.002034902572631836,
        "orig_time": 0.001615762710571289,
        "time_ratio": 0.79402460456942,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many female customers have a junior credit card?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN card AS T3 ON T2.disp_id = T3.disp_id WHERE T1.gender = 'F' AND T3.type = 'junior'",
        "llm_output": "-- Reasoning\nWe need to count clients who are female and have a 'junior' type card. We will join the `client`, `disp`, and `card` tables, filter by gender 'F' and card type 'junior', and then count the distinct `client_id`s.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE T1.gender = 'F' AND T3.type = 'junior';",
        "pred_query": "SELECT COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE T1.gender = 'F' AND T3.type = 'junior';",
        "pred_time": 0.0011153221130371094,
        "orig_time": 0.0006823539733886719,
        "time_ratio": 0.6117999144933732,
        "check": true
    },
    {
        "id": "financial",
        "question": "What proportion of customers who have accounts at the Prague branch are female?",
        "original_query": "SELECT CAST(SUM(T2.gender = 'F') AS REAL) / COUNT(T2.client_id) * 100 FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T1.A3 = 'Prague'",
        "llm_output": "-- Reasoning\nWe need to find the proportion of female customers among all customers who have accounts associated with the 'Prague' branch.\nFirst, we join `client`, `disp`, `account`, and `district` tables to link clients to their accounts and the districts their accounts belong to.\nThen, we filter these results to include only those associated with 'Prague' in the `district` table (A3 column).\nFinally, we calculate the proportion by dividing the count of distinct female clients by the total count of distinct clients in the filtered 'Prague' group.\n\n-- SQL Query\nSELECT\n  CAST(COUNT(DISTINCT CASE WHEN T1.gender = 'F' THEN T1.client_id ELSE NULL END) AS REAL) /\n  COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  T4.A3 = 'Prague';",
        "pred_query": "SELECT\n  CAST(COUNT(DISTINCT CASE WHEN T1.gender = 'F' THEN T1.client_id ELSE NULL END) AS REAL) /\n  COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nINNER JOIN district AS T4\n  ON T3.district_id = T4.district_id\nWHERE\n  T4.A3 = 'Prague';",
        "pred_time": 0.0022745132446289062,
        "orig_time": 0.0013315677642822266,
        "time_ratio": 0.5854297693920335,
        "check": false
    },
    {
        "id": "financial",
        "question": "What percentage of male clients request for weekly statements to be issued?",
        "original_query": "SELECT CAST(SUM(T1.gender = 'M') AS REAL) * 100 / COUNT(T1.client_id) FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE T2.frequency = 'POPLATEK TYDNE'",
        "llm_output": "-- Reasoning\nWe need to join the `client`, `disp`, and `account` tables to link clients to their account frequencies. First, filter for male clients. Then, count the total number of distinct male clients and the number of distinct male clients whose accounts have a 'weekly' frequency. Finally, calculate the percentage by dividing the latter by the former and multiplying by 100.\n\n-- SQL Query\nSELECT\n  CAST(SUM(CASE WHEN T3.frequency = 'weekly' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.gender = 'M';",
        "pred_query": "SELECT\n  CAST(SUM(CASE WHEN T3.frequency = 'weekly' THEN 1 ELSE 0 END) AS REAL) * 100 / COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T1.gender = 'M';",
        "pred_time": 0.0020139217376708984,
        "orig_time": 0.006902217864990234,
        "time_ratio": 3.4272522789155913,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many clients who choose statement of weekly issuance are User?",
        "original_query": "SELECT COUNT(T2.account_id) FROM account AS T1 INNER JOIN disp AS T2 ON T2.account_id = T1.account_id WHERE T1.frequency = 'POPLATEK TYDNE' AND T2.type = 'USER'",
        "llm_output": "-- Reasoning\nWe need to count clients that satisfy two conditions: their associated account has a 'weekly issuance' frequency and their dispatch type is 'USER'. We will join the `client`, `disp`, and `account` tables. Then we filter the records based on the `frequency` in the `account` table and the `type` in the `disp` table and count the distinct client IDs.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T3.frequency = 'weekly issuance' AND T2.type = 'USER';",
        "pred_query": "SELECT COUNT(DISTINCT T1.client_id)\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN account AS T3\n  ON T2.account_id = T3.account_id\nWHERE\n  T3.frequency = 'weekly issuance' AND T2.type = 'USER';",
        "pred_time": 0.0010724067687988281,
        "orig_time": 0.0008006095886230469,
        "time_ratio": 0.7465540240106714,
        "check": true
    },
    {
        "id": "financial",
        "question": "Among the accounts who have loan validity more than 24 months, list out the accounts that have the lowest approved amount and have account opening date before 1997.",
        "original_query": "SELECT T1.account_id FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.duration > 24 AND STRFTIME('%Y', T2.date) < '1997' ORDER BY T1.amount ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to identify accounts that satisfy two initial conditions: having a loan with a duration exceeding 24 months and an account opening date prior to 1997.\nFrom this filtered set of accounts and their corresponding loans, we then determine the minimum `amount` value among these loans.\nFinally, we select the `account_id` of all accounts that are associated with any loan matching both initial conditions and having this globally minimum `amount`.\n\n-- SQL Query\nSELECT T1.account_id\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.duration > 24 AND T1.date < '1997-01-01' AND T2.amount = (\n    SELECT MIN(T2_inner.amount)\n    FROM account AS T1_inner\n    INNER JOIN loan AS T2_inner\n      ON T1_inner.account_id = T2_inner.account_id\n    WHERE\n      T2_inner.duration > 24 AND T1_inner.date < '1997-01-01'\n  );",
        "pred_query": "SELECT T1.account_id\nFROM account AS T1\nINNER JOIN loan AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T2.duration > 24 AND T1.date < '1997-01-01' AND T2.amount = (\n    SELECT MIN(T2_inner.amount)\n    FROM account AS T1_inner\n    INNER JOIN loan AS T2_inner\n      ON T1_inner.account_id = T2_inner.account_id\n    WHERE\n      T2_inner.duration > 24 AND T1_inner.date < '1997-01-01'\n  );",
        "pred_time": 0.0011532306671142578,
        "orig_time": 0.0009310245513916016,
        "time_ratio": 0.8073185859003514,
        "check": true
    },
    {
        "id": "financial",
        "question": "Name the account numbers of female clients who are oldest and have lowest average salary?",
        "original_query": "SELECT T3.account_id FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN account AS T3 ON T2.district_id = T3.district_id WHERE T1.gender = 'F' ORDER BY T1.birth_date ASC, T2.A11 ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the `account_id` for female clients. To do this, we'll join the `client`, `disp`, and `district` tables. We filter for female clients using `gender = 'F'`. Then, we apply two conditions: the client's birth date must be the minimum (oldest) among all female clients, and their associated district's `A10` value (representing average salary) must be the minimum among districts associated with female clients. We use subqueries to find these minimum values.\n\n-- SQL Query\nSELECT T3.account_id\nFROM client AS T1\nJOIN district AS T2\n  ON T1.district_id = T2.district_id\nJOIN disp AS T3\n  ON T1.client_id = T3.client_id\nWHERE\n  T1.gender = 'F' AND T1.birth_date = (\n    SELECT\n      MIN(birth_date)\n    FROM client\n    WHERE\n      gender = 'F'\n  ) AND T2.A10 = (\n    SELECT\n      MIN(T4.A10)\n    FROM client AS T5\n    JOIN district AS T4\n      ON T5.district_id = T4.district_id\n    WHERE\n      T5.gender = 'F'\n  );",
        "pred_query": "SELECT T3.account_id\nFROM client AS T1\nJOIN district AS T2\n  ON T1.district_id = T2.district_id\nJOIN disp AS T3\n  ON T1.client_id = T3.client_id\nWHERE\n  T1.gender = 'F' AND T1.birth_date = (\n    SELECT\n      MIN(birth_date)\n    FROM client\n    WHERE\n      gender = 'F'\n  ) AND T2.A10 = (\n    SELECT\n      MIN(T4.A10)\n    FROM client AS T5\n    JOIN district AS T4\n      ON T5.district_id = T4.district_id\n    WHERE\n      T5.gender = 'F'\n  );",
        "pred_time": 0.004061698913574219,
        "orig_time": 0.029575109481811523,
        "time_ratio": 7.281462784691242,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many clients who were born in 1920 stay in east Bohemia?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T1.birth_date) = '1920' AND T2.A3 = 'east Bohemia'",
        "llm_output": "-- Reasoning\nWe need to count clients from the `client` table. We'll join `client` with the `district` table using `district_id` to access regional information. Then, we filter for clients born in 1920 and whose district's region (A3 column) is 'east Bohemia'.\n\n-- SQL Query\nSELECT COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  STRFTIME('%Y', T1.birth_date) = '1920' AND T2.A3 = 'east Bohemia';",
        "pred_query": "SELECT COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2\n  ON T1.district_id = T2.district_id\nWHERE\n  STRFTIME('%Y', T1.birth_date) = '1920' AND T2.A3 = 'east Bohemia';",
        "pred_time": 0.002119302749633789,
        "orig_time": 0.0019333362579345703,
        "time_ratio": 0.9122510968612892,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many loan accounts are for pre-payment of duration of 24 months with weekly issuance of statement.",
        "original_query": "SELECT COUNT(T2.account_id) FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T2.duration = 24 AND T1.frequency = 'POPLATEK TYDNE'",
        "llm_output": "-- Reasoning\nWe need to count the distinct `account_id`s from the `loan` table that meet two conditions: the loan's duration is 24 months, and the associated account has a weekly statement frequency. We will join the `loan` table with the `account` table on `account_id` to access both sets of criteria and then apply the filters. The term \"pre-payment\" is contextual and doesn't map to a specific filter in the given schema.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.account_id)\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.duration = 24 AND T2.frequency = 'weekly';",
        "pred_query": "SELECT COUNT(DISTINCT T1.account_id)\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.duration = 24 AND T2.frequency = 'weekly';",
        "pred_time": 0.0014178752899169922,
        "orig_time": 0.0006964206695556641,
        "time_ratio": 0.4911720195056331,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the average amount of loan which are still on running contract with statement issuance after each transaction?",
        "original_query": "SELECT AVG(T2.payments) FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T2.status IN ('C', 'D') AND T1.frequency = 'POPLATEK PO OBRATU'",
        "llm_output": "-- Reasoning\nWe need to find the average amount of loans. This requires joining the `loan` table with the `account` table on `account_id` to access the loan status and account frequency. We then filter for loans that are currently running (status 'C' or 'D') and have a statement issuance frequency of 'issuance after transaction'. Finally, we calculate the average of the `amount` column from the `loan` table.\n\n-- SQL Query\nSELECT AVG(T1.amount)\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.status IN ('C', 'D') AND T2.frequency = 'issuance after transaction';",
        "pred_query": "SELECT AVG(T1.amount)\nFROM loan AS T1\nINNER JOIN account AS T2\n  ON T1.account_id = T2.account_id\nWHERE\n  T1.status IN ('C', 'D') AND T2.frequency = 'issuance after transaction';",
        "pred_time": 0.0013337135314941406,
        "orig_time": 0.0009610652923583984,
        "time_ratio": 0.7205934930282446,
        "check": false
    },
    {
        "id": "financial",
        "question": "List all ID and district for clients that can only have the right to issue permanent orders or apply for loans.",
        "original_query": "SELECT T3.client_id, T2.district_id, T2.A2 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T1.account_id = T3.account_id WHERE T3.type = 'OWNER'",
        "llm_output": "-- Reasoning\nThe question asks for clients with limited rights, specifically \"can only have the right to issue permanent orders or apply for loans\". In this schema, the `disp` table links clients to accounts and has a `type` column. The `disp.type` values typically include 'OWNER' (full rights) and 'DISPONENT' (limited rights). Thus, clients whose `disp.type` is 'DISPONENT' are the most suitable match for those with restricted rights. We will join the `client` table with the `disp` table on `client_id` and filter for `disp.type = 'DISPONENT'`, then select the distinct client ID and district ID.\n\n-- SQL Query\nSELECT DISTINCT T1.client_id, T1.district_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nWHERE T2.type = 'DISPONENT';",
        "pred_query": "SELECT DISTINCT T1.client_id, T1.district_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nWHERE T2.type = 'DISPONENT';",
        "pred_time": 0.0020127296447753906,
        "orig_time": 0.004101991653442383,
        "time_ratio": 2.0380241648898365,
        "check": false
    },
    {
        "id": "financial",
        "question": "Provide the IDs and age of the client with high level credit card, which is eligible for loans.",
        "original_query": "SELECT T1.client_id, STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', T3.birth_date) FROM disp AS T1 INNER JOIN card AS T2 ON T2.disp_id = T1.disp_id INNER JOIN client AS T3 ON T1.client_id = T3.client_id WHERE T2.type = 'gold' AND T1.type = 'OWNER'",
        "llm_output": "-- Reasoning\nWe need to find the client ID and their age. The client's age can be calculated from their `birth_date` in the `client` table. We need to filter for clients who meet two conditions: possessing a 'high level credit card' and being 'eligible for loans'. We assume 'gold' for the `card.type` represents a high-level credit card and 'A' for `loan.status` indicates an approved loan, implying eligibility. We will join `client`, `disp`, `card`, `account`, and `loan` tables to link these conditions, then select distinct client IDs and calculated ages.\n\n-- SQL Query\nSELECT DISTINCT\n  T1.client_id,\n  (CAST(STRFTIME('%Y', 'now') AS INTEGER) - CAST(STRFTIME('%Y', T1.birth_date) AS INTEGER)) AS age\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nINNER JOIN account AS T4\n  ON T2.account_id = T4.account_id\nINNER JOIN loan AS T5\n  ON T4.account_id = T5.account_id\nWHERE\n  T3.type = 'gold' AND T5.status = 'A';",
        "pred_query": "SELECT DISTINCT\n  T1.client_id,\n  (CAST(STRFTIME('%Y', 'now') AS INTEGER) - CAST(STRFTIME('%Y', T1.birth_date) AS INTEGER)) AS age\nFROM client AS T1\nINNER JOIN disp AS T2\n  ON T1.client_id = T2.client_id\nINNER JOIN card AS T3\n  ON T2.disp_id = T3.disp_id\nINNER JOIN account AS T4\n  ON T2.account_id = T4.account_id\nINNER JOIN loan AS T5\n  ON T4.account_id = T5.account_id\nWHERE\n  T3.type = 'gold' AND T5.status = 'A';",
        "pred_time": 0.0014491081237792969,
        "orig_time": 0.0007987022399902344,
        "time_ratio": 0.5511681474169134,
        "check": false
    },
    {
        "id": "toxicology",
        "question": "What is the most common bond type?",
        "original_query": "SELECT T.bond_type FROM ( SELECT bond_type, COUNT(bond_id) FROM bond GROUP BY bond_type ORDER BY COUNT(bond_id) DESC LIMIT 1 ) AS T",
        "llm_output": "-- Reasoning\nWe need to count the occurrences of each bond type from the `bond` table.\nGroup the results by `bond_type`, order them by the count in descending order, and select the `bond_type` with the highest count.\n\n-- SQL Query\nSELECT bond_type\nFROM bond\nGROUP BY bond_type\nORDER BY COUNT(*) DESC\nLIMIT 1;",
        "pred_query": "SELECT bond_type\nFROM bond\nGROUP BY bond_type\nORDER BY COUNT(*) DESC\nLIMIT 1;",
        "pred_time": 0.005087375640869141,
        "orig_time": 0.004565000534057617,
        "time_ratio": 0.8973193363951636,
        "check": true
    },
    {
        "id": "toxicology",
        "question": "In the non-carcinogenic molecules, how many contain chlorine atoms?",
        "original_query": "SELECT COUNT(DISTINCT T1.molecule_id) FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T2.element = 'cl' AND T1.label = '-'",
        "llm_output": "-- Reasoning\nWe need to count molecules that are both non-carcinogenic and contain chlorine atoms. We join the `molecule` table with the `atom` table on `molecule_id`. We filter the molecules by their `label` to be 'non-carcinogenic' and the atoms by their `element` to be 'Cl'. Finally, we count the distinct `molecule_id`s that satisfy both conditions.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.molecule_id)\nFROM molecule AS T1\nINNER JOIN atom AS T2\n  ON T1.molecule_id = T2.molecule_id\nWHERE\n  T1.label = 'non-carcinogenic' AND T2.element = 'Cl';",
        "pred_query": "SELECT COUNT(DISTINCT T1.molecule_id)\nFROM molecule AS T1\nINNER JOIN atom AS T2\n  ON T1.molecule_id = T2.molecule_id\nWHERE\n  T1.label = 'non-carcinogenic' AND T2.element = 'Cl';",
        "pred_time": 0.0018007755279541016,
        "orig_time": 0.0014216899871826172,
        "time_ratio": 0.789487620812922,
        "check": false
    },
    {
        "id": "toxicology",
        "question": "Calculate the average number of oxygen atoms in single-bonded molecules.",
        "original_query": "SELECT AVG(oxygen_count) FROM (SELECT T1.molecule_id, COUNT(T1.element) AS oxygen_count FROM atom AS T1 INNER JOIN bond AS T2 ON T1.molecule_id = T2.molecule_id  WHERE T2.bond_type = '-' AND T1.element = 'o'  GROUP BY T1.molecule_id) AS oxygen_counts",
        "llm_output": "-- Reasoning\nFirst, identify all `molecule_id`s where every bond associated with that molecule is of `bond_type = 'single'`. This can be done by grouping bonds by `molecule_id` and ensuring the count of all bonds equals the count of 'single' bonds.\nNext, for these single-bonded molecules, count the number of oxygen atoms ('O') by joining with the `atom` table and filtering for `element = 'O'`.\nFinally, calculate the average of these oxygen atom counts.\n\n-- SQL Query\nSELECT AVG(T3.oxygen_count)\nFROM (\n    SELECT\n        T1.molecule_id,\n        SUM(CASE WHEN T2.element = 'O' THEN 1 ELSE 0 END) AS oxygen_count\n    FROM molecule AS T1\n    JOIN atom AS T2\n      ON T1.molecule_id = T2.molecule_id\n    WHERE T1.molecule_id IN (\n        SELECT molecule_id\n        FROM bond\n        GROUP BY molecule_id\n        HAVING COUNT(*) = SUM(CASE WHEN bond_type = 'single' THEN 1 ELSE 0 END)\n    )\n    GROUP BY T1.molecule_id\n) AS T3;",
        "pred_query": "SELECT AVG(T3.oxygen_count)\nFROM (\n    SELECT\n        T1.molecule_id,\n        SUM(CASE WHEN T2.element = 'O' THEN 1 ELSE 0 END) AS oxygen_count\n    FROM molecule AS T1\n    JOIN atom AS T2\n      ON T1.molecule_id = T2.molecule_id\n    WHERE T1.molecule_id IN (\n        SELECT molecule_id\n        FROM bond\n        GROUP BY molecule_id\n        HAVING COUNT(*) = SUM(CASE WHEN bond_type = 'single' THEN 1 ELSE 0 END)\n    )\n    GROUP BY T1.molecule_id\n) AS T3;",
        "pred_time": 0.0038361549377441406,
        "orig_time": 0.013923883438110352,
        "time_ratio": 3.6296457426973276,
        "check": false
    },
    {
        "id": "toxicology",
        "question": "On average how many carcinogenic molecules are single bonded?",
        "original_query": "SELECT AVG(single_bond_count) FROM (SELECT T3.molecule_id, COUNT(T1.bond_type) AS single_bond_count FROM bond AS T1  INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id INNER JOIN molecule AS T3 ON T3.molecule_id = T2.molecule_id WHERE T1.bond_type = '-' AND T3.label = '+' GROUP BY T3.molecule_id) AS subquery",
        "llm_output": "-- Reasoning\nWe need to calculate the average number of single bonds for molecules identified as 'carcinogenic'.\nFirst, we filter the `molecule` table to select only those molecules where the `label` indicates carcinogenicity (assuming `label = 'carcinogenic'`).\nThen, we perform a `LEFT JOIN` with the `bond` table on `molecule_id` to include all carcinogenic molecules, even those that might not have any bonds (or any single bonds).\nWithin the `LEFT JOIN`, we group by `molecule_id` and count the bonds where `bond_type` is 'single'. Using `COUNT(CASE WHEN ... THEN ... END)` ensures that molecules with no single bonds correctly contribute 0 to the count.\nFinally, we calculate the average of these per-molecule single bond counts.\n\n-- SQL Query\nSELECT AVG(single_bond_count)\nFROM (\n  SELECT\n    M.molecule_id,\n    COUNT(CASE WHEN B.bond_type = 'single' THEN B.bond_id END) AS single_bond_count\n  FROM molecule AS M\n  LEFT JOIN bond AS B\n    ON M.molecule_id = B.molecule_id\n  WHERE\n    M.label = 'carcinogenic'\n  GROUP BY\n    M.molecule_id\n) AS CarcinogenicMoleculesSingleBondCounts;",
        "pred_query": "SELECT AVG(single_bond_count)\nFROM (\n  SELECT\n    M.molecule_id,\n    COUNT(CASE WHEN B.bond_type = 'single' THEN B.bond_id END) AS single_bond_count\n  FROM molecule AS M\n  LEFT JOIN bond AS B\n    ON M.molecule_id = B.molecule_id\n  WHERE\n    M.label = 'carcinogenic'\n  GROUP BY\n    M.molecule_id\n) AS CarcinogenicMoleculesSingleBondCounts;",
        "pred_time": 0.0007679462432861328,
        "orig_time": 0.11917352676391602,
        "time_ratio": 155.18472524060851,
        "check": false
    },
    {
        "id": "toxicology",
        "question": "In the molecule containing sodium atoms, how many are non-carcinogenic?",
        "original_query": "SELECT COUNT(DISTINCT T2.molecule_id) FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.element = 'na' AND T2.label = '-'",
        "llm_output": "-- Reasoning\nTo find molecules containing sodium atoms, we join the `molecule` and `atom` tables on `molecule_id` and filter for atoms with `element` 'Na'. From this set, we then filter for molecules whose `label` indicates they are 'non-carcinogenic', assuming this descriptive status is present within the `label` text. Finally, we count the distinct `molecule_id`s that satisfy both conditions.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.molecule_id)\nFROM molecule AS T1\nINNER JOIN atom AS T2\n  ON T1.molecule_id = T2.molecule_id\nWHERE\n  T2.element = 'Na' AND T1.label LIKE '%non-carcinogenic%';",
        "pred_query": "SELECT COUNT(DISTINCT T1.molecule_id)\nFROM molecule AS T1\nINNER JOIN atom AS T2\n  ON T1.molecule_id = T2.molecule_id\nWHERE\n  T2.element = 'Na' AND T1.label LIKE '%non-carcinogenic%';",
        "pred_time": 0.0016105175018310547,
        "orig_time": 0.0012464523315429688,
        "time_ratio": 0.7739452257586973,
        "check": false
    }
]