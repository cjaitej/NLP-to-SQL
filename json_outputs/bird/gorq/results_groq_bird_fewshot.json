[
    {
        "id": "california_schools",
        "question": "What is the highest eligible free rate for K-12 students in the schools in Alameda County?",
        "original_query": "SELECT `Free Meal Count (K-12)` / `Enrollment (K-12)` FROM frpm WHERE `County Name` = 'Alameda' ORDER BY (CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)`) DESC LIMIT 1",
        "llm_output": "-- SQL Query\nSELECT T1.`Percent (%) Eligible Free (K-12)`\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.County = 'Alameda County' AND T1.`Percent (%) Eligible Free (K-12)` NOT NULL\nORDER BY T1.`Percent (%) Eligible Free (K-12)` DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.`Percent (%) Eligible Free (K-12)`\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.County = 'Alameda County' AND T1.`Percent (%) Eligible Free (K-12)` NOT NULL\nORDER BY T1.`Percent (%) Eligible Free (K-12)` DESC\nLIMIT 1;",
        "pred_time": 0.018835067749023438,
        "orig_time": 0.006710052490234375,
        "time_ratio": 0.35625316455696204,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please list the lowest three eligible free rates for students aged 5-17 in continuation schools.",
        "original_query": "SELECT `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` FROM frpm WHERE `Educational Option Type` = 'Continuation School' AND `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` IS NOT NULL ORDER BY `Free Meal Count (Ages 5-17)` / `Enrollment (Ages 5-17)` ASC LIMIT 3",
        "llm_output": "-- Reasoning\nWe first join the frpm and schools tables on CDSCode to get the district name and educational option type.\nThen, we filter for continuation schools and look for the lowest three eligible free rates for students aged 5-17.\n\n-- SQL Query\nSELECT T2.DistrictName, T1.PercentElegFreeAges517\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.School LIKE 'CONT%'\nORDER BY T1.PercentElegFreeAges517\nLIMIT 3",
        "pred_query": "SELECT T2.DistrictName, T1.PercentElegFreeAges517\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.School LIKE 'CONT%'\nORDER BY T1.PercentElegFreeAges517\nLIMIT 3",
        "pred_time": null,
        "orig_time": 0.006426334381103516,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please list the zip code of all the charter schools in Fresno County Office of Education.",
        "original_query": "SELECT T2.Zip FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`District Name` = 'Fresno County Office of Education' AND T1.`Charter School (Y/N)` = 1",
        "llm_output": "-- Reasoning\nWe join the frpm table with schools using the County and County Code foreign key references from schools table, filter by Charter type 'Y', and return the unique School Codes which belong to Fresno County Office of Education, then finally, select the zip codes of these schools from schools table.\n\n-- SQL Query\nSELECT T1.Zip\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.County = T2.`County Name` AND T1.CountyCode = T2.CountyCode\nWHERE T1.County = 'Fresno' AND T2.`Charter School (Y/N)` = 1\nGROUP BY T2.CDSCode;",
        "pred_query": "SELECT T1.Zip\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.County = T2.`County Name` AND T1.CountyCode = T2.CountyCode\nWHERE T1.County = 'Fresno' AND T2.`Charter School (Y/N)` = 1\nGROUP BY T2.CDSCode;",
        "pred_time": null,
        "orig_time": 0.006148576736450195,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the unabbreviated mailing address of the school with the highest FRPM count for K-12 students?",
        "original_query": "SELECT T2.MailStreet FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 1",
        "llm_output": "-- Question\nWhat is the unabbreviated mailing address of the school with the highest FRPM count for K-12 students?\n\n-- Reasoning\nWe first join the frpm and schools tables on CDSCode for a common link. Then, we filter the results to find the maximum FRPM count and order the results based on that count in descending order. Finally, we select the MailStreet, MailCity, and MailState columns for the unabbreviated mailing address.\n\n-- SQL Query\nSELECT \n    T2.MailStreet AS `Mail Street`,\n    T2.MailCity AS `Mail City`,\n    T2.MailState AS `Mail State`\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.`FRPM Count (K-12)` = (SELECT MAX(FRPM_count) FROM frpm)",
        "pred_query": "SELECT \n    T2.MailStreet AS `Mail Street`,\n    T2.MailCity AS `Mail City`,\n    T2.MailState AS `Mail State`\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.`FRPM Count (K-12)` = (SELECT MAX(FRPM_count) FROM frpm)",
        "pred_time": null,
        "orig_time": 0.020092487335205078,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please list the phone numbers of the direct charter-funded schools that are opened after 2000/1/1.",
        "original_query": "SELECT T2.Phone FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`Charter School (Y/N)` = 1 AND T2.OpenDate > '2000-01-01'",
        "llm_output": "-- Reasoning\nTo find the phone numbers of direct charter-funded schools that are opened after 2000/1/1, we first join the schools and frpm tables using CDSCode. We filter for schools with a StatusType of 'Active' and a FundingType of 'Direct Charter'. We then sort the results by OpenDate in ascending order, and keep only the schools that were opened after 2000/1/1. Finally, we return the phone numbers of these schools.\n\n-- SQL Query\nSELECT T1.Phone \nFROM schools AS T1 \nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode \nWHERE T2.CharterFundingType = 'Direct Charter' AND T1.FundingType = 'Direct Charter' AND T1.OpenDate > '2000-01-01' \nORDER BY T1.OpenDate ASC",
        "pred_query": "SELECT T1.Phone \nFROM schools AS T1 \nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode \nWHERE T2.CharterFundingType = 'Direct Charter' AND T1.FundingType = 'Direct Charter' AND T1.OpenDate > '2000-01-01' \nORDER BY T1.OpenDate ASC",
        "pred_time": null,
        "orig_time": null,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "How many schools with an average score in Math under 400 in the SAT test are exclusively virtual?",
        "original_query": "SELECT COUNT(DISTINCT T2.School) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' AND T1.AvgScrMath < 400",
        "llm_output": "-- Reasoning\nWe need schools with an average math score under 400 and exclusively virtual. Join the schools table with satscores using CDSCode, filter for schools where the average math score is under 400 and virtual status is 'Yes', and count those schools.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.Virtual = 'Yes'\n  AND T2.AvgScrMath < 400;",
        "pred_query": "SELECT COUNT(*)\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.Virtual = 'Yes'\n  AND T2.AvgScrMath < 400;",
        "pred_time": 0.015053749084472656,
        "orig_time": 0.015058517456054688,
        "time_ratio": 1.0003167564143174,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Among the schools with the SAT test takers of over 500, please list the schools that are magnet schools or offer a magnet program.",
        "original_query": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Magnet = 1 AND T1.NumTstTakr > 500",
        "llm_output": "-- Reasoning\nWe join the schools table with the satscores table on CDSCode. Filter schools with over 500 SAT test takers. Then, select schools that are either Magnet schools or offer a Magnet program.\n\n-- SQL Query\nSELECT T1.CDSCode\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.NumTstTakr > 500 AND (T1.Magnet = 1 OR T1.Magnet == 0 AND T1.GSoffered LIKE '%Magnet%');",
        "pred_query": "SELECT T1.CDSCode\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.NumTstTakr > 500 AND (T1.Magnet = 1 OR T1.Magnet == 0 AND T1.GSoffered LIKE '%Magnet%');",
        "pred_time": 0.01812911033630371,
        "orig_time": 0.01563739776611328,
        "time_ratio": 0.862557371874959,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the phone number of the school that has the highest number of test takers with an SAT score of over 1500?",
        "original_query": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe first join the schools table with the satscores table using CDSCode. Then, we filter for schools with an SAT score greater than 1500, and finally, we select the phone number of the school that has the highest number of test takers.\n\n-- SQL Query\nSELECT T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.NumGE1500 IS NOT NULL\nORDER BY T2.NumGE1500 DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.NumGE1500 IS NOT NULL\nORDER BY T2.NumGE1500 DESC\nLIMIT 1;",
        "pred_time": 0.0031414031982421875,
        "orig_time": 0.004656553268432617,
        "time_ratio": 1.4823163327261688,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the number of SAT test takers of the schools with the highest FRPM count for K-12 students?",
        "original_query": "SELECT NumTstTakr FROM satscores WHERE cds = ( SELECT CDSCode FROM frpm ORDER BY `FRPM Count (K-12)` DESC LIMIT 1 )",
        "llm_output": "-- Reasoning\nWe need the number of SAT test takers of the schools with the highest FRPM count for K-12 students. To do this, we join the frpm table with the satscores table using CDSCode, filter for the top row having the highest FRPM count, and return the corresponding number of SAT test takers.\n\n-- SQL Query\nSELECT T3.NumTstTakr\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nINNER JOIN satscores AS T3 ON T2.CDSCode = T3.cds\nWHERE T1.`FRPM Count (K-12)` = ( SELECT MAX(`FRPM Count (K-12)`) FROM frpm )",
        "pred_query": "SELECT T3.NumTstTakr\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nINNER JOIN satscores AS T3 ON T2.CDSCode = T3.cds\nWHERE T1.`FRPM Count (K-12)` = ( SELECT MAX(`FRPM Count (K-12)`) FROM frpm )",
        "pred_time": 0.010921955108642578,
        "orig_time": 0.007512569427490234,
        "time_ratio": 0.6878410827330277,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Among the schools with the average score in Math over 560 in the SAT test, how many schools are directly charter-funded?",
        "original_query": "SELECT COUNT(T2.`School Code`) FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath > 560 AND T2.`Charter Funding Type` = 'Directly funded'",
        "llm_output": "-- We join the schools table with satscores using CDSCode, filter for schools with average math score over 560, and select those that are directly charter-funded.\n\nSELECT COUNT(*)\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE (T2.rtype = 6 OR T2.rtype = 7 OR T2.rtype = 12) \n  AND STRFTIME('%Y', T2.rtype) = '2003'\n  AND T1.Charter = 1;",
        "pred_query": "select those that are directly charter-funded.\n\nSELECT COUNT(*)\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE (T2.rtype = 6 OR T2.rtype = 7 OR T2.rtype = 12) \n  AND STRFTIME('%Y', T2.rtype) = '2003'\n  AND T1.Charter = 1;",
        "pred_time": null,
        "orig_time": 0.008623123168945312,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "For the school with the highest average score in Reading in the SAT test, what is its FRPM count for students aged 5-17?",
        "original_query": "SELECT T2.`FRPM Count (Ages 5-17)` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrRead DESC LIMIT 1",
        "llm_output": "-- Question\nFor the school with the highest average score in Reading in the SAT test, what is its FRPM count for students aged 5-17?\n\n-- Reasoning\nWe first join schools and satscores using CDSCode and select the school name and the corresponding average reading score. Filter out inactive schools, sort schools by average reading score in descending order, and return the top one. Then we select the FRPM count for students aged 5-17 from the frpm table for that school.\n\n-- SQL Query\nSELECT T3.`FRPM Count (Ages 5-17)`\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nINNER JOIN frpm AS T3 ON T1.CDSCode = T3.CDSCode\nWHERE T1.StatusType = 'Active'\nORDER BY T2.AvgScrRead DESC\nLIMIT 1;",
        "pred_query": "SELECT T3.`FRPM Count (Ages 5-17)`\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nINNER JOIN frpm AS T3 ON T1.CDSCode = T3.CDSCode\nWHERE T1.StatusType = 'Active'\nORDER BY T2.AvgScrRead DESC\nLIMIT 1;",
        "pred_time": 0.02378058433532715,
        "orig_time": 0.0026116371154785156,
        "time_ratio": 0.10982224316493389,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Please list the codes of the schools with a total enrollment of over 500.",
        "original_query": "SELECT T2.CDSCode FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` + T2.`Enrollment (Ages 5-17)` > 500",
        "llm_output": "-- Reasoning\nWe need the codes of schools with a total enrollment greater than 500. Join the frpm table with schools using CDSCode, then sum the enrollment of both K-12 and ages 5-17, and filter for schools with total enrollment over 500.\n\n-- SQL Query\nSELECT T2.CDSCode\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE (T1.`Enrollment (K-12)` + T1.`Enrollment (Ages 5-17)`) > 500",
        "pred_query": "SELECT T2.CDSCode\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE (T1.`Enrollment (K-12)` + T1.`Enrollment (Ages 5-17)`) > 500",
        "pred_time": 0.018521547317504883,
        "orig_time": 0.019600868225097656,
        "time_ratio": 1.058273798030508,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Among the schools with an SAT excellence rate of over 0.3, what is the highest eligible free rate for students aged 5-17?",
        "original_query": "SELECT MAX(CAST(T1.`Free Meal Count (Ages 5-17)` AS REAL) / T1.`Enrollment (Ages 5-17)`) FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE CAST(T2.NumGE1500 AS REAL) / T2.NumTstTakr > 0.3",
        "llm_output": "SELECT T1.Percent_ Eligible FRPM (Ages 5-17) \nFROM frpm AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.Rtype = 'EXCEL' AND CAST(T1.Percent (%) Eligible FRPM (Ages 5-17)) AS REAL) > 0.3\nORDER BY T1.Percent (%) Eligible FRPM (Ages 5-17) DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.Percent_ Eligible FRPM (Ages 5-17) \nFROM frpm AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.Rtype = 'EXCEL' AND CAST(T1.Percent (%) Eligible FRPM (Ages 5-17)) AS REAL) > 0.3\nORDER BY T1.Percent (%) Eligible FRPM (Ages 5-17) DESC\nLIMIT 1;",
        "pred_time": null,
        "orig_time": 0.004791975021362305,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please list the phone numbers of the schools with the top 3 SAT excellence rate.",
        "original_query": "SELECT T1.Phone FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY CAST(T2.NumGE1500 AS REAL) / T2.NumTstTakr DESC LIMIT 3",
        "llm_output": "-- Reasoning\nWe first need to find the schools with the top 3 SAT excellence rates. We can do this by joining the frpm and schools tables, filtering for schools with available SAT scores, and sorting the schools by their SAT excellence rates in descending order. Then, we select the phone numbers of these top 3 schools from the schools table.\n\n-- SQL Query\nSELECT T1.Phone\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nINNER JOIN satscores AS T3 ON T1.CDSCode = T3.cds\nGROUP BY T1.Phone\nORDER BY (T3.AvgScrRead / T3.AvgScrMath / T3.AvgScrWrite) DESC\nLIMIT 3",
        "pred_query": "SELECT T1.Phone\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nINNER JOIN satscores AS T3 ON T1.CDSCode = T3.cds\nGROUP BY T1.Phone\nORDER BY (T3.AvgScrRead / T3.AvgScrMath / T3.AvgScrWrite) DESC\nLIMIT 3",
        "pred_time": 0.0283353328704834,
        "orig_time": 0.02127838134765625,
        "time_ratio": 0.7509486987471287,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "List the top five schools, by descending order, from the highest to the lowest, the most number of Enrollment (Ages 5-17). Please give their NCES school identification number.",
        "original_query": "SELECT T1.NCESSchool FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T2.`Enrollment (Ages 5-17)` DESC LIMIT 5",
        "llm_output": "-- Question\nList the top five schools, by descending order, from the highest to the lowest, the most number of Enrollment (Ages 5-17). Please give their NCES school identification number.\n\n-- Reasoning\nWe join the frpm table with schools using CDSCode, select schools with the highest enrollment (ages 5-17), and return their IDs. To get the IDs we need to go through both tables since there is a foreign key in the frpm to the schools table, then order by enrollment (ages 5-17) in descending order and return the top five.\n\n-- SQL Query\nSELECT T1.NCESSchool FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T2.`Enrollment (Ages 5-17)` DESC LIMIT 5;",
        "pred_query": "SELECT T1.NCESSchool FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T2.`Enrollment (Ages 5-17)` DESC LIMIT 5;",
        "pred_time": 0.033770084381103516,
        "orig_time": 0.034519195556640625,
        "time_ratio": 1.0221826859264906,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Which active district has the highest average score in Reading?",
        "original_query": "SELECT T1.District FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.StatusType = 'Active' ORDER BY T2.AvgScrRead DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need the district name and the corresponding average reading score. Join the schools table with satscores using CDSCode, filter for active districts, sort by reading score in descending order, and return the top one.\n\n-- SQL Query\nSELECT T1.District \nFROM schools AS T1 \nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds \nWHERE T1.StatusType = 'Active' AND T1.District = T2.dname\nORDER BY T2.AvgScrRead DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.District \nFROM schools AS T1 \nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds \nWHERE T1.StatusType = 'Active' AND T1.District = T2.dname\nORDER BY T2.AvgScrRead DESC\nLIMIT 1;",
        "pred_time": 0.02259206771850586,
        "orig_time": 0.022322416305541992,
        "time_ratio": 0.9880643322991198,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "How many schools in merged Alameda have number of test takers less than 100?",
        "original_query": "SELECT COUNT(T1.CDSCode) FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.StatusType = 'Merged' AND T2.NumTstTakr < 100 AND T1.County = 'Alameda'",
        "llm_output": "-- Reasoning\nWe need to filter schools from the merged Alameda district where the number of test takers is less than 100. We start with the schools table, filter districts matching 'Alameda' and 'Merged', join the satscores table based on CDSCode, and select schools from that filtered group where NumTstTakr is less than 100.\n\n-- SQL Query\nSELECT T1.*\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.District = 'Alameda' AND T1.StatusType = 'Merged'\nAND T2.NumTstTakr < 100;",
        "pred_query": "SELECT T1.*\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.District = 'Alameda' AND T1.StatusType = 'Merged'\nAND T2.NumTstTakr < 100;",
        "pred_time": 0.016901254653930664,
        "orig_time": 0.014775514602661133,
        "time_ratio": 0.8742259024672375,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the charter number of the school that the average score in Writing is 499?",
        "original_query": "SELECT T1.CharterNum FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T2.AvgScrWrite = 499",
        "llm_output": "SELECT T1.CharterNum\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.AvgScrWrite = 499;",
        "pred_query": "SELECT T1.CharterNum\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.AvgScrWrite = 499;",
        "pred_time": 0.0022068023681640625,
        "orig_time": 0.0017714500427246094,
        "time_ratio": 0.8027225583405359,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "How many schools in Contra Costa (directly funded) have number of test takers not more than 250?",
        "original_query": "SELECT COUNT(T1.CDSCode) FROM frpm AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds WHERE T1.`Charter Funding Type` = 'Directly funded' AND T1.`County Name` = 'Contra Costa' AND T2.NumTstTakr <= 250",
        "llm_output": "SELECT COUNT(*) \nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.StatusType = 'Directly Funded' \nAND STRFTIME('%M', T1.LastUpdate) = '08'\nAND T2.NumTstTakr <= 250;",
        "pred_query": "SELECT COUNT(*) \nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.StatusType = 'Directly Funded' \nAND STRFTIME('%M', T1.LastUpdate) = '08'\nAND T2.NumTstTakr <= 250;",
        "pred_time": 0.018500566482543945,
        "orig_time": 0.009051322937011719,
        "time_ratio": 0.48924571826230395,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the phone number of the school that has the highest average score in Math?",
        "original_query": "SELECT T1.Phone FROM schools AS T1 INNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds ORDER BY T2.AvgScrMath DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe join the schools table with satscores using CDSCode, filter for records in the satscores table with rtype='Math', sort by Math score in descending order, find the corresponding CDSCode, and then join the schools table again to retrieve the phone number of the associated school.\n\n-- SQL Query\nSELECT T3.Phone\nFROM satscores AS T1\nINNER JOIN schools AS T2 ON T1.cds = T2.CDSCode\nINNER JOIN schools AS T3 ON T1.cds = T3.CDSCode\nWHERE T1.rtype = 'Math'\nORDER BY T1.AvgScrMath DESC\nLIMIT 1;",
        "pred_query": "SELECT T3.Phone\nFROM satscores AS T1\nINNER JOIN schools AS T2 ON T1.cds = T2.CDSCode\nINNER JOIN schools AS T3 ON T1.cds = T3.CDSCode\nWHERE T1.rtype = 'Math'\nORDER BY T1.AvgScrMath DESC\nLIMIT 1;",
        "pred_time": 0.0017383098602294922,
        "orig_time": 0.017053842544555664,
        "time_ratio": 9.810588396653408,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "How many schools in Amador which the Low Grade is 9 and the High Grade is 12?",
        "original_query": "SELECT COUNT(T1.`School Name`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Amador' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12",
        "llm_output": "SELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.`District Name` = 'Amador' AND T2.`Low Grade` = '9' AND T2.`High Grade` = '12';",
        "pred_query": "SELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.`District Name` = 'Amador' AND T2.`Low Grade` = '9' AND T2.`High Grade` = '12';",
        "pred_time": 0.009692668914794922,
        "orig_time": 0.019939661026000977,
        "time_ratio": 2.0571899444089143,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "In Los Angeles how many schools have more than 500 free meals but less than 700 free or reduced price meals for K-12?",
        "original_query": "SELECT COUNT(CDSCode) FROM frpm WHERE `County Name` = 'Los Angeles' AND `Free Meal Count (K-12)` > 500 AND `Free Meal Count (K-12)` < 700",
        "llm_output": "-- Reasoning\nWe select schools in Los Angeles county with the corresponding free and reduced-price meal counts for K-12 students, filter those that have between 500 and 700 meals, and count the number of schools matching the criteria.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.County = 'Los Angeles'\nAND T1.`Free Meal Count (K-12)` BETWEEN 500 AND 700 \nAND T1.`Percent (%) Eligible FRPM (K-12)` < 100;",
        "pred_query": "SELECT COUNT(*)\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.County = 'Los Angeles'\nAND T1.`Free Meal Count (K-12)` BETWEEN 500 AND 700 \nAND T1.`Percent (%) Eligible FRPM (K-12)` < 100;",
        "pred_time": 0.018382787704467773,
        "orig_time": 0.005978822708129883,
        "time_ratio": 0.32524026302478504,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which school in Contra Costa has the highest number of test takers?",
        "original_query": "SELECT sname FROM satscores WHERE cname = 'Contra Costa' AND sname IS NOT NULL ORDER BY NumTstTakr DESC LIMIT 1",
        "llm_output": "-- We join the schools table with the satscores table using CDSCode to get the total number of test takers per school. Since we're interested in Contra Costa, filter the schools table for those in Contra Costa. Sort by the number of test takers in descending order and return the top record.\n\nSELECT T3.School\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nINNER JOIN frpm AS T3 ON T1.CDSCode = T3.CDSCode\nWHERE T1.County = 'Contra Costa'\nORDER BY T2.NumTstTakr DESC\nLIMIT 1;",
        "pred_query": "SELECT T3.School\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nINNER JOIN frpm AS T3 ON T1.CDSCode = T3.CDSCode\nWHERE T1.County = 'Contra Costa'\nORDER BY T2.NumTstTakr DESC\nLIMIT 1;",
        "pred_time": null,
        "orig_time": 0.0012664794921875,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "List the names of schools with more than 30 difference in enrollements between K-12 and ages 5-17? Please also give the full street adress of the schools.",
        "original_query": "SELECT T1.School, T1.StreetAbr FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30",
        "llm_output": "-- Reasoning\nWe need to compare the enrollment counts of schools for K-12 and ages 5-17. We join the frpm table with the schools table using the CDSCode, filter schools with more than a 30 difference in enrollment, and return the school names and full street addresses.\n\n-- SQL Query\nSELECT \n    T1.School, \n    T1.Street + ' ' + T1.City + ', ' + T1.State + ' ' + T1.Zip AS Address\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30;",
        "pred_query": "SELECT \n    T1.School, \n    T1.Street + ' ' + T1.City + ', ' + T1.State + ' ' + T1.Zip AS Address\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)` > 30;",
        "pred_time": null,
        "orig_time": null,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Give the names of the schools with the percent eligible for free meals in K-12 is more than 0.1 and test takers whose test score is greater than or equal to 1500?",
        "original_query": "SELECT T2.`School Name` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE CAST(T2.`Free Meal Count (K-12)` AS REAL) / T2.`Enrollment (K-12)` > 0.1 AND T1.NumGE1500 > 0",
        "llm_output": "-- Reasoning\nWe need to join the frpm table with schools using CDSCode. Filter the schools where the percentage eligible for free meals in K-12 is more than 0.1. Then join the satscores table with the filtered schools on CDSCode and filter the rows where the test score is greater than or equal to 1500.\n\n-- SQL Query\nSELECT T3.School as SchoolName, T4.Sname as TestName\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nINNER JOIN satscores AS T3 ON T2.CDSCode = T3.cds\nINNER JOIN frpm AS T4 ON T3.cds = T4.CDSCode\nWHERE T2.`Percent (%) Eligible Free (K-12)` < 0.1\nAND T4.NumGE1500 IS NULL",
        "pred_query": "SELECT T3.School as SchoolName, T4.Sname as TestName\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nINNER JOIN satscores AS T3 ON T2.CDSCode = T3.cds\nINNER JOIN frpm AS T4 ON T3.cds = T4.CDSCode\nWHERE T2.`Percent (%) Eligible Free (K-12)` < 0.1\nAND T4.NumGE1500 IS NULL",
        "pred_time": null,
        "orig_time": 0.006973981857299805,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Name schools in Riverside which the average of average math score for SAT is grater than 400, what is the funding type of these schools?",
        "original_query": "SELECT T1.sname, T2.`Charter Funding Type` FROM satscores AS T1 INNER JOIN frpm AS T2 ON T1.cds = T2.CDSCode WHERE T2.`District Name` LIKE 'Riverside%' GROUP BY T1.sname, T2.`Charter Funding Type` HAVING CAST(SUM(T1.AvgScrMath) AS REAL) / COUNT(T1.cds) > 400",
        "llm_output": "SELECT T1.FundingType \nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.District = 'Riverside' AND T1.County = 'Riverside'\nAND T2.rtype = 'S' AND T2.AvgScrMath IS NOT NULL \nGROUP BY T1.FundingType \nHAVING SUM(T2.AvgScrMath) > 400;",
        "pred_query": "SELECT T1.FundingType \nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.District = 'Riverside' AND T1.County = 'Riverside'\nAND T2.rtype = 'S' AND T2.AvgScrMath IS NOT NULL \nGROUP BY T1.FundingType \nHAVING SUM(T2.AvgScrMath) > 400;",
        "pred_time": 0.013010501861572266,
        "orig_time": 0.005490541458129883,
        "time_ratio": 0.4220084295400403,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "State the names and full communication address of high schools in Monterey which has more than 800 free or reduced price meals for ages 15-17?",
        "original_query": "SELECT T1.`School Name`, T2.Zip, T2.Street, T2.City, T2.State FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Monterey' AND T1.`Free Meal Count (Ages 5-17)` > 800 AND T1.`School Type` = 'High Schools (Public)'",
        "llm_output": "-- Reasoning\nWe need the names and full address of high schools in Monterey with more than 800 free or reduced price meals for ages 15-17. First, filter the schools table for high schools in Monterey, then join this table with frpm table using CDSCode to find schools with eligible free or reduced price meals for ages 15-17 greater than 800.\n\n-- SQL Query\nSELECT T1.DistrictName, T1.County, T1.District, T1.CountyName, T1.School, T1.STreet, T1.STreetAbr, T1.City, T1.Zip, T1.MailStreet, T1.MailStrAbr, T1.MailCity, T1.MailZip, T1.MailState\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.Percentage Eligible FRPM (Ages 5-17) > 800 AND T1.DistrictType = 'High School' AND T2.County Code = 'Monterey'",
        "pred_query": "SELECT T1.DistrictName, T1.County, T1.District, T1.CountyName, T1.School, T1.STreet, T1.STreetAbr, T1.City, T1.Zip, T1.MailStreet, T1.MailStrAbr, T1.MailCity, T1.MailZip, T1.MailState\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.Percentage Eligible FRPM (Ages 5-17) > 800 AND T1.DistrictType = 'High School' AND T2.County Code = 'Monterey'",
        "pred_time": null,
        "orig_time": 0.017882585525512695,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the average score in writing for the schools that were opened after 1991 or closed before 2000? List the school names along with the score. Also, list the communication number of the schools if there is any.",
        "original_query": "SELECT T2.School, T1.AvgScrWrite, T2.Phone, strftime('%Y', T2.OpenDate), strftime('%Y', T2.ClosedDate) FROM schools AS T2 LEFT JOIN satscores AS T1 ON T2.CDSCode = T1.cds WHERE strftime('%Y', T2.OpenDate) > '1991' AND strftime('%Y', T2.ClosedDate) < '2000'",
        "llm_output": "-- Reasoning\nWe need schools that match the given criteria of open date (after 1991) or closed date (before 2000), then sort the matching schools by writing score in descending order, and finally return the school name, the corresponding average writing score, and the communication number if available.\n\n-- SQL Query\nSELECT T1.School, T2.AvgScrWrite, T1 CharterNum \nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.OpenDate > '1991-12-31' OR T1.ClosedDate < '2000-01-01'\nORDER BY T2.AvgScrWrite DESC",
        "pred_query": "SELECT T1.School, T2.AvgScrWrite, T1 CharterNum \nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.OpenDate > '1991-12-31' OR T1.ClosedDate < '2000-01-01'\nORDER BY T2.AvgScrWrite DESC",
        "pred_time": null,
        "orig_time": 0.014000415802001953,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Consider the average difference between K-12 enrollment and 15-17 enrollment of schools that are locally funded, list the names and DOC type of schools which has a difference above this average.",
        "original_query": "SELECT T2.School, T2.DOC FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.FundingType = 'Locally funded' AND (T1.`Enrollment (K-12)` - T1.`Enrollment (Ages 5-17)`) > (SELECT AVG(T3.`Enrollment (K-12)` - T3.`Enrollment (Ages 5-17)`) FROM frpm AS T3 INNER JOIN schools AS T4 ON T3.CDSCode = T4.CDSCode WHERE T4.FundingType = 'Locally funded')",
        "llm_output": "-- Reasoning\nWe join the schools and frpm tables to get locally funded schools with enrollment information. Then, we calculate the average difference between K-12 enrollment and 15-17 enrollment. We use this average to filter schools with a higher difference, and finally, we return their names and DOC types.\n\n-- SQL Query\nSELECT T1.School, T1.DOCType\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.FundingType = 'Local'\nAND (T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > \n    (SELECT AVG(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) \n    FROM schools AS T1 \n    INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode \n    WHERE T1.FundingType = 'Local');",
        "pred_query": "SELECT T1.School, T1.DOCType\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.FundingType = 'Local'\nAND (T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) > \n    (SELECT AVG(T2.`Enrollment (K-12)` - T2.`Enrollment (Ages 5-17)`) \n    FROM schools AS T1 \n    INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode \n    WHERE T1.FundingType = 'Local');",
        "pred_time": 0.009893178939819336,
        "orig_time": 0.017026185989379883,
        "time_ratio": 1.7210025304253525,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "When did the first-through-twelfth-grade school with the largest enrollment open?",
        "original_query": "SELECT T2.OpenDate FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the school with the largest enrollment and its open date. Join the schools table with frpm table using CDsCode, filter for first-through-twelfth-grade schools and the largest enrollment, and return the corresponding open date.\n\n-- SQL Query\nSELECT T1.OpenDate\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12'\nGROUP BY T1.CDSCode\nORDER BY SUM(T2.`Enrollment (K-12)`) DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.OpenDate\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.`Low Grade` = 'K' AND T2.`High Grade` = '12'\nGROUP BY T1.CDSCode\nORDER BY SUM(T2.`Enrollment (K-12)`) DESC\nLIMIT 1;",
        "pred_time": 0.006903886795043945,
        "orig_time": 0.007349252700805664,
        "time_ratio": 1.064509445039196,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Which cities have the top 5 lowest enrollment number for students in grades 1 through 12?",
        "original_query": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode GROUP BY T2.City ORDER BY SUM(T1.`Enrollment (K-12)`) ASC LIMIT 5",
        "llm_output": "-- Reasoning\nWe join the frpm table with schools on CDSCode, filter for districts with grades 1-12, and then group the data by City and Enrollment (K-12) in ascending order. Finally, we return the top 5 cities with the lowest enrollment numbers.\n\n-- SQL Query\nSELECT T2.City\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE (T1.`Low Grade` = '1' AND T1.`High Grade` = '12') OR\n      (T1.`Low Grade` = '06' AND T1.`High Grade` = '12')\nGROUP BY T2.City\nORDER BY SUM(T1.`Enrollment (K-12)`) ASC\nLIMIT 5;",
        "pred_query": "SELECT T2.City\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE (T1.`Low Grade` = '1' AND T1.`High Grade` = '12') OR\n      (T1.`Low Grade` = '06' AND T1.`High Grade` = '12')\nGROUP BY T2.City\nORDER BY SUM(T1.`Enrollment (K-12)`) ASC\nLIMIT 5;",
        "pred_time": 0.0048809051513671875,
        "orig_time": 0.016093015670776367,
        "time_ratio": 3.2971375537319267,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the eligible free rate of the 10th and 11th schools with the highest enrolment for students in grades 1 through 12?",
        "original_query": "SELECT CAST(`Free Meal Count (K-12)` AS REAL) / `Enrollment (K-12)` FROM frpm ORDER BY `Enrollment (K-12)` DESC LIMIT 9, 2",
        "llm_output": "-- Reasoning\nWe join the schools table with frpm table using CDSCode, sort the schools in descending order by enrollment in grades 1 through 12. Then select the eligible free rate for the top 10 schools and the 11th school.\n\n-- SQL Query\nSELECT T1.Percent(%) Eligible Free (K-12) \nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.`Low Grade` = '1' AND T1.`High Grade` = '12'\nORDER BY T1.`Enrollment (K-12)` DESC\nLIMIT 10, 1;",
        "pred_query": "SELECT T1.Percent(%) Eligible Free (K-12) \nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.`Low Grade` = '1' AND T1.`High Grade` = '12'\nORDER BY T1.`Enrollment (K-12)` DESC\nLIMIT 10, 1;",
        "pred_time": null,
        "orig_time": 0.004548311233520508,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the eligible free or reduced price meal rate for the top 5 schools in grades 1-12 with the highest free or reduced price meal count of the schools with the ownership code 66?",
        "original_query": "SELECT CAST(T1.`FRPM Count (K-12)` AS REAL) / T1.`Enrollment (K-12)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.SOC = 66 ORDER BY T1.`FRPM Count (K-12)` DESC LIMIT 5",
        "llm_output": "-- Reasoning\nFirst, we filter the schools table to include only schools with the ownership code 66. We then join this with the frpm table to get the relevant meal counts. We sort the resulting table by the FRPM Count (K-12) in descending order, select the top 5 schools, and return their eligible free or reduced price meal rates.\n\n-- SQL Query\nSELECT T2.`Percent (%) Eligible Free (K-12)`, T2.`Percent (%) Eligible FRPM (K-12)`\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.ownershipcode = 66\nORDER BY T2.`FRPM Count (K-12)` DESC\nLIMIT 5;",
        "pred_query": "SELECT T2.`Percent (%) Eligible Free (K-12)`, T2.`Percent (%) Eligible FRPM (K-12)`\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.ownershipcode = 66\nORDER BY T2.`FRPM Count (K-12)` DESC\nLIMIT 5;",
        "pred_time": null,
        "orig_time": 0.01314687728881836,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "If there are any, what are the websites address of the schools with a free meal count of 1,900-2,000 to students aged 5-17? Include the name of the school.",
        "original_query": "SELECT T2.Website, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Free Meal Count (Ages 5-17)` BETWEEN 1900 AND 2000 AND T2.Website IS NOT NULL",
        "llm_output": "-- Reasoning\nWe join schools and frpm using CDSCode and filter for schools with a free meal count of 1,900-2,000 to students aged 5-17. We then return the name and website of the matched schools.\n\n-- SQL Query\nSELECT T1.School, T1.Website \nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE STRTOTIME('0', T2.`Percent (%) Eligible Free (Ages 5-17)`,'.') BETWEEN '1.9' AND '2.0'\n;",
        "pred_query": "SELECT T1.School, T1.Website \nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE STRTOTIME('0', T2.`Percent (%) Eligible Free (Ages 5-17)`,'.') BETWEEN '1.9' AND '2.0'\n;",
        "pred_time": null,
        "orig_time": 0.0038292407989501953,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the free rate for students between the ages of 5 and 17 at the school run by Kacey Gibson?",
        "original_query": "SELECT CAST(T2.`Free Meal Count (Ages 5-17)` AS REAL) / T2.`Enrollment (Ages 5-17)` FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.AdmFName1 = 'Kacey' AND T1.AdmLName1 = 'Gibson'",
        "llm_output": "-- Reasoning\nWe need to find the free rate for students between the ages of 5 and 17. First, we filter for schools run by Kacey Gibson by examining their administrators, then we extract the relevant information from the frpm table.\n\n-- SQL Query\nSELECT T3.`Percent (%) Eligible FRPM (Ages 5-17)`\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.AdmLName1 = 'Gibson' AND T1.AdmFName1 = 'Kacey'\nINNER JOIN schools AS T3 ON T2.CDSCode = T3.CDSCode;",
        "pred_query": "SELECT T3.`Percent (%) Eligible FRPM (Ages 5-17)`\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.AdmLName1 = 'Gibson' AND T1.AdmFName1 = 'Kacey'\nINNER JOIN schools AS T3 ON T2.CDSCode = T3.CDSCode;",
        "pred_time": null,
        "orig_time": 0.010162591934204102,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the administrator's email address of the chartered school with the fewest students enrolled in grades 1 through 12?",
        "original_query": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`Charter School (Y/N)` = 1 ORDER BY T1.`Enrollment (K-12)` ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe start by joining the schools and frpm tables based on the CDSCode, filter chartered schools, and order them by enrollment in ascending order. Then we return the administrator's email address of the first (i.e., chartered school with the fewest students) record from the results.\n\n-- SQL Query\nSELECT T1.AdmEmail1 \nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.Charter = 1\nORDER BY T2.Enrollment (K-12) ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.AdmEmail1 \nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.Charter = 1\nORDER BY T2.Enrollment (K-12) ASC\nLIMIT 1;",
        "pred_time": null,
        "orig_time": 0.005599498748779297,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Under whose administration does the school with the highest number of test takers whose total SAT Scores are greater or equal to 1500 belong to? Indicate his or her full name.",
        "original_query": "SELECT T2.AdmFName1, T2.AdmLName1, T2.AdmFName2, T2.AdmLName2, T2.AdmFName3, T2.AdmLName3 FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nTo answer this question, we need to find the school with the highest number of test takers whose total SAT Scores are greater or equal to 1500. We join the satscores and schools tables on the CDSCode and calculate the sum of NumGE1500 for each school. Then we order the results by this total number in descending order and take the top row to get the school's CDSCode. Next, we join the schools table with itself on the CDSCode and StatusType to get the full name of the first administrator. Finally, we select the full name.\n\n-- SQL Query\nSELECT T1.AdmFName1, T1.AdmLName1\nFROM schools AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode AND T1.StatusType = T2.DOC AND T1.DOCType = 'Head of School'\nWHERE T2.CDSCode = (\n    SELECT T1.cds\n    FROM satscores AS T1\n    GROUP BY T1.cds\n    ORDER BY SUM(T1.NumGE1500) DESC\n    LIMIT 1\n)",
        "pred_query": "SELECT T1.AdmFName1, T1.AdmLName1\nFROM schools AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode AND T1.StatusType = T2.DOC AND T1.DOCType = 'Head of School'\nWHERE T2.CDSCode = (\n    SELECT T1.cds\n    FROM satscores AS T1\n    GROUP BY T1.cds\n    ORDER BY SUM(T1.NumGE1500) DESC\n    LIMIT 1\n)",
        "pred_time": 0.0018627643585205078,
        "orig_time": 0.0020020008087158203,
        "time_ratio": 1.0747472161781646,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the complete address of the school with the lowest excellence rate? Indicate the Street, City, Zip and State.",
        "original_query": "SELECT T2.Street, T2.City, T2.Zip, T2.State FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY CAST(T1.NumGE1500 AS REAL) / T1.NumTstTakr ASC LIMIT 1",
        "llm_output": "-- Reasoning\nTo answer this question, we need to find the school with the lowest excellence rate (represented by AvgScrRead in the satscores table), which is the average reading score. We join the schools table with satscores using CDSCode, filter for the school of interest, and then return the corresponding street address and other details we need.\n\n-- SQL Query\nSELECT T1.Street, T1.City, T1.Zip, T1.State\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.rtype = 'S'\nORDER BY T2.AvgScrRead ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.Street, T1.City, T1.Zip, T1.State\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.rtype = 'S'\nORDER BY T2.AvgScrRead ASC\nLIMIT 1;",
        "pred_time": 0.0024755001068115234,
        "orig_time": 0.0018639564514160156,
        "time_ratio": 0.7529615718000577,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers?",
        "original_query": "SELECT T2.Website FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.NumTstTakr BETWEEN 2000 AND 3000 AND T2.County = 'Los Angeles'",
        "llm_output": "-- Question\nWhat are the webpages for the Los Angeles County school that has between 2,000 and 3,000 test takers?\n\n-- Reasoning\nFirst, filter schools with Los Angeles County using the County column. Join the schools table with satscores using CDSCode. Filter for schools having 2,000 to 3,000 test takers (NumTstTakr). Then, return the corresponding webpage (Website) from the schools table.\n\n-- SQL Query\nSELECT T1.Website\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.County = 'Los Angeles' AND 2000 <= T2.NumTstTakr AND T2.NumTstTakr <= 3000;",
        "pred_query": "SELECT T1.Website\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.County = 'Los Angeles' AND 2000 <= T2.NumTstTakr AND T2.NumTstTakr <= 3000;",
        "pred_time": 0.009828567504882812,
        "orig_time": 0.008139848709106445,
        "time_ratio": 0.8281826120706385,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980?",
        "original_query": "SELECT AVG(T1.NumTstTakr) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE strftime('%Y', T2.OpenDate) = '1980' AND T2.County = 'Fresno'",
        "llm_output": "-- Question\nWhat is the average number of test takers from Fresno schools that opened between 1/1/1980 and 12/31/1980?\n\n-- Reasoning\nWe first need to extract schools from Fresno with an open date between 1/1/1980 and 12/31/1980 from the schools table. Then, we join the satscores table with schools using the CDSCode, filter for the school type, and calculate the average number of test takers.\n\n-- SQL Query\nSELECT CAST(SUM(T2.NumTstTakr) AS REAL) / COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.StatusType = 'Active' AND T1.OpenDate BETWEEN '1980-01-01' AND '1980-12-31' AND T1.District = 'Fresno'",
        "pred_query": "SELECT CAST(SUM(T2.NumTstTakr) AS REAL) / COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.StatusType = 'Active' AND T1.OpenDate BETWEEN '1980-01-01' AND '1980-12-31' AND T1.District = 'Fresno'",
        "pred_time": 0.010753631591796875,
        "orig_time": 0.011333703994750977,
        "time_ratio": 1.0539420007094715,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the telephone number for the school with the lowest average score in reading in Fresno Unified?",
        "original_query": "SELECT T2.Phone FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.District = 'Fresno Unified' AND T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1",
        "llm_output": "-- Reasoning\nTo find the telephone number for the school with the lowest average score in reading in Fresno Unified, we need to join the schools and satscores tables, filter the school in Fresno Unified, sort the satscores by reading score in ascending order, find the school with the lowest reading score, and then select the phone number from the schools table for that school.\n\n-- SQL Query\nSELECT T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.District = 'Fresno Unified'\nORDER BY T2.AvgScrRead ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.Phone\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.District = 'Fresno Unified'\nORDER BY T2.AvgScrRead ASC\nLIMIT 1;",
        "pred_time": 0.009158849716186523,
        "orig_time": 0.008234977722167969,
        "time_ratio": 0.899127944813224,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which exclusively virtual schools have the top 5 highest average reading scores?",
        "original_query": "SELECT T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.Virtual = 'F' ORDER BY T1.AvgScrRead DESC LIMIT 5",
        "llm_output": "-- The query needs the school name and average reading score from the satscores table where the school type is 'Virtual'. \n-- Join schools and satscores on CDSCode to filter virtual schools. \n-- Filter for schools with a valid reading score. \n-- Order by average reading score in descending order and return the top 5.\n\nSELECT T1.School, T2.AvgScrRead\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.StatusType = 'Virtual'\nAND T2.AvgScrRead IS NOT NULL\nORDER BY T2.AvgScrRead DESC\nLIMIT 5;",
        "pred_query": "SELECT T1.School, T2.AvgScrRead\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.StatusType = 'Virtual'\nAND T2.AvgScrRead IS NOT NULL\nORDER BY T2.AvgScrRead DESC\nLIMIT 5;",
        "pred_time": 0.010000944137573242,
        "orig_time": 0.009427070617675781,
        "time_ratio": 0.942618065654278,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the type of education offered in the school who scored the highest average in Math?",
        "original_query": "SELECT T2.EdOpsName FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need the type of education offered in the school with the highest average Math score. First, we join the satscores table with the schools table using CDSCode to get school information and average Math scores. Then we order the results by the average Math score in descending order and return the top one. Finally, we select the education operation code (EdOpsCode) from this record.\n\n-- SQL Query\nSELECT T2.EdOpsCode \nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.StatusType = 'Active'\nORDER BY T2.AvgScrMath DESC\nLIMIT 1",
        "pred_query": "SELECT T2.EdOpsCode \nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.StatusType = 'Active'\nORDER BY T2.AvgScrMath DESC\nLIMIT 1",
        "pred_time": null,
        "orig_time": 0.0024518966674804688,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the average math score of the school with the lowest average score for all subjects, and in which county is it located?",
        "original_query": "SELECT T1.AvgScrMath, T2.County FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrMath IS NOT NULL ORDER BY T1.AvgScrMath + T1.AvgScrRead + T1.AvgScrWrite ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the school with the lowest average score for all subjects. To do this, we join the schools and satscores tables using CDSCode, calculate the average score by subject (reading, math, and writing), and select the school with the lowest total average score. Then, we can join the schools table again with the results to find the county in which this school is located. We will also return the average math score. \n\nSince average reading, math and writing scores are stored in AvgScrRead, AvgScrMath, and AvgScrWrite respectively and we need to calculate overall score we use the LEAST function that gives the lower of two values, we multiply with -1 and sum it with the other two and then use the ABS function to get the actual minimum value.\n\n-- SQL Query\nSELECT T1.District, T1.County, ABS(LEAST(-T2.AvgScrRead, -T2.AvgScrMath, -T2.AvgScrWrite)) \nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nORDER BY ABS(LEAST(-T2.AvgScrRead, -T2.AvgScrMath, -T2.AvgScrWrite)) ASC\nLIMIT 1\nOFFSET 1;",
        "pred_query": "SELECT T1.District, T1.County, ABS(LEAST(-T2.AvgScrRead, -T2.AvgScrMath, -T2.AvgScrWrite)) \nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nORDER BY ABS(LEAST(-T2.AvgScrRead, -T2.AvgScrMath, -T2.AvgScrWrite)) ASC\nLIMIT 1\nOFFSET 1;",
        "pred_time": null,
        "orig_time": 0.0027942657470703125,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated.",
        "original_query": "SELECT T1.AvgScrWrite, T2.City FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1",
        "llm_output": "-- Question\nWhat is the average writing score of the school who has the highest number of test takers whose total SAT sscores are greater or equal to 1500? Indicate the city to where the school is situated.\n\n-- Reasoning\nFirst, we need to find the school with the highest number of test takers who scored 1500 or higher in the SAT. To do this, we join the satscores table with the schools table using CDSCode and filter for those whose NumGE1500 is greater than or equal to the maximum value. Then, we sort the results by NumGE1500 in descending order and return the first record, which is the school with the highest number of test takers who scored 1500 or higher. Next, we join this subquery with the satscores table again to get the average writing score for this school. Finally, we return the average writing score and the city of the school.\n\n-- SQL Query\nSELECT T2.City, T3.AvgScrWrite\nFROM (\n    SELECT Max(NumGE1500) AS max_num, T1.cds\n    FROM satscores AS T1\n    GROUP BY T1.cds\n) AS T0\nINNER JOIN satscores AS T2 ON T0.cds = T2.cds\nINNER JOIN schools AS T3 ON T2.cds = T3.CDSCode\nWHERE T2.NumGE1500 = T0.max_num",
        "pred_query": "SELECT T2.City, T3.AvgScrWrite\nFROM (\n    SELECT Max(NumGE1500) AS max_num, T1.cds\n    FROM satscores AS T1\n    GROUP BY T1.cds\n) AS T0\nINNER JOIN satscores AS T2 ON T0.cds = T2.cds\nINNER JOIN schools AS T3 ON T2.cds = T3.CDSCode\nWHERE T2.NumGE1500 = T0.max_num",
        "pred_time": null,
        "orig_time": 0.0024836063385009766,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the average writing score of each of the schools managed by Ricci Ulrich? List the schools and the corresponding average writing scores.",
        "original_query": "SELECT T2.School, T1.AvgScrWrite FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.AdmFName1 = 'Ricci' AND T2.AdmLName1 = 'Ulrich'",
        "llm_output": "-- Reasoning\nWe need the CDSCode and the corresponding average writing score of schools managed by Ricci Ulrich. Join the schools table with satscores using CDSCode, filter for schools managed by Ricci, sort by average writing score, and return all schools with their scores.\n\n-- SQL Query\nSELECT T1.District, T2.AvgScrWrite\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.StatusType = 'Active' AND T1.AdmLName1 = 'Ulrich' AND T1.AdmFName1 = 'Ricci'\nORDER BY T2.AvgScrWrite DESC;",
        "pred_query": "SELECT T1.District, T2.AvgScrWrite\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.StatusType = 'Active' AND T1.AdmLName1 = 'Ulrich' AND T1.AdmFName1 = 'Ricci'\nORDER BY T2.AvgScrWrite DESC;",
        "pred_time": 0.012743234634399414,
        "orig_time": 0.012975215911865234,
        "time_ratio": 1.0182042694905424,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which state special schools have the highest number of enrollees from grades 1 through 12?",
        "original_query": "SELECT T2.School FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.DOC = 31 ORDER BY T1.`Enrollment (K-12)` DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe join the frpm table with the schools table using CDSCode, filter for state special schools by District Type, sort by Enrollment (K-12) in descending order, and return the top record.\n\n-- SQL Query\nSELECT T2.State, T2.Enrollment(k-12) as total_enrollees\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.District = T1.District AND T2.DistrictType = 'State Special'\nORDER BY T2.Enrollment(k-12) DESC\nLIMIT 1;",
        "pred_query": "SELECT T2.State, T2.Enrollment(k-12) as total_enrollees\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.District = T1.District AND T2.DistrictType = 'State Special'\nORDER BY T2.Enrollment(k-12) DESC\nLIMIT 1;",
        "pred_time": null,
        "orig_time": 0.010423421859741211,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the monthly average number of schools that opened in Alameda County under the jurisdiction of the Elementary School District in 1980?",
        "original_query": "SELECT CAST(COUNT(School) AS REAL) / 12 FROM schools WHERE DOC = 52 AND County = 'Alameda' AND strftime('%Y', OpenDate) = '1980'",
        "llm_output": "-- SQL Query\nSELECT SUM(CASE WHEN T2.EducationalOptionType = 'Elementary School District' THEN 1 ELSE 0 END) / \n       COUNT(CASE WHEN STRFTIME('%Y', T1.OpenDate) = '1980' THEN 1 ELSE NULL END) AS monthly_avg\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.County = 'Alameda';",
        "pred_query": "SELECT SUM(CASE WHEN T2.EducationalOptionType = 'Elementary School District' THEN 1 ELSE 0 END) / \n       COUNT(CASE WHEN STRFTIME('%Y', T1.OpenDate) = '1980' THEN 1 ELSE NULL END) AS monthly_avg\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.County = 'Alameda';",
        "pred_time": null,
        "orig_time": 0.00990152359008789,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the ratio of merged Unified School District schools in Orange County to merged Elementary School District schools?",
        "original_query": "SELECT CAST(SUM(CASE WHEN DOC = 54 THEN 1 ELSE 0 END) AS REAL) / SUM(CASE WHEN DOC = 52 THEN 1 ELSE 0 END) FROM schools WHERE StatusType = 'Merged' AND County = 'Orange'",
        "llm_output": "-- Reasoning\nWe need the ratio of schools that are Unified School District (USD) and merged in Orange County to those that are Elementary School District (ESD) and merged. We join the schools and frpm tables using the CDSCode and filter for merged schools and schools in Orange County. Then we group by District Type and sum up schools for both USD and ESD. The ratio is the sum of USD schools to the sum of ESD schools.\n\n-- SQL Query\nSELECT \n    SUM(IIF(T1.StatusType='USD' AND T1.District IN (SELECT District FROM frpm WHERE County='ORANGE'), 1, 0)) / \n    SUM(IIF(T1.StatusType='ESD' AND T1.District IN (SELECT District FROM frpm WHERE County='ORANGE'), 1, 0))\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode;",
        "pred_query": "SELECT \n    SUM(IIF(T1.StatusType='USD' AND T1.District IN (SELECT District FROM frpm WHERE County='ORANGE'), 1, 0)) / \n    SUM(IIF(T1.StatusType='ESD' AND T1.District IN (SELECT District FROM frpm WHERE County='ORANGE'), 1, 0))\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode;",
        "pred_time": 0.012769937515258789,
        "orig_time": 0.007106781005859375,
        "time_ratio": 0.5565243367375515,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which different county has the most number of closed schools? Please provide the name of each school as well as the closure date.",
        "original_query": "SELECT DISTINCT County, School, ClosedDate FROM schools WHERE County = ( SELECT County FROM schools WHERE StatusType = 'Closed' GROUP BY County ORDER BY COUNT(School) DESC LIMIT 1 ) AND StatusType = 'Closed' AND school IS NOT NULL",
        "llm_output": "-- Reasoning\nWe need the county and the count of closed schools. Join the schools table with frpm, filter for closed schools, group by county, and return the counties with the highest counts. To include school names and closure dates, join the schools table with itself for open and closed dates.\n\n-- SQL Query\nSELECT T1.County, T2.School, T2.ClosedDate\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.ClosedDate IS NOT NULL\nGROUP BY T1.County\nORDER BY COUNT(T2.ClosedDate) DESC\nLIMIT 1\nUNION ALL\nSELECT T1.County, T2.School, T2.ClosedDate\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.ClosedDate IS NOT NULL\nGROUP BY T1.County\nORDER BY COUNT(T2.ClosedDate) DESC\nOFFSET 1;",
        "pred_query": "SELECT T1.County, T2.School, T2.ClosedDate\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.ClosedDate IS NOT NULL\nGROUP BY T1.County\nORDER BY COUNT(T2.ClosedDate) DESC\nLIMIT 1\nUNION ALL\nSELECT T1.County, T2.School, T2.ClosedDate\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.ClosedDate IS NOT NULL\nGROUP BY T1.County\nORDER BY COUNT(T2.ClosedDate) DESC\nOFFSET 1;",
        "pred_time": null,
        "orig_time": 0.018224239349365234,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the postal street address for the school with the 6th highest Math average? Indicate the school's name.",
        "original_query": "SELECT T2.MailStreet, T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrMath DESC LIMIT 5, 1",
        "llm_output": "-- Question\nWhat is the postal street address for the school with the 6th highest Math average? Indicate the school's name.\n\n-- Reasoning\nTo solve this problem, we need to join the schools table with the satscores table on the CDSCode. We order the results by the Math average in descending order, select the school with the 6th highest average by using the LIMIT keyword, and finally return the Street and School names from the schools table.",
        "pred_query": "select the school with the 6th highest average by using the LIMIT keyword, and finally return the Street and School names from the schools table.",
        "pred_time": null,
        "orig_time": 0.0022928714752197266,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "In which mailing street address can you find the school that has the lowest average score in reading? Also give the school's name.",
        "original_query": "SELECT T2.MailStreet, T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T1.AvgScrRead IS NOT NULL ORDER BY T1.AvgScrRead ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe first join the schools and satscores tables using CDSCode to link them. Then, we filter for the school with the lowest average reading score. Finally, we return the school name and the mailing street address.\n\n-- SQL Query\nSELECT T3.MailStreet, T2.School\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nINNER JOIN frpm AS T3 ON T1.CDSCode = T3.CDSCode\nORDER BY T2.AvgScrRead ASC\nLIMIT 1;",
        "pred_query": "SELECT T3.MailStreet, T2.School\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nINNER JOIN frpm AS T3 ON T1.CDSCode = T3.CDSCode\nORDER BY T2.AvgScrRead ASC\nLIMIT 1;",
        "pred_time": null,
        "orig_time": 0.002207040786743164,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the total number of schools whose total SAT scores are greater or equal to 1500 whose mailing city is Lakeport?",
        "original_query": "SELECT COUNT(T1.cds) FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.MailCity = 'Lakeport' AND (T1.AvgScrRead + T1.AvgScrMath + T1.AvgScrWrite) >= 1500",
        "llm_output": "-- Reasoning\nWe need the count of schools where total SAT scores are greater or equal to 1500 and the mailing city is Lakeport. Join the schools table with satscores using CDSCode, filter for schools with SAT scores >= 1500 and mailing city 'Lakeport', and count all such schools.\n\n-- SQL Query\nSELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.MailCity = 'Lakeport'\n  AND (T2.AvgScrRead + T2.AvgScrMath + T2.AvgScrWrite) >= 1500;",
        "pred_query": "SELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.MailCity = 'Lakeport'\n  AND (T2.AvgScrRead + T2.AvgScrMath + T2.AvgScrWrite) >= 1500;",
        "pred_time": 0.008196115493774414,
        "orig_time": 0.007786273956298828,
        "time_ratio": 0.9499956366175059,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "How many test takers are there at the school/s whose mailing city address is in Fresno?",
        "original_query": "SELECT T1.NumTstTakr FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode WHERE T2.MailCity = 'Fresno'",
        "llm_output": "-- We start by selecting the school's CDSCode from the schools table where the mailing city is 'Fresno'.\n\n-- Then we join the satscores table with the schools table using CDSCode to get the total number of test takers.\n\n-- We don't need any filtering as we're only interested in schools in Fresno, so the mailing city condition already filters that.\n\n-- Finally, we count the total number of test takers and return it.\n\nSELECT COUNT(T2.enroll12) \nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.MailCity = 'Fresno';",
        "pred_query": "selecting the school's CDSCode from the schools table where the mailing city is 'Fresno'.\n\n-- Then we join the satscores table with the schools table using CDSCode to get the total number of test takers.\n\n-- We don't need any filtering as we're only interested in schools in Fresno, so the mailing city condition already filters that.\n\n-- Finally, we count the total number of test takers and return it.\n\nSELECT COUNT(T2.enroll12) \nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T1.MailCity = 'Fresno';",
        "pred_time": null,
        "orig_time": 0.009104251861572266,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please specify all of the schools and their related mailing zip codes that are under Avetik Atoian's administration.",
        "original_query": "SELECT School, MailZip FROM schools WHERE AdmFName1 = 'Avetik' AND AdmLName1 = 'Atoian'",
        "llm_output": "-- Reasoning\nWe join the schools and frpm tables using the CDSCode foreign key, filter for schools under Avetik Atoian's administration, and return the school names with their respective mailing zip codes.\n\n-- SQL Query\nSELECT T1.School, T1.MailZip\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.AdmLName1 = 'Atoian' AND T1.AdmFName1 = 'Avetik'",
        "pred_query": "SELECT T1.School, T1.MailZip\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.AdmLName1 = 'Atoian' AND T1.AdmFName1 = 'Avetik'",
        "pred_time": 0.010690927505493164,
        "orig_time": 0.009119510650634766,
        "time_ratio": 0.8530139827390112,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "Of the schools with a mailing state address in California, what is the ratio of the schools located in the county of Colusa against the school located in the county of Humboldt?",
        "original_query": "SELECT CAST(SUM(CASE WHEN County = 'Colusa' THEN 1 ELSE 0 END) AS REAL) / SUM(CASE WHEN County = 'Humboldt' THEN 1 ELSE 0 END) FROM schools WHERE MailState = 'CA'",
        "llm_output": "SELECT CAST(SUM(IIF(T2.County = 'Colusa', 1, 0)) AS REAL) / SUM(IIF(T2.County = 'Humboldt', 1, 0)) \nFROM schools AS T1 \nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode \nINNER JOIN schools AS T3 ON T2.County = T3.County \nWHERE T3.MailState = 'CA';",
        "pred_query": "SELECT CAST(SUM(IIF(T2.County = 'Colusa', 1, 0)) AS REAL) / SUM(IIF(T2.County = 'Humboldt', 1, 0)) \nFROM schools AS T1 \nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode \nINNER JOIN schools AS T3 ON T2.County = T3.County \nWHERE T3.MailState = 'CA';",
        "pred_time": null,
        "orig_time": 0.010546445846557617,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Of all the schools with a mailing state address in California, how many are active in San Joaquin?",
        "original_query": "SELECT COUNT(CDSCode) FROM schools WHERE City = 'San Joaquin' AND MailState = 'CA' AND StatusType = 'Active'",
        "llm_output": "-- Reasoning\nWe need to select schools with 'Active' status from the schools table, those with a mailing state address in California, and specifically from the district of San Joaquin. Join frpm with schools table on CDSCode to get additional school information. Select count of matching records.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.District = 'San Joaquin' \nAND T2.StatusType = 'Active' \nAND T2.MailState = 'California';",
        "pred_query": "SELECT COUNT(*)\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.District = 'San Joaquin' \nAND T2.StatusType = 'Active' \nAND T2.MailState = 'California';",
        "pred_time": 0.008423566818237305,
        "orig_time": 0.0077588558197021484,
        "time_ratio": 0.9210891285273556,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the phone number and extension number for the school that had the 333rd highest average writing score?",
        "original_query": "SELECT T2.Phone, T2.Ext FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.AvgScrWrite DESC LIMIT 332, 1",
        "llm_output": "-- Reasoning\nWe need the phone number and extension number of the school with the 333rd highest average writing score. We start by joining the schools table with satscores using CDSCode, sorting by the average writing score in descending order, and then selecting the 333rd one. \n\n-- SQL Query\nSELECT T1.Phone, T1.Ext\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nORDER BY T2.AvgScrWrite DESC\nLIMIT 332, 1;",
        "pred_query": "SELECT T1.Phone, T1.Ext\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nORDER BY T2.AvgScrWrite DESC\nLIMIT 332, 1;",
        "pred_time": 0.012212991714477539,
        "orig_time": 0.00537872314453125,
        "time_ratio": 0.4404099560761347,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the phone number and extension number for the school with the zip code 95203-3704? Indicate the school's name.",
        "original_query": "SELECT Phone, Ext, School FROM schools WHERE Zip = '95203-3704'",
        "llm_output": "-- Reasoning\nWe first select from the schools table to get the CDSCode, which is the primary key in the schools table. The table is then joined with itself to select the phone number and extension number for districts that have schools in zip code 95203-3704. Finally, we use the CDSCode to get the school name in the schools table.\n\n-- SQL Query\nSELECT T2.Phone, T2.Ext, T1.School\nFROM schools AS T1\nINNER JOIN schools AS T2 ON T2.CDSCode = T1.CDSCode\nWHERE T1.Zip = '95203-3704' AND T1.Zip = T2.Zip;\n(However, there is a problem in the above SQL query - it will return all schools whose zip codes are present twice, even if they have the same phone number. A better way to query this data is as follows.)\nSELECT T1.Phone, T1.Ext, T1.School\nFROM schools AS T1\nWHERE T1.Zip = '95203-3704'",
        "pred_query": "SELECT T2.Phone, T2.Ext, T1.School\nFROM schools AS T1\nINNER JOIN schools AS T2 ON T2.CDSCode = T1.CDSCode\nWHERE T1.Zip = '95203-3704' AND T1.Zip = T2.Zip;",
        "pred_time": 0.00839090347290039,
        "orig_time": 0.008445024490356445,
        "time_ratio": 1.0064499630618855,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the website for the schools under the administrations of Mike Larson and Dante Alvarez?",
        "original_query": "SELECT Website FROM schools WHERE (AdmFName1 = 'Mike' AND AdmLName1 = 'Larson') OR (AdmFName1 = 'Dante' AND AdmLName1 = 'Alvarez')",
        "llm_output": "-- Reasoning\nWe need the website column from the schools table. The administrators are identified by their first name, last name and email. We can filter by the email columns AdmEmail1, AdmEmail2, and AdmEmail3. Since administrators can have multiple email addresses, we use the OR operator to include all matching records. However, this returns duplicate records since multiple administrators share the same first name, last name combination. To get unique schools, we use the DISTINCT keyword around the schools table alias T1.\n\n-- SQL Query\nSELECT DISTINCT T1.Website\nFROM schools AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nINNER JOIN schools AS T3 ON T1.CDSCode = T3.CDSCode\nWHERE T2.AdmEmail1 = 'mlarson@somewhere.com'\nOR T2.AdmEmail2 = 'mlarson@somewhere.com'\nOR T2.AdmEmail3 = 'mlarson@somewhere.com'\nOR T3.AdmEmail1 = 'dalvarez@somewhere.com'\nOR T3.AdmEmail2 = 'dalvarez@somewhere.com'\nOR T3.AdmEmail3 = 'dalvarez@somewhere.com';",
        "pred_query": "SELECT DISTINCT T1.Website\nFROM schools AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nINNER JOIN schools AS T3 ON T1.CDSCode = T3.CDSCode\nWHERE T2.AdmEmail1 = 'mlarson@somewhere.com'\nOR T2.AdmEmail2 = 'mlarson@somewhere.com'\nOR T2.AdmEmail3 = 'mlarson@somewhere.com'\nOR T3.AdmEmail1 = 'dalvarez@somewhere.com'\nOR T3.AdmEmail2 = 'dalvarez@somewhere.com'\nOR T3.AdmEmail3 = 'dalvarez@somewhere.com';",
        "pred_time": 0.023799419403076172,
        "orig_time": 0.009659290313720703,
        "time_ratio": 0.40586243513453946,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What are the websites for all the partially virtual chartered schools located in San Joaquin?",
        "original_query": "SELECT Website FROM schools WHERE County = 'San Joaquin' AND Virtual = 'P' AND Charter = 1",
        "llm_output": "-- Question\nWhat are the websites for all the partially virtual chartered schools located in San Joaquin?\n\n-- Reasoning\nWe need the website information for schools with a 'Virtual' status of 'Y' and a 'County' of 'San Joaquin'. This can be achieved by joining the schools table with its CDSCode foreign key to the frpm table, filtering for schools that are partially virtual and located in San Joaquin, and then selecting the corresponding website fields.\n\n-- SQL Query\nSELECT T1.Website\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.Virtual = 'Y' AND T2.County = 'San Joaquin' AND T1.Charter = 1 AND T1.Chartertype = 'Partial Virtual Charter (PVCH);'",
        "pred_query": "SELECT T1.Website\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.Virtual = 'Y' AND T2.County = 'San Joaquin' AND T1.Charter = 1 AND T1.Chartertype = 'Partial Virtual Charter (PVCH);",
        "pred_time": null,
        "orig_time": 0.009860754013061523,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "How many chartered schools located in the city of Hickman are owned by the Elementary School District?",
        "original_query": "SELECT COUNT(School) FROM schools WHERE DOC = 52 AND Charter = 1 AND City = 'Hickman'",
        "llm_output": "-- Reasoning\nTo find chartered schools in the city of Hickman and owned by the Elementary School District, we join the frpm and schools tables using the CDSCode. Then filter for chartered schools, Hickman city schools, and elementary school districts.\n\n-- SQL Query\nSELECT COUNT(T2.CDSCode)\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.CharterSchool (Y/N) = 1 AND T2.City LIKE 'Hickman' \n    AND T2.District = 'Elementary School District';",
        "pred_query": "SELECT COUNT(T2.CDSCode)\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.CharterSchool (Y/N) = 1 AND T2.City LIKE 'Hickman' \n    AND T2.District = 'Elementary School District';",
        "pred_time": null,
        "orig_time": 0.013819456100463867,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the total number of non-chartered schools in the county of Los Angeles with a percent (%) of eligible free meals for grades 1 through 12 that is less than 0.18%?",
        "original_query": "SELECT COUNT(T2.School) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Los Angeles' AND T2.Charter = 0 AND CAST(T1.`Free Meal Count (K-12)` AS REAL) * 100 / T1.`Enrollment (K-12)` < 0.18",
        "llm_output": "-- Reasoning\nWe need to count the number of non-chartered schools with a percent (%) of eligible free meals for grades 1 through 12 less than 0.18% that are located in the county of Los Angeles. Join the frpm table with schools using CDSCode, filter for non-chartered schools in the county of Los Angeles and free meal count for grades 1 through 12 meeting the criteria, and count the number of records.\n\n-- SQL Query\nSELECT COUNT(T1.CDSCode)\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.County = 'Los Angeles'\nAND T1.Percent(%) Eligible Free (K-12) < 0.18\nAND T2.Charter = 0;",
        "pred_query": "SELECT COUNT(T1.CDSCode)\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.County = 'Los Angeles'\nAND T1.Percent(%) Eligible Free (K-12) < 0.18\nAND T2.Charter = 0;",
        "pred_time": null,
        "orig_time": 0.010269641876220703,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "In chartered schools with charter number 00D2, what are the names of all the administrators? Include the name of the school and the city to which it belongs",
        "original_query": "SELECT AdmFName1, AdmLName1, School, City FROM schools WHERE Charter = 1 AND CharterNum = '00D2'",
        "llm_output": "-- Reasoning\nWe start by selecting the required columns - the administrators' first names, last names, and email addresses, the school name, and the school city. We join the schools table with the frpm table using the CDSCode to get the school city, and then we filter for chartered schools with charter number 00D2. We return all administrators regardless of their position.\n\n-- SQL Query\nSELECT T2.AdminFName1, T2.AdminLName1, T2.AdminEmail1, T2.AdminFName2, T2.AdminLName2, T2.AdminEmail2, T2.AdminFName3, T2AdminLName3, T2.AdminEmail3, T1.School, T4.City\nFROM frpm AS T1\nINNER JOIN schools AS T2\nINNER JOIN schools AS T3\nINNER JOIN schools AS T4 ON T1.CDSCode = T2.CDSCode AND T4.CDSCode = T2.CDSCode\nWHERE T2.Charter = 1 AND T2.CharterNum = '00D2'",
        "pred_query": "SELECT T2.AdminFName1, T2.AdminLName1, T2.AdminEmail1, T2.AdminFName2, T2.AdminLName2, T2.AdminEmail2, T2.AdminFName3, T2AdminLName3, T2.AdminEmail3, T1.School, T4.City\nFROM frpm AS T1\nINNER JOIN schools AS T2\nINNER JOIN schools AS T3\nINNER JOIN schools AS T4 ON T1.CDSCode = T2.CDSCode AND T4.CDSCode = T2.CDSCode\nWHERE T2.Charter = 1 AND T2.CharterNum = '00D2'",
        "pred_time": null,
        "orig_time": null,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the total number of schools with a mailing city in Hickman belonging to the charter number 00D4?",
        "original_query": "SELECT COUNT(*) FROM schools WHERE CharterNum = '00D4' AND MailCity = 'Hickman'",
        "llm_output": "-- Reasoning\nWe need to count the total number of schools in the schools table where the mail city is 'Hickman' and the charter number is '00D4'.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM schools\nWHERE MailCity = 'Hickman' AND CharterNum = '00D4';",
        "pred_query": "SELECT COUNT(*)\nFROM schools\nWHERE MailCity = 'Hickman' AND CharterNum = '00D4';",
        "pred_time": 0.009650468826293945,
        "orig_time": 0.00833892822265625,
        "time_ratio": 0.8640956592632854,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "What is the ratio in percentage of Santa Clara County schools that are locally funded compared to all other types of charter school funding?",
        "original_query": "SELECT CAST(SUM(CASE WHEN FundingType = 'Locally funded' THEN 1 ELSE 0 END) AS REAL) * 100 / SUM(CASE WHEN FundingType != 'Locally funded' THEN 1 ELSE 0 END) FROM schools WHERE County = 'Santa Clara' AND Charter = 1",
        "llm_output": "-- Reasoning\nTo find the ratio in percentage of Santa Clara County schools that are locally funded compared to all other types of charter school funding, we join the schools and frpm tables on their respective CDS codes and then filter for Santa Clara County schools with local funding. We then count the number of locally funded schools and divide by the total number of charter schools, multiply by 100 to get the percentage.\n\n-- SQL Query\nWITH count_locally_funded AS (SELECT COUNT(T1.CDSCode) FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.County = 'Santa Clara' AND T1.Charter = 1 AND T2.Charter_Funding_Type = 'Local'),\ncount_charter AS (SELECT COUNT(T1.CDSCode) FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.Charter = 1)\nSELECT round((CAST((SELECT * FROM count_locally_funded) AS REAL) / CAST((SELECT * FROM count_charter) AS REAL)) * 100, 2) FROM dual",
        "pred_query": "SELECT COUNT(T1.CDSCode) FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.County = 'Santa Clara' AND T1.Charter = 1 AND T2.Charter_Funding_Type = 'Local'),\ncount_charter AS (SELECT COUNT(T1.CDSCode) FROM schools AS T1 INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.Charter = 1)\nSELECT round((CAST((SELECT * FROM count_locally_funded) AS REAL) / CAST((SELECT * FROM count_charter) AS REAL)) * 100, 2) FROM dual",
        "pred_time": null,
        "orig_time": 0.00974130630493164,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Between 1/1/2000 to 12/31/2005, how many directly funded schools opened in the county of Stanislaus?",
        "original_query": "SELECT COUNT(School) FROM schools WHERE strftime('%Y', OpenDate) BETWEEN '2000' AND '2005' AND County = 'Stanislaus' AND FundingType = 'Directly funded'",
        "llm_output": "-- Reasoning\nWe first select directly funded schools with CDSCode from the schools table. Then, we join the frpm table using CDSCode to filter by the county of Stanislaus, and then filter by the academic year between 2000 and 2005. We count the number of unique schools in this time range.\n\n-- SQL Query\nSELECT COUNT (DISTINCT T1.CDSCode)\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE STRFTIME('%Y', T2.`Academic Year`) BETWEEN '2000' AND '2005'\nAND T1.District = 'Stanislaus'\nAND T2.CharterSchoolNumber IS NULL;",
        "pred_query": "SELECT COUNT (DISTINCT T1.CDSCode)\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE STRFTIME('%Y', T2.`Academic Year`) BETWEEN '2000' AND '2005'\nAND T1.District = 'Stanislaus'\nAND T2.CharterSchoolNumber IS NULL;",
        "pred_time": null,
        "orig_time": 0.013549327850341797,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the total amount of Community College District closure in 1989 in the city of San Francisco?",
        "original_query": "SELECT COUNT(School) FROM schools WHERE strftime('%Y', ClosedDate) = '1989' AND City = 'San Francisco' AND DOCType = 'Community College District'",
        "llm_output": "-- We need to find the total closure amount in Community College District in 1989 for schools located in San Francisco. \n-- We'll start by joining the schools table with the frpm table using CDSCode to identify Community College District. \n-- Then, we filter for records in 1989, sort by date, and return the total closure amount where City is 'San Francisco'.\n\nSELECT SUM(T1closure) FROM (SELECT SUM(T2.ClosureAmount)  AS T1closure \n                             FROM Schools AS T1 \n                             INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode \n                             WHERE T1.StatusType = 'Community College District' \n                             AND STRFTIME('%Y', T2.`Academic Year`) = '1989')",
        "pred_query": "SELECT SUM(T1closure) FROM (SELECT SUM(T2.ClosureAmount)  AS T1closure \n                             FROM Schools AS T1 \n                             INNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode \n                             WHERE T1.StatusType = 'Community College District' \n                             AND STRFTIME('%Y', T2.`Academic Year`) = '1989')",
        "pred_time": null,
        "orig_time": 0.011343002319335938,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which county reported the most number of school closure in the 1980s with school wonership code belonging to Youth Authority Facilities (CEA)?",
        "original_query": "SELECT County FROM schools WHERE strftime('%Y', ClosedDate) BETWEEN '1980' AND '1989' AND StatusType = 'Closed' AND SOC = 11 GROUP BY County ORDER BY COUNT(School) DESC LIMIT 1",
        "llm_output": "-- Question\nWhich county reported the most number of school closure in the 1980s with school wonership code belonging to Youth Authority Facilities (CEA)?\n\n-- Reasoning\nFirst, we join the schools table with frpm using CDSCode to get the county for each school. We filter for schools that closed in the 1980s and have a school ownership code matching 'Youth Authority Facilities'. Finally, we group the results by county and return the one with the maximum count.\n\n-- SQL Query\nSELECT T1.County\nFROM `schools` AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE STRFTIME('%Y', T1.ClosedDate) BETWEEN '1980' AND '1989' AND T2.SOC = 'Youth Authority Facilities (CEA)'\nGROUP BY T1.County\nORDER BY COUNT(T1.CDSCode) DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.County\nFROM `schools` AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE STRFTIME('%Y', T1.ClosedDate) BETWEEN '1980' AND '1989' AND T2.SOC = 'Youth Authority Facilities (CEA)'\nGROUP BY T1.County\nORDER BY COUNT(T1.CDSCode) DESC\nLIMIT 1;",
        "pred_time": null,
        "orig_time": 0.011598348617553711,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Please provide the National Center for Educational Statistics school district identification number for all schools with a School Ownership Code that are part of the State Special Schools.",
        "original_query": "SELECT NCESDist FROM schools WHERE SOC = 31",
        "llm_output": "-- Reasoning\nTo solve this question, we need to join the schools table with the frpm table to filter schools based on the State Special Schools type. Then, we need to select the CDSCode of the schools with a School Ownership Code and return the National Center for Educational Statistics school district identification number corresponding to these CDSCode.\n\n-- SQL Query\nSELECT DISTINCT T1.NCESDist\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.`District Type` = 'State Special Schools'",
        "pred_query": "SELECT DISTINCT T1.NCESDist\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.`District Type` = 'State Special Schools'",
        "pred_time": 0.0050318241119384766,
        "orig_time": 0.009322166442871094,
        "time_ratio": 1.8526415541340915,
        "check": true
    },
    {
        "id": "california_schools",
        "question": "How many active and closed District Community Day Schools are there in the county of Alpine?",
        "original_query": "SELECT COUNT(School) FROM schools WHERE (StatusType = 'Closed' OR StatusType = 'Active') AND County = 'Alpine'",
        "llm_output": "-- Reasoning\nTo find the number of active and closed District Community Day Schools in the county of Alpine, we need to join the schools and frpm tables using their CDSCode. We filter the districts of interest, considering only District Community Day Schools (with District Type equal to 'District Community Day School') in the county of Alpine, and check their status. We count the active and closed schools separately.\n\n-- SQL Query\nSELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.District = 'Alpine' AND T1.StatusType IN ('Active', 'Closed') AND T2.DistrictType = 'District Community Day School'",
        "pred_query": "SELECT COUNT(T1.CDSCode)\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.District = 'Alpine' AND T1.StatusType IN ('Active', 'Closed') AND T2.DistrictType = 'District Community Day School'",
        "pred_time": null,
        "orig_time": 0.008614540100097656,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the district code for the School that does not offer a magnet program in the city of Fresno?",
        "original_query": "SELECT T1.`District Code` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.City = 'Fresno' AND T2.Magnet = 0",
        "llm_output": "-- We select the district code from the schools table where the magnet property is false and the city is Fresno.\n\nSELECT T1.District\nFROM schools AS T1\nWHERE T1.Magnet = 0 AND T1.City = 'Fresno';",
        "pred_query": "select the district code from the schools table where the magnet property is false and the city is Fresno.\n\nSELECT T1.District\nFROM schools AS T1\nWHERE T1.Magnet = 0 AND T1.City = 'Fresno';",
        "pred_time": null,
        "orig_time": 0.008826255798339844,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "How many students from the ages of 5 to 17 are enrolled at the State Special School school in Fremont for the 2014-2015 academic year?",
        "original_query": "SELECT T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.EdOpsCode = 'SSS' AND T2.City = 'Fremont' AND T1.`Academic Year` BETWEEN 2014 AND 2015",
        "llm_output": "-- Reasoning\nWe join the frpm table with schools table on the CDSCode, filter for schools with CDSCode matching the given State Special School in Fremont and Academic Year as 2014-2015, select the enrollment count of students from the ages of 5 to 17 from the result.\n\n-- SQL Query\nSELECT COUNT(frpm.`Enrollment (Ages 5-17)`)\nFROM frpm\nINNER JOIN schools AS T2 ON T2.CDSCode = frpm.CDSCode\nWHERE T2.School = 'State Special School' AND T2.City = 'Fremont'\nAND frpm.`Academic Year` = '2014-2015' AND frpm.`Low Grade` = '5'",
        "pred_query": "SELECT COUNT(frpm.`Enrollment (Ages 5-17)`)\nFROM frpm\nINNER JOIN schools AS T2 ON T2.CDSCode = frpm.CDSCode\nWHERE T2.School = 'State Special School' AND T2.City = 'Fremont'\nAND frpm.`Academic Year` = '2014-2015' AND frpm.`Low Grade` = '5'",
        "pred_time": 0.004845857620239258,
        "orig_time": 0.009264707565307617,
        "time_ratio": 1.9118819188191882,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the free or reduced price meal count for ages 5 to 17 in the Youth Authority School with a mailing street address of PO Box 1040?",
        "original_query": "SELECT T1.`FRPM Count (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.MailStreet = 'PO Box 1040' AND T2.SOCType = 'Youth Authority Facilities'",
        "llm_output": "-- Reasoning\nWe need the free or reduced price meal count for ages 5 to 17 where the school is the Youth Authority School with a mailing street address of PO Box 1040. To achieve this, we will select the required column from the frpm table, filter for schools with the given mailing street address, and finally filter for schools with the given name.\n\n-- SQL Query\nSELECT COUNT(FRPM Count (Ages 5-17)) \nFROM frpm \nWHERE School Name = 'Youth Authority School' \nAND MailStreet = 'PO Box 1040';",
        "pred_query": "SELECT COUNT(FRPM Count (Ages 5-17)) \nFROM frpm \nWHERE School Name = 'Youth Authority School' \nAND MailStreet = 'PO Box 1040';",
        "pred_time": null,
        "orig_time": 0.009598493576049805,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the lowest grade for the District Special Education Consortia School with National Center for Educational Statistics school district identification number of 613360?",
        "original_query": "SELECT MIN(T1.`Low Grade`) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.NCESDist = 613360 AND T2.EdOpsCode = 'SPECON'",
        "llm_output": "-- Question\nWhat is the lowest grade for the District Special Education Consortia School with National Center for Educational Statistics school district identification number of 613360?\n\n-- Reasoning\nTo find the lowest grade for the District Special Education Consortia School with National Center for Educational Statistics school district identification number of 613360, we first join the frpm table with the schools table using the CDSCode foreign key. We filter for districts with a type of 'District School' to capture district schools and consortia, then find the specific District Special Education Consortia School by matching the District field with 'District Special Education Consortia', and the NCESDist field with the target district ID. Finally, we return the Low Grade field from the frpm table where the CDSCode matches.\n\n-- SQL Query\nSELECT T1.LowGrade \nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.NCESDist = '613360'\nand T2.DistrictName = 'District Special Education Consortia'",
        "pred_query": "SELECT T1.LowGrade \nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.NCESDist = '613360'\nand T2.DistrictName = 'District Special Education Consortia'",
        "pred_time": null,
        "orig_time": 0.009245634078979492,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the educational level name for the schools with Breakfast Provision 2 in county code 37? Indicate the name of the school.",
        "original_query": "SELECT T2.EILName, T2.School FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`NSLP Provision Status` = 'Breakfast Provision 2' AND T1.`County Code` = 37",
        "llm_output": "-- Reasoning\nWe need to join the frpm table with the schools table using the CDSCode column, filter for schools with Breakfast Provision 2 in county code 37, and return the name of the school along with the corresponding educational level name from the schools table.\n\n\nSELECT T1.District_Name, T1.Educational_Option_Type\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.NSLP_Provision_Status = '2'\nAND T1.County_Code = '37';",
        "pred_query": "SELECT T1.District_Name, T1.Educational_Option_Type\nFROM frpm AS T1\nINNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.NSLP_Provision_Status = '2'\nAND T1.County_Code = '37';",
        "pred_time": null,
        "orig_time": 0.0035610198974609375,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the city location of the high school level school with Lunch Provision 2 whose lowest grade is 9 and the highest grade is 12 in the county of Merced?",
        "original_query": "SELECT T2.City FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T1.`NSLP Provision Status` = 'Lunch Provision 2' AND T2.County = 'Merced' AND T1.`Low Grade` = 9 AND T1.`High Grade` = 12 AND T2.EILCode = 'HS'",
        "llm_output": "-- Reasoning\nWe first look for schools with a high school level (grades 9-12), and a Lunch Provision status of 2. We filter this based on the county of 'Merced'. We then return the city location.\n\n-- SQL Query\nSELECT T1.City\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.StatusType = 'Active'\nAND T1.HighGrade = '12'\nAND T1.LowGrade = '9'\nAND T2.NSMLProvisionStatus = '2'\nAND T1.County = 'Merced'",
        "pred_query": "SELECT T1.City\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.StatusType = 'Active'\nAND T1.HighGrade = '12'\nAND T1.LowGrade = '9'\nAND T2.NSMLProvisionStatus = '2'\nAND T1.County = 'Merced'",
        "pred_time": null,
        "orig_time": 0.008314371109008789,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Which schools served a grade span of Kindergarten to 9th grade in the county of Los Angeles and what is its Percent (%) Eligible FRPM (Ages 5-17)?",
        "original_query": "SELECT T2.School, T1.`FRPM Count (Ages 5-17)` * 100 / T1.`Enrollment (Ages 5-17)` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'Los Angeles' AND T2.GSserved = 'K-9'",
        "llm_output": "-- Reasoning\nWe join the frpm and schools tables using CDSCode, filter for schools located in the county of Los Angeles, and check if the grade span is indeed Kindergarten to 9th grade. Finally, return the corresponding School Name and Percent (%) Eligible FRPM (Ages 5-17).\n\n-- SQL Query\nSELECT T1.SchoolName, T2.'Percent (%) Eligible FRPM (Ages 5-17)'\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.County = 'Los Angeles'\nAND (T1.LowGrade = 'K' AND T1.HighGrade = '9th');",
        "pred_query": "SELECT T1.SchoolName, T2.'Percent (%) Eligible FRPM (Ages 5-17)'\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.County = 'Los Angeles'\nAND (T1.LowGrade = 'K' AND T1.HighGrade = '9th');",
        "pred_time": null,
        "orig_time": 0.008687496185302734,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the most common type of grade span served in the city of Adelanto?",
        "original_query": "SELECT GSserved FROM schools WHERE City = 'Adelanto' GROUP BY GSserved ORDER BY COUNT(GSserved) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe select the grade span type with the most occurrences in cities with the name 'Adelanto' by joining the schools and frpm tables. Count the different grade span types and return the one with the highest count.\n\n-- SQL Query\nSELECT T3.GSserved\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nINNER JOIN satscores AS T3 ON T1.CDSCode = T3.cds\nWHERE T1.City = 'Adelanto'\nGROUP BY T3.GSserved\nORDER BY COUNT(T3.GSserved) DESC\nLIMIT 1;",
        "pred_query": "SELECT T3.GSserved\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nINNER JOIN satscores AS T3 ON T1.CDSCode = T3.cds\nWHERE T1.City = 'Adelanto'\nGROUP BY T3.GSserved\nORDER BY COUNT(T3.GSserved) DESC\nLIMIT 1;",
        "pred_time": null,
        "orig_time": 0.009198188781738281,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Between San Diego and Santa Barbara, which county offers the most number of schools that does not offer physical building? Indicate the amount.",
        "original_query": "SELECT County, COUNT(Virtual) FROM schools WHERE (County = 'San Diego' OR County = 'Santa Barbara') AND Virtual = 'F' GROUP BY County ORDER BY COUNT(Virtual) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need the county offering the highest number of schools without a physical building. Join schools with districts using County and District, filter districts where district name matches between San Diego and Santa Barbara, select districts where the schools' virtual attribute is 1 (true), and count these districts by county.\n\n-- SQL Query\nSELECT T1.County, COUNT(T3.District) AS amount\nFROM districts AS T1\nINNER JOIN schools AS T2 ON T1.CountyCode = T2.County\nWHERE T2.District IN (\n    SELECT T1.District\n    FROM districts AS T1\n    WHERE T1.DistrictName IN ('San Diego', 'Santa Barbara')\n)\nINNER JOIN frpm AS T3 ON T2.CDSCode = T3.CDSCode\nWHERE T2.Virtual = '1'\nGROUP BY T1.County\nORDER BY COUNT(T3.District) DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.County, COUNT(T3.District) AS amount\nFROM districts AS T1\nINNER JOIN schools AS T2 ON T1.CountyCode = T2.County\nWHERE T2.District IN (\n    SELECT T1.District\n    FROM districts AS T1\n    WHERE T1.DistrictName IN ('San Diego', 'Santa Barbara')\n)\nINNER JOIN frpm AS T3 ON T2.CDSCode = T3.CDSCode\nWHERE T2.Virtual = '1'\nGROUP BY T1.County\nORDER BY COUNT(T3.District) DESC\nLIMIT 1;",
        "pred_time": null,
        "orig_time": 0.008328676223754883,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the school type of the school with the highest latitude? Indicate the name of the school as well as the latitude coordinates.",
        "original_query": "SELECT T1.`School Type`, T1.`School Name`, T2.Latitude FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode ORDER BY T2.Latitude DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe join the schools table with its primary key CDSCode to get the latitude of each school, sort by latitude in descending order, return the top one, and select its school type and name.\n\n-- SQL Query\nSELECT T1.SchoolType, T1.School, T1.Latitude\nFROM schools AS T1\nORDER BY T1.Latitude DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.SchoolType, T1.School, T1.Latitude\nFROM schools AS T1\nORDER BY T1.Latitude DESC\nLIMIT 1;",
        "pred_time": null,
        "orig_time": 0.015217781066894531,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "In which city can you find the school in the state of California with the lowest latitude coordinates and what is its lowest grade? Indicate the school name.",
        "original_query": "SELECT T2.City, T1.`Low Grade`, T1.`School Name` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.State = 'CA' ORDER BY T2.Latitude ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe first join the schools table with frpm using CDSCode to get the latitude coordinates and low grade for each school in the database. Then, we filter for schools located in California and sort the schools by their latitudes in ascending order. Finally, we return the city and the corresponding lowest grade of the school that has the lowest latitude.\n\n-- SQL Query\nSELECT frpm.`District Name`, schools.City, frpm.LowGrade\nFROM schools AS T1\nINNER JOIN frpm ON T1.CDSCode = frpm.CDSCode\nWHERE T1.State = 'CA'\nORDER BY T1.Latitude ASC, frpm.LowGrade ASC\nLIMIT 1",
        "pred_query": "SELECT frpm.`District Name`, schools.City, frpm.LowGrade\nFROM schools AS T1\nINNER JOIN frpm ON T1.CDSCode = frpm.CDSCode\nWHERE T1.State = 'CA'\nORDER BY T1.Latitude ASC, frpm.LowGrade ASC\nLIMIT 1",
        "pred_time": null,
        "orig_time": 0.014379262924194336,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the grade span offered in the school with the highest longitude?",
        "original_query": "SELECT GSoffered FROM schools ORDER BY ABS(longitude) DESC LIMIT 1",
        "llm_output": "We need the grade span of the school with the highest longitude. First, select the school's longitude from the schools table. Next, join this table with the satscores table using the CDSCode and select the school's CDSCode which has the highest longitude. Finally, join the frpm table with the schools table using the CDSCode and select the grade span of the school with the corresponding CDSCode.\n\n\nSELECT T1.GSserved\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.CDSCode = (\n    SELECT T.CDSCode\n    FROM schools AS T\n    ORDER BY T.Longitude DESC\n    LIMIT 1\n);\n",
        "pred_query": "select the school's longitude from the schools table. Next, join this table with the satscores table using the CDSCode and select the school's CDSCode which has the highest longitude. Finally, join the frpm table with the schools table using the CDSCode and select the grade span of the school with the corresponding CDSCode.\n\n\nSELECT T1.GSserved\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.CDSCode = (\n    SELECT T.CDSCode\n    FROM schools AS T\n    ORDER BY T.Longitude DESC\n    LIMIT 1\n);",
        "pred_time": null,
        "orig_time": 0.011685848236083984,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "Of the schools that offers a magnet program serving a grade span of Kindergarten to 8th grade, how many offers Multiple Provision Types? List the number of cities that offers a Kindergarten to 8th grade span and indicate how many schools are there serving such grade span for each city.",
        "original_query": "SELECT T2.City, COUNT(T2.CDSCode) FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.Magnet = 1 AND T2.GSoffered = 'K-8' AND T1.`NSLP Provision Status` = 'Multiple Provision Types' GROUP BY T2.City",
        "llm_output": "-- Reasoning\nWe start by selecting schools where Magnet equals 1, and Grade span is between Kindergarten and 8th grade. We count the number of distinct schools having more than one provision type. Finally, we join schools with cities to get the required information and group by city.\n\n-- SQL Query\nWITH schools_with_magnet AS (\n  SELECT T1.CDSCode\n  FROM schools AS T1\n  WHERE T1.Magnet = 1\n    AND T1.GradeSpan = 'K-8'\n),\ncount_multiple_provisions AS (\n  SELECT COUNT(T2.CDSCode) AS count\n  FROM schools_with_magnet AS T1\n  INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\n  WHERE T2.ProvisionTypes = 'Multiple'\n),\ncities AS (\n  SELECT T1.City, T2.CDSCode\n  FROM schools AS T1\n  INNER JOIN schools AS T2 ON T1.City = T2.City\n  WHERE T2.GradeSpan = 'K-8'\n)\nSELECT T1.City, COUNT(T1.CDSCode) AS num_schools\nFROM cities AS T1\nGROUP BY T1.City;",
        "pred_query": "SELECT T1.CDSCode\n  FROM schools AS T1\n  WHERE T1.Magnet = 1\n    AND T1.GradeSpan = 'K-8'\n),\ncount_multiple_provisions AS (\n  SELECT COUNT(T2.CDSCode) AS count\n  FROM schools_with_magnet AS T1\n  INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode\n  WHERE T2.ProvisionTypes = 'Multiple'\n),\ncities AS (\n  SELECT T1.City, T2.CDSCode\n  FROM schools AS T1\n  INNER JOIN schools AS T2 ON T1.City = T2.City\n  WHERE T2.GradeSpan = 'K-8'\n)\nSELECT T1.City, COUNT(T1.CDSCode) AS num_schools\nFROM cities AS T1\nGROUP BY T1.City;",
        "pred_time": null,
        "orig_time": 0.00466609001159668,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What are the two most common first names among the school administrators? Indicate the district to which they administer.",
        "original_query": "SELECT DISTINCT T1.AdmFName1, T1.District FROM schools AS T1 INNER JOIN ( SELECT admfname1 FROM schools GROUP BY admfname1 ORDER BY COUNT(admfname1) DESC LIMIT 2 ) AS T2 ON T1.AdmFName1 = T2.admfname1",
        "llm_output": "-- Reasoning\nWe group by first names, sort in descending order by count, and return the top two most frequent names along with their corresponding district.\n\n-- SQL Query\nSELECT \n    T3.First_Name, \n    T1.District\nFROM \n    frpm AS T3\nINNER JOIN \n    schools AS T2 ON T3.District_Name = T2.District\nINNER JOIN \n    schools AS T1 ON T2.CDSCode = T1.CDSCode\nGROUP BY \n    T3.First_Name\nORDER BY \n    COUNT(T3.First_Name) DESC\nLIMIT 2;",
        "pred_query": "SELECT \n    T3.First_Name, \n    T1.District\nFROM \n    frpm AS T3\nINNER JOIN \n    schools AS T2 ON T3.District_Name = T2.District\nINNER JOIN \n    schools AS T1 ON T2.CDSCode = T1.CDSCode\nGROUP BY \n    T3.First_Name\nORDER BY \n    COUNT(T3.First_Name) DESC\nLIMIT 2;",
        "pred_time": null,
        "orig_time": 0.032050132751464844,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the Percent (%) Eligible Free (K-12) in the school administered by an administrator whose first name is Alusine. List the district code of the school.",
        "original_query": "SELECT T1.`Free Meal Count (K-12)` * 100 / T1.`Enrollment (K-12)`, T1.`District Code` FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.AdmFName1 = 'Alusine'",
        "llm_output": "-- Reasoning\nWe start by selecting the school administered by the desired administrator from the schools table where the first name and district name match. Then we join this school with the frpm table using CDSCode to get the desired statistic.\n\n-- SQL Query\nSELECT T2.`Percent (%) Eligible Free (K-12)`\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.StatusType = 'Active' AND T1.AdmFName1 = 'Alusine'",
        "pred_query": "SELECT T2.`Percent (%) Eligible Free (K-12)`\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T1.StatusType = 'Active' AND T1.AdmFName1 = 'Alusine'",
        "pred_time": 0.01103973388671875,
        "orig_time": 0.008317947387695312,
        "time_ratio": 0.7534554250172771,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the administrator's last name that oversees the school with Charter number 40? Indicate the district, the county where the school is situated, and the name of the school.",
        "original_query": "SELECT AdmLName1, District, County, School FROM schools WHERE CharterNum = '0040'",
        "llm_output": "-- Reasoning\nWe need to join the schools table with the frpm table using the CDSCode column to find the school name, district, and county. Then we'll filter the results for the school with a charter number of 40. Finally, we'll join the schools table once again with the frpm table for the desired administrator's name.\n\n-- SQL Query\nSELECT T1.AdminLName1, T1.District, T1.County, T2.`School Name`\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.CharterSchoolNumber = '40'",
        "pred_query": "SELECT T1.AdminLName1, T1.District, T1.County, T2.`School Name`\nFROM schools AS T1\nINNER JOIN frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE T2.CharterSchoolNumber = '40'",
        "pred_time": null,
        "orig_time": 0.00944972038269043,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the e-mail address of the administrator of the school located in the San Bernardino county, District of San Bernardino City Unified that opened between 1/1/2009 to 12/31/2010 whose school types are public Intermediate/Middle Schools and Unified Scools?",
        "original_query": "SELECT T2.AdmEmail1 FROM frpm AS T1 INNER JOIN schools AS T2 ON T1.CDSCode = T2.CDSCode WHERE T2.County = 'San Bernardino' AND T2.City = 'San Bernardino' AND T2.DOC = 54 AND strftime('%Y', T2.OpenDate) BETWEEN '2009' AND '2010' AND T2.SOC = 62",
        "llm_output": "-- Reasoning\nFirst, we filter schools based on their location, time, and type. We join the schools table with the frpm table using CDSCode, filter schools in San Bernardino County (County Name = 'San Bernardino'), District of San Bernardino City Unified (District = 'San Bernardino City Unified'), opened between 1/1/2009 to 12/31/2010, and school types are 'Public' Intermediate/Middle Schools and 'Unified School'. We then return the AdmEmail1, AdmEmail2, and AdmEmail3 of these schools. If a school has no administrators with email addresses, we return NULL for those fields.\n\n-- SQL Query\nSELECT \n    IFNULL(T1.AdmEmail1, 'NULL') AS AdmEmail1,\n    IFNULL(T1.AdmEmail2, 'NULL') AS AdmEmail2,\n    IFNULL(T1.AdmEmail3, 'NULL') AS AdmEmail3\nFROM \n    schools AS T1\nINNER JOIN \n    frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE \n    T1.County = 'San Bernardino' \n    AND T1.District = 'San Bernardino City Unified'\n    AND (T1.`Academic Year` BETWEEN '2008-2009' AND '2009-2010')\n    AND (T1.StatusType NOT IN ('Closed', 'Closed Charter', 'Closed - Moved'))\n    AND (T2.District Type IN ('Public Intermediate/Middle School', 'Unified School'))\n;",
        "pred_query": "SELECT \n    IFNULL(T1.AdmEmail1, 'NULL') AS AdmEmail1,\n    IFNULL(T1.AdmEmail2, 'NULL') AS AdmEmail2,\n    IFNULL(T1.AdmEmail3, 'NULL') AS AdmEmail3\nFROM \n    schools AS T1\nINNER JOIN \n    frpm AS T2 ON T1.CDSCode = T2.CDSCode\nWHERE \n    T1.County = 'San Bernardino' \n    AND T1.District = 'San Bernardino City Unified'\n    AND (T1.`Academic Year` BETWEEN '2008-2009' AND '2009-2010')\n    AND (T1.StatusType NOT IN ('Closed', 'Closed Charter', 'Closed - Moved'))\n    AND (T2.District Type IN ('Public Intermediate/Middle School', 'Unified School'))\n;",
        "pred_time": null,
        "orig_time": 0.010060787200927734,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "california_schools",
        "question": "What is the administrator's email address for the school with the highest number of test takers who received SAT scores of at least 1500?Provide the name of the school.",
        "original_query": "SELECT T2.AdmEmail1, T2.School FROM satscores AS T1 INNER JOIN schools AS T2 ON T1.cds = T2.CDSCode ORDER BY T1.NumGE1500 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need the school name and administrator's email address of the school with the highest number of test takers who received SAT scores of at least 1500. First, we join the satscores table with schools using CDSCode and filter for records with scores 1500 or higher. Then, we rank schools by the number of test takers in descending order. Finally, we return all records where the rank is equal to 1.\n\n-- SQL Query\nSELECT T1.School, T1.`AdmEmail1`\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.Rtype = 'A' AND T2.NumGE1500 > 0\nGROUP BY T1.CDSCode, T1.School, T1.`AdmEmail1`\nORDER BY COUNT(T2.cds, T2.NumTstTakr) DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.School, T1.`AdmEmail1`\nFROM schools AS T1\nINNER JOIN satscores AS T2 ON T1.CDSCode = T2.cds\nWHERE T2.Rtype = 'A' AND T2.NumGE1500 > 0\nGROUP BY T1.CDSCode, T1.School, T1.`AdmEmail1`\nORDER BY COUNT(T2.cds, T2.NumTstTakr) DESC\nLIMIT 1;",
        "pred_time": null,
        "orig_time": 0.0022535324096679688,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts who choose issuance after transaction are staying in East Bohemia region?",
        "original_query": "SELECT COUNT(T1.district_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE T1.A3 = 'East Bohemia' AND T2.frequency = 'POPLATEK PO OBRATU'",
        "llm_output": "-- Reasoning\nWe need to find accounts where the frequency is 'ISSUANCE AFTER TRANSACTION' and district_id corresponds to 'East Bohemia' based on the district table. We join the account and district tables using district_id, filter for desired frequency, and return the count of matching accounts.\n\n-- SQL Query\nSELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.frequency = 'ISSUANCE AFTER TRANSACTION'\nAND T2.A13 = 1;",
        "pred_query": "SELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.frequency = 'ISSUANCE AFTER TRANSACTION'\nAND T2.A13 = 1;",
        "pred_time": 0.0014503002166748047,
        "orig_time": 0.0008423328399658203,
        "time_ratio": 0.5807989478875555,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many accounts who have region in Prague are eligible for loans?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T1.district_id = T3.district_id WHERE T3.A3 = 'Prague'",
        "llm_output": "We need to join the account and district tables using their IDs, filter districts in Prague, and then join the account and loan tables to find eligible accounts for loans that are active.\n\nSELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3 ON T1.account_id = T3.account_id\nWHERE T2.A2 = 'Prague';",
        "pred_query": "SELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3 ON T1.account_id = T3.account_id\nWHERE T2.A2 = 'Prague';",
        "pred_time": 0.0013704299926757812,
        "orig_time": 0.0008020401000976562,
        "time_ratio": 0.5852470424495476,
        "check": false
    },
    {
        "id": "financial",
        "question": "The average unemployment ratio of 1995 and 1996, which one has higher percentage?",
        "original_query": "SELECT DISTINCT IIF(AVG(A13) > AVG(A12), '1996', '1995') FROM district",
        "llm_output": "-- Reasoning\nWe need the year and the corresponding average unemployment ratio. Join the account and trans tables, filter transactions from the years 1995 and 1996, group by year, and return the year with the higher average unemployment ratio. Calculate the average unemployment ratio by dividing the amount (assuming negative indicates unemployment) by the balance for each transaction type in each year.\n\n-- SQL Query\nSELECT \n    CASE \n        WHEN SUM(CASE WHEN T1.type = 'deposit' THEN T2.amount ELSE -T2.amount END) > 0 THEN \n            WHEN SUM(CASE WHEN T1.type = 'deposit' THEN T2.amount ELSE -T2.amount END) \n            /\n            AVG(T2.balance * 1.0) >=\n            SUM(CASE WHEN T1.type = 'withdrawal' THEN T2.amount ELSE -T2.amount END) \n            /\n            AVG(T2.balance * 1.0) THEN 1996 ELSE 1995 END AS year\nFROM account AS T1\nINNER JOIN trans AS T2 ON T1.account_id = T2.account_id\nWHERE STRFTIME('%Y', T2.date) IN (1995, 1996)",
        "pred_query": "SELECT \n    CASE \n        WHEN SUM(CASE WHEN T1.type = 'deposit' THEN T2.amount ELSE -T2.amount END) > 0 THEN \n            WHEN SUM(CASE WHEN T1.type = 'deposit' THEN T2.amount ELSE -T2.amount END) \n            /\n            AVG(T2.balance * 1.0) >=\n            SUM(CASE WHEN T1.type = 'withdrawal' THEN T2.amount ELSE -T2.amount END) \n            /\n            AVG(T2.balance * 1.0) THEN 1996 ELSE 1995 END AS year\nFROM account AS T1\nINNER JOIN trans AS T2 ON T1.account_id = T2.account_id\nWHERE STRFTIME('%Y', T2.date) IN (1995, 1996)",
        "pred_time": null,
        "orig_time": 0.0005853176116943359,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "List out the no. of districts that have female average salary is more than 6000 but less than 10000?",
        "original_query": "SELECT DISTINCT T2.district_id FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' AND T2.A11 BETWEEN 6000 AND 10000",
        "llm_output": "-- Reasoning\nFirst, we join the client and district tables based on the district_id to get the district name and the number of female clients in each district. Then, we join the account and district tables to get the district ID and the total salary of each district. We group the results by district ID and calculate the average salary for each district. Finally, we filter the result to only include districts with an average salary between 6000 and 10000.",
        "pred_query": null,
        "pred_time": null,
        "orig_time": 0.0015408992767333984,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many male customers who are living in North Bohemia have average salary greater than 8000?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'M' AND T2.A3 = 'North Bohemia' AND T2.A11 > 8000",
        "llm_output": "-- Reasoning\nTo solve this problem, we need to identify male customers living in North Bohemia and having an average salary greater than 8000. First, we filter the district table to select only records with A2 = 'N'. Then, we join the client table with the district table using the district_id column to find clients living in North Bohemia. After that, we filter for male clients (gender = 'M') and average salary greater than 8000. Finally, we count the number of such clients.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.gender = 'M'\nAND T2.A2 = 'N'\nAND T1.average_salary > 8000;",
        "pred_query": "SELECT COUNT(*)\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.gender = 'M'\nAND T2.A2 = 'N'\nAND T1.average_salary > 8000;",
        "pred_time": null,
        "orig_time": 0.001230478286743164,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "List out the account numbers of female clients who are oldest and has lowest average salary, calculate the gap between this lowest average salary with the highest average salary?",
        "original_query": "SELECT T1.account_id , ( SELECT MAX(A11) - MIN(A11) FROM district ) FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.district_id = ( SELECT district_id FROM client WHERE gender = 'F' ORDER BY birth_date ASC LIMIT 1 ) ORDER BY T2.A11 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need the client ID from the client table, join the client table with the account table using district_id, filter female clients, and calculate the average salary of each client. Then, we group by the district ID, return the client ID and average salary of the oldest client and the one with the lowest average salary. Finally, we calculate the gap between these two average salaries.\n\n-- SQL Query\nSELECT T1.account_id, T4.avg_salary - T7.avg_salary\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nINNER JOIN client AS T3 ON T1.district_id = T3.district_id\nINNER JOIN (\n    SELECT T5.district_id, AVG(T6.avg_salary) AS avg_salary\n    FROM client AS T5\n    INNER JOIN (\n        SELECT district_id, AVG(A10) AS avg_salary\n        FROM account\n        GROUP BY district_id\n    ) AS T6 ON T5.district_id = T6.district_id\n    GROUP BY T5.district_id\n) AS T4 ON T1.district_id = T4.district_id\nINNER JOIN client AS T5 ON T1.district_id = T5.district_id\nINNER JOIN (\n    SELECT T5.district_id, AVG(T6.avg_salary) AS avg_salary\n    FROM client AS T5\n    INNER JOIN (\n        SELECT district_id, AVG(A10) AS avg_salary\n        FROM account\n        GROUP BY district_id\n    ) AS T6 ON T5.district_id = T6.district_id\n    GROUP BY T5.district_id, AVG(T6.avg_salary)\n    ORDER BY AVG(T6.avg_salary) DESC\n) AS T7 ON T1.district_id = T7.district_id\nWHERE T3.gender = 'Female'\nORDER BY T1.account_id;",
        "pred_query": "SELECT T1.account_id, T4.avg_salary - T7.avg_salary\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nINNER JOIN client AS T3 ON T1.district_id = T3.district_id\nINNER JOIN (\n    SELECT T5.district_id, AVG(T6.avg_salary) AS avg_salary\n    FROM client AS T5\n    INNER JOIN (\n        SELECT district_id, AVG(A10) AS avg_salary\n        FROM account\n        GROUP BY district_id\n    ) AS T6 ON T5.district_id = T6.district_id\n    GROUP BY T5.district_id\n) AS T4 ON T1.district_id = T4.district_id\nINNER JOIN client AS T5 ON T1.district_id = T5.district_id\nINNER JOIN (\n    SELECT T5.district_id, AVG(T6.avg_salary) AS avg_salary\n    FROM client AS T5\n    INNER JOIN (\n        SELECT district_id, AVG(A10) AS avg_salary\n        FROM account\n        GROUP BY district_id\n    ) AS T6 ON T5.district_id = T6.district_id\n    GROUP BY T5.district_id, AVG(T6.avg_salary)\n    ORDER BY AVG(T6.avg_salary) DESC\n) AS T7 ON T1.district_id = T7.district_id\nWHERE T3.gender = 'Female'\nORDER BY T1.account_id;",
        "pred_time": null,
        "orig_time": 0.001100301742553711,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "List out the account numbers of clients who are youngest and have highest average salary?",
        "original_query": "SELECT T1.account_id FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.district_id = ( SELECT district_id FROM client ORDER BY birth_date DESC LIMIT 1 ) ORDER BY T2.A11 DESC LIMIT 1",
        "llm_output": "-- Question\nList out the account numbers of clients who are youngest and have highest average salary?\n\n-- Reasoning\nWe need the minimum birth_date to get the youngest client, then join client and disp tables to get the corresponding account_id and account_number. \nFinally, join account with the obtained account_ids and group by account_id to calculate the average salary, then sort and return the account_id with the highest average salary.\n\n-- SQL Query\nSELECT T1.account_id\nFROM account AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nINNER JOIN client AS T3 ON T2.client_id = T3.client_id\nGROUP BY T1.account_id\nHAVING AVG(T3.gender) <= (SELECT MIN(T1.gender) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id)\nORDER BY AVG(T3.gender) DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.account_id\nFROM account AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nINNER JOIN client AS T3 ON T2.client_id = T3.client_id\nGROUP BY T1.account_id\nHAVING AVG(T3.gender) <= (SELECT MIN(T1.gender) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id)\nORDER BY AVG(T3.gender) DESC\nLIMIT 1;",
        "pred_time": 0.0041239261627197266,
        "orig_time": 0.0009965896606445312,
        "time_ratio": 0.24166040353818583,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many customers who choose statement of weekly issuance are Owner?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id WHERE T2.type = 'Owner' AND T1.frequency = 'POPLATEK TYDNE'",
        "llm_output": "-- Question\nHow many customers who choose statement of weekly issuance are Owner?\n\n-- Reasoning\nWe need the count of clients who have district_id matching a district with type 'Weekly' and are of gender 'Owner'. Join the client table with the district table and filter the records accordingly.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM client\nWHERE district_id IN (\n    SELECT district_id\n    FROM district\n    WHERE A5 LIKE '%Weekly%'\n)\nAND gender = 'Owner';",
        "pred_query": "SELECT COUNT(*)\nFROM client\nWHERE district_id IN (\n    SELECT district_id\n    FROM district\n    WHERE A5 LIKE '%Weekly%'\n)\nAND gender = 'Owner';",
        "pred_time": 0.0010976791381835938,
        "orig_time": 0.0007855892181396484,
        "time_ratio": 0.7156820156385751,
        "check": true
    },
    {
        "id": "financial",
        "question": "List out the clients who choose statement of issuance after transaction are Disponent?",
        "original_query": "SELECT T2.client_id FROM account AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id WHERE T1.frequency = 'POPLATEK PO OBRATU' AND T2.type = 'DISPONENT'",
        "llm_output": "-- Question\nList out the clients who choose statement of issuance after transaction are Disponent?\n\n-- Reasoning\nWe need the clients who choose 'statement of issuance' (disp_type = 'statement of issuance') in disp table and have had transactions where the type column in trans is Disponent. Join disp and account tables using disp_id and account_id, then join the result with trans table using account_id, and filter for the required conditions.\n\n-- SQL Query\nSELECT T1.client_id\nFROM disp AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nWHERE T1.disp_type = 'statement of issuance' AND T3.type = 'Disponent';",
        "pred_query": "SELECT T1.client_id\nFROM disp AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nWHERE T1.disp_type = 'statement of issuance' AND T3.type = 'Disponent';",
        "pred_time": null,
        "orig_time": 0.001093149185180664,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Among the accounts who have approved loan date in 1997, list out the accounts that have the lowest approved amount and choose weekly issuance statement.",
        "original_query": "SELECT T2.account_id FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE STRFTIME('%Y', T1.date) = '1997' AND T2.frequency = 'POPLATEK TYDNE' ORDER BY T1.amount LIMIT 1",
        "llm_output": "-- Reasoning\nWe need the account ID and the approved loan amount from the accounts with approved loans in 1997. We find these records by inner joining account and loan tables using account_id, filtering for 1997 loan dates, and selecting minimum approved amounts when having multiple records. We choose weekly issuance statement by filtering for account type, 'weekly', and return only the accounts that meet the required conditions.\n\n-- SQL Query\nSELECT T1.account_id, loan.amount \nFROM account AS T1\nINNER JOIN loan AS T2 ON T1.account_id = T2.account_id\nINNER JOIN disp AS T3 ON T1.account_id = T3.account_id\nWHERE T2.date = '1997' AND T3.type = 'weekly' AND T2.status = 'A' GROUP BY T1.account_id ORDER BY SUM(T2.amount) ASC LIMIT 1;",
        "pred_query": "SELECT T1.account_id, loan.amount \nFROM account AS T1\nINNER JOIN loan AS T2 ON T1.account_id = T2.account_id\nINNER JOIN disp AS T3 ON T1.account_id = T3.account_id\nWHERE T2.date = '1997' AND T3.type = 'weekly' AND T2.status = 'A' GROUP BY T1.account_id ORDER BY SUM(T2.amount) ASC LIMIT 1;",
        "pred_time": null,
        "orig_time": 0.0008738040924072266,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Among the accounts who have loan validity more than 12 months, list out the accounts that have the highest approved amount and have account opening date in 1993.",
        "original_query": "SELECT T1.account_id FROM loan AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id WHERE STRFTIME('%Y', T1.date) = '1993' AND T1.duration = 12 ORDER BY T1.amount DESC LIMIT 1",
        "llm_output": "-- Reasoning\nTo solve this question, we need to first identify accounts with loan validity of more than 12 months, then filter by accounts with approved amount in 1993. Then, order these accounts by their approved amount and return the top ones.\n\n-- SQL Query\nSELECT T2.account_id, T5.date \nFROM account AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN loan AS T3 ON T2.account_id = T3.account_id\nINNER JOIN account AS T4 ON T3.account_id = T4.account_id\nINNER JOIN district AS T5 ON T4.district_id = T5.district_id\nWHERE STRFTIME('%Y', T3.date) = '1993'\nAND STRFTIME('%Y', datediff('day', min(T3.date), T3.date)) > 12\nORDER BY T3.amount DESC\nLIMIT 1;",
        "pred_query": "SELECT T2.account_id, T5.date \nFROM account AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN loan AS T3 ON T2.account_id = T3.account_id\nINNER JOIN account AS T4 ON T3.account_id = T4.account_id\nINNER JOIN district AS T5 ON T4.district_id = T5.district_id\nWHERE STRFTIME('%Y', T3.date) = '1993'\nAND STRFTIME('%Y', datediff('day', min(T3.date), T3.date)) > 12\nORDER BY T3.amount DESC\nLIMIT 1;",
        "pred_time": null,
        "orig_time": 0.0018460750579833984,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Among the account opened, how many female customers who were born before 1950 and stayed in Slokolov?",
        "original_query": "SELECT COUNT(T2.client_id) FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T2.gender = 'F' AND STRFTIME('%Y', T2.birth_date) < '1950' AND T1.A2 = 'Slokolov'",
        "llm_output": "-- Reasoning\nWe need to select female customers who were born before 1950 and stayed in Slokolov. \nWe can start by selecting the client_id from the client table where gender is 'F' and birth_date is before 1950. \nThen, we join the client table with the district table using district_id to filter for Slokolov district. \nSince we are looking for the count of such customers, we return the count of client_id.\n\n-- SQL Query\nSELECT COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.gender = 'F' AND T1.birth_date < '1950-01-01' AND T2.A2 = 'Slokolov';",
        "pred_query": "SELECT COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.gender = 'F' AND T1.birth_date < '1950-01-01' AND T2.A2 = 'Slokolov';",
        "pred_time": 0.0017120838165283203,
        "orig_time": 0.0015780925750732422,
        "time_ratio": 0.9217379195098175,
        "check": true
    },
    {
        "id": "financial",
        "question": "List out the accounts who have the earliest trading date in 1995 ?",
        "original_query": "SELECT account_id FROM trans WHERE STRFTIME('%Y', date) = '1995' ORDER BY date ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe look for the earliest date in the account table where the year is 1995. We join the account table with the trans table using their IDs, filter for transactions from 1995, group by account ID, and return those having the earliest trading date. We then select the account ID from this result.\n\n-- SQL Query\nSELECT T1.account_id\nFROM account AS T1\nINNER JOIN trans AS T2 ON T1.account_id = T2.account_id\nWHERE STRFTIME('%Y', T2.date) = '1995'\nGROUP BY T1.account_id\nORDER BY T2.date ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.account_id\nFROM account AS T1\nINNER JOIN trans AS T2 ON T1.account_id = T2.account_id\nWHERE STRFTIME('%Y', T2.date) = '1995'\nGROUP BY T1.account_id\nORDER BY T2.date ASC\nLIMIT 1;",
        "pred_time": 1.7727866172790527,
        "orig_time": 0.2701542377471924,
        "time_ratio": 0.15238959675916125,
        "check": false
    },
    {
        "id": "financial",
        "question": "State different accounts who have account opening date before 1997 and own an amount of money greater than 3000USD",
        "original_query": "SELECT DISTINCT T2.account_id FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE STRFTIME('%Y', T2.date) < '1997' AND T1.amount > 3000",
        "llm_output": "-- Reasoning\nWe start by selecting account IDs and district IDs from the account table where the date of account opening (date) is before 1997 and the balance is greater than 3000. We join the trans table with the account table on account ID to correctly filter for accounts with the desired balance. Then we join the district table using the district ID and finally select the account IDs to show the different accounts.\n\n-- SQL Query\nSELECT T1.account_id\nFROM account AS T1\nINNER JOIN trans AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T1.district_id = T3.district_id\nWHERE STRFTIME('%Y', T1.date) < '1997'\nAND T2.balance > 3000",
        "pred_query": "SELECT T1.account_id\nFROM account AS T1\nINNER JOIN trans AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T1.district_id = T3.district_id\nWHERE STRFTIME('%Y', T1.date) < '1997'\nAND T2.balance > 3000",
        "pred_time": 0.6611688137054443,
        "orig_time": 0.21806907653808594,
        "time_ratio": 0.32982359726851446,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which client issued his/her card in 1994/3/3, give his/her client id.",
        "original_query": "SELECT T2.client_id FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN card AS T3 ON T2.disp_id = T3.disp_id WHERE T3.issued = '1994-03-03'",
        "llm_output": "-- Reasoning\nWe look for the records in the card table where the issued date is '1994-03-03'. Then we join the disp table to get client_id, because card_id and client_id are foreign keys referencing each other.\n\n-- SQL Query\nSELECT T2.client_id\nFROM card AS T1\nINNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id\nWHERE T1.issued = '1994-03-03';",
        "pred_query": "SELECT T2.client_id\nFROM card AS T1\nINNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id\nWHERE T1.issued = '1994-03-03';",
        "pred_time": 0.0011568069458007812,
        "orig_time": 0.00083160400390625,
        "time_ratio": 0.718878812860676,
        "check": true
    },
    {
        "id": "financial",
        "question": "The transaction of 840 USD happened in 1998/10/14, when was this account opened?",
        "original_query": "SELECT T1.date FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.amount = 840 AND T2.date = '1998-10-14'",
        "llm_output": "-- Reasoning\nTo find the date when the account was opened, we first need to find the account_id associated with a transaction of 840 USD on 1998/10/14. We join the trans and account tables using their IDs, then filter for the account_id that has a transaction on that date with an amount of 840. Finally, we join this account_id with the account table to find the date when the account was opened.\n\n-- SQL Query\nSELECT T2.date\nFROM trans AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nWHERE T1.date = '1998-10-14' AND T1.amount = 840",
        "pred_query": "SELECT T2.date\nFROM trans AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nWHERE T1.date = '1998-10-14' AND T1.amount = 840",
        "pred_time": 0.10335874557495117,
        "orig_time": 0.07176518440246582,
        "time_ratio": 0.6943310312374573,
        "check": true
    },
    {
        "id": "financial",
        "question": "There was a loan approved in 1994/8/25, where was that account opened, give the district Id of the branch.",
        "original_query": "SELECT T1.district_id FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T2.date = '1994-08-25'",
        "llm_output": "-- We need to find the district ID where a particular account was opened. Since we know the date of loan approval, we can join the loan and account tables based on account_id and date, and then use the district_id from the account table to find the corresponding district ID.\n\nSELECT T3.district_id\nFROM loan AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T2.district_id = T3.district_id\nWHERE T1.date = '1994-08-25';",
        "pred_query": "SELECT T3.district_id\nFROM loan AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T2.district_id = T3.district_id\nWHERE T1.date = '1994-08-25';",
        "pred_time": 0.000812530517578125,
        "orig_time": 0.0005273818969726562,
        "time_ratio": 0.6490610328638498,
        "check": true
    },
    {
        "id": "financial",
        "question": "What is the biggest amount of transaction that the client whose card was opened in 1996/10/21 made?",
        "original_query": "SELECT T2.amount FROM account AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T1.date = '1996-10-21' ORDER BY T2.amount DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the account ID of the client whose card was opened in 1996/10/21. We join the disp and card tables using disp_id and card_id to find the account ID. We then join the trans table with the account table using account_id to filter transactions made by that account. We group by account_id and return the maximum transaction amount.\n\n-- SQL Query\nSELECT MAX(T4.amount)\nFROM disp AS T1\nINNER JOIN card AS T2 ON T1.disp_id = T2.disp_id\nINNER JOIN account AS T3 ON T1.account_id = T3.account_id\nINNER JOIN trans AS T4 ON T3.account_id = T4.account_id\nWHERE T2.issued = '1996-10-21'",
        "pred_query": "SELECT MAX(T4.amount)\nFROM disp AS T1\nINNER JOIN card AS T2 ON T1.disp_id = T2.disp_id\nINNER JOIN account AS T3 ON T1.account_id = T3.account_id\nINNER JOIN trans AS T4 ON T3.account_id = T4.account_id\nWHERE T2.issued = '1996-10-21'",
        "pred_time": 0.4719686508178711,
        "orig_time": 0.13114261627197266,
        "time_ratio": 0.27786298103638146,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the gender of the oldest client who opened his/her account in the highest average salary branch?",
        "original_query": "SELECT T2.gender FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id ORDER BY T1.A11 DESC, T2.birth_date ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need the client's gender, the district with the highest average salary, and the corresponding age of the oldest client who opened an account in this district. Join the account, district, and client tables using their IDs, calculate the average salary for each district, sort by the average salary, get the top district, find the district ID corresponding to the district with the highest average salary, join the district and client tables, sort by birth date, and return the gender and age of the oldest client.\n\n-- SQL Query\nSELECT T3.gender, DATEDIFF('day', T3.birth_date, '9999-12-31') \nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN client AS T3 ON T2.district_id = T3.district_id\nWHERE T1.A10 = (\n    SELECT AVG(A10) \n    FROM district \n    GROUP BY A10 \n    ORDER BY A10 DESC \n    LIMIT 1\n)\nORDER BY T3.birth_date ASC\nLIMIT 1;",
        "pred_query": "SELECT T3.gender, DATEDIFF('day', T3.birth_date, '9999-12-31') \nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN client AS T3 ON T2.district_id = T3.district_id\nWHERE T1.A10 = (\n    SELECT AVG(A10) \n    FROM district \n    GROUP BY A10 \n    ORDER BY A10 DESC \n    LIMIT 1\n)\nORDER BY T3.birth_date ASC\nLIMIT 1;",
        "pred_time": null,
        "orig_time": 0.0013468265533447266,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "For the client who applied the biggest loan, what was his/her first amount of transaction after opened the account?",
        "original_query": "SELECT T2.amount FROM loan AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id ORDER BY T1.amount DESC, T2.date ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the loan with the highest amount, then we join it with the account table to get the account ID, finally we join this account ID with the trans table to find the earliest transaction date, but we need the first transaction after the account was opened. \n\nWe can do this by finding the maximum date in the trans table where the type is 'opened' for the same account ID, and then selecting the first transaction date that is greater than this date.\n\n-- SQL Query\nSELECT T4.date\nFROM loan AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nINNER JOIN (\n  SELECT T9.account_id, MAX(T8.date) AS date\n  FROM account AS T9\n  INNER JOIN trans AS T8 ON T9.account_id = T8.account_id\n  WHERE T8.type = 'opened'\n  GROUP BY T9.account_id\n) AS T4 ON T2.account_id = T4.account_id\nWHERE T1.amount = ( SELECT MAX(T5.amount) \n                    FROM loan AS T5\n                  )\nAND T3.date > T4.date;",
        "pred_query": "SELECT T4.date\nFROM loan AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nINNER JOIN (\n  SELECT T9.account_id, MAX(T8.date) AS date\n  FROM account AS T9\n  INNER JOIN trans AS T8 ON T9.account_id = T8.account_id\n  WHERE T8.type = 'opened'\n  GROUP BY T9.account_id\n) AS T4 ON T2.account_id = T4.account_id\nWHERE T1.amount = ( SELECT MAX(T5.amount) \n                    FROM loan AS T5\n                  )\nAND T3.date > T4.date;",
        "pred_time": 1.1771488189697266,
        "orig_time": 1.2383573055267334,
        "time_ratio": 1.0519972373676407,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many clients opened their accounts in Jesenik branch were women?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' AND T2.A2 = 'Jesenik'",
        "llm_output": "-- Reasoning\nWe first need to find the district id of Jesenik branch. We join the district table with the account table on district_id and filter for 'Jesenik'. Then, we join the client table with the disp table on client_id and filter for district_id of Jesenik. Finally, we can count the number of rows where gender is 'Female'.\n\n-- SQL Query\nSELECT COUNT(T4.client_id)\nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN disp AS T3 ON T2.account_id = T3.account_id\nINNER JOIN client AS T4 ON T3.client_id = T4.client_id\nWHERE T1.A3 = 'Jesenik' AND T4.gender = 'Female';",
        "pred_query": "SELECT COUNT(T4.client_id)\nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN disp AS T3 ON T2.account_id = T3.account_id\nINNER JOIN client AS T4 ON T3.client_id = T4.client_id\nWHERE T1.A3 = 'Jesenik' AND T4.gender = 'Female';",
        "pred_time": 0.002740144729614258,
        "orig_time": 0.0015935897827148438,
        "time_ratio": 0.5815713912816497,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the disposition id of the client who made 5100 USD transaction in 1998/9/2?",
        "original_query": "SELECT T1.disp_id FROM disp AS T1 INNER JOIN trans AS T2 ON T1.account_id = T2.account_id WHERE T2.date = '1998-09-02' AND T2.amount = 5100",
        "llm_output": "-- Reasoning\nWe join the trans and disp tables using their IDs, filter for transactions with amount = 5100 and date = 1998/9/2, and then select the disp_id of the client who made such a transaction.\n\n-- SQL Query\nSELECT T2.disp_id\nFROM trans AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nWHERE STRFTIME('%Y-%m-%d', T1.date) = '1998-09-02'\nAND T1.amount = 5100;",
        "pred_query": "SELECT T2.disp_id\nFROM trans AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nWHERE STRFTIME('%Y-%m-%d', T1.date) = '1998-09-02'\nAND T1.amount = 5100;",
        "pred_time": 0.6771392822265625,
        "orig_time": 0.1884903907775879,
        "time_ratio": 0.27836280618338327,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many accounts were opened in Litomerice in 1996?",
        "original_query": "SELECT COUNT(T2.account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T2.date) = '1996' AND T1.A2 = 'Litomerice'",
        "llm_output": "-- Reasoning\nWe start by selecting the account_id from the account table where the date of account opening is in 1996. Since we're focused on the specific district, we filter for the district_id that corresponds to Litomerice. In the district table, we first need to find the district_id of Litomerice by A2 which matches 'Litomerice'. After that, we use this district_id in our query. We combine these conditions using AND and INNER JOIN, finally counting the distinct account_ids.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A2 = 'Litomerice' AND STRFTIME('%Y', T1.date) = '1996';",
        "pred_query": "SELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A2 = 'Litomerice' AND STRFTIME('%Y', T1.date) = '1996';",
        "pred_time": 0.00203704833984375,
        "orig_time": 0.0016999244689941406,
        "time_ratio": 0.834503745318352,
        "check": true
    },
    {
        "id": "financial",
        "question": "For the female client who was born in 1976/1/29, which district did she opened her account?",
        "original_query": "SELECT T1.A2 FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T2.birth_date = '1976-01-29' AND T2.gender = 'F'",
        "llm_output": "-- Reasoning\nFirst, we identify the client by her gender and date of birth, then we select her account district from the account table.\n\n-- SQL Query\nSELECT T2.district_id\nFROM client AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nWHERE T1.gender = 'Female' AND T1.birth_date = '1976-01-29';",
        "pred_query": "SELECT T2.district_id\nFROM client AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nWHERE T1.gender = 'Female' AND T1.birth_date = '1976-01-29';",
        "pred_time": 0.001107931137084961,
        "orig_time": 0.0013000965118408203,
        "time_ratio": 1.1734452334839682,
        "check": false
    },
    {
        "id": "financial",
        "question": "For the client who applied 98832 USD loan in 1996/1/3, when was his/her birthday?",
        "original_query": "SELECT T3.birth_date FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN client AS T3 ON T2.district_id = T3.district_id WHERE T1.date = '1996-01-03' AND T1.amount = 98832",
        "llm_output": "-- Reasoning\nWe need the birthdate of a client who was part of a loan where 98832 USD was applied in 1996. We join the account and loan tables to find this account_id, then join the account table with the client table based on district_id. Once we have the client_id, we can find the client's birthdate from the client table.\n\n-- SQL Query\nSELECT T3.birth_date\nFROM loan AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN client AS T3 ON T2.district_id = T3.district_id\nWHERE T1.amount = 98832 AND STRFTIME('%Y-%m-%d', T1.date) = '1996-01-03';",
        "pred_query": "SELECT T3.birth_date\nFROM loan AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN client AS T3 ON T2.district_id = T3.district_id\nWHERE T1.amount = 98832 AND STRFTIME('%Y-%m-%d', T1.date) = '1996-01-03';",
        "pred_time": 0.004548788070678711,
        "orig_time": 0.0037157535552978516,
        "time_ratio": 0.8168667120918287,
        "check": true
    },
    {
        "id": "financial",
        "question": "For the first client who opened his/her account in Prague, what is his/her account ID?",
        "original_query": "SELECT T1.account_id FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A3 = 'Prague' ORDER BY T1.date ASC LIMIT 1",
        "llm_output": "-- Question\nFor the first client who opened his/her account in Prague, what is his/her account ID?\n\n-- Reasoning\nTo solve this problem, we first need to find the district ID of Prague in the district table. Next, we join the account table with the disp table and further join the client table to find the first client who opened an account in Prague and return their account ID.\n\n-- SQL Query\nSELECT T1.account_id\nFROM account AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nINNER JOIN client AS T3 ON T2.client_id = T3.client_id\nWHERE T3.district_id = (SELECT district_id FROM district WHERE A2 = 'PRAGUE')\nORDER BY T1.date ASC\nLIMIT 1;",
        "pred_query": "SELECT T1.account_id\nFROM account AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nINNER JOIN client AS T3 ON T2.client_id = T3.client_id\nWHERE T3.district_id = (SELECT district_id FROM district WHERE A2 = 'PRAGUE')\nORDER BY T1.date ASC\nLIMIT 1;",
        "pred_time": 0.001859903335571289,
        "orig_time": 0.0013835430145263672,
        "time_ratio": 0.7438789898730932,
        "check": false
    },
    {
        "id": "financial",
        "question": "For the branch which located in the south Bohemia with biggest number of inhabitants, what is the percentage of the male clients?",
        "original_query": "SELECT CAST(SUM(T1.gender = 'M') AS REAL) * 100 / COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A3 = 'south Bohemia' GROUP BY T2.A4 ORDER BY T2.A4 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nTo answer this question, we first join the client table with the district table using the district_id. We then filter for clients living in south Bohemia, sort the districts by the total number of inhabitants in descending order, return the top one. After that, we group the filtered client data by gender and calculate the percentage of male clients.\n\n-- SQL Query\nSELECT CAST(COUNT(CASE WHEN GENDER = 'Male' THEN 1 ELSE NULL END) AS REAL) * 100 / COUNT(*) AS percentage_male\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A4 = 'South Bohemia'",
        "pred_query": "SELECT CAST(COUNT(CASE WHEN GENDER = 'Male' THEN 1 ELSE NULL END) AS REAL) * 100 / COUNT(*) AS percentage_male\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A4 = 'South Bohemia'",
        "pred_time": 0.0019600391387939453,
        "orig_time": 0.0013914108276367188,
        "time_ratio": 0.7098893078700887,
        "check": false
    },
    {
        "id": "financial",
        "question": "For the client who first applied the loan in 1993/7/5, what is the increase rate of his/her account balance from 1993/3/22 to 1998/12/27?",
        "original_query": "SELECT CAST((SUM(IIF(T3.date = '1998-12-27', T3.balance, 0)) - SUM(IIF(T3.date = '1993-03-22', T3.balance, 0))) AS REAL) * 100 / SUM(IIF(T3.date = '1993-03-22', T3.balance, 0)) FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN trans AS T3 ON T3.account_id = T2.account_id WHERE T1.date = '1993-07-05'",
        "llm_output": "-- Reasoning\nTo determine the increase rate of the account balance, first find the account balance on 1993/3/22 and on 1998/12/27. Then calculate the increase rate by dividing the difference of the two balances by the initial balance. First, find the loan_id of the client who first applied for a loan in 1993/7/5 and use it to determine the corresponding account_id. Use the account_id to join the trans table with the account table and find the balances on both dates.\n\n-- SQL Query \nSELECT CAST(((T1.balance) - (SELECT balance FROM trans WHERE date = '1993-03-22' AND account_id = (SELECT account_id FROM loan WHERE STRFTIME('%Y-%m-%d', date) = '1993-07-05')))/(SELECT balance FROM trans WHERE date = '1993-03-22' AND account_id = (SELECT account_id FROM loan WHERE STRFTIME('%Y-%m-%d', date) = '1993-07--05'))) AS REAL*100 \nFROM trans AS T1\nWHERE T1.account_id = (SELECT account_id FROM loan WHERE STRFTIME('%Y-%m-%d', date) = '1993-07-05')\nAND T1.date = '1998-12-27;",
        "pred_query": "SELECT CAST(((T1.balance) - (SELECT balance FROM trans WHERE date = '1993-03-22' AND account_id = (SELECT account_id FROM loan WHERE STRFTIME('%Y-%m-%d', date) = '1993-07-05')))/(SELECT balance FROM trans WHERE date = '1993-03-22' AND account_id = (SELECT account_id FROM loan WHERE STRFTIME('%Y-%m-%d', date) = '1993-07--05'))) AS REAL*100 \nFROM trans AS T1\nWHERE T1.account_id = (SELECT account_id FROM loan WHERE STRFTIME('%Y-%m-%d', date) = '1993-07-05')\nAND T1.date = '1998-12-27;",
        "pred_time": null,
        "orig_time": 0.6577577590942383,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the percentage of loan amount that has been fully paid with no issue.",
        "original_query": "SELECT (CAST(SUM(CASE WHEN status = 'A' THEN amount ELSE 0 END) AS REAL) * 100) / SUM(amount) FROM loan",
        "llm_output": "-- Reasoning\nWe need to calculate the percentage of loan amount that has been fully paid, which requires filtering loan records with a status of 'Paid' and then dividing the total amount of these loans by the total amount of all loans and multiplying by 100.\n\n-- SQL Query\nSELECT CAST(SUM(IIF(T2.status = 'Paid', T2.amount, 0)) AS REAL) * 100 / SUM(T2.amount)\nFROM loan AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id;",
        "pred_query": "SELECT CAST(SUM(IIF(T2.status = 'Paid', T2.amount, 0)) AS REAL) * 100 / SUM(T2.amount)\nFROM loan AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id;",
        "pred_time": null,
        "orig_time": 0.000690460205078125,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "For loan amount less than USD100,000, what is the percentage of accounts that is still running with no issue.",
        "original_query": "SELECT CAST(SUM(status = 'C') AS REAL) * 100 / COUNT(amount) FROM loan WHERE amount < 100000",
        "llm_output": "-- Reasoning\nWe need to find the percentage of accounts with loans still running and no issues for loan amounts less than USD100,000. We can achieve this by joining the account and loan tables, filtering for active loans with no issues, and then calculating the percentage based on the total number of accounts with loan amounts less than USD100,000.\n\n-- SQL Query\nSELECT CAST(COUNT(CASE \n            WHEN L.status = 'Running' \n            THEN A.account_id \n            END) \n        AS REAL) * 100 / COUNT(A.account_id) \nFROM account AS A \nINNER JOIN loan AS L ON A.account_id = L.account_id \nWHERE A.district_id IS NOT NULL \nAND L.amount < 100000;",
        "pred_query": "SELECT CAST(COUNT(CASE \n            WHEN L.status = 'Running' \n            THEN A.account_id \n            END) \n        AS REAL) * 100 / COUNT(A.account_id) \nFROM account AS A \nINNER JOIN loan AS L ON A.account_id = L.account_id \nWHERE A.district_id IS NOT NULL \nAND L.amount < 100000;",
        "pred_time": 0.001420736312866211,
        "orig_time": 0.000553131103515625,
        "time_ratio": 0.3893270683000503,
        "check": false
    },
    {
        "id": "financial",
        "question": "For accounts in 1993 with statement issued after transaction, list the account ID, district name and district region.",
        "original_query": "SELECT T1.account_id, T2.A2, T2.A3 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.frequency = 'POPLATEK PO OBRATU' AND STRFTIME('%Y', T1.date)= '1993'",
        "llm_output": "-- Reasoning\nWe need the account ID, district name, and district region from accounts where the statement was issued after the transaction in year 1997. We'll join the account, district, and trans tables based on their IDs, filter the transactions and statements issued in the year 1997, and then compare their dates to find the desired accounts. Finally, we return the account ID, district name, and district region.\n\n-- SQL Query\nSELECT T1.account_id, T2.A8, T2.A6\nFROM trans AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T2.district_id = T3.district_id\nWHERE STRFTIME('%Y', T1.date) = '1997'\nAND STRFTIME('%Y', T1.date) > STRFTIME('%Y', T1.operation_date);",
        "pred_query": "SELECT T1.account_id, T2.A8, T2.A6\nFROM trans AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T2.district_id = T3.district_id\nWHERE STRFTIME('%Y', T1.date) = '1997'\nAND STRFTIME('%Y', T1.date) > STRFTIME('%Y', T1.operation_date);",
        "pred_time": null,
        "orig_time": 0.0010631084442138672,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "From Year 1995 to 2000, who are the accounts holders from 'east Bohemia'. State the account ID the frequency of statement issuance.",
        "original_query": "SELECT T1.account_id, T1.frequency FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A3 = 'east Bohemia' AND STRFTIME('%Y', T1.date) BETWEEN '1995' AND '2000'",
        "llm_output": "-- Reasoning\nWe need the account holders from 'East Bohemia' and the frequency of statement issuance. First, we join account and district tables using their IDs, filter districts having 'East Bohemia' A2 attribute, then filter transactions from the years 1995 to 2000, select account ID and frequency of account holders, and group by account ID.\n\n-- SQL Query\nSELECT T1.account_id, T1.frequency \nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A2 LIKE '%East Bohemia%'\nINNER JOIN trans AS T3 ON T1.account_id = T3.account_id\nWHERE STRFTIME('%Y', T3.date) >= '1995' AND STRFTIME('%Y', T3.date) <= '2000'\nGROUP BY T1.account_id;",
        "pred_query": "SELECT T1.account_id, T1.frequency \nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A2 LIKE '%East Bohemia%'\nINNER JOIN trans AS T3 ON T1.account_id = T3.account_id\nWHERE STRFTIME('%Y', T3.date) >= '1995' AND STRFTIME('%Y', T3.date) <= '2000'\nGROUP BY T1.account_id;",
        "pred_time": null,
        "orig_time": 0.002713918685913086,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "List account ID and account opening date for accounts from 'Prachatice'.",
        "original_query": "SELECT T1.account_id, T1.date FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A2 = 'Prachatice'",
        "llm_output": "-- Reasoning\nWe need to join the account table with the district table using the district_id column. Filter for accounts with a district name of 'Prachatice'. Return the account_id and the date when the account was opened, which is stored in the date column.\n\n-- SQL Query\nSELECT T1.account_id, T1.date\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A2 = 'Prachatice';",
        "pred_query": "SELECT T1.account_id, T1.date\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A2 = 'Prachatice';",
        "pred_time": 0.0018265247344970703,
        "orig_time": 0.0013539791107177734,
        "time_ratio": 0.7412870382456599,
        "check": true
    },
    {
        "id": "financial",
        "question": "State the district and region for loan ID '4990'.",
        "original_query": "SELECT T2.A2, T2.A3 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T3.loan_id = 4990",
        "llm_output": "-- Reasoning\nWe start by joining the loan, account, and district tables based on their IDs. Then, filter for the loan ID '4990', and finally return the district, region information ('A6' and 'A5').\n\n-- SQL Query\nSELECT T1.A6, T1.A5, T2.district_id, T2.A2\nFROM loan AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T2.district_id = T3.district_id\nWHERE T1.loan_id = 4990",
        "pred_query": "SELECT T1.A6, T1.A5, T2.district_id, T2.A2\nFROM loan AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T2.district_id = T3.district_id\nWHERE T1.loan_id = 4990",
        "pred_time": null,
        "orig_time": 0.0005872249603271484,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Provide the account ID, district and region for loan amount greater than USD300,000.",
        "original_query": "SELECT T1.account_id, T2.A2, T2.A3 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T3.amount > 300000",
        "llm_output": "-- Reasoning\nWe join the loan table with the account table using account_id and the district table using district_id, filter loans with an amount greater than 300,000, select account_id, district's A2 (region), and A3 (district name), and return the results.\n\n-- SQL Query\nSELECT T1.account_id, T2.A3, T2.A2\nFROM loan AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T2.district_id = T3.district_id\nWHERE T1.amount > 300000;",
        "pred_query": "SELECT T1.account_id, T2.A3, T2.A2\nFROM loan AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T2.district_id = T3.district_id\nWHERE T1.amount > 300000;",
        "pred_time": null,
        "orig_time": 0.0007143020629882812,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "List the loan ID, district and average salary for loan with duration of 60 months.",
        "original_query": "SELECT T3.loan_id, T2.A2, T2.A11 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T3.duration = 60",
        "llm_output": "-- Reasoning\nWe join the loan, account, and district tables using their IDs. We filter loan records with a duration of 60 months and calculate the average salary for each district. We select the loan id, district id, and average salary.\n\n-- SQL Query\nSELECT \n    T1.loan_id,\n    T5.district_a3,\n    SUM(T3.salary) / (SELECT COUNT(*) FROM loan WHERE duration = 60) as avg_salary\nFROM \n    loan AS T1\nINNER JOIN \n    account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN \n    client AS T3 ON T2.client_id = T3.client_id\nINNER JOIN \n    disp AS T4 ON T3.client_id = T4.client_id\nINNER JOIN \n    district AS T5 ON T4.district_id = T5.district_id\nWHERE \n    T1.duration = 60\nGROUP BY \n    T5.district_a3;",
        "pred_query": "SELECT \n    T1.loan_id,\n    T5.district_a3,\n    SUM(T3.salary) / (SELECT COUNT(*) FROM loan WHERE duration = 60) as avg_salary\nFROM \n    loan AS T1\nINNER JOIN \n    account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN \n    client AS T3 ON T2.client_id = T3.client_id\nINNER JOIN \n    disp AS T4 ON T3.client_id = T4.client_id\nINNER JOIN \n    district AS T5 ON T4.district_id = T5.district_id\nWHERE \n    T1.duration = 60\nGROUP BY \n    T5.district_a3;",
        "pred_time": null,
        "orig_time": 0.0009088516235351562,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "For loans contracts which are still running where client are in debt, list the district of the and the state the percentage unemployment rate increment from year 1995 to 1996.",
        "original_query": "SELECT CAST((T3.A13 - T3.A12) AS REAL) * 100 / T3.A12 FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.status = 'D'",
        "llm_output": "-- Reasoning\nWe need to find districts where loan contracts are still running and clients are in debt. This requires joining the loan, account, disp, client, and district tables. We also need to get the unemployment rate increment from year 1995 to 1996. We'll join the account, trans, and district tables to get the total amount of debt for each account, and then we'll join the district table with a subquery to get the unemployment rate increment.\n\n-- SQL Query\nWITH subquery AS \n(SELECT T1.district_id, T2.A10, T2.A10 - LAG(T2.A10) OVER (ORDER BY T2.id) \nFROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE STRFTIME('%Y', T1.date) IN ('1995', '1996')),\nactive_dist AS \n(SELECT T4.district_id, T1.A10, CASE WHEN T1.A10 - T2.A10 THEN T1.A10 - T2.A10 ELSE 0 END AS increment\nFROM account AS T4 INNER JOIN district AS T1 ON T4.district_id = T1.district_id\nINNER JOIN subquery AS T2 ON T4.district_id = T2.district_id\nWHERE T4.account_id NOT IN (SELECT account_id FROM trans WHERE STRFTIME('%Y', date) = '1997' AND type = 'payment')),\nstill_running_loans AS \n(SELECT T5.account_id, T5.district_id, T6.increment, SUM(T6.increment * 100 / T6.A10) AS percentage_increment\nFROM loan AS T5 INNER JOIN account AS T6 ON T5.account_id = T6.account_id\nINNER JOIN active_dist AS T7 ON T5.account_id = T7.district_id\nWHERE T5.duration > 0\nGROUP BY T5.account_id, T5.district_id, T6.increment, T6.A10)\nSELECT T1.district, T3.A10 AS \"Percentage Unemployment Rate Increment\"\nFROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN still_running_loans AS T3 ON T2.account_id = T3.account_id;",
        "pred_query": "SELECT T1.district_id, T2.A10, T2.A10 - LAG(T2.A10) OVER (ORDER BY T2.id) \nFROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE STRFTIME('%Y', T1.date) IN ('1995', '1996')),\nactive_dist AS \n(SELECT T4.district_id, T1.A10, CASE WHEN T1.A10 - T2.A10 THEN T1.A10 - T2.A10 ELSE 0 END AS increment\nFROM account AS T4 INNER JOIN district AS T1 ON T4.district_id = T1.district_id\nINNER JOIN subquery AS T2 ON T4.district_id = T2.district_id\nWHERE T4.account_id NOT IN (SELECT account_id FROM trans WHERE STRFTIME('%Y', date) = '1997' AND type = 'payment')),\nstill_running_loans AS \n(SELECT T5.account_id, T5.district_id, T6.increment, SUM(T6.increment * 100 / T6.A10) AS percentage_increment\nFROM loan AS T5 INNER JOIN account AS T6 ON T5.account_id = T6.account_id\nINNER JOIN active_dist AS T7 ON T5.account_id = T7.district_id\nWHERE T5.duration > 0\nGROUP BY T5.account_id, T5.district_id, T6.increment, T6.A10)\nSELECT T1.district, T3.A10 AS \"Percentage Unemployment Rate Increment\"\nFROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN still_running_loans AS T3 ON T2.account_id = T3.account_id;",
        "pred_time": null,
        "orig_time": null,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Calculate the percentage of account from 'Decin' district for all accounts are opened in 1993.",
        "original_query": "SELECT CAST(SUM(T1.A2 = 'Decin') AS REAL) * 100 / COUNT(account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T2.date) = '1993'",
        "llm_output": "-- We first join the account and district tables using their IDs.\n-- Then filter accounts from the year 1993. \n-- We group by district, and return the total count of accounts from Decin district.\n\nSELECT CAST(SUM(IIF(T1.district_id = 3, 1, 0)) AS REAL) * 100 / COUNT(*)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE STRFTIME('%Y', T1.date) = '1993';",
        "pred_query": "SELECT CAST(SUM(IIF(T1.district_id = 3, 1, 0)) AS REAL) * 100 / COUNT(*)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE STRFTIME('%Y', T1.date) = '1993';",
        "pred_time": 0.002266407012939453,
        "orig_time": 0.001917123794555664,
        "time_ratio": 0.84588680833158,
        "check": false
    },
    {
        "id": "financial",
        "question": "List the account IDs with monthly issuance of statements.",
        "original_query": "SELECT account_id FROM account WHERE Frequency = 'POPLATEK MESICNE'",
        "llm_output": "-- Reasoning\nWe select the account IDs from the account table where the frequency is 'Monthly Issuance'. This directly maps to the SQL query.\n\n-- SQL Query\nSELECT account_id\nFROM account\nWHERE frequency = 'Monthly Issuance';",
        "pred_query": "SELECT account_id\nFROM account\nWHERE frequency = 'Monthly Issuance';",
        "pred_time": 0.0014138221740722656,
        "orig_time": 0.0022966861724853516,
        "time_ratio": 1.624451939291737,
        "check": false
    },
    {
        "id": "financial",
        "question": "List the top ten districts, by descending order, from the highest to the lowest, the number of female account holders.",
        "original_query": "SELECT T2.A2, COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' GROUP BY T2.district_id, T2.A2 ORDER BY COUNT(T1.client_id) DESC LIMIT 10",
        "llm_output": "-- Reasoning\nWe join the district and account tables using their IDs, filter the account table for female account holders, group by district, and return the top ten districts with the highest number of female account holders.\n\n-- SQL Query\nSELECT T1.district_id, COUNT(DISTINCT T2.account_id) AS num_female_account_holders\nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nWHERE T2.frequency = 'Female'\nGROUP BY T1.district_id\nORDER BY num_female_account_holders DESC\nLIMIT 10;",
        "pred_query": "SELECT T1.district_id, COUNT(DISTINCT T2.account_id) AS num_female_account_holders\nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nWHERE T2.frequency = 'Female'\nGROUP BY T1.district_id\nORDER BY num_female_account_holders DESC\nLIMIT 10;",
        "pred_time": 0.0014410018920898438,
        "orig_time": 0.0019066333770751953,
        "time_ratio": 1.32313037723362,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which are the top ten withdrawals (non-credit card) by district names for the month of January 1996?",
        "original_query": "SELECT T1.district_id FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T3.type = 'VYDAJ' AND T2.date LIKE '1996-01%' ORDER BY A2 ASC LIMIT 10",
        "llm_output": "-- Reasoning\nWe join the trans table with account and district tables using their IDs, filter transactions from January 1996, exclude credit card transactions by type, group by district, and return the top ten districts by total withdrawal amounts.\n\n-- SQL Query\nSELECT T3.A3, SUM(T2.amount) as total_withdrawal\nFROM trans AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T2.district_id = T3.district_id\nWHERE STRFTIME('%Y-%m', T1.date) = '1996-01'\nAND T1.type IN ('Withdrawal', 'Cash Withdrawal', 'ATM Withdrawal')\nGROUP BY T3.A3\nORDER BY total_withdrawal DESC\nLIMIT 10;",
        "pred_query": "SELECT T3.A3, SUM(T2.amount) as total_withdrawal\nFROM trans AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T2.district_id = T3.district_id\nWHERE STRFTIME('%Y-%m', T1.date) = '1996-01'\nAND T1.type IN ('Withdrawal', 'Cash Withdrawal', 'ATM Withdrawal')\nGROUP BY T3.A3\nORDER BY total_withdrawal DESC\nLIMIT 10;",
        "pred_time": null,
        "orig_time": 0.1134335994720459,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many of the account holders in South Bohemia still do not own credit cards?",
        "original_query": "SELECT COUNT(T3.account_id) FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T2.client_id = T3.client_id WHERE T1.A3 = 'south Bohemia' AND T3.type != 'OWNER'",
        "llm_output": "-- Question\nHow many of the account holders in South Bohemia still do not own credit cards?\n\n-- Reasoning\nWe first find the district ID of South Bohemia by joining the account and district tables based on the district ID. Then, we join the disp table, which stores the account IDs of clients who do not own credit cards, with the district table using account_id and district_id. Next, we count the number of rows where there are no matching records in the disp table, thus determining the number of account holders not owning credit cards in South Bohemia.\n\n-- SQL Query\nSELECT COUNT(T1.account_id) \nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nWHERE T2.account_id NOT IN (\n  SELECT DISTINCT(account_id)\n  FROM disp\n  WHERE disp_id IS NOT NULL\n)",
        "pred_query": "SELECT COUNT(T1.account_id) \nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nWHERE T2.account_id NOT IN (\n  SELECT DISTINCT(account_id)\n  FROM disp\n  WHERE disp_id IS NOT NULL\n)",
        "pred_time": null,
        "orig_time": 0.0014493465423583984,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which district has highest active loan?",
        "original_query": "SELECT T2.A3 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T3.status IN ('C', 'D') GROUP BY T2.A3 ORDER BY SUM(T3.amount) DESC LIMIT 1",
        "llm_output": "-- Question\nWhich district has the highest active loan?\n\n-- Reasoning\nTo find the district with the highest active loan, we need to join the account, loan, and district tables using their IDs. We filter for active loans by joining the loan table with the latest date in each account ID, then group the results by district and return the district with the maximum sum of amounts.\n\n-- SQL Query\nSELECT T1.district_id\nFROM account AS T1\nINNER JOIN loan AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T1.district_id = T3.district_id\nWHERE T2.status = 'Active'\nGROUP BY T1.district_id\nORDER BY SUM(T2.amount) DESC\nLIMIT 1;",
        "pred_query": "SELECT T1.district_id\nFROM account AS T1\nINNER JOIN loan AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T1.district_id = T3.district_id\nWHERE T2.status = 'Active'\nGROUP BY T1.district_id\nORDER BY SUM(T2.amount) DESC\nLIMIT 1;",
        "pred_time": 0.0014333724975585938,
        "orig_time": 0.0014388561248779297,
        "time_ratio": 1.0038256819693945,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the average loan amount by male borrowers?",
        "original_query": "SELECT AVG(T3.amount) FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id WHERE T1.gender = 'M'",
        "llm_output": "-- Reasoning\nFirst, we need to select the account_id from the client table for male borrowers. We then join the loan table with the account table based on the account_id. Next, we filter for the loan amounts and group them by the loan_id. Finally, we calculate the average loan amount by using the AVG function and return the result.\n\n-- SQL Query\nSELECT AVG(T3.amount)\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN loan AS T3 ON T2.account_id = T3.account_id\nWHERE T1.gender = 'male';",
        "pred_query": "SELECT AVG(T3.amount)\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN loan AS T3 ON T2.account_id = T3.account_id\nWHERE T1.gender = 'male';",
        "pred_time": 0.0013275146484375,
        "orig_time": 0.005327463150024414,
        "time_ratio": 4.013110632183908,
        "check": false
    },
    {
        "id": "financial",
        "question": "In 1996, which districts have the highest unemployment rate? List their branch location and district name.",
        "original_query": "SELECT district_id, A2 FROM district ORDER BY A13 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need the A3 and A2 columns of the districts table, which represent the branch location and district name respectively. We join the account and trans tables with the account_id foreign key to access transaction data for districts. Then, we filter the data for the year 1996 by date, group the data by district_id, and return the districts with the highest average (balance / sum of amount) in descending order.\n\n-- SQL Query\nSELECT T1.A3, T1.A2\nFROM district AS T1\nINNER JOIN trans AS T2 ON T1.district_id = T2.account_id\nWHERE STRFTIME('%Y', T2.date) = '1996'\nGROUP BY T1.district_id\nORDER BY SUM(T2.balance) / SUM(T2.amount) DESC;",
        "pred_query": "SELECT T1.A3, T1.A2\nFROM district AS T1\nINNER JOIN trans AS T2 ON T1.district_id = T2.account_id\nWHERE STRFTIME('%Y', T2.date) = '1996'\nGROUP BY T1.district_id\nORDER BY SUM(T2.balance) / SUM(T2.amount) DESC;",
        "pred_time": 0.27903103828430176,
        "orig_time": 0.0006525516510009766,
        "time_ratio": 0.002338634637255296,
        "check": false
    },
    {
        "id": "financial",
        "question": "In the branch where the largest number of crimes were committed in 1996, how many accounts were opened?",
        "original_query": "SELECT COUNT(T2.account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id GROUP BY T1.A16 ORDER BY T1.A16 DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need the district ID and number of accounts where a crime was committed in 1996 in the trans table, then join this with the account table using their IDs. We sum the count of trans for each account and group by district ID to get the total count in each district. Finally, we sort the result by this count in descending order and select the top district (with the most crimes).\n\n-- SQL Query\nSELECT T1.district_id, COUNT(DISTINCT T1.account_id)\nFROM trans AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nWHERE STRFTIME('%Y', T1.date) = '1996'\nGROUP BY T1.district_id\nORDER BY COUNT(DISTINCT T1.account_id) DESC\nLIMIT 1",
        "pred_query": "SELECT T1.district_id, COUNT(DISTINCT T1.account_id)\nFROM trans AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nWHERE STRFTIME('%Y', T1.date) = '1996'\nGROUP BY T1.district_id\nORDER BY COUNT(DISTINCT T1.account_id) DESC\nLIMIT 1",
        "pred_time": null,
        "orig_time": 0.0021796226501464844,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "After making a credit card withdrawal, how many account/s with monthly issuance has a negative balance?",
        "original_query": "SELECT COUNT(T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.balance < 0 AND T1.operation = 'VYBER KARTOU' AND T2.frequency = 'POPLATEK MESICNE'",
        "llm_output": "-- Question\nAfter making a credit card withdrawal, how many account/s with monthly issuance has a negative balance?\n\n-- Reasoning\nWe identify the accounts that have monthly issuance by joining the account and disp tables. Then, we filter the transactions where the date is after the issuance date of the account. Finally, we count the accounts that have at least one negative balance transaction after issuance.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.account_id)\nFROM disp AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nWHERE T1.type = 'Monthly Card'\nAND EXISTS (\n    SELECT T3.amount\n    FROM trans AS T3\n    INNER JOIN account AS T4 ON T3.account_id = T4.account_id\n    WHERE T3.date > T1.issued\n    AND T4.account_id = T1.account_id\n    AND T3.amount < 0\n);",
        "pred_query": "SELECT COUNT(DISTINCT T1.account_id)\nFROM disp AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nWHERE T1.type = 'Monthly Card'\nAND EXISTS (\n    SELECT T3.amount\n    FROM trans AS T3\n    INNER JOIN account AS T4 ON T3.account_id = T4.account_id\n    WHERE T3.date > T1.issued\n    AND T4.account_id = T1.account_id\n    AND T3.amount < 0\n);",
        "pred_time": null,
        "orig_time": 0.07802248001098633,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Between 1/1/1995 and 12/31/1997, how many loans in the amount of at least 250,000 per account that chose monthly statement issuance were approved?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T2.date BETWEEN '1995-01-01' AND '1997-12-31' AND T1.frequency = 'POPLATEK MESICNE' AND T2.amount > 250000",
        "llm_output": "-- Reasoning\nTo find the number of loans in the amount of at least 250,000 per account that chose monthly statement issuance were approved, we need to join the account, loan, and disp tables using their account IDs. Then we filter for accounts with monthly statement issuance and loans approved, with amounts greater than or equal to 250,000, and finally for the years 1995\u20131997. We will count the distinct accounts that meet these criteria.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN loan AS T2 ON T1.account_id = T2.account_id\nINNER JOIN disp AS T3 ON T1.account_id = T3.account_id\nWHERE STRFTIME('%Y', T2.date) BETWEEN '1995' AND '1997'\nAND T2.amount >= 250000\nAND T3.type = 'M';",
        "pred_query": "SELECT COUNT(DISTINCT T1.account_id)\nFROM account AS T1\nINNER JOIN loan AS T2 ON T1.account_id = T2.account_id\nINNER JOIN disp AS T3 ON T1.account_id = T3.account_id\nWHERE STRFTIME('%Y', T2.date) BETWEEN '1995' AND '1997'\nAND T2.amount >= 250000\nAND T3.type = 'M';",
        "pred_time": 0.0014297962188720703,
        "orig_time": 0.0007112026214599609,
        "time_ratio": 0.4974153743538436,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts have running contracts in Branch location 1?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T1.account_id = T3.account_id WHERE T1.district_id = 1 AND (T3.status = 'C' OR T3.status = 'D')",
        "llm_output": "-- Reasoning\nWe need the count of accounts where there is a loan with a status of 'Running' that is associated with an account of a location in Branch 1. This involves joining the loan and account tables on the loan account ID and filtering for running loans and accounts in Branch 1 district.\n\n-- SQL Query\nSELECT COUNT(T3.account_id)\nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3 ON T2.account_id = T3.account_id\nWHERE T1.A2 = 'Branch' AND T1.A3 = '1' AND T3.status = 'Running';",
        "pred_query": "SELECT COUNT(T3.account_id)\nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3 ON T2.account_id = T3.account_id\nWHERE T1.A2 = 'Branch' AND T1.A3 = '1' AND T3.status = 'Running';",
        "pred_time": 0.0009679794311523438,
        "orig_time": 0.0009853839874267578,
        "time_ratio": 1.0179802955665025,
        "check": false
    },
    {
        "id": "financial",
        "question": "In the branch where the second-highest number of crimes were committed in 1995 occurred, how many male clients are there?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'M' AND T2.A15 = (SELECT T3.A15 FROM district AS T3 ORDER BY T3.A15 DESC LIMIT 1, 1)",
        "llm_output": "-- Reasoning\nTo find the branch with the second-highest number of crimes in 1995, we first join the trans table with the account and district tables to get the district where the crime was committed. Then we filter for crimes committed in 1995, group by district, and sort by the count in descending order to find the second-highest one. Next, we join this district with the client table to find the count of male clients in that district. Since there is only one district with the second-highest number of crimes, we limit the query to 1.\n\n-- SQL Query\nSELECT COUNT(*) \nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN account AS T3 ON T2.account_id = T3.account_id\nINNER JOIN district AS T4 ON T3.district_id = T4.district_id\nINNER JOIN trans AS T5 ON T3.account_id = T5.account_id\nWHERE T1.gender = 'Male'\n    AND T5.type = 'Crime'\n    AND STRFTIME('%Y', T5.date) = '1995'\n    AND T4.district_id IN (\n        SELECT T3.district_id\n        FROM client AS T1\n        INNER JOIN disp AS T2 ON T1.client_id = T2.client_id\n        INNER JOIN account AS T3 ON T2.account_id = T3.account_id\n        INNER JOIN trans AS T4 ON T3.account_id = T4.account_id\n        WHERE T4.type = 'Crime'\n            AND STRFTIME('%Y', T4.date) = '1995'\n        GROUP BY T3.district_id\n        ORDER BY COUNT(T4.type) DESC\n        LIMIT 1 OFFSET 1\n    )",
        "pred_query": "SELECT COUNT(*) \nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN account AS T3 ON T2.account_id = T3.account_id\nINNER JOIN district AS T4 ON T3.district_id = T4.district_id\nINNER JOIN trans AS T5 ON T3.account_id = T5.account_id\nWHERE T1.gender = 'Male'\n    AND T5.type = 'Crime'\n    AND STRFTIME('%Y', T5.date) = '1995'\n    AND T4.district_id IN (\n        SELECT T3.district_id\n        FROM client AS T1\n        INNER JOIN disp AS T2 ON T1.client_id = T2.client_id\n        INNER JOIN account AS T3 ON T2.account_id = T3.account_id\n        INNER JOIN trans AS T4 ON T3.account_id = T4.account_id\n        WHERE T4.type = 'Crime'\n            AND STRFTIME('%Y', T4.date) = '1995'\n        GROUP BY T3.district_id\n        ORDER BY COUNT(T4.type) DESC\n        LIMIT 1 OFFSET 1\n    )",
        "pred_time": 0.0019102096557617188,
        "orig_time": 0.0016515254974365234,
        "time_ratio": 0.8645781328007988,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many high-level credit cards have \"disponent\" type of disposition?",
        "original_query": "SELECT COUNT(T1.card_id) FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id WHERE T1.type = 'gold' AND T2.type = 'DISPONENT'",
        "llm_output": "-- Question\nHow many high-level credit cards have \"disponent\" type of disposition?\n\n-- Reasoning\nWe need to find high-level credit cards with \"disponent\" type of disposition. We join the card table with disp table using the disp_id column and filter for type='credit' and disposition='disponent'. Then we count the number of rows in the result.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM card AS T1\nINNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id\nWHERE T2.type = 'credit' AND T2.type_of_disposition = 'disponent';",
        "pred_query": "SELECT COUNT(*)\nFROM card AS T1\nINNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id\nWHERE T2.type = 'credit' AND T2.type_of_disposition = 'disponent';",
        "pred_time": null,
        "orig_time": 0.0007483959197998047,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts are there in the district of \"Pisek\"?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T2.A2 = 'Pisek'",
        "llm_output": "-- Reasoning\nTo find the number of accounts in the district of \"Pisek\", we can join the account and district tables based on their IDs. We filter for districts where the A3 column matches 'Pisek', and then count the number of accounts in those districts.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A3 = 'Pisek';",
        "pred_query": "SELECT COUNT(*)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A3 = 'Pisek';",
        "pred_time": 0.0021059513092041016,
        "orig_time": 0.0012555122375488281,
        "time_ratio": 0.5961734405071889,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which districts have transactions greater than USS$10,000 in 1997?",
        "original_query": "SELECT T1.district_id FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T1.account_id = T3.account_id WHERE STRFTIME('%Y', T3.date) = '1997' GROUP BY T1.district_id HAVING SUM(T3.amount) > 10000",
        "llm_output": "-- Reasoning\nWe first join the account, district, and trans tables using their respective IDs to establish relationships between them. Then, we filter transactions made in 1997. To meet the condition of total transactions greater than 10,000, we group the transactions by district and apply an inequality check to the total transaction amounts.\n\n-- SQL Query\nSELECT T1.district_id\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3 ON T1.account_id = T3.account_id\nWHERE STRFTIME('%Y', T3.date) = '1997'\nGROUP BY T1.district_id\nHAVING SUM(T3.amount) > 10000;",
        "pred_query": "SELECT T1.district_id\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3 ON T1.account_id = T3.account_id\nWHERE STRFTIME('%Y', T3.date) = '1997'\nGROUP BY T1.district_id\nHAVING SUM(T3.amount) > 10000;",
        "pred_time": 0.35076236724853516,
        "orig_time": 0.3284940719604492,
        "time_ratio": 0.9365145826139679,
        "check": true
    },
    {
        "id": "financial",
        "question": "Which accounts placed orders for household payment in Pisek?",
        "original_query": "SELECT DISTINCT T2.account_id FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.k_symbol = 'SIPO' AND T3.A2 = 'Pisek'",
        "llm_output": "-- Question\nWhich accounts placed orders for household payment in Pisek?\n\n-- Reasoning\nWe join the order and district tables using account_id and district_id to link orders to their corresponding districts. Then, we filter the districts for those matching 'Pisek'. Finally, we return the account_ids from the account table that are associated with these districts.\n\n-- SQL Query\nSELECT T1.account_id\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nINNER JOIN `order` AS T3 ON T1.account_id = T3.account_id\nWHERE T2.A2 = 'Pisek' AND T3.bank_to = 'HOUSEHOLD';",
        "pred_query": "SELECT T1.account_id\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nINNER JOIN `order` AS T3 ON T1.account_id = T3.account_id\nWHERE T2.A2 = 'Pisek' AND T3.bank_to = 'HOUSEHOLD';",
        "pred_time": 0.013115882873535156,
        "orig_time": 0.0916280746459961,
        "time_ratio": 6.986039409583364,
        "check": false
    },
    {
        "id": "financial",
        "question": "What are the accounts that have both gold and junior credit cards?",
        "original_query": "SELECT T2.account_id FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id WHERE T1.type IN ('gold', 'junior')",
        "llm_output": "-- Reasoning\nTo find the accounts that have both gold and junior credit cards, we need to join the disp and card tables using the disp_id, which will connect an account to the credit cards it has. We then filter for cards of type 'gold' and 'junior', and finally group by account_id to count the distinct accounts that have both types of credit cards.\n\n-- SQL Query\nSELECT count(DISTINCT T1.account_id)\nFROM disp AS T1\nINNER JOIN card AS T2 ON T1.disp_id = T2.disp_id\nWHERE T2.type = 'gold' AND T2.type = 'junior'",
        "pred_query": "SELECT count(DISTINCT T1.account_id)\nFROM disp AS T1\nINNER JOIN card AS T2 ON T1.disp_id = T2.disp_id\nWHERE T2.type = 'gold' AND T2.type = 'junior'",
        "pred_time": 0.0011353492736816406,
        "orig_time": 0.0010638236999511719,
        "time_ratio": 0.9370012599748005,
        "check": false
    },
    {
        "id": "financial",
        "question": "How much is the average amount in credit card made by account holders in a month, in year 2021?",
        "original_query": "SELECT AVG(T3.amount) FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE STRFTIME('%Y', T3.date) = '2021' AND T3.operation = 'VYBER KARTOU'",
        "llm_output": "-- Reasoning\nTo find the average amount in credit card transactions made by account holders in a month for the year 2021, we join the account table with the trans table using account_id and then filter for credit card transactions by checking the type column. We also filter for the year 2021 and group by month and year before calculating the average transaction amount.\n\n-- SQL Query\nSELECT AVG(amount)\nFROM trans AS T2\nINNER JOIN account AS T1 ON T2.account_id = T1.account_id\nWHERE date LIKE '2021-%'\nAND T2.type = 'Credit';",
        "pred_query": "SELECT AVG(amount)\nFROM trans AS T2\nINNER JOIN account AS T1 ON T2.account_id = T1.account_id\nWHERE date LIKE '2021-%'\nAND T2.type = 'Credit';",
        "pred_time": null,
        "orig_time": 0.25739359855651855,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Who are the account holder identification numbers whose spent per month on the credit card is less than the average, in 1998?",
        "original_query": "SELECT T1.account_id FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE STRFTIME('%Y', T1.date) = '1998' AND T1.operation = 'VYBER KARTOU' AND T1.amount < (SELECT AVG(amount) FROM trans WHERE STRFTIME('%Y', date) = '1998')",
        "llm_output": "-- Reasoning\nWe need to find the account holder IDs with spending less than the average in 1998. First, calculate the average monthly spending in 1998 for all accounts, then join the account and transaction tables to get the monthly spending for each account. Finally, filter and return the account holder IDs where the spending per month is less than the average.\n\n-- SQL Query\nSELECT T1.account_id\nFROM account AS T1\nINNER JOIN (\n    SELECT T4.account_id, \n           SUM(T5.amount) / COUNT(DISTINCT STRFTIME('%m', T5.date)) as avg_monthly_spending\n    FROM account AS T4\n    INNER JOIN trans AS T5 ON T4.account_id = T5.account_id\n    WHERE STRFTIME('%Y', T5.date) = '1998'\n    GROUP BY T4.account_id\n) AS avg_spending ON T1.account_id = avg_spending.account_id\nINNER JOIN trans AS T6 ON T1.account_id = T6.account_id\nWHERE STRFTIME('%Y', T6.date) = '1998' AND \n      T6.amount < avg_spending.avg_monthly_spending;",
        "pred_query": "SELECT T1.account_id\nFROM account AS T1\nINNER JOIN (\n    SELECT T4.account_id, \n           SUM(T5.amount) / COUNT(DISTINCT STRFTIME('%m', T5.date)) as avg_monthly_spending\n    FROM account AS T4\n    INNER JOIN trans AS T5 ON T4.account_id = T5.account_id\n    WHERE STRFTIME('%Y', T5.date) = '1998'\n    GROUP BY T4.account_id\n) AS avg_spending ON T1.account_id = avg_spending.account_id\nINNER JOIN trans AS T6 ON T1.account_id = T6.account_id\nWHERE STRFTIME('%Y', T6.date) = '1998' AND \n      T6.amount < avg_spending.avg_monthly_spending;",
        "pred_time": 0.9584469795227051,
        "orig_time": 0.6828405857086182,
        "time_ratio": 0.7124448198988164,
        "check": false
    },
    {
        "id": "financial",
        "question": "Who are the female account holders who own credit cards and also have loans?",
        "original_query": "SELECT T1.client_id FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id INNER JOIN card AS T4 ON T2.disp_id = T4.disp_id WHERE T1.gender = 'F'",
        "llm_output": "-- Reasoning\nWe need the first and last names of female account holders who have a credit card and also have a loan. First, we join the account, disp, and client tables using the account ID to get the information of account holders. Then, we filter the table for clients with a gender of 'F' (representing female) and have a disp ID in the card table (indicating they own a credit card). Next, we also filter the table by joining the account and loan tables to find account holders who have a loan. Finally, we return the full names of these account holders.\n\n-- SQL Query\nSELECT T2.first_name, T2.last_name\nFROM account AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nINNER JOIN client AS T3 ON T1.district_id = T3.district_id\nINNER JOIN card AS T4 ON T2.disp_id = T4.disp_id\nINNER JOIN loan AS T5 ON T1.account_id = T5.account_id\nWHERE T3.gender = 'F'\n    AND T4.type = 'Credit';",
        "pred_query": "SELECT T2.first_name, T2.last_name\nFROM account AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nINNER JOIN client AS T3 ON T1.district_id = T3.district_id\nINNER JOIN card AS T4 ON T2.disp_id = T4.disp_id\nINNER JOIN loan AS T5 ON T1.account_id = T5.account_id\nWHERE T3.gender = 'F'\n    AND T4.type = 'Credit';",
        "pred_time": null,
        "orig_time": 0.0022857189178466797,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many female clients' accounts are in the region of South Bohemia?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'F' AND T2.A3 = 'south Bohemia'",
        "llm_output": "-- Reasoning\nFirst, we need to identify the female clients. We join the client table with the district table, filter clients of gender 'Female', and return the corresponding district ID. Then we join the account table with the district table again to get the accounts of districts found previously.\n\n-- SQL Query\nSELECT COUNT(T2.account_id)\nFROM district AS T1\nINNER JOIN client AS T2 ON T1.district_id = T2.district_id\nINNER JOIN account AS T3 ON T2.district_id = T3.district_id\nWHERE T2.gender = 'Female'\nAND T1.A2 = 'South Bohemia';",
        "pred_query": "SELECT COUNT(T2.account_id)\nFROM district AS T1\nINNER JOIN client AS T2 ON T1.district_id = T2.district_id\nINNER JOIN account AS T3 ON T2.district_id = T3.district_id\nWHERE T2.gender = 'Female'\nAND T1.A2 = 'South Bohemia';",
        "pred_time": null,
        "orig_time": 0.0014872550964355469,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please list the accounts whose district is Tabor that are eligible for loans.",
        "original_query": "SELECT T2.account_id FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T2.account_id = T3.account_id WHERE T3.type = 'OWNER' AND T1.A2 = 'Tabor'",
        "llm_output": "-- Reasoning\nTo find accounts eligible for loans in Tabor district, we need to join the account and district tables using district_id. Then, we should filter accounts for the desired district, and finally, select those accounts that meet the loan eligibility criteria (which is not explicitly stated in the schema; assuming it can be derived from the loan table where the status is 'active'). \n\n-- SQL Query\nSELECT T1.account_id\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A2 = 'Tabor' AND T1.account_id IN (\n    SELECT T4.account_id\n    FROM account AS T1\n    INNER JOIN loan AS T2 ON T1.account_id = T2.account_id\n    WHERE T2.status = 'Active'\n);",
        "pred_query": "SELECT T1.account_id\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A2 = 'Tabor' AND T1.account_id IN (\n    SELECT T4.account_id\n    FROM account AS T1\n    INNER JOIN loan AS T2 ON T1.account_id = T2.account_id\n    WHERE T2.status = 'Active'\n);",
        "pred_time": null,
        "orig_time": 0.001981973648071289,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please list the account types that are not eligible for loans, and the average income of residents in the district where the account is located exceeds $8000 but is no more than $9000.",
        "original_query": "SELECT T3.type FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T2.account_id = T3.account_id WHERE T3.type != 'OWNER' AND T1.A11 BETWEEN 8000 AND 9000",
        "llm_output": "-- Reasoning\nTo answer the question, we need to find account types that are not eligible for loans, which are those with a balance less than 1000. We also need to find districts where the average income of residents is between $8000 and $9000. We perform a join on the account and district tables using the account_id and district_id columns. We then filter for accounts with a balance less than 1000 and for districts with an average income between $8000 and $9000. The account types eligible for loans are filtered out from the result set because we are interested in those that are not eligible.\n\n-- SQL Query\nSELECT DISTINCT T4.type \nFROM account AS T1\nINNER JOIN account_type AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T1.district_id = T3.district_id\nINNER JOIN trans AS T4 ON T1.account_id = T4.account_id\nWHERE T1.balance < 1000\nAND T3.A8 > 8000 AND T3.A8 <= 9000;",
        "pred_query": "SELECT DISTINCT T4.type \nFROM account AS T1\nINNER JOIN account_type AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T1.district_id = T3.district_id\nINNER JOIN trans AS T4 ON T1.account_id = T4.account_id\nWHERE T1.balance < 1000\nAND T3.A8 > 8000 AND T3.A8 <= 9000;",
        "pred_time": null,
        "orig_time": 0.0015537738800048828,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts in North Bohemia has made a transaction with the partner's bank being AB?",
        "original_query": "SELECT COUNT(T2.account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T3.bank = 'AB' AND T1.A3 = 'north Bohemia'",
        "llm_output": "-- Reasoning\nWe filter the trans table for transactions involving a partner bank with 'AB'. Then, we join this result with the account table to get the corresponding account IDs and finally filter with the districts with A2 matching 'North Bohemia' using the district table.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM trans AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T3.district_id = T2.district_id\nWHERE T3.A2 LIKE 'North Bohemia'\nAND T1.bank LIKE 'AB';",
        "pred_query": "SELECT COUNT(*)\nFROM trans AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T3.district_id = T2.district_id\nWHERE T3.A2 LIKE 'North Bohemia'\nAND T1.bank LIKE 'AB';",
        "pred_time": 0.09057760238647461,
        "orig_time": 0.08123946189880371,
        "time_ratio": 0.8969045300202679,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please list the name of the districts with accounts that made withdrawal transactions.",
        "original_query": "SELECT DISTINCT T1.A2 FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T3.type = 'VYDAJ'",
        "llm_output": "-- Reasoning\nWe need to find the names of the districts that have accounts that made withdrawal transactions. To achieve this, we will first join the account table with the district table using the district_id column. Then, we will join this combined table with the trans table based on the account_id to find the transactions. To find withdrawal transactions, we will filter the transaction type to match 'Withdrawal'. Finally, we will select the district name from the district table.\n\n-- SQL Query\nSELECT T1.A3\nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nWHERE T3.type = 'Withdrawal'",
        "pred_query": "SELECT T1.A3\nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nWHERE T3.type = 'Withdrawal'",
        "pred_time": 0.08747172355651855,
        "orig_time": 0.17419862747192383,
        "time_ratio": 1.9914850238359367,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the average number of crimes committed in 1995 in regions where the number exceeds 4000 and the region has accounts that are opened starting from the year 1997?",
        "original_query": "SELECT AVG(T1.A15) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T2.date) >= '1997' AND T1.A15 > 4000",
        "llm_output": "-- Reasoning\nWe join account, district, and trans tables using their IDs. Filter for regions where the number of residents exceeds 4000 and districts with accounts opened in 1997 or later. Then, filter transactions from the year 1995, group by district, and return the average number of crimes (trans type equals 'Crime').\n\n-- SQL Query\nSELECT avg(CASE WHEN T4.type = 'Crime' THEN 1 ELSE 0 END) \nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3 ON T1.account_id = T3.account_id\nINNER JOIN district as subquery \nON subquery.district_id = T2.district_id AND \n   subquery.A8  >  4000 AND \n   (  STRFTIME('%Y', subquery.date)  >=  '1997' OR \n     T2.district_id IN ( \n       SELECT T1.district_id \n       FROM account AS T1\n       INNER JOIN trans AS T5 ON T1.account_id = T5.account_id \n       WHERE STRFTIME('%Y', T5.date) >=  '1997'\n     )\n   )\nWHERE STRFTIME('%Y', T3.date)  =  '1995'",
        "pred_query": "SELECT avg(CASE WHEN T4.type = 'Crime' THEN 1 ELSE 0 END) \nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3 ON T1.account_id = T3.account_id\nINNER JOIN district as subquery \nON subquery.district_id = T2.district_id AND \n   subquery.A8  >  4000 AND \n   (  STRFTIME('%Y', subquery.date)  >=  '1997' OR \n     T2.district_id IN ( \n       SELECT T1.district_id \n       FROM account AS T1\n       INNER JOIN trans AS T5 ON T1.account_id = T5.account_id \n       WHERE STRFTIME('%Y', T5.date) >=  '1997'\n     )\n   )\nWHERE STRFTIME('%Y', T3.date)  =  '1995'",
        "pred_time": null,
        "orig_time": 0.002074003219604492,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many 'classic' cards are eligible for loan?",
        "original_query": "SELECT COUNT(T1.card_id) FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id WHERE T1.type = 'classic' AND T2.type = 'Owner'",
        "llm_output": "-- Question\nHow many 'classic' cards are eligible for loan?\n\n-- Reasoning\nWe first join the card table with the loan table using their account IDs, since a card is eligible for loan if it has at least one associated account that has participated in a loan. We then count how many cards are of type 'classic' and meet the condition that their associated account has at least one loan entry. We use the DISTINCT keyword to prevent duplicate counts. The final count is returned as the result.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T2.disp_id)\nFROM loan AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE T3.type = 'classic' AND T1.status = 'approved';",
        "pred_query": "SELECT COUNT(DISTINCT T2.disp_id)\nFROM loan AS T1\nINNER JOIN disp AS T2 ON T1.account_id = T2.account_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE T3.type = 'classic' AND T1.status = 'approved';",
        "pred_time": 0.0012068748474121094,
        "orig_time": 0.0007853507995605469,
        "time_ratio": 0.6507309363887791,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many male clients in 'Hl.m. Praha' district?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE T1.gender = 'M' AND T2.A2 = 'Hl.m. Praha'",
        "llm_output": "-- Reasoning\nWe need to count all male clients whose district is 'Hl.m. Praha'. Join clients and district tables on id, filter for 'Hl.m. Praha' district, and return the count of males.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A2 = 'Hl.m. Praha'\nAND T1.gender = 'Male';",
        "pred_query": "SELECT COUNT(*)\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T2.A2 = 'Hl.m. Praha'\nAND T1.gender = 'Male';",
        "pred_time": 0.001399993896484375,
        "orig_time": 0.0013628005981445312,
        "time_ratio": 0.973433242506812,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many percent of 'Gold' cards were issued prior to 1998?",
        "original_query": "SELECT CAST(SUM(type = 'gold') AS REAL) * 100 / COUNT(card_id) FROM card WHERE STRFTIME('%Y', issued) < '1998'",
        "llm_output": "-- Reasoning\nWe need to calculate the percentage of 'Gold' cards that were issued prior to 1998. To achieve this, we must join the cards table with its counterpart, disp, on disp_id, select both tables where card type equals 'Gold' and issue date is before 1998. We then divide the count of these results by the total number of 'Gold' cards and multiply by 100 to obtain a percentage.\n\n-- SQL Query\nSELECT CAST(COUNT(CASE WHEN T2.type = 'Gold' AND date('2000', T2.issued) < DATE('2000', '1998') THEN T2.card_id ELSE NULL END) AS REAL) * 100 / COUNT(T2.card_id) FROM card AS T2 INNER JOIN disp AS T1 ON T1.disp_id = T2.disp_id",
        "pred_query": "SELECT CAST(COUNT(CASE WHEN T2.type = 'Gold' AND date('2000', T2.issued) < DATE('2000', '1998') THEN T2.card_id ELSE NULL END) AS REAL) * 100 / COUNT(T2.card_id) FROM card AS T2 INNER JOIN disp AS T1 ON T1.disp_id = T2.disp_id",
        "pred_time": 0.0013113021850585938,
        "orig_time": 0.000762939453125,
        "time_ratio": 0.5818181818181818,
        "check": false
    },
    {
        "id": "financial",
        "question": "Who is the owner of the account with the largest loan amount?",
        "original_query": "SELECT T1.client_id FROM disp AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T1.type = 'OWNER' ORDER BY T2.amount DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe join the account and client tables using district_id to get the owner of each account, then filter the accounts having a loan with the highest amount.\n\n-- SQL Query\nSELECT T2.Gender, T2.district_id, T2.client_id \nFROM account AS T1\nINNER JOIN client AS T2 ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3 ON T1.account_id = T3.account_id\nORDER BY T3.Amount DESC\nLIMIT 1;",
        "pred_query": "SELECT T2.Gender, T2.district_id, T2.client_id \nFROM account AS T1\nINNER JOIN client AS T2 ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3 ON T1.account_id = T3.account_id\nORDER BY T3.Amount DESC\nLIMIT 1;",
        "pred_time": 0.009265422821044922,
        "orig_time": 0.0012204647064208984,
        "time_ratio": 0.1317225052750759,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the number of committed crimes in 1995 in the district of the account with the id 532?",
        "original_query": "SELECT T1.A15 FROM district AS T1 INNER JOIN `account` AS T2 ON T1.district_id = T2.district_id WHERE T2.account_id = 532",
        "llm_output": "-- Reasoning\nTo find the number of committed crimes in 1995 in the district of the account with id 532, we need to filter the account with id 532 from the account table, join it with the district table, filter crimes from the year 1995, and count the corresponding trans actions.\n\n-- SQL Query\nSELECT COUNT(T2.trans_id) \nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nWHERE T1.district_id = 532\n  AND STRFTIME('%Y', T3.date) = '1995'\n  AND T3.operation IS NOT NULL",
        "pred_query": "SELECT COUNT(T2.trans_id) \nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nWHERE T1.district_id = 532\n  AND STRFTIME('%Y', T3.date) = '1995'\n  AND T3.operation IS NOT NULL",
        "pred_time": null,
        "orig_time": 0.0005047321319580078,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the district Id of the account that placed the order with the id 33333?",
        "original_query": "SELECT T3.district_id FROM `order` AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN district AS T3 ON T2.district_id = T3.district_id WHERE T1.order_id = 33333",
        "llm_output": "-- Reasoning\nWe need the district Id of the account associated with the order with id 33333. Join the accounts table with the orders table using account_id, filter for the order with id 33333, and return the district Id.\n\n-- SQL Query\nSELECT T1.district_id\nFROM account AS T1\nINNER JOIN `order` AS T2 ON T1.account_id = T2.account_id\nWHERE T2.order_id = 33333;",
        "pred_query": "SELECT T1.district_id\nFROM account AS T1\nINNER JOIN `order` AS T2 ON T1.account_id = T2.account_id\nWHERE T2.order_id = 33333;",
        "pred_time": 0.0011267662048339844,
        "orig_time": 0.0005233287811279297,
        "time_ratio": 0.4644519678374947,
        "check": true
    },
    {
        "id": "financial",
        "question": "List all the withdrawals in cash transactions that the client with the id 3356 makes.",
        "original_query": "SELECT T4.trans_id FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN account AS T3 ON T2.account_id = T3.account_id INNER JOIN trans AS T4 ON T3.account_id = T4.account_id WHERE T1.client_id = 3356 AND T4.operation = 'VYBER'",
        "llm_output": "-- Reasoning\nWe start by joining the account, disp, and trans tables using their IDs to establish the client's transactions. Then, we filter for transactions where the type is 'WITHDRAWAL' and the date is a date value (not NULL). We join the client table with the disp table (using the client_id) to filter for transactions made by the client with id 3356. Finally, we filter for cash transactions by selecting trans_id where the type is 'Withdrawal, Cash only'. \n\n-- SQL Query\nSELECT T2.trans_id\nFROM disp AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nINNER JOIN client AS T4 ON T1.client_id = T4.client_id\nWHERE T3.type IN ('Withdrawal')\nAND T3.date IS NOT NULL\nAND T1.client_id = 3356\nAND T3.type = 'Withdrawal, Cash only';",
        "pred_query": "SELECT T2.trans_id\nFROM disp AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nINNER JOIN client AS T4 ON T1.client_id = T4.client_id\nWHERE T3.type IN ('Withdrawal')\nAND T3.date IS NOT NULL\nAND T1.client_id = 3356\nAND T3.type = 'Withdrawal, Cash only';",
        "pred_time": null,
        "orig_time": 0.18216466903686523,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Among the weekly issuance accounts, how many have a loan of under 200000?",
        "original_query": "SELECT COUNT(T1.account_id) FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T2.frequency = 'POPLATEK TYDNE' AND T1.amount < 200000",
        "llm_output": "-- Question\nAmong the weekly issuance accounts, how many have a loan of under 200000?\n\n-- Reasoning\nWe need the count of account IDs from the account table where the frequency is 'Weekly' and the corresponding maximum amount from the loan table is under 200000. First, join the account and loan tables using account_id. Then, filter for weekly issuance accounts and maximum loan amounts under 200000. Finally, return the count of these accounts.\n\n-- SQL Query\nSELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN loan AS T2 ON T1.account_id = T2.account_id\nWHERE T1.frequency = 'Weekly' AND MAX(T2.amount) < 200000;",
        "pred_query": "SELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN loan AS T2 ON T1.account_id = T2.account_id\nWHERE T1.frequency = 'Weekly' AND MAX(T2.amount) < 200000;",
        "pred_time": null,
        "orig_time": 0.0008904933929443359,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "What type of credit card does the client with the id 13539 own?",
        "original_query": "SELECT T3.type FROM disp AS T1 INNER JOIN client AS T2 ON T1.client_id = T2.client_id INNER JOIN card AS T3 ON T1.disp_id = T3.disp_id WHERE T2.client_id = 13539",
        "llm_output": "-- Reasoning\nWe first look for the card type associated with this client, which involves joining the disp, client, and card tables using their IDs. We filter the query for the client with id 13539 and select the card type from the card table.\n\n-- SQL Query\nSELECT T2.type \nFROM disp AS T1\nINNER JOIN client AS T3 ON T1.client_id = T3.client_id\nINNER JOIN card AS T2 ON T1.disp_id = T2.disp_id\nWHERE T3.client_id = 13539;",
        "pred_query": "SELECT T2.type \nFROM disp AS T1\nINNER JOIN client AS T3 ON T1.client_id = T3.client_id\nINNER JOIN card AS T2 ON T1.disp_id = T2.disp_id\nWHERE T3.client_id = 13539;",
        "pred_time": 0.0008041858673095703,
        "orig_time": 0.0005998611450195312,
        "time_ratio": 0.7459235102282834,
        "check": true
    },
    {
        "id": "financial",
        "question": "What is the region of the client with the id 3541 from?",
        "original_query": "SELECT T2.district_id, T1.A3 FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T2.client_id = 3541",
        "llm_output": "-- Reasoning\nTo find the region of the client with the id 3541, we first need to join the client table with the district table using the district_id foreign key. We will then filter the result to only include the client with id 3541. Finally, we will select the A2 column from the district table, which corresponds to the region.\n\n-- SQL Query\nSELECT T2.A2\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.client_id = 3541;",
        "pred_query": "SELECT T2.A2\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.client_id = 3541;",
        "pred_time": 0.0009567737579345703,
        "orig_time": 0.0004889965057373047,
        "time_ratio": 0.5110889608771493,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which district has the most accounts with loan contracts finished with no problems?",
        "original_query": "SELECT T1.district_id FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id WHERE T3.status = 'A' GROUP BY T1.district_id ORDER BY COUNT(T2.account_id) DESC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need to find the district with the most loan contracts finished with no problems. To do this, we join the loan and account tables using their IDs. We filter loans that finished (status is not active and date is not null) and also exclude loans that were cancelled (status is not 'cancelled') or active. We then aggregate by district and count the number of such loans for each district, returning those with the maximum count.\n\n-- SQL Query\nSELECT T1.district_id, COUNT(T3.account_id) AS count\nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3 ON T2.account_id = T3.account_id\nWHERE T3.status != 'active' AND T3.status != 'cancelled' AND T3.date IS NOT NULL\nGROUP BY T1.district_id\nORDER BY count DESC\nLIMIT 1",
        "pred_query": "SELECT T1.district_id, COUNT(T3.account_id) AS count\nFROM district AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN loan AS T3 ON T2.account_id = T3.account_id\nWHERE T3.status != 'active' AND T3.status != 'cancelled' AND T3.date IS NOT NULL\nGROUP BY T1.district_id\nORDER BY count DESC\nLIMIT 1",
        "pred_time": 0.0017902851104736328,
        "orig_time": 0.0007839202880859375,
        "time_ratio": 0.43787455053935276,
        "check": false
    },
    {
        "id": "financial",
        "question": "Who placed the order with the id 32423?",
        "original_query": "SELECT T3.client_id FROM `order` AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN client AS T3 ON T2.district_id = T3.district_id WHERE T1.order_id = 32423",
        "llm_output": "-- Reasoning\nWe join the account table with the order table using the account_id, filter for the desired order_id, and return the district_id of the corresponding account.\n\n-- SQL Query\nSELECT T1.account_id\nFROM account AS T1\nINNER JOIN `order` AS T2 ON T1.account_id = T2.account_id\nWHERE T2.order_id = 32423;",
        "pred_query": "SELECT T1.account_id\nFROM account AS T1\nINNER JOIN `order` AS T2 ON T1.account_id = T2.account_id\nWHERE T2.order_id = 32423;",
        "pred_time": 0.0011420249938964844,
        "orig_time": 0.0009334087371826172,
        "time_ratio": 0.8173277661795407,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please list all the transactions made by accounts from district 5.",
        "original_query": "SELECT T3.trans_id FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T1.district_id = 5",
        "llm_output": "-- Reasoning\nWe join the account and trans tables using their IDs, filter the account table by district_id 5, and select all transactions (trans_id, date, type, amount, balance) from the trans table.\n\n-- SQL Query\nSELECT T1.trans_id, T1.date, T1.type, T1.amount, T1.balance\nFROM trans AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nWHERE T2.district_id = 5;",
        "pred_query": "SELECT T1.trans_id, T1.date, T1.type, T1.amount, T1.balance\nFROM trans AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nWHERE T2.district_id = 5;",
        "pred_time": 0.0993344783782959,
        "orig_time": 0.09635138511657715,
        "time_ratio": 0.9699692059552755,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many of the accounts are from Jesenik district?",
        "original_query": "SELECT COUNT(T2.account_id) FROM district AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE T1.A2 = 'Jesenik'",
        "llm_output": "-- Reasoning\nWe select the count of rows from the account table where the district_id column matches the one from Jesenik district. We assume that the database contains a list of district names.\n\n-- SQL Query\nSELECT COUNT(*) \nFROM account \nWHERE district_id IN ( SELECT district_id FROM district WHERE A2 = 'Jesenik' );",
        "pred_query": "SELECT COUNT(*) \nFROM account \nWHERE district_id IN ( SELECT district_id FROM district WHERE A2 = 'Jesenik' );",
        "pred_time": 0.0015153884887695312,
        "orig_time": 0.0014908313751220703,
        "time_ratio": 0.9837948395217118,
        "check": true
    },
    {
        "id": "financial",
        "question": "List all the clients' IDs whose junior credit cards were issued after 1996.",
        "original_query": "SELECT T2.client_id FROM card AS T1 INNER JOIN disp AS T2 ON T1.disp_id = T2.disp_id WHERE T1.type = 'junior' AND T1.issued >= '1997-01-01'",
        "llm_output": "-- Reasoning\nWe need the client IDs of those who have junior credit cards. Join the disp table with card using disp_id, filter for credit cards issued after 1996, and return the client IDs of the corresponding clients.\n\n-- SQL Query\nSELECT T2.client_id\nFROM disp AS T1\nINNER JOIN card AS T2 ON T1.disp_id = T2.disp_id\nINNER JOIN client AS T3 ON T1.client_id = T3.client_id\nWHERE STRFTIME('%Y', T2.issued) > '1996'\nAND T2.type = 'Junior Credit Card';",
        "pred_query": "SELECT T2.client_id\nFROM disp AS T1\nINNER JOIN card AS T2 ON T1.disp_id = T2.disp_id\nINNER JOIN client AS T3 ON T1.client_id = T3.client_id\nWHERE STRFTIME('%Y', T2.issued) > '1996'\nAND T2.type = 'Junior Credit Card';",
        "pred_time": null,
        "orig_time": 0.0008342266082763672,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "What percentage of clients who opened their accounts in the district with an average salary of over 10000 are women?",
        "original_query": "SELECT CAST(SUM(T2.gender = 'F') AS REAL) * 100 / COUNT(T2.client_id) FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T1.A11 > 10000",
        "llm_output": "-- Reasoning\nFirst, we need to find the district with an average salary over 10000. We can do this by joining the district and account tables to access the average salary information. Since the client has a foreign key to account which has a foreign key to district, these tables can be easily joined. Next, we filter for the district with an average salary greater than 10000 and count the number of clients within this district. To get the percentage of women, we divide this count by the total count of clients in the district and multiply by 100. \n\nWe need to access the information of clients and count the number of women. Since the client table has a foreign key to district and an account, which is related to the district we are filtering for, this can be done using a subquery.\n\n-- SQL Query\nSELECTROUND(\n  ( COUNT(CASE WHEN gender = 'female' THEN client_id ELSE NULL END) \n    / \n    (\n      SELECT COUNT(client_id) \n      FROM client\n      WHERE district_id = (\n        SELECT district_id \n        FROM (\n          SELECT A8, district_id \n          FROM account AS T1\n          INNER JOIN district AS T2 ON T1.district_id = T2.district_id\n          GROUP BY T1.account_id, T2.district_id\n          ) AS T3 \n        WHERE T3.A8 > 10000 \n        GROUP BY T3.district_id \n        ORDER BY AVG(T3.A8) DESC \n        LIMIT 1\n        )\n      ) ) * 100, 2 ) AS percentage\nFROM client\nWHERE district_id = (\n  SELECT district_id \n  FROM (\n    SELECT A8, district_id \n    FROM account AS T1\n    INNER JOIN district AS T2 ON T1.district_id = T2.district_id\n    GROUP BY T1.account_id, T2.district_id\n    ) AS T3 \n  WHERE T3.A8 > 10000 \n  GROUP BY T3.district_id \n  ORDER BY AVG(T3.A8) DESC \n  LIMIT 1\n);",
        "pred_query": "SELECTROUND(\n  ( COUNT(CASE WHEN gender = 'female' THEN client_id ELSE NULL END) \n    / \n    (\n      SELECT COUNT(client_id) \n      FROM client\n      WHERE district_id = (\n        SELECT district_id \n        FROM (\n          SELECT A8, district_id \n          FROM account AS T1\n          INNER JOIN district AS T2 ON T1.district_id = T2.district_id\n          GROUP BY T1.account_id, T2.district_id\n          ) AS T3 \n        WHERE T3.A8 > 10000 \n        GROUP BY T3.district_id \n        ORDER BY AVG(T3.A8) DESC \n        LIMIT 1\n        )\n      ) ) * 100, 2 ) AS percentage\nFROM client\nWHERE district_id = (\n  SELECT district_id \n  FROM (\n    SELECT A8, district_id \n    FROM account AS T1\n    INNER JOIN district AS T2 ON T1.district_id = T2.district_id\n    GROUP BY T1.account_id, T2.district_id\n    ) AS T3 \n  WHERE T3.A8 > 10000 \n  GROUP BY T3.district_id \n  ORDER BY AVG(T3.A8) DESC \n  LIMIT 1\n);",
        "pred_time": null,
        "orig_time": 0.0016129016876220703,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "What was the growth rate of the total amount of loans across all accounts for a male client between 1996 and 1997?",
        "original_query": "SELECT CAST((SUM(CASE WHEN STRFTIME('%Y', T1.date) = '1997' THEN T1.amount ELSE 0 END) - SUM(CASE WHEN STRFTIME('%Y', T1.date) = '1996' THEN T1.amount ELSE 0 END)) AS REAL) * 100 / SUM(CASE WHEN STRFTIME('%Y', T1.date) = '1996' THEN T1.amount ELSE 0 END) FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN disp AS T3 ON T3.account_id = T2.account_id INNER JOIN client AS T4 ON T4.client_id = T3.client_id WHERE T4.gender = 'M' AND T3.type = 'OWNER'",
        "llm_output": "-- Reasoning\nTo answer the question, we first need to calculate the total amount of loans for each year. We filter the loan table for male clients (gender = 'M') and calculate the total amount for each year using the STRFTIME function. We then subtract the total amount for 1996 from the total amount for 1997 to calculate the growth rate.\n\n -- SQL Query\nSELECT \n  ((SUM(CASE WHEN STRFTIME('%Y', L1.date) = '1997' THEN L1.amount END) - \n    SUM(CASE WHEN STRFTIME('%Y', L1.date) = '1996' THEN L1.amount END)) \n   /  \n   SUM(CASE WHEN STRFTIME('%Y', L1.date) = '1996' THEN L1.amount END) ) * 100\nFROM \n  loan AS L1\nINNER JOIN \n  client AS C1 ON L1.account_id = C1.account_id\nWHERE \n  C1.gender = 'M';",
        "pred_query": "SELECT \n  ((SUM(CASE WHEN STRFTIME('%Y', L1.date) = '1997' THEN L1.amount END) - \n    SUM(CASE WHEN STRFTIME('%Y', L1.date) = '1996' THEN L1.amount END)) \n   /  \n   SUM(CASE WHEN STRFTIME('%Y', L1.date) = '1996' THEN L1.amount END) ) * 100\nFROM \n  loan AS L1\nINNER JOIN \n  client AS C1 ON L1.account_id = C1.account_id\nWHERE \n  C1.gender = 'M';",
        "pred_time": null,
        "orig_time": 0.002530813217163086,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many credit card withdrawals were recorded after 1995?",
        "original_query": "SELECT COUNT(account_id) FROM trans WHERE STRFTIME('%Y', date) > '1995' AND operation = 'VYBER KARTOU'",
        "llm_output": "-- Reasoning\nWe filter transactions where the date is after 1995 and the transaction type is 'Credit card', then return the count of such transactions.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM trans\nWHERE STRFTIME('%Y', date) > '1995'\n    AND type LIKE 'Credit card';",
        "pred_query": "SELECT COUNT(*)\nFROM trans\nWHERE STRFTIME('%Y', date) > '1995'\n    AND type LIKE 'Credit card';",
        "pred_time": 0.2860445976257324,
        "orig_time": 0.28662896156311035,
        "time_ratio": 1.0020429119872507,
        "check": false
    },
    {
        "id": "financial",
        "question": "What was the difference in the number of crimes committed in East and North Bohemia in 1996?",
        "original_query": "SELECT SUM(IIF(A3 = 'East Bohemia', A16, 0)) - SUM(IIF(A3 = 'North Bohemia', A16, 0)) FROM district",
        "llm_output": "-- Reasoning\nTo find the difference in the number of crimes committed in East and North Bohemia in 1996, we need to first identify the districts of these regions, then count the number of trans operations in each district in 1996, and finally subtract the count for East Bohemia from the count for North Bohemia.\n\n-- SQL Query\nWITH east_bohemia AS (\n  SELECT COUNT(*) as num_crimes\n  FROM account AS T1\n  INNER JOIN trans AS T2 ON T1.account_id = T2.account_id\n  INNER JOIN district AS T3 ON T1.district_id = T3.district_id\n  WHERE STRFTIME('%Y', T2(date)) = '1996' AND T3.A2 = 'Kraj V\u00fdchodn\u00edch \u010cech'\n),\nnorth_bohemia AS (\n  SELECT COUNT(*) as num_crimes\n  FROM account AS T1\n  INNER JOIN trans AS T2 ON T1.account_id = T2.account_id\n  INNER JOIN district AS T3 ON T1.district_id = T3.district_id\n  WHERE STRFTIME('%Y', T2(date)) = '1996' AND T3.A2 = 'Kraj Severov\u00fdchodn\u00edch \u010cech'\n)\nSELECT north_bohemia.num_crimes - east_bohemia.num_crimes as difference",
        "pred_query": "SELECT COUNT(*) as num_crimes\n  FROM account AS T1\n  INNER JOIN trans AS T2 ON T1.account_id = T2.account_id\n  INNER JOIN district AS T3 ON T1.district_id = T3.district_id\n  WHERE STRFTIME('%Y', T2(date)) = '1996' AND T3.A2 = 'Kraj V\u00fdchodn\u00edch \u010cech'\n),\nnorth_bohemia AS (\n  SELECT COUNT(*) as num_crimes\n  FROM account AS T1\n  INNER JOIN trans AS T2 ON T1.account_id = T2.account_id\n  INNER JOIN district AS T3 ON T1.district_id = T3.district_id\n  WHERE STRFTIME('%Y', T2(date)) = '1996' AND T3.A2 = 'Kraj Severov\u00fdchodn\u00edch \u010cech'\n)\nSELECT north_bohemia.num_crimes - east_bohemia.num_crimes as difference",
        "pred_time": null,
        "orig_time": 0.0005216598510742188,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many owner and disponent dispositions are there from account number 1 to account number 10?",
        "original_query": "SELECT SUM(type = 'Owner') , SUM(type = 'Disponent') FROM disp WHERE account_id BETWEEN 1 AND 10",
        "llm_output": "-- Reasoning\nTo find the number of owner and disponent dispositions from account number 1 to account number 10, we first select the count of rows in the disp table where the account_id falls within this range. We join the disp table with account using the account_id, filter for account_id between 1 and 10, and then filter for type as 'Owner' or 'Disponent'. We use OR operator to combine these two conditions.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM disp AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nWHERE T2.account_id BETWEEN 1 AND 10\nAND (T1.type = 'Owner' OR T1.type = 'Disponent');",
        "pred_query": "SELECT COUNT(*)\nFROM disp AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nWHERE T2.account_id BETWEEN 1 AND 10\nAND (T1.type = 'Owner' OR T1.type = 'Disponent');",
        "pred_time": 0.001550912857055664,
        "orig_time": 0.0007462501525878906,
        "time_ratio": 0.4811683320522675,
        "check": false
    },
    {
        "id": "financial",
        "question": "How often does account number 3 request an account statement to be released? What was the aim of debiting 3539 in total?",
        "original_query": "SELECT T1.frequency, T2.k_symbol FROM account AS T1 INNER JOIN `order` AS T2 ON T1.account_id = T2.account_id WHERE T1.account_id = 3 AND T2.amount = 3539",
        "llm_output": "-- Question\nHow often does account number 3 request an account statement to be released? What was the aim of debiting 3539 in total?\n\n-- Reasoning\nWe need to count how many times account number 3 is involved in transactions with the operation type 'Statement'. Additionally, we filter transactions where the aim of debiting is '3539' in total. Join the trans table with account using account_id, filter for the involved account and debiting aim, group by the involved account, and return the count.\n\n-- SQL Query\nSELECT \n    COUNT(CASE WHEN T2.operation = 'Statement' THEN 1 END) AS statement_requests,\n    SUM(CASE WHEN T2.operation = 'Debit' AND T2.amount = 3539 THEN 1 END) AS total_debits\nFROM account AS T1\nINNER JOIN trans AS T2 ON T1.account_id = T2.account_id\nWHERE T1.account_id = 3;",
        "pred_query": "SELECT \n    COUNT(CASE WHEN T2.operation = 'Statement' THEN 1 END) AS statement_requests,\n    SUM(CASE WHEN T2.operation = 'Debit' AND T2.amount = 3539 THEN 1 END) AS total_debits\nFROM account AS T1\nINNER JOIN trans AS T2 ON T1.account_id = T2.account_id\nWHERE T1.account_id = 3;",
        "pred_time": 0.07274866104125977,
        "orig_time": 0.0009579658508300781,
        "time_ratio": 0.01316815783436568,
        "check": false
    },
    {
        "id": "financial",
        "question": "What year was account owner number 130 born?",
        "original_query": "SELECT STRFTIME('%Y', T1.birth_date) FROM client AS T1 INNER JOIN disp AS T3 ON T1.client_id = T3.client_id INNER JOIN account AS T2 ON T3.account_id = T2.account_id WHERE T2.account_id = 130",
        "llm_output": "-- Reasoning\nWe join the account, client, and district tables using their IDs. Next, we filter for account owners with account_id = 130. We select the birth_date from the client table which stores birth information. The date can be extracted as a year.\n\n-- SQL Query\nSELECT SUBSTR(T2.birth_date, 1, 4)\nFROM account AS T1\nINNER JOIN client AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T1.district_id = T3.district_id\nWHERE T1.account_id = 130;\n\n-- The output will be the extracted birth year for account owner number 130.",
        "pred_query": "SELECT SUBSTR(T2.birth_date, 1, 4)\nFROM account AS T1\nINNER JOIN client AS T2 ON T1.account_id = T2.account_id\nINNER JOIN district AS T3 ON T1.district_id = T3.district_id\nWHERE T1.account_id = 130;",
        "pred_time": null,
        "orig_time": 0.0009965896606445312,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts have an owner disposition and request for a statement to be generated upon a transaction?",
        "original_query": "SELECT COUNT(T1.account_id) FROM account AS T1 INNER JOIN disp AS T2 ON T1.account_id = T2.account_id WHERE T2.type = 'OWNER' AND T1.frequency = 'POPLATEK PO OBRATU'",
        "llm_output": "-- Reasoning\nWe need the count of accounts where the owner's disposition is 'Yes' and there is a transaction operation of type 'Withdrawl' that resulted in a statement generation request.\n\nWe join the trans table with the trans table itself (for self-join) on account_id and then with the account table to filter accounts with owner's disposition 'Yes', then filter the trans table to only include Withdrawl operations that resulted in a statement generation request.\n\n-- SQL Query\nSELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN trans AS T2 ON T1.account_id = T2.account_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nWHERE T1.owner_disposition = 'Yes'\nAND T3.operation = 'statement request'\nAND T2.type = 'Withdrawl';",
        "pred_query": "SELECT COUNT(T1.account_id)\nFROM account AS T1\nINNER JOIN trans AS T2 ON T1.account_id = T2.account_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nWHERE T1.owner_disposition = 'Yes'\nAND T3.operation = 'statement request'\nAND T2.type = 'Withdrawl';",
        "pred_time": null,
        "orig_time": 0.0018870830535888672,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the amount of debt that client number 992 has, and how is this client doing with payments?",
        "original_query": "SELECT T3.amount, T3.status FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id WHERE T1.client_id = 992",
        "llm_output": "-- Reasoning\nWe need to join the disp and client tables using client_id to find client information. Then, we join the disp table with the loan table using account_id to find all loans associated with this client. We return the total loan amount along with the average payment percentage.\n\n-- SQL Query\nSELECT T1.disp_id, SUM(T3.amount) AS total_debt, AVG(T4.payments) as average_payment_percentage\nFROM disp AS T1\nINNER JOIN client AS T2 ON T1.client_id = T2.client_id\nINNER JOIN loan AS T3 ON T1.account_id = T3.account_id\nINNER JOIN `order` AS T4 ON T1.account_id = T4.account_id\nWHERE T2.client_id = 992",
        "pred_query": "SELECT T1.disp_id, SUM(T3.amount) AS total_debt, AVG(T4.payments) as average_payment_percentage\nFROM disp AS T1\nINNER JOIN client AS T2 ON T1.client_id = T2.client_id\nINNER JOIN loan AS T3 ON T1.account_id = T3.account_id\nINNER JOIN `order` AS T4 ON T1.account_id = T4.account_id\nWHERE T2.client_id = 992",
        "pred_time": null,
        "orig_time": 0.0010609626770019531,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the sum that client number 4's account has following transaction 851? Who owns this account, a man or a woman?",
        "original_query": "SELECT T3.balance, T1.gender FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE T1.client_id = 4 AND T3.trans_id = 851",
        "llm_output": "-- Reasoning\nTo find the sum that client number 4's account has following transaction 851, we need to first find the account_id associated with client_id 4, which can be done by joining the disp and client tables. Then, we can filter the disp table to get the account_id that corresponds to transaction 851 by joining it with the trans table. We use the account_id to join the account and trans tables, filter for the correct trans_id, and finally return the corresponding amount.\n\n-- SQL Query\nSELECT T1.balance - T2.balance AS sum\nFROM account AS T1\nINNER JOIN (SELECT T4.account_id, T4.trans_id\n             FROM disp AS T2\n             INNER JOIN client AS T3 ON T2.client_id = T3.client_id\n             INNER JOIN trans AS T4 ON T2.account_id = T4.account_id\n             WHERE T3.client_id = 4) AS T5 ON T1.account_id = T5.account_id\nINNER JOIN trans AS T2 ON T1.account_id = T2.account_id\nWHERE T2.trans_id = 851;",
        "pred_query": "SELECT T1.balance - T2.balance AS sum\nFROM account AS T1\nINNER JOIN (SELECT T4.account_id, T4.trans_id\n             FROM disp AS T2\n             INNER JOIN client AS T3 ON T2.client_id = T3.client_id\n             INNER JOIN trans AS T4 ON T2.account_id = T4.account_id\n             WHERE T3.client_id = 4) AS T5 ON T1.account_id = T5.account_id\nINNER JOIN trans AS T2 ON T1.account_id = T2.account_id\nWHERE T2.trans_id = 851;",
        "pred_time": null,
        "orig_time": 0.0009088516235351562,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Which kind of credit card does client number 9 possess?",
        "original_query": "SELECT T3.type FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN card AS T3 ON T2.disp_id = T3.disp_id WHERE T1.client_id = 9",
        "llm_output": "-- Reasoning\nWe need the disp_id of the client number 9 whose type matches 'Credit'. Join the client and disp tables using client_id, filter for the client with client_id 9, and return the disp_id corresponding to type 'Credit'. Then, join the disp and card tables to find the type of credit card.\n\n-- SQL Query\nSELECT T1.type\nFROM disp AS T1\nINNER JOIN client AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T1.disp_id = T3.disp_id\nWHERE T2.client_id = 9 AND T1.type = 'Credit';",
        "pred_query": "SELECT T1.type\nFROM disp AS T1\nINNER JOIN client AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T1.disp_id = T3.disp_id\nWHERE T2.client_id = 9 AND T1.type = 'Credit';",
        "pred_time": 0.0009856224060058594,
        "orig_time": 0.00083160400390625,
        "time_ratio": 0.8437348814707305,
        "check": false
    },
    {
        "id": "financial",
        "question": "How much, in total, did client number 617 pay for all of the transactions in 1998?",
        "original_query": "SELECT SUM(T3.amount) FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN trans AS T3 ON T2.account_id = T3.account_id WHERE STRFTIME('%Y', T3.date)= '1998' AND T1.client_id = 617",
        "llm_output": "-- Reasoning\nWe need the total amount paid by client number 617 for all transactions in 1998, so we first join the account table with the trans table using their IDs, then filter transactions from the year 1998, filter the desired account based on its client_id, and finally return the sum of the amounts.\n\n-- SQL Query\nSELECT SUM(T3.amount)\nFROM client AS T1\nINNER JOIN account AS T2 ON T1.client_id = T2.account_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nWHERE T1.client_id = 617 AND STRFTIME('%Y', T3.date) = '1998'",
        "pred_query": "SELECT SUM(T3.amount)\nFROM client AS T1\nINNER JOIN account AS T2 ON T1.client_id = T2.account_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nWHERE T1.client_id = 617 AND STRFTIME('%Y', T3.date) = '1998'",
        "pred_time": 0.47142601013183594,
        "orig_time": 0.5611436367034912,
        "time_ratio": 1.190311150940877,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please provide a list of clients who were born between 1983 and 1987 and whose account branch is in East Bohemia, along with their IDs.",
        "original_query": "SELECT T1.client_id, T3.account_id FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN account AS T3 ON T2.district_id = T3.district_id WHERE T2.A3 = 'east Bohemia' AND STRFTIME('%Y', T1.birth_date) BETWEEN '1983' AND '1987'",
        "llm_output": "-- Reasoning\nWe first join the client table with the district table using district_id to link clients with their respective district information. We filter for clients born between 1983 and 1987, then match the district to those in East Bohemia. Finally, we select the client IDs along with all clients who match the conditions.\n\n-- SQL Query\nSELECT T1.client_id\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.gender = 'ALL' AND T1.birth_date BETWEEN '1983-01-01' AND '1987-12-31' \nAND T2.A2 = 'East Bohemia'",
        "pred_query": "SELECT T1.client_id\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.gender = 'ALL' AND T1.birth_date BETWEEN '1983-01-01' AND '1987-12-31' \nAND T2.A2 = 'East Bohemia'",
        "pred_time": 0.0015616416931152344,
        "orig_time": 0.0057277679443359375,
        "time_ratio": 3.667786259541985,
        "check": false
    },
    {
        "id": "financial",
        "question": "Please provide the IDs of the 3 female clients with the largest loans.",
        "original_query": "SELECT T1.client_id FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id INNER JOIN loan AS T3 ON T2.account_id = T3.account_id WHERE T1.gender = 'F' ORDER BY T3.amount DESC LIMIT 3",
        "llm_output": "-- We need the IDs of the 3 clients with the largest loan amounts. We should join the client table with the loan table using client_id, filter for female clients, sort by the amount of the largest loans in descending order, and return the top 3 client IDs.\n\nSELECT T1.client_id\nFROM client AS T1\nINNER JOIN loan AS T2 ON T1.client_id = T2.account_id\nWHERE T1.gender = 'F'\nORDER BY T2.amount DESC\nLIMIT 3;",
        "pred_query": "SELECT T1.client_id\nFROM client AS T1\nINNER JOIN loan AS T2 ON T1.client_id = T2.account_id\nWHERE T1.gender = 'F'\nORDER BY T2.amount DESC\nLIMIT 3;",
        "pred_time": 0.0011017322540283203,
        "orig_time": 0.008668899536132812,
        "time_ratio": 7.86842674745726,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many male customers who were born between 1974 and 1976 have made a payment on their home in excess of $4000?",
        "original_query": "SELECT COUNT(T1.account_id) FROM trans AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id INNER JOIN client AS T3 ON T2.district_id = T3.district_id WHERE STRFTIME('%Y', T3.birth_date) BETWEEN '1974' AND '1976' AND T3.gender = 'M' AND T1.amount > 4000 AND T1.k_symbol = 'SIPO'",
        "llm_output": "-- Question\nHow many male customers who were born between 1974 and 1976 have made a payment on their home in excess of $4000?\n\n-- Reasoning\nWe select first and last names, and the count of male clients who made a payment on their account with the amount greater than 4000, join the client, disp, and trans tables using their IDs, filter male clients born between 1974 and 1976, and join trans to filter accounts where the amount is in excess of 4000.\n\n-- SQL Query\nSELECT COUNT( DISTINCT T1.client_id ) \nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nWHERE T1.gender = 'M'\nAND T1.birth_date BETWEEN '1974-01-01' AND '1976-12-31'\nAND T3.type = 'Home Mortgage'\nAND T3.amount > 4000;",
        "pred_query": "SELECT COUNT( DISTINCT T1.client_id ) \nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN trans AS T3 ON T2.account_id = T3.account_id\nWHERE T1.gender = 'M'\nAND T1.birth_date BETWEEN '1974-01-01' AND '1976-12-31'\nAND T3.type = 'Home Mortgage'\nAND T3.amount > 4000;",
        "pred_time": 0.08275961875915527,
        "orig_time": 0.14666199684143066,
        "time_ratio": 1.7721444230940975,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many accounts in Beroun were opened after 1996?",
        "original_query": "SELECT COUNT(account_id) FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T1.date) > '1996' AND T2.A2 = 'Beroun'",
        "llm_output": "-- Reasoning\nWe join the account and district tables using district_id, filter for accounts in the city of Beroun and opened after 1996, and return the count of such accounts.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.date > '1996-12-31'\nAND T2.A2 = 'Beroun';",
        "pred_query": "SELECT COUNT(*)\nFROM account AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE T1.date > '1996-12-31'\nAND T2.A2 = 'Beroun';",
        "pred_time": 0.0013816356658935547,
        "orig_time": 0.0018224716186523438,
        "time_ratio": 1.3190681622088007,
        "check": true
    },
    {
        "id": "financial",
        "question": "How many female customers have a junior credit card?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN disp AS T2 ON T1.client_id = T2.client_id INNER JOIN card AS T3 ON T2.disp_id = T3.disp_id WHERE T1.gender = 'F' AND T3.type = 'junior'",
        "llm_output": "-- Reasoning\nWe need to find the number of female customers who have a junior credit card. To do this, we need to join the client and disp tables on the client_id, filter for female clients and junior credit cards, and then count the number of matches.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE T1.gender = 'F' AND T3.type = 'Junior';",
        "pred_query": "SELECT COUNT(*)\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nINNER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nWHERE T1.gender = 'F' AND T3.type = 'Junior';",
        "pred_time": 0.0011343955993652344,
        "orig_time": 0.0008220672607421875,
        "time_ratio": 0.7246742328709542,
        "check": false
    },
    {
        "id": "financial",
        "question": "What proportion of customers who have accounts at the Prague branch are female?",
        "original_query": "SELECT CAST(SUM(T2.gender = 'F') AS REAL) / COUNT(T2.client_id) * 100 FROM district AS T1 INNER JOIN client AS T2 ON T1.district_id = T2.district_id WHERE T1.A3 = 'Prague'",
        "llm_output": "-- Question\nWhat proportion of customers who have accounts at the Prague branch are female?\n\n-- Reasoning\nTo find the proportion of customers who have accounts at the Prague branch that are female, we need to join the account and client tables on their district IDs. Then, we filter the districts that are Prague, select only female clients, and calculate the proportion.\n\n-- SQL Query\nSELECT CAST(COUNT(CASE WHEN T2.gender = 'Female' THEN 1 ELSE NULL END) AS REAL) * 100 / COUNT(T2.client_id)\nFROM account AS T1\nINNER JOIN client AS T2 ON T1.district_id = T2.district_id\nINNER JOIN district AS T3 ON T2.district_id = T3.district_id\nWHERE T3.A2 = 'Prague';",
        "pred_query": "SELECT CAST(COUNT(CASE WHEN T2.gender = 'Female' THEN 1 ELSE NULL END) AS REAL) * 100 / COUNT(T2.client_id)\nFROM account AS T1\nINNER JOIN client AS T2 ON T1.district_id = T2.district_id\nINNER JOIN district AS T3 ON T2.district_id = T3.district_id\nWHERE T3.A2 = 'Prague';",
        "pred_time": 0.0016334056854248047,
        "orig_time": 0.001317739486694336,
        "time_ratio": 0.8067435410888921,
        "check": false
    },
    {
        "id": "financial",
        "question": "What percentage of male clients request for weekly statements to be issued?",
        "original_query": "SELECT CAST(SUM(T1.gender = 'M') AS REAL) * 100 / COUNT(T1.client_id) FROM client AS T1 INNER JOIN account AS T2 ON T1.district_id = T2.district_id WHERE T2.frequency = 'POPLATEK TYDNE'",
        "llm_output": "-- Reasoning\nWe start by counting the total number of male clients in the client table. Then, we select all clients who request for weekly statements from the account table. Since we want the percentage of males requesting for weekly statements, we will divide the number of males requesting by the total number of males.\n\n-- SQL Query\nSELECT CAST(COUNT(CASE WHEN T1.frequency = 'Weekly' AND T2.gender = 'M' THEN T1.account_id ELSE NULL END)\n             AS REAL) * 100 / COUNT(CASE WHEN T2.gender = 'M' THEN T2.client_id ELSE NULL END)\nFROM account AS T1\nINNER JOIN client AS T2 ON T1.district_id = T2.district_id",
        "pred_query": "SELECT CAST(COUNT(CASE WHEN T1.frequency = 'Weekly' AND T2.gender = 'M' THEN T1.account_id ELSE NULL END)\n             AS REAL) * 100 / COUNT(CASE WHEN T2.gender = 'M' THEN T2.client_id ELSE NULL END)\nFROM account AS T1\nINNER JOIN client AS T2 ON T1.district_id = T2.district_id",
        "pred_time": 0.05707955360412598,
        "orig_time": 0.0058095455169677734,
        "time_ratio": 0.10177979942274518,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many clients who choose statement of weekly issuance are User?",
        "original_query": "SELECT COUNT(T2.account_id) FROM account AS T1 INNER JOIN disp AS T2 ON T2.account_id = T1.account_id WHERE T1.frequency = 'POPLATEK TYDNE' AND T2.type = 'USER'",
        "llm_output": "-- Reasoning\nWe join the disp and client tables using client_id, filter for clients issued weekly, then count those who are of gender 'User'. \n\n-- SQL Query\nSELECT COUNT(*)\nFROM client AS T1\nINNER JOIN disp ON T1.client_id = disp.client_id\nWHERE disp.type = 'Weekly' AND T1.gender = 'User';",
        "pred_query": "SELECT COUNT(*)\nFROM client AS T1\nINNER JOIN disp ON T1.client_id = disp.client_id\nWHERE disp.type = 'Weekly' AND T1.gender = 'User';",
        "pred_time": 0.0016412734985351562,
        "orig_time": 0.0008423328399658203,
        "time_ratio": 0.51321905868681,
        "check": true
    },
    {
        "id": "financial",
        "question": "Among the accounts who have loan validity more than 24 months, list out the accounts that have the lowest approved amount and have account opening date before 1997.",
        "original_query": "SELECT T1.account_id FROM loan AS T1 INNER JOIN account AS T2 ON T1.account_id = T2.account_id WHERE T1.duration > 24 AND STRFTIME('%Y', T2.date) < '1997' ORDER BY T1.amount ASC LIMIT 1",
        "llm_output": "-- Reasoning\nWe need accounts with loan validity more than 24 months, the lowest approved amount, and account opening date before 1997. First, we join loan and account tables to get the account id and approved amount of loans. Then, we filter the result to include only loans with duration more than 24 months and account open dates before 1997. We select the minimum approved amount, join it with the first query to get the account id corresponding to the minimum approved amount, and finally return the account.\n\n-- SQL Query\nSELECT T1.account_id\nFROM loan AS T1\nJOIN account AS T2 ON T1.account_id = T2.account_id\nWHERE T1.duration + 1 > 24 AND STRFTIME('%Y', T2.date) < '1997'\nJOIN ( SELECT MIN(amount) amount_id FROM loan WHERE duration + 1 > 24 AND STRFTIME('%Y', date) < '1997' ) AS T3 ON amount = T3.amount_id",
        "pred_query": "SELECT T1.account_id\nFROM loan AS T1\nJOIN account AS T2 ON T1.account_id = T2.account_id\nWHERE T1.duration + 1 > 24 AND STRFTIME('%Y', T2.date) < '1997'\nJOIN ( SELECT MIN(amount) amount_id FROM loan WHERE duration + 1 > 24 AND STRFTIME('%Y', date) < '1997' ) AS T3 ON amount = T3.amount_id",
        "pred_time": null,
        "orig_time": 0.0009784698486328125,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Name the account numbers of female clients who are oldest and have lowest average salary?",
        "original_query": "SELECT T3.account_id FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN account AS T3 ON T2.district_id = T3.district_id WHERE T1.gender = 'F' ORDER BY T1.birth_date ASC, T2.A11 ASC LIMIT 1",
        "llm_output": "-- Reasoning\nTo find the account numbers of female clients who are oldest and have the lowest average salary, we first need to calculate the average salary for each gender, then find the minimum average salary among females, and finally select the account numbers of female clients with this minimum average salary. We join client, account, and trans tables to access necessary data, calculate the average salary for each gender, find the minimum average salary among females, and return the account numbers of female clients with this minimum average salary.\n\n-- SQL Query\nSELECT T1.account_id\nFROM client AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3 ON T1.client_id = T3.account_id\nWHERE T1.gender = 'F' AND T1.birth_date = (\n    SELECT T.birth_date\n    FROM client AS T\n    WHERE T.gender = 'F'\n    ORDER BY T.birth_date DESC\n    LIMIT 1\n)\nAND T2.district_id = (\n    SELECT T.district_id\n    FROM client AS T\n    WHERE T.gender = 'F'\n    GROUP BY T.district_id\n    ORDER BY AVG(T3.balance) ASC\n    LIMIT 1\n)",
        "pred_query": "SELECT T1.account_id\nFROM client AS T1\nINNER JOIN account AS T2 ON T1.district_id = T2.district_id\nINNER JOIN trans AS T3 ON T1.client_id = T3.account_id\nWHERE T1.gender = 'F' AND T1.birth_date = (\n    SELECT T.birth_date\n    FROM client AS T\n    WHERE T.gender = 'F'\n    ORDER BY T.birth_date DESC\n    LIMIT 1\n)\nAND T2.district_id = (\n    SELECT T.district_id\n    FROM client AS T\n    WHERE T.gender = 'F'\n    GROUP BY T.district_id\n    ORDER BY AVG(T3.balance) ASC\n    LIMIT 1\n)",
        "pred_time": null,
        "orig_time": 0.022928953170776367,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many clients who were born in 1920 stay in east Bohemia?",
        "original_query": "SELECT COUNT(T1.client_id) FROM client AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id WHERE STRFTIME('%Y', T1.birth_date) = '1920' AND T2.A3 = 'east Bohemia'",
        "llm_output": "-- Reasoning\nWe first identify the table and column where the client's birth year is available (the `birth_date` in the client table). Then, we join this table with the district table based on district_id to link districts with their locations. Finally, we filter districts in the east Bohemia region and count how many clients were born in 1920.\n\n-- SQL Query\nSELECT COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE strftime('%Y', T1.birth_date) = '1920'\nAND T2.A2 = 'East Bohemia';",
        "pred_query": "SELECT COUNT(T1.client_id)\nFROM client AS T1\nINNER JOIN district AS T2 ON T1.district_id = T2.district_id\nWHERE strftime('%Y', T1.birth_date) = '1920'\nAND T2.A2 = 'East Bohemia';",
        "pred_time": 0.0018405914306640625,
        "orig_time": 0.0015163421630859375,
        "time_ratio": 0.8238341968911918,
        "check": false
    },
    {
        "id": "financial",
        "question": "How many loan accounts are for pre-payment of duration of 24 months with weekly issuance of statement.",
        "original_query": "SELECT COUNT(T2.account_id) FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T2.duration = 24 AND T1.frequency = 'POPLATEK TYDNE'",
        "llm_output": "-- Reasoning\nWe join the account and loan tables using account_id. We filter for weekly statement issuance and loan durations of 24 months. We count rows from this filtered result set.\n\n-- SQL Query\nSELECT COUNT(*)\nFROM loan AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nWHERE T2.frequency = 'Weekly' AND T1.duration = 24;",
        "pred_query": "SELECT COUNT(*)\nFROM loan AS T1\nINNER JOIN account AS T2 ON T1.account_id = T2.account_id\nWHERE T2.frequency = 'Weekly' AND T1.duration = 24;",
        "pred_time": 0.0012373924255371094,
        "orig_time": 0.0006725788116455078,
        "time_ratio": 0.5435452793834297,
        "check": false
    },
    {
        "id": "financial",
        "question": "What is the average amount of loan which are still on running contract with statement issuance after each transaction?",
        "original_query": "SELECT AVG(T2.payments) FROM account AS T1 INNER JOIN loan AS T2 ON T1.account_id = T2.account_id WHERE T2.status IN ('C', 'D') AND T1.frequency = 'POPLATEK PO OBRATU'",
        "llm_output": "-- Reasoning\nTo find the average amount of loans that are still running, we need to join the loan table with the account table based on account_id and then filter for loans where the status is 'Running'. Since we want the average amount after each transaction, we need to get the maximum date for each account id in the transaction table, then join this result with the loan table. This will give us the loan with the most recent payment which is still active. We can then get the average amount of these loans.\n\n-- SQL Query\nSELECT AVG(T2.amount)\nFROM trans AS T1\nINNER JOIN loan AS T2 ON T1.account_id = T2.account_id\nINNER JOIN account AS T3 ON T2.account_id = T3.account_id\nWHERE T1.date = (\n  SELECT MAX(date)\n  FROM trans AS T4\n  INNER JOIN account AS T5 ON T4.account_id = T5.account_id\n  WHERE T5.district_id = T3.district_id\n    AND T4.date IN (\n      SELECT T6.date\n      FROM trans AS T6\n      INNER JOIN account AS T7 ON T6.account_id = T7.account_id\n      INNER JOIN loan AS T8 ON T7.account_id = T8.account_id\n      WHERE T6.date > T8.date\n        AND T8.status = 'Running'\n    )\n)\nAND T2.status = 'Running'",
        "pred_query": "SELECT AVG(T2.amount)\nFROM trans AS T1\nINNER JOIN loan AS T2 ON T1.account_id = T2.account_id\nINNER JOIN account AS T3 ON T2.account_id = T3.account_id\nWHERE T1.date = (\n  SELECT MAX(date)\n  FROM trans AS T4\n  INNER JOIN account AS T5 ON T4.account_id = T5.account_id\n  WHERE T5.district_id = T3.district_id\n    AND T4.date IN (\n      SELECT T6.date\n      FROM trans AS T6\n      INNER JOIN account AS T7 ON T6.account_id = T7.account_id\n      INNER JOIN loan AS T8 ON T7.account_id = T8.account_id\n      WHERE T6.date > T8.date\n        AND T8.status = 'Running'\n    )\n)\nAND T2.status = 'Running'",
        "pred_time": null,
        "orig_time": 0.0008511543273925781,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "List all ID and district for clients that can only have the right to issue permanent orders or apply for loans.",
        "original_query": "SELECT T3.client_id, T2.district_id, T2.A2 FROM account AS T1 INNER JOIN district AS T2 ON T1.district_id = T2.district_id INNER JOIN disp AS T3 ON T1.account_id = T3.account_id WHERE T3.type = 'OWNER'",
        "llm_output": "-- Reasoning\nWe want clients who have either a card with type = 'Permanent Order' or loans. This means we join the client table with the disp table and filter the results where the client has either a disp_id corresponding to a Permanent Order type in the card table or a loan_id in the loan table.\n\n-- SQL Query\nSELECT T1.client_id, T1.district_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nFULL OUTER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nFULL OUTER JOIN loan AS T4 ON T1.client_id = T4.account_id\nWHERE T3.type = 'Permanent Order'\nOR T4.loan_id IS NOT NULL;",
        "pred_query": "SELECT T1.client_id, T1.district_id\nFROM client AS T1\nINNER JOIN disp AS T2 ON T1.client_id = T2.client_id\nFULL OUTER JOIN card AS T3 ON T2.disp_id = T3.disp_id\nFULL OUTER JOIN loan AS T4 ON T1.client_id = T4.account_id\nWHERE T3.type = 'Permanent Order'\nOR T4.loan_id IS NOT NULL;",
        "pred_time": null,
        "orig_time": 0.004170656204223633,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "financial",
        "question": "Provide the IDs and age of the client with high level credit card, which is eligible for loans.",
        "original_query": "SELECT T1.client_id, STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', T3.birth_date) FROM disp AS T1 INNER JOIN card AS T2 ON T2.disp_id = T1.disp_id INNER JOIN client AS T3 ON T1.client_id = T3.client_id WHERE T2.type = 'gold' AND T1.type = 'OWNER'",
        "llm_output": "-- Question\nProvide the IDs and age of the client with high level credit card, which is eligible for loans.\n\n-- Reasoning\nWe need the client_id and age of a client who has at least one disp with type 'HLC'. We also need to check for the client's eligibility for loans by joining the client table with the loan table, ensuring that the account_id in the loan is the same as the account_id in the disp. Finally, we return the client's age.\n\n-- SQL Query\nWITH eligible_clients AS (\n  SELECT T1.client_id\n  FROM disp AS T1\n  INNER JOIN account AS T2 ON T1.account_id = T2.account_id\n  INNER JOIN loan AS T3 ON T2.account_id = T3.account_id\n  WHERE T1.type = 'HLC' AND T3.status = 'Approved'\n  GROUP BY T1.client_id\n)\nSELECT T1.client_id,\n       TIMESTAMP(T1.birth_date, '+' || strftime('%J', 'now') || ' days') - T1.birth_date AS age\nFROM client AS T1\nINNER JOIN eligible_clients AS T2 ON T1.client_id = T2.client_id;",
        "pred_query": "SELECT T1.client_id\n  FROM disp AS T1\n  INNER JOIN account AS T2 ON T1.account_id = T2.account_id\n  INNER JOIN loan AS T3 ON T2.account_id = T3.account_id\n  WHERE T1.type = 'HLC' AND T3.status = 'Approved'\n  GROUP BY T1.client_id\n)\nSELECT T1.client_id,\n       TIMESTAMP(T1.birth_date, '+' || strftime('%J', 'now') || ' days') - T1.birth_date AS age\nFROM client AS T1\nINNER JOIN eligible_clients AS T2 ON T1.client_id = T2.client_id;",
        "pred_time": null,
        "orig_time": 0.0010673999786376953,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "toxicology",
        "question": "What is the most common bond type?",
        "original_query": "SELECT T.bond_type FROM ( SELECT bond_type, COUNT(bond_id) FROM bond GROUP BY bond_type ORDER BY COUNT(bond_id) DESC LIMIT 1 ) AS T",
        "llm_output": "-- Reasoning\nWe group the bonds table by bond_type, count the occurrences of each bond type, and return the most common one. \n\n-- SQL Query\nSELECT bond_type\nFROM bond\nGROUP BY bond_type\nORDER BY COUNT(*) DESC\nLIMIT 1;",
        "pred_query": "SELECT bond_type\nFROM bond\nGROUP BY bond_type\nORDER BY COUNT(*) DESC\nLIMIT 1;",
        "pred_time": 0.0045888423919677734,
        "orig_time": 0.0043087005615234375,
        "time_ratio": 0.9389515249129734,
        "check": true
    },
    {
        "id": "toxicology",
        "question": "In the non-carcinogenic molecules, how many contain chlorine atoms?",
        "original_query": "SELECT COUNT(DISTINCT T1.molecule_id) FROM molecule AS T1 INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id WHERE T2.element = 'cl' AND T1.label = '-'",
        "llm_output": "-- Reasoning\nWe need to find the number of non-carcinogenic molecules that contain chlorine atoms. This requires joining the atom and molecule tables based on molecule ID, filtering for molecules with 'non-carcinogenic' label, counting atoms of chlorine in each molecule, and grouping by molecule ID to get the total count for each molecule. We then filter for non-zero counts and return the count of such molecules.\n\n-- SQL Query\nSELECT COUNT(T3.molecule_id)\nFROM atom AS T1\nINNER JOIN connected AS T2 ON T1.atom_id = T2.atom_id\nINNER JOIN connected AS T3 ON T1.atom_id = T3.atom_id2\nINNER JOIN connected AS T4 ON T3.atom_id = T4.atom_id\nINNER JOIN connected AS T5 ON T1.atom_id = T5.atom_id2\nINNER JOIN connected AS T6 ON T5.atom_id = T6.atom_id\nINNER JOIN connected AS T7 ON T1.atom_id = T7.atom_id2\nINNER JOIN bond AS T8 ON T7.bond_id = T8.bond_id\nINNER JOIN atom AS T9 ON T7.atom_id = T9.atom_id\nINNER JOIN molecule AS T10 ON T9.molecule_id = T10.molecule_id\nWHERE T10.label = 'non-carcinogenic' AND T9.element = 'chlorine'\nGROUP BY T10.molecule_id\nHAVING COUNT(T9.element) > 1",
        "pred_query": "SELECT COUNT(T3.molecule_id)\nFROM atom AS T1\nINNER JOIN connected AS T2 ON T1.atom_id = T2.atom_id\nINNER JOIN connected AS T3 ON T1.atom_id = T3.atom_id2\nINNER JOIN connected AS T4 ON T3.atom_id = T4.atom_id\nINNER JOIN connected AS T5 ON T1.atom_id = T5.atom_id2\nINNER JOIN connected AS T6 ON T5.atom_id = T6.atom_id\nINNER JOIN connected AS T7 ON T1.atom_id = T7.atom_id2\nINNER JOIN bond AS T8 ON T7.bond_id = T8.bond_id\nINNER JOIN atom AS T9 ON T7.atom_id = T9.atom_id\nINNER JOIN molecule AS T10 ON T9.molecule_id = T10.molecule_id\nWHERE T10.label = 'non-carcinogenic' AND T9.element = 'chlorine'\nGROUP BY T10.molecule_id\nHAVING COUNT(T9.element) > 1",
        "pred_time": null,
        "orig_time": 0.0018939971923828125,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "toxicology",
        "question": "Calculate the average number of oxygen atoms in single-bonded molecules.",
        "original_query": "SELECT AVG(oxygen_count) FROM (SELECT T1.molecule_id, COUNT(T1.element) AS oxygen_count FROM atom AS T1 INNER JOIN bond AS T2 ON T1.molecule_id = T2.molecule_id  WHERE T2.bond_type = '-' AND T1.element = 'o'  GROUP BY T1.molecule_id) AS oxygen_counts",
        "llm_output": "-- Reasoning\nTo calculate the average number of oxygen atoms in single-bonded molecules, we need to first join the connected table with itself to find pairs of atoms, then join the resulting table with the atom table to get the element of each atom, and finally join the atom table with the molecule table to get the molecule information. Next, we filter the results to single-bonded molecules using the bond table, then group the results by molecule and count the oxygen atoms in each molecule, and finally calculate the average number of oxygen atoms across all molecules.\n\n-- SQL Query\nSELECT AVG(T4.count) \nFROM (\n  SELECT T1.label \n  FROM connected AS T1 \n  INNER JOIN connected AS T2 ON T1.atom_id2 = T2.atom_id AND T2.bond_id IS NULL \n  INNER JOIN atom AS T3 ON T1.atom_id = T3.atom_id \n  LEFT JOIN atom AS T6 ON T2.atom_id2 = T6.atom_id \n  INNER JOIN bond AS T5 ON T1.bond_id = T5.bond_id \n  WHERE T3.element = 'Oxygen' AND T5.bond_type IS NOT NULL \n  GROUP BY T1.label \n) AS T6 \nINNER JOIN molecule AS T7 ON T6.label = T7.label \nINNER JOIN atom AS T4 ON T7.molecule_id = T4.molecule_id \nWHERE T4.element = 'Oxygen';",
        "pred_query": "SELECT AVG(T4.count) \nFROM (\n  SELECT T1.label \n  FROM connected AS T1 \n  INNER JOIN connected AS T2 ON T1.atom_id2 = T2.atom_id AND T2.bond_id IS NULL \n  INNER JOIN atom AS T3 ON T1.atom_id = T3.atom_id \n  LEFT JOIN atom AS T6 ON T2.atom_id2 = T6.atom_id \n  INNER JOIN bond AS T5 ON T1.bond_id = T5.bond_id \n  WHERE T3.element = 'Oxygen' AND T5.bond_type IS NOT NULL \n  GROUP BY T1.label \n) AS T6 \nINNER JOIN molecule AS T7 ON T6.label = T7.label \nINNER JOIN atom AS T4 ON T7.molecule_id = T4.molecule_id \nWHERE T4.element = 'Oxygen';",
        "pred_time": null,
        "orig_time": 0.013008356094360352,
        "time_ratio": 0,
        "check": false
    },
    {
        "id": "toxicology",
        "question": "On average how many carcinogenic molecules are single bonded?",
        "original_query": "SELECT AVG(single_bond_count) FROM (SELECT T3.molecule_id, COUNT(T1.bond_type) AS single_bond_count FROM bond AS T1  INNER JOIN atom AS T2 ON T1.molecule_id = T2.molecule_id INNER JOIN molecule AS T3 ON T3.molecule_id = T2.molecule_id WHERE T1.bond_type = '-' AND T3.label = '+' GROUP BY T3.molecule_id) AS subquery",
        "llm_output": "-- Reasoning\nWe need to find the average number of single bonded atoms (atoms that have bond_type='single') in carcinogenic molecules. To do this, we join the connected table with the bond table using bond_id, group by atom_id to find the number of single bonded atoms for each atom, and filter for atoms in carcinogenic molecules by joining the connected table with the atom and molecule tables using their IDs. Finally, we use the sum of single bonded atoms for each atom and divide it by the count of the unique atoms to get the average number.\n\n-- SQL Query\nSELECT COUNT(DISTINCT T1.atom_id) / COUNT(DISTINCT T2.atom_id)\nFROM atom AS T1\nINNER JOIN connected AS T2 ON T1.atom_id = T2.atom_id\nJOIN bond AS T3 ON T2.bond_id = T3.bond_id\nWHERE T1.molecule_id IN (SELECT molecule_id FROM molecule WHERE label LIKE '%carcinogen%')\nAND T3.bond_type = 'single';",
        "pred_query": "SELECT COUNT(DISTINCT T1.atom_id) / COUNT(DISTINCT T2.atom_id)\nFROM atom AS T1\nINNER JOIN connected AS T2 ON T1.atom_id = T2.atom_id\nJOIN bond AS T3 ON T2.bond_id = T3.bond_id\nWHERE T1.molecule_id IN (SELECT molecule_id FROM molecule WHERE label LIKE '%carcinogen%')\nAND T3.bond_type = 'single';",
        "pred_time": 0.03330540657043457,
        "orig_time": 0.11041545867919922,
        "time_ratio": 3.315241279090577,
        "check": false
    },
    {
        "id": "toxicology",
        "question": "In the molecule containing sodium atoms, how many are non-carcinogenic?",
        "original_query": "SELECT COUNT(DISTINCT T2.molecule_id) FROM atom AS T1 INNER JOIN molecule AS T2 ON T1.molecule_id = T2.molecule_id WHERE T1.element = 'na' AND T2.label = '-'",
        "llm_output": "-- Reasoning\nTo answer the question, we first need to find the molecule containing sodium, which can be achieved by joining the atom and molecule tables based on the molecule_id. Then we can calculate the number of non-carcinogenic atoms (assuming 'non-carcinogenic' means no 'Carcinogen' in the hazard label) in the found molecule.\n\n-- SQL Query\nSELECT COUNT(T1.atom_id)\nFROM atom AS T1\nINNER JOIN connected AS T2 ON T1.atom_id = T2.atom_id\nINNER JOIN molecule AS T3 ON T1.molecule_id = T3.molecule_id\nWHERE T3.label LIKE '%sodium%' \nAND T3.label NOT LIKE '%Carcinogen%;%'",
        "pred_query": "SELECT COUNT(T1.atom_id)\nFROM atom AS T1\nINNER JOIN connected AS T2 ON T1.atom_id = T2.atom_id\nINNER JOIN molecule AS T3 ON T1.molecule_id = T3.molecule_id\nWHERE T3.label LIKE '%sodium%' \nAND T3.label NOT LIKE '%Carcinogen%;",
        "pred_time": null,
        "orig_time": 0.001483917236328125,
        "time_ratio": 0,
        "check": false
    }
]